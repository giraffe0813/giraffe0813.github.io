{"meta":{"title":"Giraffe's Home","subtitle":"A Stupid Giraffe","description":"Add more ~ing into your life","author":"Mengying Ye","url":"http://yemengying.com"},"pages":[{"title":"Categories","date":"2016-03-19T01:28:47.000Z","updated":"2016-02-02T05:59:56.000Z","comments":true,"path":"categories/index.html","permalink":"http://yemengying.com/categories/index.html","excerpt":"","keywords":null,"text":"","raw":null,"content":null},{"title":"å‹æƒ…é“¾æ¥","date":"2017-08-10T02:29:49.000Z","updated":"2017-08-10T02:29:49.000Z","comments":true,"path":"friends/index.html","permalink":"http://yemengying.com/friends/index.html","excerpt":"","keywords":null,"text":"ä¸‰â€è§‚â€èŒ…åº(ä¸€ä¸ªåšè¿‡åç«¯ï¼Œå‰ç«¯ï¼Œç›®å‰åœ¨åšç§»åŠ¨ç«¯çš„ç¨‹åºçŒ´çš„åšå®¢)é»˜é»˜å°å±‹(æ€§æƒ…æ¸©é¡º,ä¸»ä¸šå†™ä»£ç )James Panâ€™s Blog(çœŸâ˜…å¤§ç¥çš„åšå®¢)Jiaxiâ€™s Home(share various techniques &amp; life)ä»“é¼ å›(èŒèŒå“’ä»“é¼ å›çš„blog)è„šæ‰‹æ¶ä¸è½®å­(ğŸ˜˜)ookamiAntDâ€™s Blog(Javaæ”»åŸç‹®)å§‹ç»ˆ(Liam Huangâ€˜s blog)crossoverjieâ€™s blog(You never know what you can do till you try.)","raw":null,"content":null},{"title":"æ­£åœ¨è¯»...","date":"2017-07-02T14:11:30.000Z","updated":"2017-07-02T14:11:30.000Z","comments":true,"path":"reading/index.html","permalink":"http://yemengying.com/reading/index.html","excerpt":"","keywords":null,"text":"ã€Šé»‘å®¢ä¸ç”»å®¶ã€‹ä½œè€…ï¼šPaul Graham å·²çœ‹å®Œ ã€Šæˆ‘ä»¬ä»¨ã€‹ ã€Šäººç±»ç®€å²ã€‹ ã€Šè…¾è®¯ä¼ ã€‹ ã€Šå“ˆåˆ©æ³¢ç‰¹ä¸æ­»äº¡åœ£å™¨ã€‹ ã€Šå“ˆåˆ©æ³¢ç‰¹ä¸æ··è¡€ç‹å­ã€‹ ã€Šå“ˆåˆ©æ³¢ç‰¹ä¸å‡¤å‡°ç¤¾ã€‹ ã€Šå“ˆåˆ©æ³¢ç‰¹ä¸ç«ç„°æ¯ã€‹ ã€Šå“ˆåˆ©æ³¢ç‰¹ä¸é˜¿å…¹å¡ç­å›šå¾’ã€‹ ã€Šå“ˆåˆ©æ³¢ç‰¹ä¸å¯†å®¤ã€‹ ã€Šå“ˆåˆ©æ³¢ç‰¹ä¸é­”æ³•çŸ³ã€‹","raw":null,"content":null},{"title":"ç•™è¨€","date":"2016-09-21T08:49:17.000Z","updated":"2016-09-21T08:49:17.000Z","comments":true,"path":"message/index.html","permalink":"http://yemengying.com/message/index.html","excerpt":"","keywords":null,"text":"æ¬¢è¿å¤§å®¶ç•™è¨€~ ä¸€èµ·äº¤æµï¼Œå­¦ä¹ ï¼ŒåŠªåŠ›ï¼Œæˆé•¿å§ ğŸ‰ğŸ‰ğŸ‰~~","raw":null,"content":null},{"title":"RESULT","date":"2016-03-19T01:28:47.000Z","updated":"2016-01-18T05:59:08.000Z","comments":false,"path":"search/index.html","permalink":"http://yemengying.com/search/index.html","excerpt":"","keywords":null,"text":"","raw":null,"content":null},{"title":"Tags","date":"2016-03-19T01:28:47.000Z","updated":"2016-02-02T05:59:56.000Z","comments":true,"path":"tags/index.html","permalink":"http://yemengying.com/tags/index.html","excerpt":"","keywords":null,"text":"","raw":null,"content":null},{"title":"å…³äºæˆ‘","date":"2016-04-02T05:20:37.000Z","updated":"2016-10-16T07:34:07.000Z","comments":true,"path":"about/index.html","permalink":"http://yemengying.com/about/index.html","excerpt":"","keywords":null,"text":"æ™®é€šç¨‹åºå‘˜ï¼Œæ¯•ä¸šäºä¸œä¸­å›½æ­£å¸¸å¤§å­¦(æ ¡å‹éƒ½æ‡‚å“ˆ)ï¼Œç›®å‰ä»äº‹Javaå¼€å‘ï¼Œå¯¹pythonå’Œæœç´¢ä¹Ÿæœ‰æ‰€äº†è§£ã€‚ç”Ÿæ´»å¤§çˆ†ç‚¸å’ŒRunning manè„‘æ®‹ç²‰ï¼Œå› ä¸ºå¾ˆå–œæ¬¢æå…‰æ´™(å¤–å·é•¿é¢ˆé¹¿)ï¼Œæ‰€ä»¥åšå®¢å–åä¸ºGiraffeâ€™s Homeï¼Œç”¨æ¥è®°å½•å­¦ä¹ æ€è€ƒä¸­çš„ä¸€äº›æ”¶è·ï¼Œä¹Ÿè®¸ä¼šæœ‰é”™è¯¯ï¼Œä¹Ÿè®¸å¹¶ä¸å®Œç¾ï¼Œä½†è¿™ä¸å°±æ˜¯æˆé•¿çš„è¿‡ç¨‹ä¹ˆã€‚æ²¡ä»€ä¹ˆå®ä¼Ÿçš„ç›®æ ‡ï¼Œåªå¸Œæœ›æ¯å¤©éƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼Œadd more ing into my lifeã€‚ğŸ˜œğŸ˜œğŸ˜œ è”ç³»æ–¹å¼:yemengying1993@foxmail.com å‰æ–¹é«˜èƒ½é¢„è­¦ï¼Œéæˆ˜æ–—äººå‘˜æŠ“ç´§æ’¤ç¦» ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ æ—¢ç„¶ä¸æ’¤ç¦»å°±å…³æ³¨ä¸€ä¸‹å§ğŸŒ[æ‚è„¸]","raw":null,"content":null}],"posts":[{"title":"å°æ­»é”","slug":"deadlock-in-oracle","date":"2017-07-15T14:52:22.000Z","updated":"2017-07-17T14:55:34.000Z","comments":true,"path":"2017/07/15/deadlock-in-oracle/","link":"","permalink":"http://yemengying.com/2017/07/15/deadlock-in-oracle/","excerpt":"æœ€è¿‘çº¿ä¸Šå¶å°”å°±ä¼šæŠ¥ä¸ªæ­»é”é—®é¢˜ï¼Œä¸Šå‘¨ç»ˆäºè§£å†³äº†,å‘¨æœ«æ•´ç†ä¸‹ã€‚è™½ç„¶é—®é¢˜è§£å†³äº†ï¼Œä½†æ˜¯trace fileé‡Œçš„æ­»é”å›¾è¿˜æ˜¯ä¸å¤ªç†è§£ã€‚è¦æ˜¯æœ‰äººèƒ½ç»™æˆ‘è®²è®²é‚£çœŸæ˜¯æå¥½çš„ï¼Œè¦æ˜¯æ²¡äººçš„è¯æˆ‘å°±ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å†ç¿»ç¿»æ–‡æ¡£ã€‚","keywords":null,"text":"æœ€è¿‘çº¿ä¸Šå¶å°”å°±ä¼šæŠ¥ä¸ªæ­»é”é—®é¢˜ï¼Œä¸Šå‘¨ç»ˆäºè§£å†³äº†,å‘¨æœ«æ•´ç†ä¸‹ã€‚è™½ç„¶é—®é¢˜è§£å†³äº†ï¼Œä½†æ˜¯trace fileé‡Œçš„æ­»é”å›¾è¿˜æ˜¯ä¸å¤ªç†è§£ã€‚è¦æ˜¯æœ‰äººèƒ½ç»™æˆ‘è®²è®²é‚£çœŸæ˜¯æå¥½çš„ï¼Œè¦æ˜¯æ²¡äººçš„è¯æˆ‘å°±ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å†ç¿»ç¿»æ–‡æ¡£ã€‚ èƒŒæ™¯è¿‘ä¸€ä¸ªæœˆçº¿ä¸Šå¶å°”å°±ä¼šæŠ¥æ­»é”çš„é—®é¢˜ï¼Œé”™è¯¯å¦‚ä¸‹å›¾ï¼š â€œORA-00060: deadlock detected while waiting for resource â€è¿™ä¸ªé”™è¯¯è¯´æ˜Oracle æ•°æ®åº“ç›‘æµ‹åˆ°äº†æ­»é”çš„å­˜åœ¨ã€‚è¿™æ—¶ Oracle ä¼šå›æ»šé€ æˆæ­»é”çš„å…¶ä¸­ä¸€ä¸ªäº‹åŠ¡ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡æ­£å¸¸æ‰§è¡Œ(ä¸ä¼šå¯Ÿè§‰åˆ°å‘ç”Ÿäº†æ­»é”)ï¼Œå¹¶å‘æ‰§è¡Œäº†å›æ»šçš„äº‹åŠ¡æŠ›å‡ºä¸Šé¢çš„é”™è¯¯ä¿¡æ¯ã€‚ åœ¨ DBA çš„å¸®åŠ©ä¸‹å®šä½åˆ°äº†é€ æˆæ­»é”çš„ä¸¤å—ä»£ç ã€‚ç”±äºé¡¹ç›®æœ‰å¾ˆå¤šçš„æ‚²è§‚é”ï¼Œå³åˆ©ç”¨â€œSELECTâ€¦FOR UPDATEâ€å¯¹èµ„æºåŠ æ’ä»–è¡Œçº§é”ï¼Œæ‰€ä»¥ç¬¬ä¸€æ„Ÿè§‰å°±æ˜¯çœ‹çœ‹è¿™ä¸¤æ®µä»£ç æœ‰æ²¡æœ‰æŒ‰ç…§ç›¸åçš„é¡ºåºå¯¹ä¸¤ä¸ªæˆ–å¤šä¸ªèµ„æºè¿›è¡ŒåŠ é”ã€‚ ä¸è¿‡åˆ†æè¿‡ä»£ç ä¹‹åå´æ²¡æœ‰ç«‹åˆ»æ‰¾åˆ°å¯èƒ½é€ æˆæ­»é”çš„åŸå› ï¼Œä¸¤å—ä»£ç å¯¹æ•°æ®åº“èµ„æºçš„æ“ä½œå¦‚ä¸‹è¡¨ã€‚ ä»è¡¨é¢ä¸Šçœ‹Session 1è²Œä¼¼ä¸­åªé”äº† actor1 å¹¶æ›´æ–°ï¼ŒSession 2ä¸­ä¾æ¬¡é”äº† actor2 å’Œ actor1ï¼Œä¸æ»¡è¶³äº’ç›¸ç­‰å¾…å¯¹æ–¹åŠ é”çš„èµ„æºï¼Œå°±ç®—æ˜¯Session1æŒæœ‰actor1é”æ—¶é—´è¿‡é•¿ï¼Œå¯¼è‡´ Session2 ä¸€ç›´æ‹¿ä¸åˆ° actor1 çš„é”ï¼Œä¹Ÿåº”è¯¥æŠ¥â€œlock wait timeoutâ€ï¼Œè€Œä¸æ˜¯æ­»é”ã€‚ ä¸ºäº†éªŒè¯ç¡®å®æ˜¯è¿™ä¸¤æ®µä»£ç é€ æˆçš„æ­»é”ï¼Œå†™äº†æµ‹è¯•ä»£ç ï¼Œå¼€äº†ä¸¤ä¸ªçº¿ç¨‹ï¼Œæ¨¡ä»¿æ­»é”çš„è¿™ä¸¤æ®µä»£ç ï¼Œå»æ‰äº†ä¸æ•°æ®åº“æ— å…³çš„ä¸šåŠ¡é€»è¾‘ï¼Œçœ‹çœ‹èƒ½å¦é‡ç°ã€‚æ¯•ç«Ÿå¿ƒé‡Œè¿˜æœ‰ç‚¹å°æ€€ç–‘ï¼Œä¼šä¸ä¼šæ˜¯ DBA æé”™äº†ï¼Œä¸æ˜¯è¿™ä¸¤æ®µä»£ç çš„é—®é¢˜ã€‚ä»£ç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051@SpringApplicationConfiguration(classes = DeadLockTest.class)@ImportAutoConfiguration(&#123;CommonConfig.class&#125;)public class DeadLockTest extends BaseUnitDbTest &#123; Long lenderId = 16642L; Long borrowerId = 16643L; @Autowired private ActorService actorService; @Autowired @Qualifier(CommonConfig.ORACLE_TRANSACTION_MANAGER_NAME) private PlatformTransactionManager platformTransactionManager; private ExecutorService es = Executors.newFixedThreadPool(5, new ThreadFactoryBuilder().setNameFormat(\"Test-Thread-%d\").build()); @Test public void testRefreshAndLockActor() throws Exception &#123; es.invokeAll(Lists.newArrayList(this::lock1, this::lock2)); &#125; public Void lock1() &#123; TransactionTemplate t = new TransactionTemplate(platformTransactionManager); t.execute((s) -&gt; &#123; System.out.println(\"Before Lock \" + Thread.currentThread().getName()); Actor lender = actorService.refreshAndLockActor(lenderId); try &#123; Thread.sleep(6000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; lender.setLockedForInv(BigDecimal.ONE); actorService.update(lender); System.out.println(\"After Lock \" + Thread.currentThread().getName()); return null; &#125;); return null; &#125; public Void lock2() &#123; TransactionTemplate t = new TransactionTemplate(platformTransactionManager); t.execute((s) -&gt; &#123; try &#123; Thread.sleep(1000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; System.out.println(\"Before Lock \" + Thread.currentThread().getName()); Actor borrower = actorService.refreshAndLockActor(borrowerId); Actor lender = actorService.refreshAndLockActor(lenderId); System.out.println(\"After Lock \" + Thread.currentThread().getName()); return null; &#125;); return null; &#125;&#125; ç»“æœã€‚ã€‚ã€‚çœŸçš„æŠ¥äº†æ­»é”ã€‚ã€‚ã€‚ã€‚æ§åˆ¶å°çš„æŠ¥é”™å¦‚ä¸‹å›¾ é—®é¢˜åŸå› å·²ç»ç¡®å®šäº†é€ æˆæ­»é”çš„ä¸¤æ®µä»£ç ï¼Œæ¥ä¸‹æ¥å°±å·®æ‰¾å‡ºåŸå› äº†ã€‚SELECT ... FOR UPDATEæ¯”è¾ƒç›´è§‚ï¼Œå°±æ˜¯å¯¹èµ„æºåŠ è¡Œçº§æ’ä»–é”ï¼Œåº”è¯¥æ²¡ä»€ä¹ˆçŒ«è…»ã€‚é‚£å°±è‚¯å®šæ˜¯åœ¨UPDATE Actor1çš„æ—¶å€™æœ‰ä»€ä¹ˆä¸ä¸ºäººçŸ¥çš„æ“ä½œï¼Œå¯¼è‡´ Session1 éœ€è¦è·å– Actor2 çš„é”ï¼Œå¯¼è‡´æ­»é”ã€‚ ç¬¬ä¸€æ€€ç–‘çš„æ˜¯è§¦å‘å™¨ï¼Œè™½ç„¶ç›®å‰å…¬å¸å·²ç»ç¦æ­¢ä½¿ç”¨è§¦å‘å™¨äº†ï¼Œä½†ç”±äºå†å²åŸå› ä¸»åº“è¿˜æ˜¯é—ç•™ç€ä¸€äº›è§¦å‘å™¨ã€‚å’Œæ˜ä½³æ’æŸ¥äº†æ‰€æœ‰ç›¸å…³çš„è§¦å‘å™¨ä¹‹åï¼ŒåŸºæœ¬æ’é™¤äº†æ˜¯ç”±è§¦å‘å™¨å¼•èµ·çš„ã€‚ ä¸è¿‡è™½ç„¶è¿™ä¸ªé—®é¢˜ä¸æ˜¯è§¦å‘å™¨çš„é”…ï¼Œä½†è¿˜æ˜¯æä¼šåˆ°äº†ï¼Œåœ¨æ¶‰åŠåˆ°è§¦å‘å™¨æ—¶ï¼Œå¦‚æœä¸æ˜¯å¯¹ç³»ç»Ÿç‰¹åˆ«ç†Ÿï¼Œæ’æŸ¥é”™è¯¯çœŸçš„å¾ˆå›°éš¾ã€‚ã€‚ã€‚ æ’é™¤äº†è§¦å‘å™¨ä¹‹åï¼ŒDBA æå‡ºé‚£å°±åªèƒ½æ˜¯å¤–é”®å¯¼è‡´çš„äº†ã€‚åœ¨ DBA æŠŠ devç¯å¢ƒæ•°æ®åº“çš„å¤–é”®å»æ‰åï¼Œå†æ¬¡æ‰§è¡Œæµ‹è¯•ä»£ç ï¼Œæœç„¶å°±ä¸å†æŠ¥æ­»é”äº†ã€‚ åŸæ¥ Actor è¡¨ä¸Šçš„ refer_id æ˜¯ä¸€ä¸ªå…³è” Actor è¡¨ä¸»é”®çš„å¤–é”®(Self-Referential Integrity Constraints)ï¼Œè€Œ actor1 çš„ refer_id æ­£å¥½æ˜¯ actor2 çš„ idï¼Œæ‰€ä»¥åœ¨æ›´æ–° actor1 çš„å…¨å­—æ®µçš„æ—¶å€™ï¼Œä¹Ÿæ›´æ–°äº† refer_id(å…¶å®å€¼æ²¡å˜)ï¼Œç”±äºå¤–é”®çš„çº¦æŸï¼Œåœ¨å°† actor1 çš„ refer_id æ›´æ–°ä¸º actor2çš„ id æ—¶ï¼Œéœ€è¦ç¡®ä¿ actor2 æ˜¯å­˜åœ¨çš„ï¼Œå¹¶ä¸”åœ¨æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œä¸èƒ½è¢«åˆ é™¤ï¼Œæ‰€ä»¥ Session1 ä¼šç”³è¯· actor2 çš„é”(ä¸ªäººç†è§£ä¸ä¸€å®šå‡†ç¡®)ã€‚è€Œè¿™æ—¶ actor2 çš„é”å·²ç»è¢« Session2 æŒæœ‰äº†ï¼Œå¹¶ä¸” Session2 æ­£åœ¨ç­‰å¾… actor1 çš„é”ï¼Œå°±å‘ç”Ÿäº†æ­»é”ã€‚ ç”¨å›¾æ¥æè¿°ä¸‹ï¼š è§£å†³åŠæ³•è´¹äº†ä¸€å¤©å¤šæ‰æŠŠé—®é¢˜æ‰¾å‡ºæ¥ï¼Œç”¨äº†å‡ åˆ†é’Ÿå°± fix äº†ã€‚å…¶å®æˆ‘åªæ˜¯éœ€è¦æ›´æ–° Actor ä¸Šçš„ä¸¤ä¸ªå­—æ®µï¼Œæ ¹æœ¬ä¸éœ€è¦æ›´æ–°å…¨éƒ¨å­—æ®µï¼Œåªæ˜¯å½“æ—¶åœ¨å†™çš„æ—¶å€™å·²ç»æœ‰æ›´æ–°å…¨å­—æ®µçš„æ–¹æ³•äº†ï¼Œå°±å·äº†ä¸ªæ‡’ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ æ‰€ä»¥è§£å†³åŠæ³•å°±æ˜¯ä¸å†è°ƒç”¨æ›´æ–°å…¨å­—æ®µçš„æ–¹æ³•ï¼ŒåŠ äº†ä¸ªåªæ›´æ–°éƒ¨åˆ†å­—æ®µçš„æ–¹æ³•ï¼Œè¿™æ ·å°±ä¸ä¼šåœ¨æ›´æ–° actor1 çš„å¤–é”®å­—æ®µäº†ï¼Œä¹Ÿå°±ä¸ä¼šé€ æˆåœ¨æ›´æ–° actor1 çš„æ—¶å€™å»è¯·æ±‚ actor2 çš„é”äº†ã€‚ æ€»ç»“ è™½ç„¶è¿™ä¸ªé—®é¢˜ä¸æ˜¯è§¦å‘å™¨å¼•èµ·çš„ï¼Œä½†ç¦ç”¨è§¦å‘å™¨è¿˜æ˜¯å¾ˆæœ‰é“ç†æ»´ï¼Œä¸ç„¶å‡ºé—®é¢˜æŸ¥åˆ°åè¡€ å¤–é”®è¿™ä¸ªä¸œä¸œï¼Œä¹Ÿèƒ½ä¸ç”¨å°±ä¸ç”¨å§ï¼Œç”±ç¨‹åºæ§åˆ¶ã€‚å…¶å®ç°åœ¨å…¬å¸å·²ç»ä¸è®©ç”¨å¤–é”®å’Œè§¦å‘å™¨äº†ï¼Œä¸è¿‡ç”±äºå†å²åŸå› ï¼Œä¸€äº›è€ç³»ç»Ÿåªèƒ½æ…¢æ…¢é‡æ„äº†ã€‚æŸ¥äº†ä¸‹ï¼Œç”±äºå¤–é”®å¼•èµ·çš„æ­»é”è¿˜æ˜¯è›®å¤šçš„ï¼Œæ¯”è¾ƒå¸¸è§çš„æ˜¯å¤–é”®åˆ—ä¸åŠ ç´¢å¼•ï¼Œå¯¼è‡´æ›´æ–°ä¸»è¡¨å­—æ®µæ—¶é”ä½äº†å­è¡¨ï¼Œä¸‹ç¯‡blogå¯ä»¥å­¦ä¹ ä¸‹å¤–é”®å’Œæ­»é”ä¸å¾—ä¸è¯´çš„é‚£äº›äº‹ã€‚ç®—äº†ï¼Œè¿˜æ˜¯ä¸ç«‹ flag äº†ï¼ŒåŸºæœ¬ä¸Šè¯´äº†ä¸‹ç¯‡è¦å†™å•¥çš„ï¼Œéƒ½æ²¡æœ‰ä¸‹ç¯‡äº†ã€‚ã€‚ã€‚ã€‚ ä¸è¦æ›´æ–°å…¨å­—æ®µã€‚æŠ›å¼€è¿™ä¸ªæ­»é”é—®é¢˜ï¼Œæ›´æ–°å…¨å­—æ®µä¹Ÿæ˜¯å¾ˆå½±å“æ•ˆç‡çš„ã€‚è¿˜æ˜¯åªæ›´æ–°æœ‰æ”¹åŠ¨çš„å­—æ®µå§ã€‚ ä¸èƒ½å·æ‡’ï¼Œå½“æ—¶çœäº†5åˆ†é’Ÿï¼Œæ‰¾ bug èŠ±äº†ä¸€å¤©å¤šã€‚ã€‚ã€‚éƒ½æ˜¯æ³ª é—ç•™é—®é¢˜é—®é¢˜è™½ç„¶è§£å†³äº†ï¼Œä½†æ˜¯è¿˜æœ‰ç‚¹å°ç–‘é—®çš„ã€‚è¿™ä¸ªæ­»é”åœ¨ trace file ä¸­çš„æ­»é”å›¾å¦‚ä¸‹ï¼š é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸¤ä¸ª session æŒæœ‰ä¸¤ä¸ªèµ„æºçš„ X é”è¿˜æ˜¯å¥½ç†è§£çš„ï¼Œä½†ä»–ä»¬ç­‰å¾…çš„ä¸ºä»€ä¹ˆæ˜¯ S é”å‘¢ï¼Ÿï¼Ÿï¼Ÿè‡³å°‘ Session2 æ˜¯åœ¨ç­‰å¾… actor1 çš„æ’ä»–è¡Œçº§é”çš„ï¼Œä¸åº”è¯¥æ˜¯ä¹Ÿæ˜¯ç­‰å¾… X ä¹ˆã€‚æ±‚å¥½å¿ƒäººçš„è§£ç­”ã€‚","raw":null,"content":null,"categories":[{"name":"Oracle","slug":"Oracle","permalink":"http://yemengying.com/categories/Oracle/"}],"tags":[{"name":"Oracle","slug":"Oracle","permalink":"http://yemengying.com/tags/Oracle/"}]},{"title":"ã€è¯‘ã€‘Redditå¦‚ä½•ç»Ÿè®¡æ¯ä¸ªå¸–å­çš„æµè§ˆé‡","slug":"reddit-view-counting","date":"2017-06-04T05:26:17.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2017/06/04/reddit-view-counting/","link":"","permalink":"http://yemengying.com/2017/06/04/reddit-view-counting/","excerpt":"ä¹‹å‰æ²¡å¬è¿‡ä¹Ÿæ²¡äº†è§£è¿‡ HyperLogLogï¼Œé€šè¿‡ç¿»è¯‘è¿™ç¯‡æ–‡ç« æ­£å¥½ç®€å•å­¦ä¹ ä¸‹ã€‚æ¬¢è¿æŒ‡æ­£é”™è¯¯~","keywords":null,"text":"ä¹‹å‰æ²¡å¬è¿‡ä¹Ÿæ²¡äº†è§£è¿‡ HyperLogLogï¼Œé€šè¿‡ç¿»è¯‘è¿™ç¯‡æ–‡ç« æ­£å¥½ç®€å•å­¦ä¹ ä¸‹ã€‚æ¬¢è¿æŒ‡æ­£é”™è¯¯~ åŸæ–‡é“¾æ¥ğŸ˜ğŸ¤—ğŸ˜‰ æˆ‘ä»¬æƒ³è¦æ›´å¥½çš„å‘ç”¨æˆ·å±•ç¤º Reddit çš„è§„æ¨¡ã€‚ä¸ºäº†è¿™ä¸€ç‚¹ï¼ŒæŠ•ç¥¨å’Œè¯„è®ºæ•°æ˜¯ä¸€ä¸ªå¸–å­æœ€é‡è¦çš„æŒ‡æ ‡ã€‚ç„¶è€Œï¼Œåœ¨ Reddit ä¸Šæœ‰ç›¸å½“å¤šçš„ç”¨æˆ·åªæµè§ˆå†…å®¹ï¼Œæ—¢ä¸æŠ•ç¥¨ä¹Ÿä¸è¯„è®ºã€‚æ‰€ä»¥æˆ‘ä»¬æƒ³è¦å»ºç«‹ä¸€ä¸ªèƒ½å¤Ÿè®¡ç®—ä¸€ä¸ªå¸–å­æµè§ˆæ•°çš„ç³»ç»Ÿã€‚è¿™ä¸€æ•°å­—ä¼šè¢«å±•ç¤ºç»™å¸–å­çš„åˆ›ä½œè€…å’Œç‰ˆä¸»ï¼Œä»¥ä¾¿ä»–ä»¬æ›´å¥½çš„äº†è§£æŸä¸ªå¸–å­çš„æ´»è·ƒç¨‹åº¦ã€‚ åœ¨è¿™ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºæˆ‘ä»¬æ˜¯å¦‚ä½•å®ç°è¶…å¤§æ•°æ®é‡çš„è®¡æ•°ã€‚ è®¡æ•°æœºåˆ¶å¯¹äºè®¡æ•°ç³»ç»Ÿæˆ‘ä»¬ä¸»è¦æœ‰å››ç§éœ€æ±‚: å¸–å­æµè§ˆæ•°å¿…é¡»æ˜¯å®æ—¶æˆ–è€…è¿‘å®æ—¶çš„ï¼Œè€Œä¸æ˜¯æ¯å¤©æˆ–è€…æ¯å°æ—¶æ±‡æ€»ã€‚ åŒä¸€ç”¨æˆ·åœ¨çŸ­æ—¶é—´å†…å¤šæ¬¡è®¿é—®å¸–å­ï¼Œåªç®—ä¸€ä¸ªæµè§ˆé‡ æ˜¾ç¤ºçš„æµè§ˆé‡ä¸çœŸå®æµè§ˆé‡é—´å…è®¸æœ‰\bå°ç™¾åˆ†ä¹‹å‡ çš„è¯¯å·® Reddit æ˜¯å…¨çƒè®¿é—®é‡ç¬¬å…«çš„ç½‘ç«™ï¼Œç³»ç»Ÿè¦èƒ½åœ¨ç”Ÿäº§ç¯å¢ƒçš„è§„æ¨¡ä¸Šæ­£å¸¸è¿è¡Œï¼Œä»…å…è®¸å‡ ç§’çš„å»¶è¿Ÿ è¦å…¨éƒ¨æ»¡è¶³ä»¥ä¸Šå››ä¸ªéœ€æ±‚çš„å›°éš¾è¿œè¿œæ¯”å¬ä¸Šå»å¤§çš„å¤šã€‚ä¸ºäº†å®æ—¶ç²¾å‡†è®¡æ•°ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“æŸä¸ªç”¨æˆ·æ˜¯å¦æ›¾ç»è®¿é—®è¿‡è¿™ç¯‡å¸–å­ã€‚æƒ³è¦çŸ¥é“è¿™ä¸ªä¿¡æ¯ï¼Œæˆ‘ä»¬å°±è¦ä¸ºæ¯ç¯‡å¸–å­ç»´æŠ¤ä¸€ä¸ªè®¿é—®ç”¨æˆ·çš„é›†åˆï¼Œç„¶ååœ¨æ¯æ¬¡è®¡ç®—æµè§ˆé‡æ—¶æ£€æŸ¥é›†åˆã€‚ä¸€ä¸ª naive çš„å®ç°æ–¹å¼å°±æ˜¯å°†è®¿é—®ç”¨æˆ·çš„é›†åˆå­˜å‚¨åœ¨å†…å­˜çš„ hashMap ä¸­ï¼Œä»¥å¸–å­ Id ä¸º keyã€‚ è¿™ç§å®ç°æ–¹å¼å¯¹äºè®¿é—®é‡ä½çš„å¸–å­æ˜¯å¯è¡Œçš„ï¼Œä½†ä¸€æ—¦ä¸€ä¸ªå¸–å­å˜å¾—æµè¡Œï¼Œè®¿é—®é‡å‰§å¢æ—¶å°±å¾ˆéš¾æ§åˆ¶äº†ã€‚ç”šè‡³æœ‰çš„å¸–å­æœ‰è¶…è¿‡ 100 ä¸‡çš„ç‹¬ç«‹è®¿å®¢ï¼ å¯¹äºè¿™æ ·çš„å¸–å­ï¼Œå­˜å‚¨ç‹¬ç«‹è®¿å®¢çš„ ID å¹¶ä¸”é¢‘ç¹æŸ¥è¯¢æŸä¸ªç”¨æˆ·æ˜¯å¦ä¹‹å‰æ›¾è®¿é—®è¿‡ä¼šç»™å†…å­˜å’Œ CPU é€ æˆå¾ˆå¤§çš„è´Ÿæ‹…ã€‚ å› ä¸ºæˆ‘ä»¬ä¸èƒ½æä¾›å‡†ç¡®çš„è®¡æ•°ï¼Œæˆ‘ä»¬æŸ¥çœ‹äº†å‡ ç§ä¸åŒçš„åŸºæ•°ä¼°è®¡ç®—æ³•ã€‚æœ‰ä¸¤ä¸ªç¬¦åˆæˆ‘ä»¬éœ€æ±‚çš„é€‰æ‹©ï¼š ä¸€æ˜¯çº¿æ€§æ¦‚ç‡è®¡æ•°æ³•ï¼Œå¾ˆå‡†ç¡®ï¼Œä½†å½“è®¡æ•°é›†åˆå˜å¤§æ—¶æ‰€éœ€å†…å­˜ä¼šçº¿æ€§å˜å¤§ã€‚ äºŒæ˜¯åŸºäº HyperLogLog (ä»¥ä¸‹ç®€ç§° HLL )çš„è®¡æ•°æ³•ã€‚ HLL ç©ºé—´å¤æ‚åº¦è¾ƒä½ï¼Œä½†æ˜¯ç²¾ç¡®åº¦ä¸å¦‚çº¿æ€§è®¡æ•°ã€‚ ä¸‹é¢çœ‹ä¸‹ HLL ä¼šèŠ‚çœå¤šå°‘å†…å­˜ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦å­˜å‚¨ 100 ä¸‡ä¸ªç‹¬ç«‹è®¿å®¢çš„ ID, æ¯ä¸ªç”¨æˆ· ID 8 å­—èŠ‚é•¿ï¼Œé‚£ä¹ˆä¸ºäº†å­˜å‚¨ä¸€ç¯‡å¸–å­çš„ç‹¬ç«‹è®¿å®¢æˆ‘ä»¬å°±éœ€è¦ 8 Mçš„å†…å­˜ã€‚åä¹‹ï¼Œå¦‚æœé‡‡ç”¨ HLL ä¼šæ˜¾è‘—å‡å°‘å†…å­˜å ç”¨ã€‚ä¸åŒçš„ HLL å®ç°æ–¹å¼æ¶ˆè€—çš„å†…å­˜ä¸åŒã€‚å¦‚æœé‡‡ç”¨è¿™ç¯‡æ–‡ç« çš„å®ç°æ–¹æ³•ï¼Œé‚£ä¹ˆå­˜å‚¨ 100 ä¸‡ä¸ª ID ä»…éœ€ 12 KBï¼Œæ˜¯åŸæ¥çš„ 0.15%ï¼ï¼ Big Data Counting: How to count a billion distinct objects using only 1.5KB of Memory - High Scalability -è¿™ç¯‡æ–‡ç« å¾ˆå¥½çš„æ€»ç»“äº†ä¸Šé¢çš„ç®—æ³•ã€‚ è®¸å¤š HLL çš„å®ç°éƒ½æ˜¯ç»“åˆäº†ä¸Šé¢ä¸¤ç§ç®—æ³•ã€‚åœ¨é›†åˆå°çš„æ—¶å€™é‡‡ç”¨çº¿æ€§è®¡æ•°ï¼Œå½“é›†åˆå¤§å°åˆ°è¾¾ä¸€å®šçš„é˜ˆå€¼ååˆ‡æ¢åˆ° HLLã€‚å‰è€…é€šå¸¸è¢«æˆä¸º â€ç¨€ç–â€œ(sparse) HLLï¼Œåè€…è¢«ç§°ä¸ºâ€ç¨ å¯†â€œ(dense) HLLã€‚è¿™ç§ç»“åˆäº†ä¸¤ç§ç®—æ³•çš„å®ç°æœ‰å¾ˆå¤§çš„å¥½å¤„ï¼Œå› ä¸ºå®ƒå¯¹äºå°é›†åˆå’Œå¤§é›†åˆéƒ½èƒ½å¤Ÿä¿è¯ç²¾ç¡®åº¦ï¼ŒåŒæ—¶ä¿è¯äº†é€‚åº¦çš„å†…å­˜å¢é•¿ã€‚å¯ä»¥åœ¨ google çš„è¿™ç¯‡è®ºæ–‡ä¸­äº†è§£è¿™ç§å®ç°çš„è¯¦ç»†å†…å®¹ã€‚ ç°åœ¨æˆ‘ä»¬å·²ç»ç¡®å®šè¦é‡‡ç”¨ HLL ç®—æ³•äº†ï¼Œä¸è¿‡åœ¨é€‰æ‹©å…·ä½“çš„å®ç°æ—¶ï¼Œæˆ‘ä»¬è€ƒè™‘äº†ä»¥ä¸‹ä¸‰ç§ä¸åŒçš„å®ç°ã€‚å› ä¸ºæˆ‘ä»¬çš„æ•°æ®å·¥ç¨‹å›¢é˜Ÿä½¿ç”¨ Java å’Œ Scalaï¼Œæ‰€ä»¥æˆ‘ä»¬åªè€ƒè™‘ Java å’Œ Scala çš„å®ç°ã€‚ Twitter æä¾›çš„ Algebirdï¼Œé‡‡ç”¨ Scala å®ç°ã€‚Algebird æœ‰å¾ˆå¥½çš„æ–‡æ¡£ï¼Œä½†ä»–ä»¬å¯¹äº sparse å’Œ dense HLL çš„å®ç°ç»†èŠ‚ä¸æ˜¯å¾ˆå®¹æ˜“ç†è§£ã€‚ stream-libä¸­æä¾›çš„ HyperLogLog++ï¼Œ é‡‡ç”¨ Java å®ç°ã€‚stream-lib ä¸­çš„ä»£ç æ–‡æ¡£é½å…¨ï¼Œä½†æœ‰äº›éš¾ç†è§£å¦‚ä½•åˆé€‚çš„ä½¿ç”¨å¹¶ä¸”æ”¹é€ çš„ç¬¦åˆæˆ‘ä»¬çš„éœ€æ±‚ã€‚ Redis HLL å®ç°ï¼Œè¿™æ˜¯æˆ‘ä»¬æœ€ç»ˆé€‰æ‹©çš„ã€‚æˆ‘ä»¬è®¤ä¸º Redis ä¸­ HLLs çš„å®ç°æ–‡æ¡£é½å…¨ã€å®¹æ˜“é…ç½®ï¼Œæä¾›çš„ç›¸å…³ API ä¹Ÿå¾ˆå®¹æ˜“é›†æˆã€‚è¿˜æœ‰ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ä¸€å°ä¸“é—¨çš„æœåŠ¡å™¨éƒ¨ç½²ï¼Œä»è€Œå‡è½»æ€§èƒ½ä¸Šçš„å‹åŠ›ã€‚ Reddit çš„æ•°æ®ç®¡é“ä¾èµ–äº Kafkaã€‚å½“ä¸€ä¸ªç”¨æˆ·è®¿é—®äº†ä¸€ç¯‡åšå®¢ï¼Œä¼šè§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œäº‹ä»¶ä¼šè¢«å‘é€åˆ°äº‹ä»¶æ”¶é›†æœåŠ¡å™¨ï¼Œå¹¶è¢«æŒä¹…åŒ–åœ¨ Kafka ä¸­ã€‚ ä¹‹åï¼Œè®¡æ•°ç³»ç»Ÿä¼šä¾æ¬¡é¡ºåºè¿è¡Œä¸¤ä¸ªç»„ä»¶ã€‚åœ¨æˆ‘ä»¬çš„è®¡æ•°ç³»ç»Ÿæ¶æ„ä¸­ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯ä¸€ä¸ª Kafka çš„æ¶ˆè´¹è€…ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º Nazarã€‚Nazar ä¼šä» Kafka ä¸­è¯»å–æ¯ä¸ªäº‹ä»¶ï¼Œå¹¶å°†å®ƒé€šè¿‡ä¸€ç³»åˆ—é…ç½®çš„è§„åˆ™æ¥åˆ¤æ–­è¯¥äº‹ä»¶æ˜¯å¦éœ€è¦è¢«è®¡æ•°ã€‚æˆ‘ä»¬å–è¿™ä¸ªåå­—ä»…ä»…æ˜¯å› ä¸º Nazar æ˜¯ä¸€ä¸ªçœ¼ç›å½¢çŠ¶çš„æŠ¤èº«ç¬¦ï¼Œè€Œ â€Nazarâ€œ ç³»ç»Ÿå°±åƒçœ¼ç›ä¸€æ ·ä½¿æˆ‘ä»¬çš„è®¡æ•°ç³»ç»Ÿè¿œç¦»ä¸æ€€å¥½æ„è€…çš„ç ´åã€‚å…¶ä¸­ä¸€ä¸ªæˆ‘ä»¬ä¸å°†ä¸€ä¸ªäº‹ä»¶è®¡ç®—åœ¨å†…çš„åŸå› å°±æ˜¯åŒä¸€ä¸ªç”¨æˆ·åœ¨å¾ˆçŸ­æ—¶é—´å†…é‡å¤è®¿é—®ã€‚Nazar ä¼šä¿®æ”¹äº‹ä»¶ï¼ŒåŠ ä¸Šä¸ªæ ‡æ˜æ˜¯å¦åº”è¯¥è¢«è®¡æ•°çš„å¸ƒå°”æ ‡è¯†ï¼Œå¹¶å°†äº‹ä»¶é‡æ–°æ”¾å…¥ Kafkaã€‚ ä¸‹é¢å°±åˆ°äº†ç³»ç»Ÿçš„ç¬¬äºŒä¸ªéƒ¨åˆ†ã€‚æˆ‘ä»¬å°†ç¬¬äºŒä¸ª Kafka çš„æ¶ˆè´¹è€…ç§°ä½œ Abacusï¼Œç”¨æ¥è¿›è¡ŒçœŸæ­£æµè§ˆé‡çš„è®¡ç®—ï¼Œå¹¶ä¸”å°†è®¡ç®—ç»“æœæ˜¾ç¤ºåœ¨ç½‘ç«™æˆ–å®¢æˆ·ç«¯ã€‚Abacus ä» Kafka ä¸­è¯»å–ç»è¿‡ Nazar å¤„ç†è¿‡çš„äº‹ä»¶ï¼Œå¹¶æ ¹æ® Nazar çš„å¤„ç†ç»“æœå†³å®šæ˜¯è·³è¿‡è¿™ä¸ªäº‹ä»¶è¿˜æ˜¯å°†å…¶åŠ å…¥è®¡æ•°ã€‚å¦‚æœ Nazar ä¸­çš„å¤„ç†ç»“æœæ˜¯å¯ä»¥åŠ å…¥è®¡æ•°ï¼Œé‚£ä¹ˆ Abacus é¦–å…ˆä¼šæ£€æŸ¥è¿™ä¸ªäº‹ä»¶æ‰€å…³è”çš„å¸–å­åœ¨ Redis ä¸­æ˜¯å¦å·²ç»å­˜åœ¨äº†ä¸€ä¸ª HLL è®¡æ•°å™¨ã€‚å¦‚æœå·²ç»å­˜åœ¨ï¼ŒAbacus ä¼šç»™ Redis å‘é€ä¸ª PFADD çš„è¯·æ±‚ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œé‚£ä¹ˆ Abacus ä¼šç»™ Cassandra é›†ç¾¤å‘é€ä¸ªè¯·æ±‚ï¼ˆCassandra ç”¨æ¥æŒä¹…åŒ– HLL è®¡æ•°å™¨å’Œ è®¡æ•°å€¼çš„ï¼‰ï¼Œç„¶åå‘ Redis å‘é€ SET è¯·æ±‚ã€‚è¿™é€šå¸¸ä¼šå‘ç”Ÿåœ¨ç½‘å‹è®¿é—®è¾ƒè€å¸–å­çš„æ—¶å€™ï¼Œè¿™æ—¶è¯¥å¸–å­çš„è®¡æ•°å™¨å¾ˆå¯èƒ½å·²ç»åœ¨ Redis ä¸­è¿‡æœŸäº†ã€‚ ä¸ºäº†å­˜å‚¨å­˜åœ¨ Redis ä¸­çš„è®¡æ•°å™¨è¿‡æœŸçš„è€å¸–å­çš„æµè§ˆé‡ã€‚Abacus ä¼šå‘¨æœŸæ€§çš„å°† Redis ä¸­å…¨éƒ¨çš„ HLL å’Œ æ¯ç¯‡å¸–å­çš„æµè§ˆé‡å†™å…¥åˆ° Cassandra é›†ç¾¤ä¸­ã€‚ä¸ºäº†é¿å…é›†ç¾¤è¿‡è½½ï¼Œæˆ‘ä»¬ä»¥ 10 ç§’ä¸ºå‘¨æœŸæ‰¹é‡å†™å…¥ã€‚ ä¸‹å›¾æ˜¯äº‹ä»¶æµçš„å¤§è‡´æµç¨‹ï¼š æ€»ç»“æˆ‘ä»¬å¸Œæœ›æµè§ˆé‡å¯ä»¥è®©å‘å¸–è€…äº†è§£å¸–å­å…¨éƒ¨çš„è®¿é—®é‡ï¼Œä¹Ÿå¸®åŠ©ç‰ˆä¸»å¿«é€Ÿå®šä½è‡ªå·±ç¤¾åŒºä¸­é«˜è®¿é—®é‡çš„å¸–å­ã€‚åœ¨æœªæ¥ï¼Œæˆ‘ä»¬è®¡åˆ’åˆ©ç”¨æˆ‘ä»¬æ•°æ®ç®¡é“åœ¨å®æ—¶æ–¹é¢çš„æ½œåŠ›æ¥ä¸º Reddit çš„ç”¨æˆ·æä¾›æ›´å¤šçš„æœ‰ç”¨çš„åé¦ˆã€‚ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”åˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”- è¿™å‘¨ä¸€å®šè¦çœ‹å®Œã€Šåœ°çƒä¸Šçš„æ˜Ÿæ˜Ÿã€‹ğŸ’ª","raw":null,"content":null,"categories":[{"name":"ç¿»è¯‘","slug":"ç¿»è¯‘","permalink":"http://yemengying.com/categories/ç¿»è¯‘/"}],"tags":[{"name":"ç¿»è¯‘","slug":"ç¿»è¯‘","permalink":"http://yemengying.com/tags/ç¿»è¯‘/"}]},{"title":"MySQL å”¯ä¸€æ€§çº¦æŸä¸ NULL","slug":"mysql-unique-key-null","date":"2017-05-18T14:35:54.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2017/05/18/mysql-unique-key-null/","link":"","permalink":"http://yemengying.com/2017/05/18/mysql-unique-key-null/","excerpt":"å¾ˆä¹…ä¹‹å‰çš„ä¸€ä¸ª bug äº†ï¼Œç®€å•è®°å½•ä¸‹ã€‚ã€‚ã€‚","keywords":null,"text":"å¾ˆä¹…ä¹‹å‰çš„ä¸€ä¸ª bug äº†ï¼Œç®€å•è®°å½•ä¸‹ã€‚ã€‚ã€‚ ä¹‹å‰åšçš„ä¸€ä¸ªéœ€æ±‚ï¼Œç®€åŒ–æè¿°ä¸‹å°±æ˜¯æ¥å—å…¶ä»–ç»„çš„ MQ çš„æ¶ˆæ¯ï¼Œç„¶ååœ¨æ•°æ®åº“é‡Œæ’å…¥ä¸€æ¡è®°å½•ã€‚ä¸ºäº†é˜²æ­¢ä»–ä»¬é‡å¤å‘æ¶ˆæ¯ï¼Œæ’å…¥å¤šæ¡é‡å¤è®°å½•ï¼Œæ‰€ä»¥åœ¨è¡¨ä¸­çš„å‡ ä¸ªåˆ—ä¸ŠåŠ äº†ä¸ªå”¯ä¸€æ€§ç´¢å¼•ã€‚1CREATE UNIQUE INDEX IDX_UN_LOAN_PLAN_APP ON testTable (A, B, C); è¿™æ—¶ A,B,C ä¸‰åˆ—éƒ½æ˜¯ä¸å…è®¸ NULL å€¼çš„ï¼Œå”¯ä¸€æ€§çº¦æŸä¹Ÿæ˜¯ work çš„ã€‚åæ¥ç”±äºéœ€æ±‚çš„å˜åŒ–ï¼Œä¿®æ”¹äº†ä»¥å‰çš„å”¯ä¸€æ€§çº¦æŸï¼Œåˆå¤šåŠ äº†ä¸€åˆ—ã€‚(è‡³äºä¸ºä»€ä¹ˆåŠ å°±ä¸èµ˜è¿°äº†)ã€‚123ALTER TABLE testTableDROP INDEX IDX_UN_LOAN_PLAN_APP,ADD UNIQUE KEY `IDX_UN_LOAN_PLAN_APP` (A, B, C, D); æ–°åŠ çš„ D æ˜¯ç±»å‹æ˜¯ datetime, å…è®¸ä¸º NULLï¼Œé»˜è®¤å€¼ä¸º NULLã€‚ä¹‹æ‰€ä»¥é»˜è®¤å€¼ä¸º NULLï¼Œæ˜¯è€ƒè™‘åˆ°ä¸æ˜¯æ‰€æœ‰è®°å½•éƒ½æœ‰è¿™ä¸ªæ—¶é—´çš„ï¼Œ å¦‚æœå¼ºè¡Œè®¾ç½®ä¸€ä¸ª Magic Value (æ¯”å¦‚â€™1970-01-01 08:00:00â€˜)å½“åšé»˜è®¤å€¼ï¼Œçœ‹èµ·æ¥å¾ˆå¥‡æ€ªã€‚ è“åã€‚ã€‚ã€‚å°±å‡ºé—®é¢˜äº†ã€‚åŠ äº† D ä¹‹åï¼Œå”¯ä¸€æ€§çº¦æŸåŸºæœ¬å°±å¤±æ•ˆäº†ã€‚ 123Insert into testTable (A,B,C,D) VALUES (1,2,3,NULL); --- OKInsert into testTable (A,B,C,D) VALUES (1,2,3,NULL); --- OKInsert into testTable (A,B,C,D) VALUES (1,2,3,NULL); --- OK ä¸Šé¢çš„ä¸‰æ¡ SQL éƒ½æ˜¯å¯ä»¥æ‰§è¡ŒæˆåŠŸçš„ï¼Œæ•°æ®åº“ä¸­ä¼šæœ‰å¤šæ¡ä¸€æ ·çš„è®°å½•ã€‚å¯æŒ‰ç…§æˆ‘ä»¬ä»¥å‰çš„æ„æƒ³ï¼Œåœ¨æ‰§è¡Œåä¸¤æ¡ SQL æ—¶ åº”è¯¥æŠ›å‡º â€˜Duplicate keyâ€™ çš„å¼‚å¸¸çš„ã€‚ åæ¥æŸ¥äº†ä¸€ä¸‹ï¼Œæ‰å‘ç°å…¶å® MySQL å®˜æ–¹æ–‡æ¡£ä¸Šå·²ç»æ˜ç¡®è¯´äº†è¿™ä¸€ç‚¹ï¼Œ å”¯ä¸€æ€§ç´¢å¼•æ˜¯å…è®¸å¤šä¸ª NULL å€¼çš„å­˜åœ¨çš„ï¼š A UNIQUE index creates a constraint such that all values in the index must be distinct. An error occurs if you try to add a new row with a key value that matches an existing row. For all engines, a UNIQUE index allows multiple NULL values for columns that can contain NULL. ä»ä¸‹è¡¨ä¸­ä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ä¸ç®¡æ˜¯é‡‡ç”¨ä»€ä¹ˆç±»å‹çš„å­˜å‚¨å¼•æ“ï¼Œåœ¨å»ºç«‹ unique key çš„æ—¶å€™éƒ½æ˜¯å…è®¸å¤šä¸ª NULL å­˜åœ¨çš„ã€‚ã€‚ã€‚ã€‚ï¿¼ç»†æƒ³æƒ³ï¼Œå…¶å®ä¹Ÿè›®åˆç†ï¼Œæ¯•ç«Ÿåœ¨ MySQL ä¸­è®¤ä¸º NULL ä»£è¡¨ç€â€œæœªçŸ¥â€ã€‚ åœ¨ SQL ä¸­ï¼Œä»»ä½•å€¼ä¸ NULL çš„æ¯”è¾ƒè¿”å›å€¼éƒ½æ˜¯ NULL è€Œä¸æ˜¯ TRUE, å°±ç®— NULL ä¸ NULL çš„æ¯”è¾ƒä¹Ÿæ˜¯è¿”å› NULLã€‚ æ‰€ä»¥åªèƒ½ fix äº†ã€‚ã€‚ã€‚è§£å†³åŠæ³•ä¹Ÿè›®ç®€å•ç²—æš´çš„ï¼Œç›´æ¥æŠŠçº¿ä¸Šæ•°æ®åˆ·äº†ä¸€éï¼Œå°†â€œ1970-01-01 08:00:00â€ä½œä¸ºé»˜è®¤å€¼ï¼Œç„¶åæŠŠé‚£åˆ—æ”¹ä¸ºä¸å…è®¸ä¸º NULL çš„äº†ï¼Œå’³å’³ã€‚ MySQL å®˜ç½‘ä¸Šä¹Ÿæœ‰è›®å¤šäººè®¨è®ºè¿‡è¿™ä¸ªé—®é¢˜ï¼Œä¸€éƒ¨åˆ†äººè®¤ä¸ºè¿™æ˜¯ MySQL çš„ bugï¼Œ å¦ä¸€éƒ¨åˆ†åˆ™è®¤ä¸ºæ˜¯ä¸€ä¸ª featureï¼Œé™„ä¸Šé“¾æ¥ã€‚ MySQL Bugs: #8173: unique index allows duplicates with null values","raw":null,"content":null,"categories":[{"name":"MySQL","slug":"MySQL","permalink":"http://yemengying.com/categories/MySQL/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"http://yemengying.com/tags/MySQL/"}]},{"title":"ã€è¯‘ã€‘Executor, ExecutorService å’Œ Executors é—´çš„ä¸åŒ","slug":"difference-between-executor-executorService","date":"2017-03-17T06:07:21.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2017/03/17/difference-between-executor-executorService/","link":"","permalink":"http://yemengying.com/2017/03/17/difference-between-executor-executorService/","excerpt":"æäº†å¥½ä¹…æ²¡æ›´åšå®¢ï¼Œå†ä¸å†™è¦è¢«æŸäºº BS äº†ï¼Œå’¦ã€‚ã€‚ã€‚ã€‚ã€‚ åŸæ–‡é“¾æ¥","keywords":null,"text":"æäº†å¥½ä¹…æ²¡æ›´åšå®¢ï¼Œå†ä¸å†™è¦è¢«æŸäºº BS äº†ï¼Œå’¦ã€‚ã€‚ã€‚ã€‚ã€‚ åŸæ–‡é“¾æ¥ java.util.concurrent.Executor, java.util.concurrent.ExecutorService, java.util.concurrent. Executors è¿™ä¸‰è€…å‡æ˜¯ Java Executor æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æ¥æä¾›çº¿ç¨‹æ± çš„åŠŸèƒ½ã€‚å› ä¸ºåˆ›å»ºå’Œç®¡ç†çº¿ç¨‹éå¸¸å¿ƒç´¯ï¼Œå¹¶ä¸”æ“ä½œç³»ç»Ÿé€šå¸¸å¯¹çº¿ç¨‹æ•°æœ‰é™åˆ¶ï¼Œæ‰€ä»¥å»ºè®®ä½¿ç”¨çº¿ç¨‹æ± æ¥å¹¶å‘æ‰§è¡Œä»»åŠ¡ï¼Œè€Œä¸æ˜¯æ¯æ¬¡è¯·æ±‚è¿›æ¥æ—¶åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚ä½¿ç”¨çº¿ç¨‹æ± ä¸ä»…å¯ä»¥æé«˜åº”ç”¨çš„å“åº”æ—¶é—´ï¼Œè¿˜å¯ä»¥é¿å…&quot;java.lang.OutOfMemoryError: unable to create new native thread&quot; ä¹‹ç±»çš„é”™è¯¯ã€‚ åœ¨ Java 1.5 æ—¶ï¼Œå¼€å‘è€…éœ€è¦å…³å¿ƒçº¿ç¨‹æ± çš„åˆ›å»ºå’Œç®¡ç†ï¼Œä½†åœ¨ Java 1.5 ä¹‹å Executor æ¡†æ¶æä¾›äº†å¤šç§å†…ç½®çš„çº¿ç¨‹æ± ,ä¾‹å¦‚ï¼šFixedThreadPool(åŒ…å«å›ºå®šæ•°ç›®çš„çº¿ç¨‹)ï¼ŒCachedThreadPool(å¯æ ¹æ®éœ€è¦åˆ›å»ºæ–°çš„çº¿ç¨‹)ç­‰ç­‰ã€‚ ExecutorExecutor, ExecutorService, å’Œ Executors æœ€ä¸»è¦çš„åŒºåˆ«æ˜¯ Executor æ˜¯ä¸€ä¸ªæŠ½è±¡å±‚é¢çš„æ ¸å¿ƒæ¥å£(å¤§è‡´ä»£ç å¦‚ä¸‹)ã€‚123public interface Executor &#123; void execute(Runnable command);&#125; ä¸åŒäº java.lang.Thread ç±»å°†ä»»åŠ¡å’Œæ‰§è¡Œè€¦åˆåœ¨ä¸€èµ·ï¼Œ Executor å°†ä»»åŠ¡æœ¬èº«å’Œæ‰§è¡Œä»»åŠ¡åˆ†ç¦»ï¼Œå¯ä»¥é˜…è¯» difference between Thread and Executor æ¥äº†è§£ Thread å’Œ Executor é—´æ›´å¤šçš„ä¸åŒã€‚ ExecutorServiceExecutorService æ¥å£ å¯¹ Executor æ¥å£è¿›è¡Œäº†æ‰©å±•ï¼Œæä¾›äº†è¿”å› Future å¯¹è±¡ï¼Œç»ˆæ­¢ï¼Œå…³é—­çº¿ç¨‹æ± ç­‰æ–¹æ³•ã€‚å½“è°ƒç”¨ shutDown æ–¹æ³•æ—¶ï¼Œçº¿ç¨‹æ± ä¼šåœæ­¢æ¥å—æ–°çš„ä»»åŠ¡ï¼Œä½†ä¼šå®Œæˆæ­£åœ¨ pending ä¸­çš„ä»»åŠ¡ã€‚ Future å¯¹è±¡æä¾›äº†å¼‚æ­¥æ‰§è¡Œï¼Œè¿™æ„å‘³ç€æ— éœ€ç­‰å¾…ä»»åŠ¡æ‰§è¡Œçš„å®Œæˆï¼Œåªè¦æäº¤éœ€è¦æ‰§è¡Œçš„ä»»åŠ¡ï¼Œç„¶ååœ¨éœ€è¦æ—¶æ£€æŸ¥ Future æ˜¯å¦å·²ç»æœ‰äº†ç»“æœï¼Œå¦‚æœä»»åŠ¡å·²ç»æ‰§è¡Œå®Œæˆï¼Œå°±å¯ä»¥é€šè¿‡ Future.get() æ–¹æ³•è·å¾—æ‰§è¡Œç»“æœã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒFuture.get() æ–¹æ³•æ˜¯ä¸€ä¸ªé˜»å¡å¼çš„æ–¹æ³•ï¼Œå¦‚æœè°ƒç”¨æ—¶ä»»åŠ¡è¿˜æ²¡æœ‰å®Œæˆï¼Œä¼šç­‰å¾…ç›´åˆ°ä»»åŠ¡æ‰§è¡Œç»“æŸã€‚ é€šè¿‡ ExecutorService.submit() æ–¹æ³•è¿”å›çš„ Future å¯¹è±¡ï¼Œè¿˜å¯ä»¥å–æ¶ˆä»»åŠ¡çš„æ‰§è¡Œã€‚Future æä¾›äº† cancel() æ–¹æ³•ç”¨æ¥å–æ¶ˆæ‰§è¡Œ pending ä¸­çš„ä»»åŠ¡ã€‚ ExecutorService éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š123456public interface ExecutorService extends Executor &#123; void shutdown(); &lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task); &lt;T&gt; Future&lt;T&gt; submit(Runnable task, T result); &lt;T&gt; List&lt;Future&lt;T&gt;&gt; invokeAll(Collection&lt;? extends Callable&lt;T&gt;&gt; tasks, long timeout, TimeUnit unit) throws InterruptedException;&#125; ExecutorsExecutors æ˜¯ä¸€ä¸ªå·¥å…·ç±»ï¼Œç±»ä¼¼äº Collectionsã€‚æä¾›å·¥å‚æ–¹æ³•æ¥åˆ›å»ºä¸åŒç±»å‹çš„çº¿ç¨‹æ± ï¼Œæ¯”å¦‚ FixedThreadPool æˆ– CachedThreadPoolã€‚ Executors éƒ¨åˆ†ä»£ç ï¼š12345678910public class Executors &#123; public static ExecutorService newFixedThreadPool(int nThreads) &#123; return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS,new LinkedBlockingQueue&lt;Runnable&gt;()); &#125; public static ExecutorService newCachedThreadPool() &#123; return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;()); &#125;&#125; ä¸‹é¢è¯¦ç»†çœ‹ä¸€ä¸‹ä¸‰è€…çš„åŒºåˆ«ï¼š Executor vs ExecutorService vs Executorsæ­£å¦‚ä¸Šé¢æ‰€è¯´ï¼Œè¿™ä¸‰è€…å‡æ˜¯ Executor æ¡†æ¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚Java å¼€å‘è€…å¾ˆæœ‰å¿…è¦å­¦ä¹ å’Œç†è§£ä»–ä»¬ï¼Œä»¥ä¾¿æ›´é«˜æ•ˆçš„ä½¿ç”¨ Java æä¾›çš„ä¸åŒç±»å‹çš„çº¿ç¨‹æ± ã€‚æ€»ç»“ä¸€ä¸‹è¿™ä¸‰è€…é—´çš„åŒºåˆ«ï¼Œä»¥ä¾¿å¤§å®¶æ›´å¥½çš„ç†è§£ï¼š Executor å’Œ ExecutorService è¿™ä¸¤ä¸ªæ¥å£ä¸»è¦çš„åŒºåˆ«æ˜¯ï¼šExecutorService æ¥å£ç»§æ‰¿äº† Executor æ¥å£ï¼Œæ˜¯ Executor çš„å­æ¥å£ Executor å’Œ ExecutorService ç¬¬äºŒä¸ªåŒºåˆ«æ˜¯ï¼šExecutor æ¥å£å®šä¹‰äº† execute()æ–¹æ³•ç”¨æ¥æ¥æ”¶ä¸€ä¸ªRunnableæ¥å£çš„å¯¹è±¡ï¼Œè€Œ ExecutorService æ¥å£ä¸­çš„ submit()æ–¹æ³•å¯ä»¥æ¥å—Runnableå’ŒCallableæ¥å£çš„å¯¹è±¡ã€‚ Executor å’Œ ExecutorService æ¥å£ç¬¬ä¸‰ä¸ªåŒºåˆ«æ˜¯ Executor ä¸­çš„ execute() æ–¹æ³•ä¸è¿”å›ä»»ä½•ç»“æœï¼Œè€Œ ExecutorService ä¸­çš„ submit()æ–¹æ³•å¯ä»¥é€šè¿‡ä¸€ä¸ª Future å¯¹è±¡è¿”å›è¿ç®—ç»“æœã€‚ Executor å’Œ ExecutorService æ¥å£ç¬¬å››ä¸ªåŒºåˆ«æ˜¯é™¤äº†å…è®¸å®¢æˆ·ç«¯æäº¤ä¸€ä¸ªä»»åŠ¡ï¼ŒExecutorService è¿˜æä¾›ç”¨æ¥æ§åˆ¶çº¿ç¨‹æ± çš„æ–¹æ³•ã€‚æ¯”å¦‚ï¼šè°ƒç”¨ shutDown() æ–¹æ³•ç»ˆæ­¢çº¿ç¨‹æ± ã€‚å¯ä»¥é€šè¿‡ ã€ŠJava Concurrency in Practiceã€‹ ä¸€ä¹¦äº†è§£æ›´å¤šå…³äºå…³é—­çº¿ç¨‹æ± å’Œå¦‚ä½•å¤„ç† pending çš„ä»»åŠ¡çš„çŸ¥è¯†ã€‚ Executors ç±»æä¾›å·¥å‚æ–¹æ³•ç”¨æ¥åˆ›å»ºä¸åŒç±»å‹çš„çº¿ç¨‹æ± ã€‚æ¯”å¦‚: newSingleThreadExecutor() åˆ›å»ºä¸€ä¸ªåªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ï¼ŒnewFixedThreadPool(int numOfThreads)æ¥åˆ›å»ºå›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± ï¼ŒnewCachedThreadPool()å¯ä»¥æ ¹æ®éœ€è¦åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œä½†å¦‚æœå·²æœ‰çº¿ç¨‹æ˜¯ç©ºé—²çš„ä¼šé‡ç”¨å·²æœ‰çº¿ç¨‹ã€‚ æ€»ç»“ä¸‹è¡¨åˆ—å‡ºäº† Executor å’Œ ExecutorService çš„åŒºåˆ«ï¼š Executor ExecutorService Executor æ˜¯ Java çº¿ç¨‹æ± çš„æ ¸å¿ƒæ¥å£ï¼Œç”¨æ¥å¹¶å‘æ‰§è¡Œæäº¤çš„ä»»åŠ¡ ExecutorService æ˜¯ Executor æ¥å£çš„æ‰©å±•ï¼Œæä¾›äº†å¼‚æ­¥æ‰§è¡Œå’Œå…³é—­çº¿ç¨‹æ± çš„æ–¹æ³• æä¾›execute()æ–¹æ³•ç”¨æ¥æäº¤ä»»åŠ¡ æä¾›submit()æ–¹æ³•ç”¨æ¥æäº¤ä»»åŠ¡ execute()æ–¹æ³•æ— è¿”å›å€¼ submit()æ–¹æ³•è¿”å›Futureå¯¹è±¡ï¼Œå¯ç”¨æ¥è·å–ä»»åŠ¡æ‰§è¡Œç»“æœ ä¸èƒ½å–æ¶ˆä»»åŠ¡ å¯ä»¥é€šè¿‡Future.cancel()å–æ¶ˆpendingä¸­çš„ä»»åŠ¡ æ²¡æœ‰æä¾›å’Œå…³é—­çº¿ç¨‹æ± æœ‰å…³çš„æ–¹æ³• æä¾›äº†å…³é—­çº¿ç¨‹æ± çš„æ–¹æ³• è¯‘è€…æ³¨ä¸ªäººè§‰å¾—ï¼Œåˆ©ç”¨ Executors ç±»æä¾›çš„å·¥å‚æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± æ˜¯å¾ˆæ–¹ä¾¿ï¼Œä½†å¯¹äºéœ€è¦æ ¹æ®å®é™…æƒ…å†µè‡ªå®šä¹‰çº¿ç¨‹æ± æŸäº›å‚æ•°çš„åœºæ™¯ï¼Œå°±ä¸å¤ªé€‚ç”¨äº†ã€‚ ä¸¾ä¸ªä¾‹å­ï¼šå½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹å‡å¤„äºå·¥ä½œçŠ¶æ€ï¼Œå¹¶ä¸”çº¿ç¨‹æ•°å·²è¾¾çº¿ç¨‹æ± å…è®¸çš„æœ€å¤§çº¿ç¨‹æ•°æ—¶ï¼Œå°±ä¼šé‡‡å–æŒ‡å®šçš„é¥±å’Œç­–ç•¥æ¥å¤„ç†æ–°æäº¤çš„ä»»åŠ¡ã€‚æ€»å…±æœ‰å››ç§ç­–ç•¥ï¼š AbortPolicy: ç›´æ¥æŠ›å¼‚å¸¸ CallerRunsPolicy: ç”¨è°ƒç”¨è€…çš„çº¿ç¨‹æ¥è¿è¡Œä»»åŠ¡ DiscardOldestPolicy: ä¸¢å¼ƒçº¿ç¨‹é˜Ÿåˆ—é‡Œæœ€è¿‘çš„ä¸€ä¸ªä»»åŠ¡ï¼Œæ‰§è¡Œæ–°æäº¤çš„ä»»åŠ¡ DiscardPolicy ç›´æ¥å°†æ–°ä»»åŠ¡ä¸¢å¼ƒ å¦‚æœä½¿ç”¨ Executors çš„å·¥å‚æ–¹æ³•åˆ›å»ºçš„çº¿ç¨‹æ± ï¼Œé‚£ä¹ˆé¥±å’Œç­–ç•¥éƒ½æ˜¯é‡‡ç”¨é»˜è®¤çš„ AbortPolicyï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬æƒ³å½“çº¿ç¨‹æ± å·²æ»¡çš„æƒ…å†µï¼Œä½¿ç”¨è°ƒç”¨è€…çš„çº¿ç¨‹æ¥è¿è¡Œä»»åŠ¡ï¼Œå°±è¦è‡ªå·±åˆ›å»ºçº¿ç¨‹æ± ï¼ŒæŒ‡å®šæƒ³è¦çš„é¥±å’Œç­–ç•¥ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ Executors äº†ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦åˆ›å»º ThreadPoolExecutor(ExecutorServiceæ¥å£çš„å®ç°ç±») å¯¹è±¡ï¼Œè‡ªå®šä¹‰ä¸€äº›å‚æ•°ï¼Œè€Œä¸æ˜¯è°ƒç”¨ Executors çš„å·¥å‚æ–¹æ³•åˆ›å»ºã€‚ å½“ç„¶ï¼Œåœ¨ä½¿ç”¨ Spring æ¡†æ¶çš„é¡¹ç›®ä¸­ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ Spring æä¾›çš„ ThreadPoolTaskExecutor ç±»æ¥åˆ›å»ºçº¿ç¨‹æ± ã€‚ThreadPoolTaskExecutor ä¸ ThreadPoolExecutor ç±»ä¼¼ï¼Œä¹Ÿæä¾›äº†è®¸å¤šå‚æ•°ç”¨æ¥è‡ªå®šä¹‰çº¿ç¨‹æ± ï¼Œæ¯”å¦‚ï¼šæ ¸å¿ƒçº¿ç¨‹æ± å¤§å°ï¼Œçº¿ç¨‹æ± æœ€å¤§æ•°é‡ï¼Œé¥±å’Œç­–ç•¥ï¼Œçº¿ç¨‹æ´»åŠ¨ä¿æŒæ—¶é—´ç­‰ç­‰ã€‚ ç›¸å…³æ–‡æ¡£ Executors java api doc","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"}]},{"title":"è°ˆè°ˆ NoSuchBeanDefinitionException","slug":"something-about-noSuchBeanDefinitionException","date":"2017-02-18T07:55:50.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2017/02/18/something-about-noSuchBeanDefinitionException/","link":"","permalink":"http://yemengying.com/2017/02/18/something-about-noSuchBeanDefinitionException/","excerpt":"è¿™ç¯‡åšå®¢æ˜¯æ¥è‡ªå¯¹ä¸¤ç¯‡æ–‡ç« çš„ç¿»è¯‘ï¼ŒåŸæ–‡é“¾æ¥å¦‚ä¸‹ã€‚è¿™ä¸¤ç¯‡æ–‡ç« éƒ½æ€»ç»“äº†åœ¨ä½¿ç”¨ Spring æ¡†æ¶æ—¶å¯èƒ½é€ æˆ NoSuchBeanDefinitionException çš„æƒ…å†µï¼Œä»¥åŠåº”è¯¥å¦‚ä½•è§£å†³ã€‚","keywords":null,"text":"è¿™ç¯‡åšå®¢æ˜¯æ¥è‡ªå¯¹ä¸¤ç¯‡æ–‡ç« çš„ç¿»è¯‘ï¼ŒåŸæ–‡é“¾æ¥å¦‚ä¸‹ã€‚è¿™ä¸¤ç¯‡æ–‡ç« éƒ½æ€»ç»“äº†åœ¨ä½¿ç”¨ Spring æ¡†æ¶æ—¶å¯èƒ½é€ æˆ NoSuchBeanDefinitionException çš„æƒ…å†µï¼Œä»¥åŠåº”è¯¥å¦‚ä½•è§£å†³ã€‚ åŸæ–‡é“¾æ¥java - What is a NoSuchBeanDefinitionException and how do I fix it? - Stack OverflowSpring NoSuchBeanDefinitionException | Baeldung æ¦‚è¿°org.springframework.beans.factory.NoSuchBeanDefinitionException æ˜¯å¾ˆå¸¸è§çš„å¼‚å¸¸ï¼Œå¯ä»¥è¯´ç»å¤§å¤šæ•°ä½¿ç”¨è¿‡ Spring çš„äººéƒ½æ›¾é‡åˆ°è¿‡å®ƒã€‚æœ¬æ–‡æ—¨åœ¨æ€»ç»“ä¸‹NoSuchBeanDefinitionExceptionï¼ˆä»¥ä¸‹ç®€ç§° NSBDEï¼‰çš„å«ä¹‰ï¼Œå“ªäº›æƒ…å†µä¸‹å¯èƒ½æŠ›å‡º NSBDEï¼Œå’Œå¦‚ä½•è§£å†³ï¼ˆæ–‡ä¸­é…ç½®å‡ç”¨ JavaConfigï¼‰ã€‚ ä»€ä¹ˆæ˜¯ NoSuchBeanDefinitionExceptionä»å­—é¢å…¶å®å°±å¾ˆå¥½ç†è§£ï¼ŒNoSuchBeanDefinitionException å°±æ˜¯æ²¡æœ‰æ‰¾åˆ°æŒ‡å®š Bean çš„ Definitionã€‚NoSuchBeanDefinitionException çš„ JavaDocæ˜¯è¿™æ ·å®šä¹‰çš„ï¼š Exception thrown when a BeanFactory is asked for a bean instance for which it cannot find a definition. This may point to a non-existing bean, a non-unique bean, or a manually registered singleton instance without an associated bean definition. ä¸‹é¢çœ‹çœ‹å¯èƒ½æŠ›å‡º NSBDE çš„ä¸€äº›æƒ…å†µã€‚ æƒ…å†µ1: No qualifying bean of type [â€¦] found for dependencyæœ€å¸¸è§çš„æŠ›å‡º NSBDE çš„æƒ…å†µå°±æ˜¯åœ¨ä¸€ä¸ª BeanA ä¸­æ³¨å…¥ BeanB æ—¶æ‰¾ä¸åˆ° BeanB çš„å®šä¹‰ã€‚ä¾‹å­å¦‚ä¸‹ï¼š123456@Componentpublic class BeanA &#123; @Autowired private BeanB dependency; //...&#125; å½“åœ¨ BeanA ä¸­æ³¨å…¥ BeanB æ—¶ï¼Œå¦‚æœåœ¨ Spring ä¸Šä¸‹æ–‡ä¸­æ‰¾ä¸åˆ° BeanB çš„å®šä¹‰ï¼Œå°±ä¼šæŠ›å‡º NSBDEã€‚å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š1234567org.springframework.beans.factory.NoSuchBeanDefinitionException: No qualifying bean of type [org.baeldung.packageB.BeanB] found for dependency: expected at least 1 bean which qualifies as autowire candidate for this dependency. Dependency annotations: &#123;@org.springframework.beans.factory.annotation.Autowired(required=true)&#125; æŠ›å¼‚å¸¸çš„åŸå› åœ¨å¼‚å¸¸ä¿¡æ¯ä¸­è¯´çš„å¾ˆæ¸…æ¥šï¼šexpected at least 1 bean which qualifies as autowire candidate for this dependencyã€‚æ‰€ä»¥è¦ä¹ˆæ˜¯ BeanB ä¸å­˜åœ¨åœ¨ Spring ä¸Šä¸‹æ–‡ä¸­ï¼ˆæ¯”å¦‚æ²¡æœ‰æ ‡æ³¨ @ Componentï¼Œ@Repositoryï¼Œ@Service, @Controllerç­‰æ³¨è§£ï¼‰ ï¼Œè¦ä¹ˆå°±æ˜¯ BeanB æ‰€åœ¨çš„åŒ…æ²¡æœ‰è¢« Spring æ‰«æåˆ°ã€‚ è§£å†³åŠæ³•å°±æ˜¯å…ˆç¡®è®¤ BeanB æœ‰æ²¡æœ‰è¢«æŸäº›æ³¨è§£å£°æ˜ä¸º Beanï¼š123package org.baeldung.packageB;@Componentpublic class BeanB &#123; ...&#125; å¦‚æœ BeanB å·²ç»è¢«å£°æ˜ä¸ºä¸€ä¸ª Beanï¼Œå°±å†ç¡®è®¤ BeanB æ‰€åœ¨çš„åŒ…æœ‰æ²¡æœ‰è¢«æ‰«æã€‚1234@Configuration@ComponentScan(\"org.baeldung.packageB\")public class ContextWithJavaConfig &#123;&#125; æƒ…å†µ2: No qualifying bean of type [â€¦] is definedè¿˜æœ‰ä¸€ç§å¯èƒ½æŠ›å‡º NSBDE çš„æƒ…å†µæ˜¯åœ¨ä¸Šä¸‹æ–‡ä¸­å­˜åœ¨ç€ä¸¤ä¸ª Beanï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªæ¥å£ IBeanBï¼Œå®ƒæœ‰ä¸¤ä¸ªå®ç°ç±» BeanB1 å’Œ BeanB2ã€‚12345678@Componentpublic class BeanB1 implements IBeanB &#123; //&#125;@Componentpublic class BeanB2 implements IBeanB &#123; //&#125; ç°åœ¨ï¼Œå¦‚æœ BeanA æŒ‰ç…§ä¸‹é¢çš„æ–¹å¼æ³¨å…¥ï¼Œé‚£ä¹ˆ Spring å°†ä¸çŸ¥é“è¦æ³¨å…¥ä¸¤ä¸ªå®ç°ä¸­çš„å“ªä¸€ä¸ªï¼Œå°±ä¼šæŠ›å‡º NSBDEã€‚12345@Componentpublic class BeanA &#123; @Autowired private IBeanB dependency;&#125; å¼‚å¸¸ä¿¡æ¯å¦‚ä¸‹ï¼š1234Caused by: org.springframework.beans.factory.NoUniqueBeanDefinitionException: No qualifying bean of type [org.baeldung.packageB.IBeanB] is defined: expected single matching bean but found 2: beanB1,beanB2 ä»”ç»†çœ‹å¼‚å¸¸ä¿¡æ¯ä¼šå‘ç°ï¼Œå¹¶ä¸æ˜¯ç›´æ¥æŠ›å‡º NSBDEï¼Œè€Œæ˜¯å®ƒçš„å­ç±» NoUniqueBeanDefinitionExceptionï¼Œè¿™æ˜¯ Spring 3.2.1 ä¹‹åå¼•å…¥çš„æ–°å¼‚å¸¸ï¼Œç›®çš„å°±æ˜¯ä¸ºäº†å’Œç¬¬ä¸€ç§æ‰¾ä¸åˆ° Bean Definition çš„æƒ…å†µä½œåŒºåˆ†ã€‚ è§£å†³åŠæ³•1å°±æ˜¯åˆ©ç”¨ @Qualifier æ³¨è§£ï¼Œæ˜ç¡®æŒ‡å®šè¦æ³¨å…¥çš„ Bean çš„åå­—(BeanB2 é»˜è®¤çš„åå­—å°±æ˜¯ beanB2)ã€‚123456@Componentpublic class BeanA &#123; @Autowired @Qualifier(\"beanB2\") private IBeanB dependency;&#125; é™¤äº†æŒ‡å®šåå­—ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°†å…¶ä¸­ä¸€ä¸ª Bean åŠ ä¸Š @Primaryçš„æ³¨è§£,è¿™æ ·ä¼šé€‰æ‹©åŠ äº† Primary æ³¨è§£çš„ Bean æ¥æ³¨å…¥ï¼Œè€Œä¸ä¼šæŠ›å¼‚å¸¸ï¼š12345@Component@Primarypublic class BeanB1 implements IBeanB &#123; //&#125; è¿™æ · Spring å°±èƒ½å¤ŸçŸ¥é“åˆ°åº•åº”è¯¥æ³¨å…¥å“ªä¸ª Bean äº†ã€‚ æƒ…å†µ3: No Bean Named [â€¦] is definedNSBDE è¿˜å¯èƒ½åœ¨ä» Spring ä¸Šä¸‹æ–‡ä¸­é€šè¿‡åå­—è·å–ä¸€ä¸ª Bean æ—¶æŠ›å‡ºã€‚123456789@Componentpublic class BeanA implements InitializingBean &#123; @Autowired private ApplicationContext context; @Override public void afterPropertiesSet() &#123; context.getBean(\"someBeanName\"); &#125;&#125; åœ¨è¿™ç§æƒ…å†µä¸­ï¼Œå¦‚æœæ‰¾ä¸åˆ°æŒ‡å®šåå­— Bean çš„ Definitionï¼Œå°±ä¼šæŠ›å‡ºå¦‚ä¸‹å¼‚å¸¸ï¼š12Caused by: org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named &apos;someBeanName&apos; is defined æƒ…å†µ4: ä»£ç† BeansSpring é€šè¿‡ AOP ä»£ç† å®ç°äº†è®¸å¤šé«˜çº§åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼š é€šè¿‡ @Transactionalå®Œæˆ äº‹åŠ¡ç®¡ç† é€šè¿‡ @Cacheableå®ç°ç¼“å­˜ é€šè¿‡ @Asyncå’Œ @Scheduledå®ç°ä»»åŠ¡è°ƒåº¦å’Œå¼‚æ­¥æ‰§è¡Œ Spring æœ‰ä¸¤ç§æ–¹å¼å®ç°ä»£ç†ï¼š åˆ©ç”¨ JDK åŠ¨æ€ä»£ç†æœºåˆ¶ ï¼Œåœ¨è¿è¡Œæ—¶ä¸ºå®ç°äº†æŸäº›æ¥å£çš„ç±»åŠ¨æ€åˆ›å»ºä¸€ä¸ªå®ç°äº†åŒæ ·æ¥å£çš„ä»£ç†å¯¹è±¡ã€‚ ä½¿ç”¨ CGLIBï¼ŒCGLIB å¯ä»¥åœ¨è¿è¡ŒæœŸæ‰©å±•Javaç±»ä¸å®ç°Javaæ¥å£,ä¹Ÿå°±æ˜¯è¯´å½“ä¸€ä¸ªç±»æ²¡æœ‰å®ç°æ¥å£æ—¶ï¼Œå¿…é¡»ç”¨ CGLIB ç”Ÿæˆä»£ç†å¯¹è±¡ã€‚ æ‰€ä»¥ï¼Œå½“ Spring ä¸Šä¸‹æ–‡ä¸­çš„ä¸€ä¸ªå®ç°äº†æŸä¸ªæ¥å£çš„ Bean é€šè¿‡JDK åŠ¨æ€ä»£ç†æœºåˆ¶è¢«ä»£ç†æ—¶ï¼Œä»£ç†ç±»å¹¶ä¸æ˜¯ç»§æ‰¿äº†ç›®æ ‡ç±»ï¼Œè€Œæ˜¯å®ç°åŒæ ·çš„æ¥å£ã€‚ ä¹Ÿæ­£å› ä¸ºå¦‚æ­¤ï¼Œå¦‚æœä¸€ä¸ª Bean é€šè¿‡æ¥å£æ³¨å…¥æ—¶ï¼Œå¯ä»¥æˆåŠŸè¢«æ³¨å…¥ã€‚ä½†å¦‚æœæ˜¯é€šè¿‡çœŸæ­£çš„ç±»æ³¨å…¥ï¼Œé‚£ä¹ˆ Spring å°†æ— æ³•æ‰¾åˆ°åŒ¹é…è¿™ä¸ªç±»çš„ Definitionâ€”â€”å› ä¸ºä»£ç†ç±»å¹¶æ²¡æœ‰ç»§æ‰¿è¿™ä¸ªç±»ã€‚ ä»¥ Spring ä¸­æ¯”è¾ƒå¸¸è§çš„äº‹åŠ¡ç®¡ç†ä¸ºä¾‹ï¼Œå‡è®¾ ServiceA ä¸­è¦æ³¨å…¥ ServiceBï¼Œä¸¤ä¸ª Service å‡æ ‡æ³¨äº† @Transactionalæ³¨è§£æ¥è¿›è¡Œäº‹åŠ¡ç®¡ç†ï¼Œé‚£ä¹ˆä¸‹é¢çš„æ³¨å…¥æ–¹å¼æ˜¯ä¸ä¼šæ­£å¸¸ work çš„ã€‚123456789101112@Service@Transactionalpublic class ServiceA implements IServiceA&#123; @Autowired private ServiceB serviceB; ...&#125; @Service@Transactionalpublic class ServiceB implements IServiceB&#123;&#125; è§£å†³åŠæ³•å°±æ˜¯é€šè¿‡æ¥å£æ¥è¿›è¡Œæ³¨å…¥ï¼š1234567891011@Service@Transactionalpublic class ServiceA implements IServiceA&#123; @Autowired private IServiceB serviceB;&#125; @Service@Transactionalpublic class ServiceB implements IServiceB&#123;&#125; æ€»ç»“ä»Šå¤©å¤©æ°”å¥½å¥½å•Š~","raw":null,"content":null,"categories":[{"name":"spring","slug":"spring","permalink":"http://yemengying.com/categories/spring/"}],"tags":[{"name":"spring","slug":"spring","permalink":"http://yemengying.com/tags/spring/"}]},{"title":"RabbitMq å¦‚ä½•å¤„ç†å¼‚å¸¸","slug":"how-does-rabbitmq-handle-exception","date":"2017-01-30T11:37:21.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2017/01/30/how-does-rabbitmq-handle-exception/","link":"","permalink":"http://yemengying.com/2017/01/30/how-does-rabbitmq-handle-exception/","excerpt":"è¿™åº”è¯¥æ˜¯è¿‡å¹´å‡æœŸçš„æœ€åä¸€ç¯‡ï¼Œå¦‚æœä¸æ˜¯ï¼Œé‚£ä½ ä¸€å®šçœ‹åˆ°äº†å‡åšå®¢ã€‚(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§","keywords":null,"text":"è¿™åº”è¯¥æ˜¯è¿‡å¹´å‡æœŸçš„æœ€åä¸€ç¯‡ï¼Œå¦‚æœä¸æ˜¯ï¼Œé‚£ä½ ä¸€å®šçœ‹åˆ°äº†å‡åšå®¢ã€‚(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ åœ¨æ¶ˆè´¹ RabbitMq ä¸­çš„ Message æ—¶ï¼Œå¸¸å¸¸ä¼šå‡ºç°å¼‚å¸¸ï¼Œå¯èƒ½æ˜¯ Message æœ¬èº«æ ¼å¼ä¸å¯¹ï¼Œæˆ–è€…ç”±äºæŸäº›åŸå› æ— æ³•è¢«å¤„ç†ã€‚æˆ‘ä¸€èˆ¬éƒ½æ˜¯ catch å¼‚å¸¸ç„¶åæŠ›ä¸ª AmqpRejectAndDontRequeueException (ä»¥ä¸‹ç®€ç§° ARADRE )ï¼Œä¹Ÿå‡ºå•¥é—®é¢˜ï¼Œä¸è¿‡è¿˜æ˜¯ä»”ç»†çœ‹ä¸‹ï¼Œrabbitmq æ˜¯å¦‚ä½•å¯¹å¾…æ¶ˆè´¹æ¶ˆæ¯æ—¶å‡ºç°çš„å¼‚å¸¸ï¼Œæ˜¯ä¼šå°†æ¶ˆæ¯ç›´æ¥ä¸¢å¼ƒè¿˜æ˜¯æœ‰å…¶ä»–æ“ä½œã€‚ å…¶å® Spring-amqp å®˜æ–¹æ–‡æ¡£ä¸Šå¯¹äº RabbitMq æ˜¯å¦‚ä½•å¤„ç†å¼‚å¸¸çš„è¯´çš„å·²ç»å¾ˆæ˜ç™½äº†ï¼Œä¸è¿‡éƒ½æ˜¯å¤§æ®µçš„æ–‡å­—å¯èƒ½ä¸å¤ªå¥½ç†è§£ï¼Œè¿˜æ˜¯é…ç€ä»£ç çœ‹ä¸€ä¸‹ã€‚ ä»£ç ç‰ˆæœ¬ï¼š 1.6.3.RELEASE æ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼Œå½“ listener åœ¨æ¶ˆè´¹æ¶ˆæ¯æ—¶æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸çš„æ—¶å€™ï¼Œè¯¥å¼‚å¸¸ä¼šè¢«åŒ…è£…åœ¨ ListenerExecutionFailedException ä¸­æŠ›å‡ºï¼Œå¹¶æ ¹æ® listenerContainer ä¸­ defaultRequeueRejected è®¾å®šçš„å€¼æ¥å†³å®šæ˜¯å¦å°†è¯¥æ¶ˆæ¯é‡æ–°åŠ å…¥é˜Ÿåˆ—ï¼Œé»˜è®¤æ˜¯ä¼šé‡æ–°åŠ å…¥é˜Ÿåˆ—ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœæŠ›å‡ºçš„å¼‚å¸¸æ˜¯ ARADRE æˆ–å…¶ä»–è¢« RabbitMq è®¤ä¸ºæ˜¯è‡´å‘½é”™è¯¯çš„å¼‚å¸¸ï¼Œå³ä¾¿ defaultRequeueRejected çš„å€¼ä¸º true ï¼Œ è¯¥æ¶ˆæ¯ä¹Ÿä¸ä¼šé‡æ–°åŠ å…¥é˜Ÿåˆ—ï¼Œè€Œæ˜¯ä¼šè¢«ç›´æ¥ä¸¢å¼ƒæˆ–åŠ å…¥ dead-letter-exchange ä¸­(å¦‚æœæœ‰é…ç½® dead-letter-exchange)ã€‚ åœ¨ 1.6.3. RELEASE ä¸­è¢« RabbitMq è®¤ä¸ºæ˜¯è‡´å‘½é”™è¯¯çš„å¼‚å¸¸æœ‰ä»¥ä¸‹ 6 ç§ï¼š o.s.amqpâ€¦MessageConversionException o.s.messagingâ€¦MessageConversionException o.s.messagingâ€¦MethodArgumentNotValidException o.s.messagingâ€¦MethodArgumentTypeMismatchException java.lang.NoSuchMethodException java.lang.ClassCastException ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æŠ›å‡ºä»¥ä¸Šå¼‚å¸¸åŠ ARADRE æ—¶ï¼Œè¯¥æ¶ˆæ¯ä¸€å®šä¸ä¼šé‡æ–°å…¥é˜Ÿï¼Œå³ä¾¿ defaultRequeueRejected çš„å€¼ä¸º trueã€‚ ä¸‹é¢çœ‹çœ‹ Spring-RabbitMq æ˜¯å¦‚ä½•å®ç°çš„ï¼š åœ¨æºç ä¸­ï¼Œå¼‚å¸¸åœ¨ AbstractMessageListenerContainer ä¸­è¢«åŒ…è£…åœ¨ ListenerExecutionFailedException ä¸­ä¹‹åè¿˜ä¼šç»ç”± ErrorHandler çš„ handleError æ–¹æ³•å¤„ç†ï¼Œ é»˜è®¤çš„ ErrorHandler æ˜¯ ConditionalRejectingErrorHandler ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥å®ç°è‡ªå·±çš„ ErrorHandler æ¥æ§åˆ¶éœ€è¦ä¸¢å¼ƒæ¶ˆæ¯çš„å¼‚å¸¸ï¼Œåªè¦å®ç° org.springframework.util.ErrorHandler æ¥å£ï¼Œç„¶åå°†listenerContainer ä¸­çš„ errorHandler å‚æ•°æŒ‡å®šæˆ‘ä»¬è‡ªå®šä¹‰çš„ handler å³å¯ã€‚ ConditionalRejectingErrorHandler ä¸­é…ç½®æœ‰ FatalExceptionStrategyï¼Œä¼šè°ƒç”¨ FatalExceptionStrategy ä¸­çš„ isFatal æ–¹æ³•æ¥åˆ¤æ–­å¼‚å¸¸æ˜¯ä¸æ˜¯å±äºè‡´å‘½å¼‚å¸¸ã€‚ ConditionalRejectingErrorHandler çš„å…·ä½“å®ç°å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374public class ConditionalRejectingErrorHandler implements ErrorHandler &#123;private final FatalExceptionStrategy exceptionStrategy; @Overridepublic void handleError(Throwable t) &#123; if (this.logger.isWarnEnabled()) &#123; this.logger.warn(\"Execution of Rabbit message listener failed.\", t); &#125; // å¦‚æœæ˜¯è‡´å‘½å¼‚å¸¸ï¼Œåˆ™è½¬ä¸º AmqpRejectAndDontRequeueException æŠ›å‡º if (!this.causeChainContainsARADRE(t) &amp;&amp; this.exceptionStrategy.isFatal(t)) &#123; throw new AmqpRejectAndDontRequeueException(\"Error Handler converted exception to fatal\", t); &#125;&#125;/** * @return true if the cause chain already contains an * &#123;@link AmqpRejectAndDontRequeueException&#125;. */private boolean causeChainContainsARADRE(Throwable t) &#123; Throwable cause = t.getCause(); while (cause != null) &#123; if (cause instanceof AmqpRejectAndDontRequeueException) &#123; return true; &#125; cause = cause.getCause(); &#125; return false;&#125;/** * Default implementation of &#123;@link FatalExceptionStrategy&#125;. * @since 1.6.3 */public class DefaultExceptionStrategy implements FatalExceptionStrategy &#123; // åˆ¤æ–­ä¼ å…¥å‚æ•° æ˜¯ä¸æ˜¯ è‡´å‘½å¼‚å¸¸ @Override public boolean isFatal(Throwable t) &#123; if (t instanceof ListenerExecutionFailedException &amp;&amp; isCauseFatal(t.getCause())) &#123; if (ConditionalRejectingErrorHandler.this.logger.isWarnEnabled()) &#123; ConditionalRejectingErrorHandler.this.logger.warn( \"Fatal message conversion error; message rejected; \" + \"it will be dropped or routed to a dead letter exchange, if so configured: \" + ((ListenerExecutionFailedException) t).getFailedMessage()); &#125; return true; &#125; return false; &#125; private boolean isCauseFatal(Throwable cause) &#123; return cause instanceof MessageConversionException || cause instanceof org.springframework.messaging.converter.MessageConversionException || cause instanceof MethodArgumentNotValidException || cause instanceof MethodArgumentTypeMismatchException || cause instanceof NoSuchMethodException || cause instanceof ClassCastException || isUserCauseFatal(cause); &#125; /** * é€šè¿‡é‡å†™è¯¥æ–¹æ³•æ¥æ·»åŠ è‡ªå®šä¹‰çš„å¼‚å¸¸ * Subclasses can override this to add custom exceptions. * @param cause the cause * @return true if the cause is fatal. */ protected boolean isUserCauseFatal(Throwable cause) &#123; return false; &#125; &#125;&#125; ä»£ç æ¯”è¾ƒé•¿ï¼Œç®€å•æ¥è¯´ï¼Œå°±æ˜¯ ConditionalRejectingErrorHandler çš„ handleError ä¼šå…ˆåˆ¤æ–­æ¥åˆ°çš„å¼‚å¸¸ä¸­çš„ cause æ˜¯ä¸æ˜¯ ARADREï¼Œå¦‚æœä¸æ˜¯å†è°ƒç”¨ FatalExceptionStrategy çš„ isFatal æ–¹æ³•ï¼Œåˆ¤æ–­æ˜¯ä¸æ˜¯è‡´å‘½å¼‚å¸¸ä¸­çš„ä¸€ç§ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å°†å¼‚å¸¸è½¬ä¸º ARADRE æŠ›å‡ºï¼Œè¯¥æ¶ˆæ¯ä¹Ÿå°±ä¸ä¼šé‡æ–°å…¥é˜Ÿã€‚ å¦‚æœæƒ³è¦æŠŠè‡ªå®šä¹‰çš„å¼‚å¸¸åŠ å…¥åˆ° fatalExceptionï¼Œ ä¸€ä¸ªç®€å•çš„åŠæ³•å°±æ˜¯æä¾›æ–°çš„ FatalExceptionStrategy ï¼Œåªè¦ç»§æ‰¿ ConditionalRejectingErrorHandler.DefaultExceptionStrategy å¹¶é‡å†™ isUserCauseFatal(Throwable cause) æ–¹æ³•ï¼Œåœ¨æ–¹æ³•é‡Œå¯¹äºéœ€è¦ä¸¢å¼ƒæ¶ˆæ¯çš„å¼‚å¸¸è¿”å› trueå³å¯ã€‚ å†ç®€å•çœ‹ä¸‹ï¼ŒRabbitMq åˆ¤æ–­æ˜¯å¦éœ€è¦å°†æ¶ˆæ¯é‡å…¥é˜Ÿåˆ—çš„éƒ¨åˆ†é€»è¾‘ã€‚ 123456789// We should always requeue if the container was stoppingboolean shouldRequeue = this.defaultRequeuRejected || ex instanceof MessageRejectedWhileStoppingException;Throwable t = ex;while (shouldRequeue &amp;&amp; t != null) &#123; if (t instanceof AmqpRejectAndDontRequeueException) &#123; shouldRequeue = false; &#125; t = t.getCause();&#125; æ ¹æ®ä¸Šé¢çš„ä»£ç ï¼Œå¦‚æœå¤„ç†æ¶ˆæ¯æ—¶å‡ºç°å¼‚å¸¸ï¼Œåœ¨åˆ¤æ–­æ˜¯å¦éœ€è¦å…¥é˜Ÿæ—¶ï¼Œä¼šå°† shouldRequeue å˜é‡ç­‰äº this.defaultRequeuRejected ||ex instanceof MessageRejectedWhileStoppingException çš„å€¼ï¼Œç„¶åå¦‚æœå¼‚å¸¸æ˜¯ ARADREï¼Œ ä¸ç®¡ä¹‹å‰ shouldRequeue çš„å€¼æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šè¢«ç½®ä¸º falseã€‚æœ€åæ ¹æ® shouldRequeue çš„å€¼æ¥å†³å®šæ˜¯å¦éœ€è¦é‡æ–°å…¥é˜Ÿã€‚ å¯ä»¥ç”¨ä¸‹å›¾æ€»ç»“ä¸€ä¸‹ï¼š æœ€åã€‚ã€‚Cookie å®å®ç¥å¤§å®¶æ–°æ˜¥å¿«ä¹~~","raw":null,"content":null,"categories":[{"name":"rabbitmq","slug":"rabbitmq","permalink":"http://yemengying.com/categories/rabbitmq/"}],"tags":[{"name":"rabbitmq","slug":"rabbitmq","permalink":"http://yemengying.com/tags/rabbitmq/"},{"name":"spring","slug":"spring","permalink":"http://yemengying.com/tags/spring/"}]},{"title":"ä¸ºRabbitmqä¸­çš„Jackson2JsonMessageConverterè‡ªå®šä¹‰ClassMapper","slug":"rabbitmq-classMapper","date":"2017-01-03T14:40:30.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2017/01/03/rabbitmq-classMapper/","link":"","permalink":"http://yemengying.com/2017/01/03/rabbitmq-classMapper/","excerpt":"æ–°å¹´ç¬¬ä¸€ç¯‡~~ ğŸ£ğŸ¥ğŸ¤ğŸ”","keywords":null,"text":"æ–°å¹´ç¬¬ä¸€ç¯‡~~ ğŸ£ğŸ¥ğŸ¤ğŸ” æ¶ˆæ¯é˜Ÿåˆ—ç®—æ˜¯å„ä¸ªç³»ç»Ÿé—´é€šä¿¡æ¯”è¾ƒå¸¸è§çš„æ–¹å¼äº†ã€‚æˆ‘ä»¬å…¬å¸ç”¨çš„æ˜¯æ˜¯åŸºäº AMQP åè®®çš„ RabbitMqã€‚åœ¨ Spring-AMQP ä¸­æ¯”è¾ƒé‡è¦çš„ç±»å°±æ˜¯ Messageï¼Œå› ä¸ºè¦å‘é€çš„æ¶ˆæ¯å¿…é¡»è¦æ„é€ æˆä¸€ä¸ª Message å¯¹è±¡æ¥è¿›è¡Œä¼ è¾“ã€‚Message å¯¹è±¡åŒ…æ‹¬ä¸¤éƒ¨åˆ† Body å’Œ Propertiesï¼ŒBody å°±æ˜¯çœŸæ­£è¦å‘é€çš„æ¶ˆæ¯å†…å®¹ï¼ŒProperties å°±æ˜¯å’Œæ¶ˆæ¯ç›¸å…³çš„ä¸€äº›å±æ€§(æ¶ˆæ¯å¤´ï¼Œè¦å‘é€çš„äº¤æ¢æœºï¼ŒroutingKeyç­‰ç­‰)ï¼Œä¸»è¦ç»“æ„å¦‚ä¸‹ï¼š1234567public class Message &#123; private final MessageProperties messageProperties; private final byte[] body;&#125; æ¶ˆæ¯ç”Ÿäº§è€…æ„é€ å¥½ Message ä¹‹åï¼Œå°±ä¼šå°† Message å‘é€åˆ°æŒ‡å®šçš„ Exchange (äº¤æ¢æœº)ï¼Œå†æ ¹æ® Exchange çš„ç±»å‹åŠ routing-key å°†æ¶ˆæ¯è·¯ç”±åˆ°ç›¸åº”çš„ queue ä¸­ï¼Œæœ€åè¢«ç›‘å¬è¯¥ queue çš„æ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œå¤§è‡´å¦‚ä¸‹å›¾ï¼š ä¸è¿‡æ¯æ¬¡å‘æ¶ˆæ¯éƒ½è¦è‡ªå·±æ„é€  Message å¯¹è±¡æ¯”è¾ƒéº»çƒ¦ã€‚Spring-AMQP å…è®¸æˆ‘ä»¬ç›´æ¥ä½¿ç”¨è‡ªå®šä¹‰çš„ç±»ï¼Œç„¶åä¼šåˆ©ç”¨æŒ‡å®šå¥½çš„ MessageConverter å°†è‡ªå®šä¹‰çš„ç±»è½¬æ¢ä¸º Message è¿›è¡Œå‘é€ï¼Œåœ¨æ¥æ”¶æ—¶ä¹Ÿä¼šåˆ©ç”¨ MessageConverter å°†æ¥æ”¶åˆ°çš„ Message å¯¹è±¡è½¬æˆéœ€è¦çš„å¯¹è±¡ã€‚Spring-AMQP æä¾›äº†å¤šç§ MessageConverterï¼Œæ¯”å¦‚ SimpleMessageConverterï¼ŒSerializerMessageConverterï¼ŒJackson2JsonMessageConverterï¼ŒMarshallingMessageConverterç­‰ç­‰ï¼Œå¦‚æœå‘é€çš„æ¶ˆæ¯å¯¹è±¡ä¸æ˜¯ Message å®ä¾‹ï¼Œå¹¶ä¸”æ²¡æœ‰æŒ‡å®š MessageConverter çš„è¯ï¼Œé»˜è®¤ç”¨ SimpleMessageConverterã€‚ä»¥ä¸Šå„ç§ MessageConverter å½’æ ¹ç»“åº•éƒ½æ˜¯å®ç°äº† MessageConverter æ¥å£ï¼Œè¯¥æ¥å£åªæœ‰ä¸¤ä¸ªæ–¹æ³•ï¼š1234public interface MessageConverter &#123; Message toMessage(Object object, MessageProperties messageProperties) throws MessageConversionException; Object fromMessage(Message message) throws MessageConversionException;&#125; è¿™ä¸¤ä¸ªæ–¹æ³•ä¸€ä¸ªæ˜¯åœ¨å‘é€æ¶ˆæ¯æ—¶å°†æˆ‘ä»¬çš„æ¶ˆæ¯å¯¹è±¡è½¬æ¢æˆæ ‡å‡†çš„ Message å¯¹è±¡ï¼Œå¦ä¸€ä¸ªæ˜¯åœ¨æ¥å—æ¶ˆæ¯æ—¶å°† Message å¯¹è±¡è½¬æ¢ä¸ºç›¸åº”çš„å¯¹è±¡ã€‚æ¯”è¾ƒå¸¸ç”¨çš„ Converter å°±æ˜¯ Jackson2JsonMessageConverter(ä»¥ä¸‹ç®€ç§° JsonMessageConverter)ï¼Œåœ¨å‘é€æ¶ˆæ¯æ—¶ï¼Œå®ƒä¼šå…ˆå°†è‡ªå®šä¹‰çš„æ¶ˆæ¯ç±»åºåˆ—åŒ–æˆjsonæ ¼å¼ï¼Œå†è½¬æˆbyteæ„é€  Messageï¼Œåœ¨æ¥æ”¶æ¶ˆæ¯æ—¶ï¼Œä¼šå°†æ¥æ”¶åˆ°çš„ Message å†ååºåˆ—åŒ–æˆè‡ªå®šä¹‰çš„ç±»ã€‚å¤§è‡´æµç¨‹å¦‚ä¸‹å›¾ï¼š ä¸è¿‡ä½¿ç”¨ JsonMessageConverter æ—¶æœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œåœ¨ä¸å¯¹å®ƒè¿›è¡Œä»»ä½•æ”¹é€ çš„å‰æä¸‹ï¼Œå‘é€æ¶ˆæ¯çš„ç±»å’Œæ¥å—æ¶ˆæ¯çš„ç±»å¿…é¡»æ˜¯ä¸€æ ·çš„ï¼Œä¸ä»…æ˜¯è¦é‡Œé¢çš„å­—æ®µä¸€æ ·ï¼Œç±»åä¸€æ ·ï¼Œè¿ç±»çš„åŒ…è·¯å¾„éƒ½è¦ä¸€æ ·ã€‚ æ‰€ä»¥å½“ç³»ç»Ÿ1ä½¿ç”¨ JsonMessageConverter å‘é€æ¶ˆæ¯ç±»Aç»™ç³»ç»Ÿ2æ—¶ï¼Œç³»ç»Ÿ2å¯ä»¥æœ‰å¦‚ä¸‹å‡ ç§æ–¹å¼æ¥æ¥æ”¶ï¼š 1.ä¾èµ–ç³»ç»Ÿ1çš„jaråŒ…,ç›´æ¥ä½¿ç”¨ç±»Aæ¥æ¥æ”¶ 2.ä¸ä¾èµ–ç³»ç»Ÿ1çš„jaråŒ…ï¼Œè‡ªå·±å»ºä¸€ä¸ªå’ŒAä¸€æ¨¡ä¸€æ ·çš„ç±»ï¼Œè¿åç§°ï¼ŒåŒ…è·¯å¾„éƒ½ä¸€æ · 3.è´Ÿè´£ç›‘å¬ queue çš„ç±»å®ç° MessageListener æ¥å£ï¼Œç›´æ¥æ¥æ”¶ Message ç±»ï¼Œå†è‡ªå·±è½¬æ¢ ä¸Šé¢ä¸‰ä¸ªæ–¹æ³•éƒ½ä¸æ˜¯å¾ˆå¥½ï¼ŒæŒ‰ç…§æ­£å¸¸çš„æƒ³æ³•ï¼Œæˆ‘ä»¬è‚¯å®šæ˜¯æœŸæœ›ç³»ç»Ÿ2ç›´æ¥ä½¿ç”¨è‡ªå·±çš„ç±»æ¥æ¥æ”¶å°±å¯ä»¥äº†ï¼Œåªè¦ä¸Aç±»çš„å­—æ®µåä¸€æ ·å³å¯ã€‚é‚£æœ‰æ²¡æœ‰æ–¹æ³•å¯ä»¥è®©ç³»ç»Ÿ2æ—¢ä¸ä¾èµ–æ— ç”¨çš„jaråŒ…ï¼Œä¹Ÿä¸ç”¨å»ºç«‹ä¸ªä¸è‡ªå·±å‘½åè§„èŒƒä¸ç›¸ç¬¦çš„ç±»ï¼Œ ä¹Ÿæ— éœ€è‡ªå·±è½¬æ¢å‘¢? è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±è¦å…ˆçœ‹çœ‹ JsonMessageConverter æ˜¯å¦‚ä½•å°† Message è¿›è¡Œååºåˆ—åŒ–çš„ã€‚åœ¨ JsonMessageConverter çš„ fromMessage æ–¹æ³•ä¸­æœ‰è¿™ä¹ˆä¸€æ®µ:123456789if (getClassMapper() == null) &#123; JavaType targetJavaType = getJavaTypeMapper() .toJavaType(message.getMessageProperties()); content = convertBytesToObject(message.getBody(), encoding, targetJavaType);&#125; else &#123; Class&lt;?&gt; targetClass = getClassMapper().toClass( message.getMessageProperties()); content = convertBytesToObject(message.getBody(), encoding, targetClass);&#125; å°±æ˜¯è¯´é»˜è®¤æƒ…å†µä¸‹ï¼ŒJsonMessageConverter ä½¿ç”¨çš„ ClassMapper æ˜¯ DefaultJackson2JavaTypeMapperï¼Œåœ¨è½¬æ¢æ—¶é€šè¿‡ Message çš„ Properties æ¥è·å–è¦è½¬æ¢çš„ç›®æ ‡ç±»çš„ç±»å‹ã€‚é€šè¿‡ Debug å¯ä»¥å‘ç°ï¼Œç›®æ ‡ç±»çš„ç±»å‹æ˜¯å­˜å‚¨åœ¨ Message çš„ Proterties çš„ ä¸€ä¸ª headers çš„ Map ä¸­ï¼ŒKey å«â€œ__TypeId__â€ã€‚æ‰€ä»¥åªè¦æƒ³åŠæ³•åœ¨ä¼ è¾“æ¶ˆæ¯æ—¶æ›´æ”¹__TypeId__çš„å€¼å³å¯ã€‚ ä¸‹é¢æ˜¯è§£å†³åŠæ³•ï¼Œåœ¨æ¶ˆæ¯çš„ç”Ÿäº§è€…ç«¯ä¸º JsonMessageConverterï¼Œ è®¾ç½®ä¸€ä¸ªè‡ªå®šä¹‰çš„ ClassMapperï¼Œé‡å†™ fromClass æ–¹æ³•ï¼Œå°† __TypeId__ çš„å€¼è®¾ä¸ºæ¶ˆè´¹ç«¯ç”¨æ¥æ¥æ”¶çš„ç±»çš„è·¯å¾„+åç§°ã€‚å½“ç„¶äº†ï¼Œä¹Ÿå¯ä»¥åœ¨æ¶ˆè´¹è€…ç«¯é‡å†™toClassæ–¹æ³•ï¼Œç›´æ¥è¿”å›æƒ³è¦è½¬æ¢çš„ç›®æ ‡ç±»çš„ç±»ç±»å‹ã€‚ä¸¤ç§é€‰ä¸€ç§å°±å¯ä»¥ã€‚ 123456789101112131415161718@Beanpublic Jackson2JsonMessageConverter customConverter() &#123; Jackson2JsonMessageConverter converter = new Jackson2JsonMessageConverter(); converter.setClassMapper(new ClassMapper() &#123; @Override public Class&lt;?&gt; toClass(MessageProperties properties) &#123; throw new UnsupportedOperationException(\"this mapper is only for outbound, do not use for receive message\"); &#125; @Override public void fromClass(Class&lt;?&gt; clazz, MessageProperties properties) &#123; properties.setHeader(\"__TypeId__\", \"com.xxx.B\"); &#125; &#125;); return converter;&#125; æ„Ÿè§‰è‡ªå·±è¯­è¨€ç»„ç»‡èƒ½åŠ›é€€åŒ–äº†ã€‚ã€‚ã€‚ã€‚ã€‚","raw":null,"content":null,"categories":[{"name":"rabbitmq","slug":"rabbitmq","permalink":"http://yemengying.com/categories/rabbitmq/"}],"tags":[{"name":"rabbitmq","slug":"rabbitmq","permalink":"http://yemengying.com/tags/rabbitmq/"},{"name":"spring","slug":"spring","permalink":"http://yemengying.com/tags/spring/"}]},{"title":"log ä¸æ‰“å°å¼‚å¸¸å †æ ˆ","slug":"log4j-not-printing-stacktrace-for-eception","date":"2016-12-18T06:17:33.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/12/18/log4j-not-printing-stacktrace-for-eception/","link":"","permalink":"http://yemengying.com/2016/12/18/log4j-not-printing-stacktrace-for-eception/","excerpt":"å’Œä¸Šç¯‡å†…å®¹å¹¶ä¸é‡å¤ ğŸ™ƒ","keywords":null,"text":"å’Œä¸Šç¯‡å†…å®¹å¹¶ä¸é‡å¤ ğŸ™ƒ æœ€è¿‘ç”±äºè§„åˆ™å¼•æ“æœ‰é—®é¢˜ï¼Œå¯¼è‡´äº§çº¿ä¸Šçš„ä¸€ä¸ª job ä¼šæŠ› NullPointerExceptionã€‚æœ¬æ¥è¿™æ˜¯ä¸ªå·²çŸ¥çš„é—®é¢˜ï¼Œä¹Ÿæ²¡ä»€ä¹ˆï¼Œå·²ç»è”ç³»å¯¹åº”çš„äººå»ä¿®å¤äº†ã€‚å¯ç”±æ­¤å‘ç°äº†å¦å¤–ä¸€ä¸ªé—®é¢˜ï¼Œ fireman çš„å‘Šè­¦é‚®ä»¶åªæœ‰å¼‚å¸¸çš„åç§°ï¼Œè€Œæ²¡æœ‰å¼‚å¸¸å †æ ˆã€‚ è¿™å°±å¾ˆä»¤äººæ‡µåœˆäº†ï¼Œå› ä¸ºä¸çŸ¥é“æ˜¯å·²çŸ¥çš„è§„åˆ™å¼•æ“çš„é—®é¢˜è¿˜æ˜¯å…¶ä»–é—®é¢˜ã€‚ å…ˆçœ‹äº†ä¸‹å¯¹åº” job çš„ä»£ç ï¼Œç¡®è®¤æ‰“å°å¼‚å¸¸çš„å§¿åŠ¿æ˜¯æ­£ç¡®çš„, æœ¬åœ°ä¹Ÿå¯ä»¥æ­£å¸¸æ‰“å°ã€‚ç„¶åå»æœäº†ä¸‹å¯¹åº”æ—¥æœŸçš„ log æ–‡ä»¶ï¼Œç¡®å®æœ‰ä¸€å † NPE çš„æŠ¥é”™ï¼Œä¸è¿‡æƒŠå–œçš„å‘ç°åœ¨ä¸€å¼€å§‹çš„æ—¶å€™å…¶å®æ˜¯æœ‰æ‰“å‡ºå †æ ˆçš„ï¼Œåªæ˜¯åˆ°åé¢å°±æ²¡æœ‰äº†ã€‚ æœ€åç»ˆäºåœ¨ stackoverflow ä¸Šæ‰¾åˆ°äº†ç­”æ¡ˆã€‚ The compiler in the server VM now provides correct stack backtraces for all â€œcoldâ€ built-in exceptions. For performance purposes, when such an exception is thrown a few times, the method may be recompiled. After recompilation, the compiler may choose a faster tactic using preallocated exceptions that do not provide a stack trace. To disable completely the use of preallocated exceptions, use this new flag: -XX:-OmitStackTraceInFastThrow. ä¸ªäººç†è§£å°±æ˜¯ï¼ŒJVM ä¸ºäº†æ€§èƒ½ä¼šåšä¼˜åŒ–ï¼Œå¦‚æœé¢‘ç¹çš„æŠ›å‡ºæŸä¸ªå¼‚å¸¸ï¼Œä¼šé‡æ–°ç¼–è¯‘ï¼Œä¸å†æ‰“å°å¼‚å¸¸å †æ ˆã€‚è§£å†³è¿™ä¸ªé—®é¢˜ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¦‚æœä¸æƒ³æ¯æ¬¡éƒ½å»æŸ¥å‰é¢çš„ log å»çœ‹å †æ ˆï¼Œåªè¦åœ¨å¯åŠ¨å‚æ•°åŠ ä¸Š -XX:-OmitStackTraceInFastThrowï¼Œå°±å¯ä»¥ç¦ç”¨è¯¥ä¼˜åŒ–ï¼Œå¼ºåˆ¶æ‰“å°å¼‚å¸¸å †æ ˆã€‚è¿™æ ·å¯èƒ½ä¼šå¯¼è‡´ï¼Œlog æ–‡ä»¶è¿‡å¤§ï¼Œä¸è¿‡äº§çº¿ä¸Šä»Šå¤©ä¹‹å‰çš„ log æ–‡ä»¶éƒ½ä¼šè¢«å‹ç¼©ï¼Œæ‰€ä»¥æ„Ÿè§‰é—®é¢˜ä¹Ÿä¸å¤§ã€‚ Ps:ç”¨ iPic ä¸Šä¼ å›¾ç‰‡çœŸæ˜¯å¥½ç”¨åˆ°é£èµ·ï¼Œéå¸¸é€‚åˆæˆ‘è¿™ç§å–œæ¬¢æ’å›¾æ˜Ÿäººï¼Œå¤šè°¢æ´ªèŠçš„è‰¯å¿ƒæ¨èã€‚","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"}]},{"title":"Clean Code, Clean Log","slug":"clean-code-clean-log","date":"2016-11-18T03:14:13.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/11/18/clean-code-clean-log/","link":"","permalink":"http://yemengying.com/2016/11/18/clean-code-clean-log/","excerpt":"æœ€è¿‘æçš„ PR éƒ½æœ‰å…³äº Log çš„ commentï¼Œä¸èƒ½å¿ï¼Œä»¥ä¸‹å†…å®¹æ€»ç»“æ•´ç†è‡ªæ˜ä½³çš„ Comment å’Œç½‘ç»œèµ„æ–™ï¼Œåªæ˜¯ä¸ºäº†ä»¥åæ PR ä¹‹å‰è¿‡æ¥æ‰«ä¸€çœ¼ï¼Œå°½é‡é¿å… Log ä¸Šçš„ç–å¿½ï¼Œä¸ä¸€å®šé€‚ç”¨äºæ‰€æœ‰äººã€‚","keywords":null,"text":"æœ€è¿‘æçš„ PR éƒ½æœ‰å…³äº Log çš„ commentï¼Œä¸èƒ½å¿ï¼Œä»¥ä¸‹å†…å®¹æ€»ç»“æ•´ç†è‡ªæ˜ä½³çš„ Comment å’Œç½‘ç»œèµ„æ–™ï¼Œåªæ˜¯ä¸ºäº†ä»¥åæ PR ä¹‹å‰è¿‡æ¥æ‰«ä¸€çœ¼ï¼Œå°½é‡é¿å… Log ä¸Šçš„ç–å¿½ï¼Œä¸ä¸€å®šé€‚ç”¨äºæ‰€æœ‰äººã€‚ åœ¨ç¨‹åºä¸­çš„é€‚å½“ä½ç½®æ‰“ Log çš„é‡è¦æ€§å°±ä¸ç”¨å¤šè¯´äº†ï¼Œå¾ˆå¤šäººåº”è¯¥éƒ½ä½“ä¼šè¿‡çº¿ä¸Šæœ‰ Bug å´ç”±äºæ²¡æœ‰æ‰“ log è€Œä¸å¥½ troubleshooting çš„ç»å†ã€‚ ç›¸å…³æ–‡æ¡£ï¼ˆåº·æ¡‘å“ˆå¯†è¾¾ï¼‰ Clean code, clean logs(ğŸ‘å¾ˆèµ) SLF4J VS Log4Jæœ‰å¾ˆå¤šå…³äºæ‰“ Log çš„ç¬¬ä¸‰æ–¹åº“ï¼Œä¹Ÿæ²¡æœ‰å¤šç ”ç©¶è¿‡ï¼Œæ¥è§¦è¿‡çš„å°±æ˜¯ SLF4J å’Œ Log4J äº†ï¼Œä¸è¿‡å¢™è£‚å»ºè®®ç”¨ SLF4Jï¼Œä½¿ç”¨å ä½ç¬¦ {} çœŸçš„æ¯”åŠ å·æ‹¼æ¥å­—ç¬¦ä¸²å¯è¯»æ€§æé«˜Nå€å•Šï¼ï¼ï¼ æ„Ÿå—ä¸€ä¸‹&lt;(ï¿£ï¸¶ï¿£)&gt;1234// SLF4J, goodlog.error(\"Invest loan failed, loan Id: &#123;&#125;, error: &#123;&#125;\", loanId, errorMsg);// Log4J, badlog.error(\"Invest loan failed, loan Id:\" + loanId + \" error: \" + errorMsg); å½“ç„¶ï¼ŒSLF4J è¿˜æœ‰å…¶ä»–çš„ä¼˜ç‚¹ï¼Œæ¯”å¦‚ä¸ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ï¼ŒèŠ‚çœäº†åˆ›å»º String å¯¹è±¡æ‰€è€—è´¹çš„èµ„æºä¹‹ç±»çš„ã€‚ä¸è¿‡æˆ‘æœ€çœ‹é‡çš„å°±æ˜¯å¯è¯»æ€§é«˜äº†ã€‚ Logging Level ERROR - è®°å½•ä¸€äº›æ¯”è¾ƒä¸¥é‡çš„é”™è¯¯ï¼Œæ¯”å¦‚ä¸€äº›ä¸¥é‡å¼‚å¸¸ï¼Œæ•°æ®åº“é“¾æ¥ä¸å¯ç”¨ç­‰ç­‰ WARN - è®°å½•ä¸€äº›ç³»ç»Ÿå¯ä»¥å®¹å¿çš„å¼‚å¸¸ï¼Œæˆ–è€…æ˜¯ä¸€äº›è­¦ç¤ºä¿¡æ¯ã€‚æ¯”å¦‚:â€Current data unavailable, using cached valuesâ€ã€‚ INFO - è®°å½•ä¸€äº›æ¯”è¾ƒé‡è¦çš„æ“ä½œï¼Œèƒ½åæ˜ ç¨‹åºè¿è¡ŒçŠ¶æ€çš„ã€‚æ¯”å¦‚:â€[Who] booked ticket from [Where] to [Where]â€ DEBUG - ä¸€äº›å¸®åŠ©è°ƒè¯•çš„ä¿¡æ¯ TRACE - å—¯ï¼Œè¿™ä¸ªçº§åˆ«ä¿ºä¹Ÿæ²¡ç”¨è¿‡ã€‚ Pay attention Log ä¿¡æ¯é¦–å­—æ¯å¤§å†™è¿™ç‚¹å®Œå…¨æ˜¯ä¸ºäº†çœ‹ä¸Šå»èˆ’æœï¼Œè‡³äºåˆ°åº•éœ€ä¸éœ€è¦å¤§å†™ï¼Œè§ä»è§æ™ºå§~ï¼Œä¸è¿‡æˆ‘è¿˜æ˜¯è¦æ³¨æ„ä¸€ä¸‹ï¼Œè¦å¤§å†™ã€‚ 1234// goodlog.error(\"Invest loan failed, loan Id: &#123;&#125;, error: &#123;&#125;\", loanId, errorMsg);// badlog.error(\"invest loan failed, loan Id: &#123;&#125;, error: &#123;&#125;\", loanId, errorMsg); é¿å… Log ä¸­çš„ NullPointerExceptionå¦‚æœåƒä¸‹é¢è¿™æ ·è®° Logï¼Œè¦æ³¨æ„ç¡®ä¿ loan ä¸ä¼šä¸ºnull, ä¸ç„¶æ‰“ Log æ—¶æŠ›ä¸ª NPEï¼Œæƒ³æƒ³å°±è›‹ç–¼ã€‚ 1log.info(\"Invest loan : &#123;&#125;\", loan.getId()); Log çš„ä¿¡æ¯ç®€æ´æœ‰ç”¨Log çš„å†…å®¹ä¸€å®šè¦æ˜¯æœ‰ç”¨çš„ï¼Œèƒ½åæ˜ å‡ºç¨‹åºçš„è¿è¡ŒçŠ¶æ€ï¼Œèƒ½å¸®åŠ©å®šä½é”™è¯¯ã€‚ 1234// goodlog.info(\"Invest loan with id:&#123;&#125;\", loanId);// badlog.info(\"Invest loan\"); è®°å½•æŸäº›æ–¹æ³•çš„å…¥å‚å’Œå‡ºå‚è®°å½•æ–¹æ³•çš„å…¥å‚å’Œå‡ºå‚ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©æˆ‘ä»¬å®šä½é—®é¢˜ã€‚ç‰¹åˆ«æ˜¯è°ƒç”¨æä¾›æ¥å£ç»™å…¶ä»–ç³»ç»Ÿè°ƒç”¨çš„æ—¶å€™ï¼Œè®°å½•å…¥å‚å¯ä»¥å¸®åŠ©åˆ†è¾¨åˆ°åº•æ˜¯è°çš„é”…ğŸŒšã€‚ 123456public String printDocument(Document doc, Mode mode) &#123; log.debug(\"Entering printDocument(doc=&#123;&#125;, mode=&#123;&#125;)\", doc, mode); String id = //Lengthy printing operation log.debug(\"Leaving printDocument(): &#123;&#125;\", id); return id;&#125; åˆé€‚çš„è®°å½•å¼‚å¸¸å¤§å®¶éƒ½çŸ¥é“è¦åœ¨è®°å½•ç¨‹åºè¿è¡Œä¸­æŠ›å‡ºçš„å¼‚å¸¸ï¼Œä½†æœ‰çš„æ—¶å€™æ–¹å¼å¯èƒ½æ˜¯ä¸å¯¹çš„ã€‚ 12345678910111213141516try&#123; throw new NullPointerException(\"Just for test\"); &#125; catch (Exception e)&#123; log.error(e); //A log.error(e, e); //B log.error(\"\" + e); //C log.error(e.toString()); //D log.error(e.getMessage()); //E log.error(null, e); //F log.error(\"\", e); //G log.error(\"&#123;&#125;\", e); //H log.error(\"&#123;&#125;\", e.getMessage()); //I log.error(\"Error reading configuration file: \" + e); //J log.error(\"Error reading configuration file: \" + e.getMessage()); //K log.error(\"Error reading configuration file\", e); //L &#125; åœ¨ä¸Šé¢ 12 ç§æ‰“å°å¼‚å¸¸çš„æ–¹å¼ä¸­ï¼Œåªæœ‰ G å’Œ Læ˜¯æ­£ç¡®çš„ã€‚A å’Œ B åœ¨ä½¿ç”¨ SLF4J æ—¶ä¼šç¼–è¯‘ä¸é€šè¿‡ï¼Œ å…¶ä»–çš„å‡ ç§è¦ä¹ˆä¸ä¼šæ‰“å°å¼‚å¸¸å †æ ˆï¼Œè¦ä¹ˆä¼šæ‰“å°å‡ºä¸æ­£ç¡®çš„ä¿¡æ¯ã€‚æ¯”å¦‚ï¼ŒE çš„æ–¹å¼åªä¼šæ‰“å°â€Just for testâ€çš„ä¿¡æ¯ï¼Œè€Œä¸ä¼šæ‰“å°å¼‚å¸¸ç±»å‹å’Œå¼‚å¸¸å †æ ˆã€‚åœ¨ SLF4J ä¸­ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ–‡æœ¬ä¿¡æ¯ï¼Œç®€å•æè¿°ä¸€ä¸‹å¼‚å¸¸ï¼›ç¬¬äºŒä¸ªå‚æ•°è¦ä¼ å¼‚å¸¸æœ¬èº«ï¼Œè€Œä¸æ˜¯e.getMessage()æˆ–e.toString(),è¿™æ ·æ‰èƒ½æ‰“å°å‡ºå¼‚å¸¸å †æ ˆï¼Œæ–¹ä¾¿å®šä½é—®é¢˜ã€‚ å¸Œæœ›å¯ä»¥æ¶ˆç­å’Œ Log æœ‰å…³çš„ Commentã€‚ æ¬¢è¿æŒ‡æ­£é”™è¯¯ï¼Œæ¬¢è¿ä¸€èµ·è®¨è®º~(â‰§â–½â‰¦)/~ã€‚","raw":null,"content":null,"categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/categories/éšç¬”/"}],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/tags/éšç¬”/"}]},{"title":"ã€è½¬ã€‘EVE æ—©æœŸæˆå‘˜é¢åŸº","slug":"i-love-eve","date":"2016-11-15T05:12:46.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/11/15/i-love-eve/","link":"","permalink":"http://yemengying.com/2016/11/15/i-love-eve/","excerpt":"ç¬¬ä¸€æ¬¡è½¬åˆ«äººçš„åšå®¢ï¼Œæƒ³çœ‹åŸæ–‡çš„è¯·ç§»æ­¥ä¸‰â€œè§‚â€èŒ…åºï¼Œæˆ‘æ‰ä¸ä¼šå‘Šè¯‰ä½ ä»¬åŸæ–‡æœ‰å¤§ç¥é«˜æ¸…æ— ç ç…§çš„ï¼ï¼ï¼","keywords":null,"text":"ç¬¬ä¸€æ¬¡è½¬åˆ«äººçš„åšå®¢ï¼Œæƒ³çœ‹åŸæ–‡çš„è¯·ç§»æ­¥ä¸‰â€œè§‚â€èŒ…åºï¼Œæˆ‘æ‰ä¸ä¼šå‘Šè¯‰ä½ ä»¬åŸæ–‡æœ‰å¤§ç¥é«˜æ¸…æ— ç ç…§çš„ï¼ï¼ï¼ å…ˆè¯´ç‚¹è‡ªå·±æƒ³è¯´çš„ï¼Œ EVE æ˜¯æ¯•ä¸šåç¬¬ä¸€ä»½å·¥ä½œåšçš„ç¬¬ä¸€ä¸ªäº§å“(ä¹Ÿå¯ä»¥è¯´ç¬¬ä¸€ä»½å·¥ä½œåšå¾—å”¯ä¸€çš„äº§å“ï¼Œåé¢çš„é‚£ä¸ªæˆ‘å®åœ¨ä¸æƒ³æ‰¿è®¤æ˜¯æˆ‘å†™çš„ğŸ™„)ï¼Œåš EVE çš„é‚£æ®µæ—¥å­æ˜¯åˆ°ç›®å‰ä¸ºæ­¢æ¯•ä¸šåæœ€å¼€å¿ƒçš„æ—¶å…‰ï¼Œå­¦ä¹ åˆ°äº†å¾ˆå¤šä¸œè¥¿ä¹Ÿè®¤è¯†äº†å¾ˆå¤šå¾ˆæ£’çš„å°ä¼™ä¼´ï¼Œä¸è¿‡ä¹Ÿå°±æ˜¯å› ä¸ºé‚£æ®µæ—¶å…‰å¤ªè¿‡ç¾å¥½ï¼Œæ‰å¯¼è‡´åœ¨éƒ¨é—¨æ‹†åˆ†ï¼ŒEVE å›¢é˜Ÿå¤§æ¢è¡€ä¹‹åèŒç”Ÿäº†ç¦»èŒçš„å¿µå¤´ã€‚å”‰ï¼Œæ²¡æœ‰å¯¹æ¯”å°±æ²¡æœ‰ä¼¤å®³å•Šã€‚ä¸è¿‡è¿˜æ˜¯å¾ˆæ„Ÿè°¢å‰å‰å¸ï¼Œè€å¤§è¿˜æœ‰ç£Šå“¥æ”¶ç•™æŠ€è‰ºä¸ç²¾çš„æˆ‘ã€‚ ä¸Šå‘¨å’Œä¹‹å‰çš„ EVE å°ä¼™ä¼´æäº†æ¬¡èšé¤ï¼Œè§åˆ°äº†ä¸€å¹´å¤šæ²¡è§çš„ sunshine å¤§ç¥ï¼Œä¹‹å‰åš EVE æ—¶ï¼Œå‰æœŸä¸€ç›´å’Œå¤§ç¥è”è°ƒï¼Œè™½æœªçœ‹è¿‡å¤§ç¥çš„ä»£ç ï¼Œä½†ä¹Ÿåœ¨ API æ–‡æ¡£è¯„å®¡æ—¶æ·±åˆ»æ„Ÿå—åˆ°äº†å¤§ç¥çš„ä»£ç æ´ç™–ã€‚å—¯ï¼Œæœ‰ä»£ç æ´ç™–çš„äººä»£ç ä¸€å®šå†™çš„å¥½ã€‚ æœ€åï¼Œå¸Œæœ›ä¸‹æ¬¡èšé¤å¯ä»¥å¬åˆ°å¤§ç¥è®²æ®µå­ğŸ˜ã€‚ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”åˆ†å‰²çº¿ï¼Œä»¥ä¸‹å†…å®¹æ¥è‡ªhongjuâ€™s blogâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” è¿™æ¬¡é¢åŸºçš„æˆå› ä¸»è¦è¿˜æ˜¯å› ä¸ºå‰ä¸¤å¤©çœ‹å¾®ä¿¡é€šè®¯å½•ï¼Œsunshine å¤§ç¥çš„å¤´åƒæ¢æˆäº†ä¸€åªç‹—ã€‚äºæ˜¯å°±èŠäº†èµ·æ¥ï¼Œç„¶åå°±æœ‰äº†ä»Šæ™šçš„è¿™æ¬¡èšé¤~ sunshine å¤§ç¥å»å¹´ç¦»èŒåï¼Œå¤§çº¦åœ¨åæœˆä¸€ä¹‹å‰èšè¿‡ä¸€æ¬¡é¤ï¼Œå½“æ—¶ä½çš„ä¹Ÿæ¯”è¾ƒè¿‘ï¼Œåæ¥å¤§ç¥æ¬åˆ°æµ¦ä¸œï¼Œäºæ˜¯ä¸€å¹´æœªè§ã€‚äºæ˜¯åˆçº¦åˆ°é˜¿å§¨ï¼Œå¢ç¥ï¼Œå‡‘äº†ä¸€æ¬¡çƒ¤è‚‰ã€‚ æœªç»å¤§ç¥åŒæ„ï¼Œå…ˆå·å·çš„æ”¾ä¸€å¼  sunshine çš„ç…§ç‰‡å§~ &lt;æ­¤å¤„åº”è¯¥æœ‰ç…§ç‰‡&gt; å¤§ç¥ï¼Œé˜¿å§¨ï¼Œå¢ç¥å’Œæˆ‘ä»¬å½“æ—¶ä¸€èµ·åšåœ¨ * å…¬å¸åš EVE è¿™æ¬¾äº§å“ï¼Œé˜¿å§¨å’Œå¢ç¥æ˜¯EVEçš„åç«¯ä¸»åŠ›ï¼Œsunshine ç®—æ˜¯æˆ‘çš„ mentorï¼Œå¸¦ç€æˆ‘ç”¨ cordova åšå®¢æˆ·ç«¯ï¼Œè¯´ç™½äº†å°±æ˜¯ç”¨ H5 æŠ€æœ¯æ¥åšå®¢æˆ·ç«¯ã€‚é‚£æ®µæ—¥å­å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ï¼Œsunshine å¤§ç¥çš„ä»£ç ä¸€ç›´å¾ˆ cleanï¼Œç»™æˆ‘åšäº†éå¸¸å¥½çš„æ¦œæ ·ã€‚ä»¥è‡³äºè¿™ä¸€å¹´å¤šæ¥ï¼Œæ²¡è§è¿‡æ¯”å¤§ç¥æ›´åŠ å¹²å‡€çš„ä»£ç ã€‚ä¹Ÿå°±è¯´ï¼Œå½“æˆ‘çœ‹é‚£äº›äººä»£ç çš„æ—¶å€™ï¼ŒæŠ‘åˆ¶ä¸ä½åæ§½çš„æƒ…ç»ªã€‚åœ¨ sunshine çš„è‰¯å¥½å½±å“ä¸‹ï¼Œæˆ‘è‡ªå·±ä¹Ÿå°½é‡å†™æœ€å¹²å‡€çš„ä»£ç ã€‚ é™¤äº†ä»£ç ä¹‹å¤–ï¼Œsunshine å¯¹æŠ€æœ¯çš„è¿½æ±‚ä¹Ÿç»™æˆ‘æ ‘ç«‹äº†å¾ˆå¥½çš„æ¦œæ ·ã€‚å…¶å®ï¼Œåœ¨å…¬å¸å°±ä¼šæ„Ÿè§‰åˆ°å¾ˆå¤šäººå¯¹æŠ€æœ¯ä»…é™äºè¡¨é¢ï¼Œæˆ–è€…èƒ½ç”¨å°±è¡Œã€‚ä¸€ç‚¹ç‚¹è¿½æ±‚éƒ½æ²¡æœ‰ï¼Œè¿™ç‚¹ï¼Œå¾ˆè‡´å‘½ã€‚ è¯´å®ŒæŠ€æœ¯ï¼Œå†è¯´è¯´ sunshine å¤§ç¥çš„ RPï¼Œå¤§ç¥ä¸ä»…æŠ€æœ¯ä¹Ÿå¥½ï¼Œåšæœ‹å‹ä¹Ÿå¾ˆå¥½ã€‚éå¸¸è¸å®ï¼Œæœ‰è¿½æ±‚ï¼Œå› æ­¤æˆ‘è§‰å¾—è‡ªå·±éå¸¸å¹¸è¿ï¼Œèƒ½åœ¨è‡ªå·±æ¯•ä¸šæ­£å¼ç­¾çº¦çš„ç¬¬ä¸€å®¶å…¬å¸å°±èƒ½é‡åˆ°è¿™ä¹ˆå¥½çš„ mentorã€‚å¯æƒœçš„æ˜¯ï¼Œsunshine ç¦»èŒï¼Œä¸¢ä¸‹çš„ EVE è¿™æ¬¾ç¾ä¸½çš„äº§å“äºä¸é è°±çš„ sjn ä¹‹æ‰‹ã€‚è¿™é‡Œä¸å†åæ§½äº†ã€‚æœ€è¿‘å¾—çŸ¥ï¼ŒEVE è¿™æ¬¾äº§å“æ›´å **ã€‚é ï¼ è¯´å®Œï¼Œsunshine ï¼Œ è¿™ç¯‡æ–‡ç« åŸºæœ¬å°±ç®—å®Œäº‹äº†ã€‚ EVE çš„æ—©æœŸæˆå‘˜éƒ½æ˜¯éå¸¸é è°±ï¼Œå°å›¢é˜Ÿï¼Œåˆèƒ½æˆäº‹ï¼Œç°åœ¨å¾ˆå¤šäººç¦»å¼€äº†å…¬å¸ï¼Œä¸€éƒ¨åˆ†äººä¹Ÿåˆ†å¸ƒåœ¨ä¸åŒçš„ä¸šåŠ¡çº¿ä¸Šï¼Œå¹¶ä¸”éƒ½æ··å¾—å¾ˆä¸é”™ã€‚æœŸå¾…ç€ï¼Œå“ªä¸€å¤©èƒ½å†æ¬¡èšåœ¨ä¸€èµ·~ä¹Ÿä¸æ‰ä¸€èµ·ä¸ºäº† EVE ç†¬äº†è®¸å¤šå¤œã€‚","raw":null,"content":null,"categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/categories/éšç¬”/"}],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/tags/éšç¬”/"},{"name":"è½¬è½½","slug":"è½¬è½½","permalink":"http://yemengying.com/tags/è½¬è½½/"}]},{"title":"Something about Spring Transaction","slug":"something-about-spring-transaction","date":"2016-11-14T13:30:34.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/11/14/something-about-spring-transaction/","link":"","permalink":"http://yemengying.com/2016/11/14/something-about-spring-transaction/","excerpt":"è®°å½•ä¸€ä¸ªä¸Šå‘¨é‡åˆ°çš„å°é—®é¢˜ã€‚","keywords":null,"text":"è®°å½•ä¸€ä¸ªä¸Šå‘¨é‡åˆ°çš„å°é—®é¢˜ã€‚ åç«¯å¼€å‘å…ä¸äº†è¦å’Œäº‹åŠ¡æ‰“äº¤é“ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„å°±æ˜¯åˆ©ç”¨ Spring æ¡†æ¶çš„å£°æ˜å¼äº‹åŠ¡ç®¡ç†ï¼Œç®€å•çš„è¯´å°±æ˜¯åœ¨éœ€è¦äº‹åŠ¡ç®¡ç†çš„ç±»æˆ–æ–¹æ³•ä¸Šæ·»åŠ  @Transactional æ³¨è§£ï¼Œç„¶ååœ¨é…ç½®ç±»ä¸Šæ·»åŠ  @EnableTransactionManagementæ³¨è§£(è¿™é‡Œé…ç½®é‡‡ç”¨ JavaConfig çš„æ–¹å¼ï¼Œå¦‚æœæ˜¯ XMLï¼Œ æ˜¯è¦åœ¨ XML æ–‡ä»¶ä¸­æ·»åŠ &lt;tx:annotation-driven/&gt;)ã€‚ç„¶å Spring æ¡†æ¶ä¼šåˆ©ç”¨ AOP åœ¨ç›¸å…³æ–¹æ³•è°ƒç”¨çš„å‰åè¿›è¡Œäº‹åŠ¡ç®¡ç†ã€‚ ä¸€ç›´ä»¥æ¥ä¹Ÿæ²¡å‡ºä»€ä¹ˆå²”å­ï¼Œç›´åˆ°ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ ä¸Šå‘¨å†™äº†æ®µå¤§æ¦‚é•¿ä¸‹é¢æ ·çº¸çš„ä»£ç ã€‚12345678910111213141516public class GiraffeServiceImpl implements GiraffeService &#123; public void A(List&lt;Giraffe&gt; giraffes) &#123; for (Giraffe giraffe : giraffes) &#123; B(giraffe); &#125; &#125; @Transactional(\"transactionManager\") public void B(Giraffe giraffe) &#123; // Step 1: update something // Step 2: insert something // Step 3: update something &#125;&#125; å¤§æ¦‚å°±æ˜¯ Service ä¸­æœ‰ä¸€ä¸ªæ–¹æ³• Aï¼Œä¼šå†…éƒ¨è°ƒç”¨æ–¹æ³• Bï¼Œ æ–¹æ³• A æ²¡æœ‰äº‹åŠ¡ç®¡ç†ï¼Œæ–¹æ³• B é‡‡ç”¨äº†å£°æ˜å¼äº‹åŠ¡ï¼Œé€šè¿‡åœ¨æ–¹æ³•ä¸Šå£°æ˜ Transactional çš„æ³¨è§£æ¥åšäº‹åŠ¡ç®¡ç†ã€‚ ç„¶é¹…ï¼Œé€šè¿‡ä¸‹é¢çš„ Junit æµ‹è¯•æ–¹æ³• A çš„æ—¶å€™å‘ç°æ–¹æ³• B çš„äº‹åŠ¡å¹¶æ²¡æœ‰å¼€å¯ï¼Œ è€Œç›´æ¥è°ƒç”¨æ–¹æ³• B äº‹åŠ¡æ˜¯æ­£å¸¸å¼€å¯çš„ã€‚ 1234567891011121314151617public class GiraffeServiceTest&#123; @Autowired private GiraffeService giraffeService; // æ²¡æœ‰å¼€å¯äº‹åŠ¡ @Test public void testA() &#123; giraffeService.A(); &#125; // æ­£å¸¸å¼€å¯äº‹åŠ¡ @Test public void testB() &#123; giraffeService.B(); &#125;&#125; é—®äº†ä¸‹æ˜ä½³å’Œè¶…å“¥ä¹‹åï¼Œç»ˆäºæœ‰ç‚¹æ˜ç™½äº†ğŸ¤” Spring åœ¨åŠ è½½ç›®æ ‡ Bean çš„æ—¶å€™ï¼Œä¼šä¸ºå£°æ˜äº† @Transactional çš„ ç›®æ ‡ Bean åˆ›é€ ä¸€ä¸ªä»£ç†ç±»ï¼Œè€Œç›®æ ‡ç±»æœ¬èº«å¹¶ä¸èƒ½æ„ŸçŸ¥åˆ°ä»£ç†ç±»çš„å­˜åœ¨ã€‚è°ƒç”¨é€šè¿‡ Spring ä¸Šä¸‹æ–‡æ³¨å…¥çš„ Bean çš„æ–¹æ³•ï¼Œ å¹¶ä¸æ˜¯ç›´æ¥è°ƒç”¨ç›®æ ‡ç±»çš„æ–¹æ³•ã€‚è€Œæ˜¯å…ˆè°ƒç”¨ä»£ç†ç±»çš„æ–¹æ³•ï¼Œå†è°ƒç”¨ç›®æ ‡ç±»çš„ã€‚ å¯¹äºåŠ äº†@Transactionalæ³¨è§£çš„æ–¹æ³•æ¥è¯´ï¼Œåœ¨è°ƒç”¨ä»£ç†ç±»çš„æ–¹æ³•æ—¶ï¼Œä¼šå…ˆé€šè¿‡æ‹¦æˆªå™¨TransactionInterceptorå¼€å¯äº‹åŠ¡ï¼Œç„¶ååœ¨è°ƒç”¨ç›®æ ‡ç±»çš„æ–¹æ³•ï¼Œæœ€ååœ¨è°ƒç”¨ç»“æŸåï¼ŒTransactionInterceptor ä¼šæäº¤æˆ–å›æ»šäº‹åŠ¡ï¼Œå¤§è‡´æµç¨‹å¦‚ä¸‹å›¾ã€‚ è€Œå¯¹äºç¬¬ä¸€æ®µçš„ä»£ç ï¼Œæˆ‘åœ¨æ–¹æ³• A ä¸­è°ƒç”¨æ–¹æ³• Bï¼Œå®é™…ä¸Šæ˜¯é€šè¿‡â€œthisâ€çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯ç›´æ¥è°ƒç”¨äº†ç›®æ ‡ç±»çš„æ–¹æ³•ï¼Œè€Œéé€šè¿‡ Spring ä¸Šä¸‹æ–‡è·å¾—çš„ä»£ç†ç±»ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚äº‹åŠ¡æ˜¯ä¸ä¼šå¼€å¯æ»´ã€‚ è§£å†³åŠæ³•ä¹Ÿè›®ç®€å•ï¼Œé€šè¿‡å®ç°ApplicationContextAwareæ¥å£è·å¾— Spring çš„ä¸Šä¸‹æ–‡ï¼Œç„¶åè·å¾—ç›®æ ‡ç±»çš„ä»£ç†ç±»ï¼Œé€šè¿‡ä»£ç†ç±»çš„å¯¹è±¡ï¼Œè°ƒç”¨æ–¹æ³• Bï¼Œå³å¯ã€‚1234567891011121314151617181920public class GiraffeServiceImpl implements GiraffeService,ApplicationContextAware&#123; @Setter private ApplicationContext applicationContext; public void A(List&lt;Giraffe&gt; giraffes) &#123; GiraffeService service = applicationContext.getBean(GiraffeService.class); for (Giraffe giraffe : giraffes) &#123; service.B(giraffe); &#125; &#125; @Transactional(\"transactionManager\") public void B(Giraffe giraffe) &#123; // Step 1: update something // Step 2: insert something // Step 3: update something &#125;&#125; stackoverflow ä¸Šä¹Ÿæœ‰ç›¸å…³çš„é—®é¢˜:@Transactional - What happens in background?@Transactional Annotation : Self Invocation å”‰ï¼Œéƒ½å¿«å†™å®Œäº†ï¼Œè¿˜æ²¡ç­‰æ¥ wuli æ‚¦å„¿","raw":null,"content":null,"categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/categories/éšç¬”/"}],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/tags/éšç¬”/"},{"name":"spring","slug":"spring","permalink":"http://yemengying.com/tags/spring/"}]},{"title":"Running Man 7012","slug":"runningman-7012","date":"2016-10-27T13:47:17.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/10/27/runningman-7012/","link":"","permalink":"http://yemengying.com/2016/10/27/runningman-7012/","excerpt":"å‰ä¸¤å¤©åˆ·å¾®åšæ—¶çªç„¶çœ‹åˆ° Gary å³å°†ä» ã€ŠRunning Manã€‹(ä»¥ä¸‹ç®€ç§° RM) ä¸‹è½¦çš„æ¶ˆæ¯ï¼Œæœ‰ç‚¹ä¼¤æ„Ÿï¼Œå´å¹¶ä¸æƒŠè®¶ã€‚å¯èƒ½ä»2016å¹´å¼€å§‹ï¼Œå°±éšçº¦æ„Ÿåˆ°èŠ‚ç›®åˆ°äº†ç“¶é¢ˆï¼Œæ”¶è§†ç‡ä¹Ÿä¸€ç›´ä¸Šä¸æ¥ï¼Œä½œä¸ºä¸€ä¸ªé“æ†ç²‰ä¸ä¹Ÿä¸å¾—ä¸æ‰¿è®¤ RM æ²¡æœ‰ä»¥å‰å¥½çœ‹äº†ï¼Œå¾ˆé•¿æ—¶é—´æ²¡æœ‰ä¸€æœŸçœ‹å¥½å‡ éçš„æƒ…å†µäº†ã€‚ä¸è¿‡è¿½äº† RM å››å¹´ï¼Œçœ‹ RM æ—©å·²ä¸æ˜¯ä¸ºäº†å¨±ä¹æç¬‘ï¼Œè€Œå˜æˆäº†è‡ªå·±ç”Ÿæ´»çš„ä¸€éƒ¨åˆ†ï¼Œåªè¦çœ‹åˆ°ä»–ä»¬ä¸ƒä¸ªå°±å¼€å¿ƒã€‚ä¹Ÿè®¸åœ¨ä¸ä¹…çš„å°†æ¥è¿ RM éƒ½ä¼šåœæ’­äº†ï¼Œä½†ç°åœ¨åªè¦ RM æ›´æ–°ä¸€æœŸï¼Œå°±ä¼šçœ‹ä¸€æœŸï¼Œå“ªæ€•å°±æ˜¯ä»–ä»¬å‡ ä¸ªå—‘ç“œå­é—²èŠå¤©ã€‚å³ä¾¿æœ‰å†ç«å†å¥½çœ‹çš„èŠ‚ç›®ï¼Œè‡ªå·±ä¹Ÿæ—©æ²¡äº†å½“åˆçš„å¿ƒå¢ƒå»è¿½äº†ã€‚æ”¹ç¼–æˆ‘å‰å¥³ç¥çš„ä¸€å¥æ­Œè¯å°±æ˜¯â€œæœ‰çš„ç»¼è‰ºè¯´ä¸æ¸…å“ªé‡Œå¥½ï¼Œä½†å°±æ˜¯è°éƒ½æ›¿ä»£ä¸äº†â€ã€‚","keywords":null,"text":"å‰ä¸¤å¤©åˆ·å¾®åšæ—¶çªç„¶çœ‹åˆ° Gary å³å°†ä» ã€ŠRunning Manã€‹(ä»¥ä¸‹ç®€ç§° RM) ä¸‹è½¦çš„æ¶ˆæ¯ï¼Œæœ‰ç‚¹ä¼¤æ„Ÿï¼Œå´å¹¶ä¸æƒŠè®¶ã€‚å¯èƒ½ä»2016å¹´å¼€å§‹ï¼Œå°±éšçº¦æ„Ÿåˆ°èŠ‚ç›®åˆ°äº†ç“¶é¢ˆï¼Œæ”¶è§†ç‡ä¹Ÿä¸€ç›´ä¸Šä¸æ¥ï¼Œä½œä¸ºä¸€ä¸ªé“æ†ç²‰ä¸ä¹Ÿä¸å¾—ä¸æ‰¿è®¤ RM æ²¡æœ‰ä»¥å‰å¥½çœ‹äº†ï¼Œå¾ˆé•¿æ—¶é—´æ²¡æœ‰ä¸€æœŸçœ‹å¥½å‡ éçš„æƒ…å†µäº†ã€‚ä¸è¿‡è¿½äº† RM å››å¹´ï¼Œçœ‹ RM æ—©å·²ä¸æ˜¯ä¸ºäº†å¨±ä¹æç¬‘ï¼Œè€Œå˜æˆäº†è‡ªå·±ç”Ÿæ´»çš„ä¸€éƒ¨åˆ†ï¼Œåªè¦çœ‹åˆ°ä»–ä»¬ä¸ƒä¸ªå°±å¼€å¿ƒã€‚ä¹Ÿè®¸åœ¨ä¸ä¹…çš„å°†æ¥è¿ RM éƒ½ä¼šåœæ’­äº†ï¼Œä½†ç°åœ¨åªè¦ RM æ›´æ–°ä¸€æœŸï¼Œå°±ä¼šçœ‹ä¸€æœŸï¼Œå“ªæ€•å°±æ˜¯ä»–ä»¬å‡ ä¸ªå—‘ç“œå­é—²èŠå¤©ã€‚å³ä¾¿æœ‰å†ç«å†å¥½çœ‹çš„èŠ‚ç›®ï¼Œè‡ªå·±ä¹Ÿæ—©æ²¡äº†å½“åˆçš„å¿ƒå¢ƒå»è¿½äº†ã€‚æ”¹ç¼–æˆ‘å‰å¥³ç¥çš„ä¸€å¥æ­Œè¯å°±æ˜¯â€œæœ‰çš„ç»¼è‰ºè¯´ä¸æ¸…å“ªé‡Œå¥½ï¼Œä½†å°±æ˜¯è°éƒ½æ›¿ä»£ä¸äº†â€ã€‚ å¥½äº†ï¼Œç»“æŸä¼¤æ„Ÿçš„è¯é¢˜ã€‚ æœ¬æ¥æƒ³å†™ç¯‡ RM ç§‘æ™®æ–‡ï¼Œä½†å¯¹ RM ä¸æ„Ÿå†’ä¼°è®¡æ€ä¹ˆè¯´ä¹Ÿä¸ä¼šæ„Ÿå…´è¶£å§ã€‚æ‰€ä»¥å°±ç®€å•å†™ç‚¹ï¼Œçºªå¿µä¸‹æˆ‘çˆ±çš„ä¸ƒåªå’Œç¬¬ä¸€æ¬¡ä¹Ÿæ˜¯æœ€åä¸€æ¬¡è¿½äº†å››å¹´çœ‹è¿‡æ¯ä¸€æœŸçš„ RMã€‚éƒ¨åˆ†èµ„æ–™å’Œå›¾ç‰‡æ¥æºäºç½‘ç»œï¼Œæƒä¾µåˆ ã€‚ ä¸ƒåªRM èƒ½æ”¶è·é‚£ä¹ˆçš„å–œçˆ±å’Œå…³æ³¨ï¼Œè™½ç„¶ç¦»ä¸å¼€åˆ¶ä½œç»„çš„ç²¾å¿ƒåˆ¶ä½œå’Œåˆ›æ„ï¼Œä½†æ›´é‡è¦çš„æ˜¯ä¸ƒä¸ª MC çš„äººæ ¼é­…åŠ›ã€‚Soâ€¦..å°±ä»ä»‹ç»ä¸ƒåªå¼€å§‹ï¼ŒèŠèŠ RM å§ã€‚ åˆ˜åœ¨çŸ³: å¤–å·ï¼šåˆ˜å¤§ç¥ã€åˆ˜é²æ–¯Â·å¨åˆ©æ–¯ã€åˆ˜å§†æ–¯Â·é‚¦å¾·ã€èš‚èš±/èš±èœ¢ã€åˆ˜èµ« å›½æ°‘ MCï¼Œä¹Ÿåº”è¯¥æ˜¯ç›®å‰éŸ©å›½åœ°ä½æœ€é«˜çš„ MC äº†ã€‚RM çš„çµé­‚äººç‰©ï¼Œç¾å¥½çš„ä¸€å¡Œç³Šæ¶‚(æˆ‘æ˜¯ä¸æ˜¯å’Œé©´å¾—æ°´é‡Œé¢çš„æ•™è‚²éƒ¨é•¿ä¸€æ ·ä¸ä¼šç”¨è¯ğŸ¤“)ã€‚ä¼šè®°ä½å·¥ä½œäººå‘˜çš„åå­—ï¼Œä¼šåœ¨å½•åˆ¶ä¸­å»å¸®åŠ©è·¯è¾¹çš„å¸‚æ°‘ï¼Œä¼šéšè—è‡ªå·±åŠªåŠ›çªå‡ºå…¶ä»–äººï¼Œäº²æ°‘ï¼Œè°¦é€Šï¼Œå¹½é»˜ï¼Œæ¸©æš–(æ­¤å¤„çœç•¥10ä¸‡å­—)ã€‚è·‘æ­¥å¾ˆå¿«ï¼Œæ‰€ä»¥æœ‰ä¸ªå¤–å·å«åˆ˜é²æ–¯Â·å¨åˆ©æ–¯ã€‚å¦‚æœç¡¬è¦è¯´ä¸€ä¸ªç¼ºç‚¹çš„è¯ï¼Œé‚£å°±æ˜¯ã€‚ã€‚ã€‚ã€‚ã€‚æ©ï¼Œæ‘˜äº†çœ¼ç›é¢œå€¼éª¤é™ã€‚ æ± çŸ³é•‡ï¼š å¤–å·ï¼šç‹é¼»å­ã€é»‘æ–‘ç¾šã€Race Starter ç‹ğŸ‘ƒå¤§å”ï¼ŒRM ä¸­å¹´é¾„æœ€å¤§çš„ï¼Œæ“…é•¿èº«ä½“æç¬‘ã€‚æ˜¯ RM ä¸­çš„æœ€å¼±ä½“, ç›‘ç‹±ä¸‰äººç»„ä¹‹ä¸€ã€‚å‡ ä¹æ¯æ¬¡æ’•åç‰Œéƒ½æ˜¯æœ€å…ˆå»ç›‘ç‹±çš„ï¼Œæ‰€ä»¥ä¹Ÿè¢«ç§°ä¸ºâ€œRace Starterâ€(æ¯”èµ›å¼€å§‹)ã€‚å…¶å®é¼»å­å¤§å”å¯¹ RM çš„è´¡çŒ®æ˜¯å¾ˆå¤§çš„ï¼Œåœ¨å‰æœŸæ‰€æœ‰äººçš„å®šä½è¿˜ä¸æ˜ç¡®çš„æ—¶å€™ï¼ŒRM çš„ç¬‘ç‚¹éƒ½æ˜¯é å¤§ç¥å’Œé¼»å­å¤§å”æ‰›èµ·æ¥çš„ï¼Œé¼»å­å”æ˜¯é‚£ç§èº«ä½“ç´ è´¨ä¸€èˆ¬ï¼Œä½†å£æ‰è¶…æ£’çš„äººï¼Œå¾ˆä¼šåˆ¶é€ ç¬‘æ–™ã€‚ å®‹æ™ºå­ï¼š å¤–å·ï¼šæ‡µæ™ºã€ä¸è‰¯æ™ºå­ã€Aceã€é‡‘æ™ºå­ã€å‘¨ä¸€æƒ…ä¾£ RM ä¸­å”¯ä¸€çš„å¥³ MCã€‚ç¬¬ä¸€çœ¼æ„Ÿè§‰å°±æ˜¯æ¼‚äº®ï¼Œå¾ˆè€çœ‹ã€‚ä½†æ·±å…¥äº†è§£ä¸‹å»ï¼Œæ‰å‘ç°æ¼‚äº®åœ¨æ™ºå­èº«ä¸Šå·²ç»ç®—ä¸ä¸Šä»€ä¹ˆé—ªå…‰ç‚¹äº†ã€‚ç¬¬ä¸€æ¬¡è§åˆ°åˆšç¡é†’é¡¶ç€ä¸€å¤´ä¹±ä¹±çš„å¤´å‘å°±å»å½•å½±çš„å¥³æ¼”å‘˜ï¼›ç¬¬ä¸€æ¬¡è§åˆ°åœ¨è½¦ä¸Šå¼ ç€å˜´ç¡çš„å¥³æ¼”å‘˜ï¼›èƒ½æ‘”è·¤ï¼Œèƒ½åŠˆç –ï¼Œèƒ½ä¸‹æ³¥æ½­ï¼Œèƒ½è¹¦æï¼Œå®Œå…¨ä¸è¾“ç»™ç”·ç”Ÿï¼›æ°”æ€¥äº†è¿˜ä¼šçˆ†ä¸¤å¥ç²—å£ï¼Œç¬é—´å˜èº«ä¸è‰¯æ™ºå­;å¾ˆèªæ˜ï¼Œæ˜¯ RM ä¸­å•ç‹¬è·èƒœæ¬¡æ•°æœ€å¤šçš„ï¼›è¿™æ ·çš„æ‡µæ™ºæ€ä¹ˆå¯èƒ½ä¸å–œæ¬¢ğŸ˜ é‡‘é’Ÿå›½ï¼š å¤–å·ï¼šèƒ½åŠ›è€…ã€è€è™ã€é’Ÿæ·‘ã€æ–¯å·´è¾¾å›½ å¾ˆå…·æœ‰åè½¬é­…åŠ›çš„ä¸€ä¸ªäººã€‚å”±æ­Œæ—¶å—“éŸ³å¾ˆç»†è…»æ¸©æŸ”ï¼Œæ’•åç‰Œæ—¶å´ä»¥ä¸€æŠµåï¼›çœ‹èº«æå¾ˆå‰½æ‚ï¼Œå®é™…å´å¾ˆçˆ±å–èŒã€‚æ˜¯ RM ä¸­çš„èƒ½åŠ›è€…ï¼Œæ’•éå¤©ä¸‹æ— æ•Œæ‰‹ï¼Œä¸è¿‡ä¹Ÿå› ä¸ºå¤ªå¼ºï¼Œç»å¸¸åœ¨æ’•åç‰Œæ—¶è¢«å›´å‰¿ğŸ˜­ã€‚è¦è¯´èƒ½åŠ›è€…æœ‰ä»€ä¹ˆæ€•çš„ï¼Œåº”è¯¥å°±æ˜¯â€œèƒŒå›é•¿é¢ˆé¹¿â€ï¼ˆæå…‰æ´™ï¼‰äº†ï¼Œå°±æ˜¯æœ¬èƒ½å‘å®³è€è™ã€‚ å’³å’³ï¼Œåªæ˜¯ä¸ºäº†èŠ‚ç›®æ•ˆæœï¼Œå›½å„¿å’Œå…‰æ´™è¿˜æ˜¯å¾ˆæœ‰çˆ±çš„ğŸ™ƒã€‚ å§œgary: å¤–å·ï¼šç‹—å“¥ã€å¹³å’ŒGaryã€å¶å°”èƒ½åŠ›è€…ã€é±¿é±¼ã€å‘¨ä¸€æƒ…ä¾£ æœ¬èŒå·¥ä½œæ˜¯éŸ³ä¹äººï¼Œä½†å´å› ä¸ºç»¼è‰ºç«äº†èµ·æ¥ã€‚åœ¨èŠ‚ç›®ä¸­ï¼Œæ€»æ˜¯ä¸ç»æ„çš„çˆ†å‘ä¸€ä¸‹ï¼Œæ‰€ä»¥è¢«ç§°ä¸ºå¶å°”èƒ½åŠ›è€…ï¼Œå‰ä¸¤æœŸçš„æœ€å¼ºè€…ç‰¹è¾‘ï¼Œ gary éƒ½æ˜¯æœ€åçš„è·èƒœè€…ã€‚gary çš„è¯¸å¤šå®šä½ä¸­ï¼Œæœ€ç«çš„åº”è¯¥å°±æ˜¯å’Œæ™ºå­çš„å‘¨ä¸€æƒ…ä¾£äº†ã€‚è™½ç„¶åœ¨2016å¹´çš„èŠ‚ç›®ä¸­ï¼Œåˆ¶ä½œç»„ç‰¹æ„æ·¡åŒ–äº†å‘¨ä¸€cpé—´çš„äº’åŠ¨ï¼Œä½†æˆ‘ä¸€ç›´è§‰å¾— gary å°±æ˜¯æ™ºå­çš„â€œå§œç›–é‡Œâ€ï¼Œä¼šå·å·æ”¾èµ°å¥¹çš„â€œå§œç›–é‡Œâ€ã€‚å¤šäºäº†å‘¨ä¸€æƒ…ä¾£ï¼Œè®©æˆ‘åœ¨çœ‹ç»¼è‰ºçš„åŒæ—¶ï¼Œä¹Ÿçœ‹äº†éƒ¨å¶åƒå‰§ğŸŒš å“ˆå“ˆï¼š å¤–å·ï¼šHaroroã€ä¼é¹…ã€èŠ±å¿ƒå“ˆå“ˆ å“ˆå“ˆï¼Œæœ¬åæ²³ä¸œå‹‹ï¼Œä¸è¿‡è¿˜æ˜¯æ›´ä¹ æƒ¯å“ˆå“ˆè¿™ä¸ªåå­—ã€‚æ—©æœŸåœ¨ RM çš„å®šä½æ˜¯â€œèŠ±å¿ƒå“ˆå“ˆâ€ï¼Œæ¯æ¬¡ä¸€æ¥å¥³å˜‰å®¾ï¼Œå°±ä¼šè¯´â€œæˆä¸ºæˆ‘æœ€åçš„çˆ±å§ (ï½¡â™¥â€¿â™¥ï½¡)â€ã€‚ä¸è¿‡è¿™äº›åªæ˜¯ä¸ºäº†æ´»è·ƒæ°”æ°›ï¼Œç»“å©šä¹‹åâ€œèŠ±å¿ƒå“ˆå“ˆâ€çš„å®šä½å°±æ²¡æœ‰ï¼Œå˜æˆäº†â€œé¡¾å®¶å¥½ç”·äººâ€ï¼Œæœ€è¿‘å¬è¯´å“ˆå“ˆé©¬ä¸Šè¦æœ‰ç¬¬äºŒä¸ªå­©å­äº†ï¼Œåœ¨æ¸¡æ±‰æ±Ÿé‚£æœŸè¯´çš„æ„¿æœ›ä¹Ÿè¦å®ç°äº†ã€‚ æå…‰æ´™: å¤–å·ï¼šé•¿é¢ˆé¹¿ã€äºšæ´²ç‹å­ã€æå…‰å­ã€å…‰å‡¡è¾¾ã€å…‰èŸ¾èœã€æƒ…æ™¯å‰§å‘çƒ§å‹ ç»å¯¹çš„ç”·ç¥ï¼Œæˆ‘åšå®¢çš„æ ‡å‡†ç»“å°¾ã€‚å…¶å®åœ¨ä¸€å¼€å§‹ï¼Œå…‰æ´™å¯ä»¥è¯´æ˜¯æœ€ä¸èµ·çœ¼çš„ï¼Œä½œä¸ºä¸€ä¸ªç»¼è‰ºæ–°æ‰‹ï¼Œæ²¡æœ‰å¤§ç¥ï¼Œå›½å„¿ï¼Œhahaä»ä»¥å‰èŠ‚ç›®ç§¯ç´¯ä¸‹çš„è§‚ä¼—ç¼˜ï¼Œæ²¡æœ‰ç‹é¼»å­è€ç»ƒï¼Œæ²¡æœ‰ gary æœ‰é‚£ä¹ˆå¤šçš„æ­Œè¿·ï¼Œä¹Ÿæ²¡æœ‰å®‹ä»²åŸºé‚£ä¹ˆæ˜æ˜¾çš„é¢œå€¼ä¼˜åŠ¿ã€‚ä½†åœ¨è‡ªå·±çš„åŠªåŠ›å’Œå…¶ä»–äººçš„å¸®åŠ©ä¸‹ï¼Œä¸€ç‚¹ç‚¹æ‰¾åˆ°äº†è‡ªå·±çš„å®šä½ï¼ˆé™·å®³å…‰æ´™ï¼Œeasy å…„å¼Ÿï¼Œé•¿é¢ˆé¹¿)ã€‚åœ¨èŠ‚ç›®ä¸­ï¼Œå…‰æ´™æœ€æ˜æ˜¾çš„ç‰¹è´¨åº”è¯¥å°±æ˜¯â€œèƒŒå›â€äº†ï¼Œæ¯æ¬¡éƒ½è®©äººè§‰å¾—å¥½æ°”å•Šï¼Œç„¶åå°±åˆç¬‘çš„è‚šå­ç–¼ã€‚ã€‚ã€‚ã€‚ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸ƒä¸ª MC ä¸­ï¼Œæœ€æœ€å–œæ¬¢å…‰æ´™ï¼Œè¿å¸¦ç€æŠŠå¾ˆå¤šç½‘ç«™çš„ç”¨æˆ·åéƒ½æ¢æˆäº† giraffeï¼Œå¯èƒ½å¤©ç”Ÿå°±å¯¹è¿™ç§åˆåŠªåŠ›åˆé€—æ¯”çš„äººæ²¡æœ‰æŠµæŠ—åŠ›å§ã€‚ æ”¾ä¸€ä¸‹å¥³è£…é€ å‹ ä¸è¿‡ä¸€å¼€å§‹çš„èƒ¡å­é€ å‹çœŸæ˜¯äº®çäº†æˆ‘çš„å¡å§¿å…°å¤§çœ¼ç›ã€‚ å“ˆå“ˆå“ˆå“ˆï¼ŒåŸè°…æˆ‘ï¼Œçˆ±åˆ°æ·±å¤„è‡ªç„¶é»‘å•Šã€‚ å¢™è£‚æ¨èæœ¬æ¥æƒ³æŒ‰ç…§å¥½çœ‹ç¨‹åº¦æ’ä¸ªæœ€å¥½çœ‹çš„åæœŸï¼Œæœ€åå‘ç°å®åœ¨é€‰ä¸å‡ºæ¥ã€‚æ¯ä¸€æœŸéƒ½æ•²å¥½çœ‹ï¼Œéƒ½å€¼å¾—çœ‹ã€‚å°±éšä¾¿æ¨å‡ æœŸå§ã€‚ 20130825 æŒ‰ç…§ç”µå½±é›ªå›½åˆ—è½¦ä¸ºä¸»é¢˜æ‹æ‘„çš„ä¸€æœŸï¼Œç©æ¸¸æˆæ•´ç†æ’åï¼Œå›½å„¿å’Œå¤§ç¥äº’æ‰“æ‰‹æŒé‚£æ®µç®€ç›´ç¬‘å±æˆ‘äº†ã€‚ 20130526 å˜‰å®¾æ˜¯é‡‘ç§€è´¤å’Œæç¹é›¨ï¼Œå…¨é›†é«˜èƒ½ï¼Œæˆ‘å¤§ç¥å¼ç€æ¥åŠ›æ£’åƒæ´‹è‘±åœˆç®€ç›´èŒç¿»æˆ‘ã€‚ 20141123 è¿™é›†é€ å‹æå…¶å“‡æ’’ï¼Œæ”¾å¼ å›¾ï¼Œå¤§å®¶æ†‹è¯´è¯ï¼Œç”¨å¿ƒæ„Ÿå— 20141012 ä¸ƒä¸ªæˆå‘˜éƒ½å˜æˆäº†è¶…çº§è‹±é›„ï¼Œé«˜ç©ºæµ‹è¯•èƒ†é‡é‚£æ®µç¬‘çš„æˆ‘è‚šå­ç–¼ã€‚ 20141109 å¥³è£…ç‰¹è¾‘ï¼Œæœ€çˆ±wuliå…‰å­å’Œé’Ÿæ·‘äº†ã€‚ 20130915 å¾ˆå¤šäººåº”è¯¥å†²ç€å˜‰å®¾æ˜¯Bigbangçœ‹è¿‡è¿™æœŸäº†ï¼Œä½†æˆ‘æ¨èè¿™æœŸæ˜¯å› ä¸ºè¿™æœŸæœ‰æˆ‘å‘¨ä¸€æƒ…ä¾£çš„è§å±åˆå»ï¼Œæˆ‘çš„å°‘å¥³å¿ƒå•ŠğŸ˜ 20141214 é€šè¿‡ä¸€å¼ å›¾å°±èƒ½çŸ¥é“å¤§ç¥ä¸ºäº†èµ¢æœ‰å¤šæ‹¼ã€‚ 20160403 2016å¹´é‡Œçš„è§‰å¾—æœ€å¥½çœ‹çš„ä¸€æœŸã€‚ç‰¹åˆ«æ˜¯wuliå…‰æ´™è¢«hahaæ„šå¼„çš„é‚£æ®µã€‚ 20111225 ç¬¬ä¸€æœŸæœ€å¼ºè€…ç‰¹è¾‘ã€‚RM æ¯å¹´éƒ½ä¼šæœ‰ä¸€æœŸæ˜¯æœ€å¼ºè€…ç‰¹è¾‘ï¼Œé—æ†¾çš„æ˜¯å›½å„¿è¿˜ä»æ¥æ²¡æœ‰èµ¢è¿‡ï¼Œå¸Œæœ›ä¸‹ä¸€æœŸæœ€å¼ºè€…æˆ˜å¯ä»¥æ˜¯å›½å„¿èµ¢ã€‚ 20120624 RM ç¬¬ä¸€ç™¾æœŸç‰¹è¾‘ï¼Œè¯¸ç¥ä¹‹æˆ˜ï¼Œ å˜‰å®¾æ˜¯é‡‘å–œå–„ï¼Œ ç»“å±€è›®ä¸é”™çš„ 20150125 åˆ˜å§†æ–¯é‚¦å¾· vs å…‰ä½›å²©ï¼Œç»“å°¾ç‹—å“¥çœŸæ˜¯è ¢èŒçš„è®©äººå¿ƒç–¼ 20110911 ç‹—å“¥åšé—´è°ğŸ•µçš„ä¸€æœŸï¼Œä¸åº”è¯¥è¯´æ˜¯ç‹—å“¥ä»¥ä¸ºä»–åšé—´è°ï¼Œä½†æ˜¯å…¶ä»–æˆå‘˜å…¶å®éƒ½çŸ¥é“ä»–æ˜¯é—´è°ï¼Œä»–å¹¶ä¸çŸ¥é“å…¶ä»–æˆå‘˜çŸ¥é“ä»–æ˜¯é—´è°çš„ä¸€æœŸã€‚ã€‚ã€‚è‰¾ç›å•Šï¼Œè¯´çš„å¥½ç»•ğŸ™ƒ åˆåˆ°ç¡è§‰è§‰çš„æ—¶å€™äº†å†™çš„å·®ä¸å¤šäº†ï¼Œè¿™ä¹ˆç‚¹å†…å®¹æ ¹æœ¬è¡¨è¾¾ä¸å‡º RM å¸¦ç»™æˆ‘çš„å¿«ä¹ã€‚ç”Ÿæ´»å¤§çˆ†ç‚¸ä¹Ÿå¼€å§‹æ›´æ–°ç¬¬åå­£äº†ï¼Œå¾ˆæœ‰å¯èƒ½æ˜¯æœ€åä¸€å­£ï¼Œè¯´ä¸å®šè¿‡ä¸¤å¤©åˆè¦å†™ç¯‡æ–‡ç« çºªå¿µä¸‹è´±èŒè´±èŒçš„ Sheldon, æ€»è¢«å‹è¿«çš„ Leonard å’Œå¥³æ±‰çº¸ Penny äº†ã€‚","raw":null,"content":null,"categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/categories/éšç¬”/"}],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/tags/éšç¬”/"}]},{"title":"æ»šè›‹å§~ XML å›","slug":"javaConfig-vs-XML","date":"2016-10-15T07:20:20.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/10/15/javaConfig-vs-XML/","link":"","permalink":"http://yemengying.com/2016/10/15/javaConfig-vs-XML/","excerpt":"Long long time ago, åœ¨ã€ŠSpring In Actionã€‹ä¸€ä¹¦ä¸­çœ‹åˆ°è¿™ä¹ˆä¸€å¥è¯ JavaConfig is the preferred option for explicit configuration because itâ€™s more powerful, type-safe, and refactor-friendly ã€‚ä¸è¿‡å½“æ—¶å¹¶ä¸çŸ¥é“ JavaConfig æ˜¯ç¥é©¬ä¸œä¸œå°±é€‰æ‹©æ€§å¿½ç•¥äº†ã€‚æœ€è¿‘æ–°çš„é¡¹ç›®é‡‡ç”¨äº† Spring Boot + JavaConfig ,æ¥è§¦äº†ä¸€ä¸ªæ˜ŸæœŸçš„ JavaConfigï¼Œæ„Ÿè§‰è¿˜ä¸é”™ï¼Œç®€å•æ¯”è¾ƒä¸‹å®ƒå’Œ XMLã€‚ç”±äºæ¥è¿çœ‹äº† 4 éƒ¨éŸ©å›½ç¾éš¾ç‰‡å¿ƒæƒ…æ¯”è¾ƒè“ç˜¦ï¼Œå°±æš‚æ—¶ä¸è¦æŒ‡æ­£é”™è¯¯äº†ï¼Œé”™å°±é”™å§(ã¥ï½¡â—•â€¿â€¿â—•ï½¡)ã¥","keywords":null,"text":"Long long time ago, åœ¨ã€ŠSpring In Actionã€‹ä¸€ä¹¦ä¸­çœ‹åˆ°è¿™ä¹ˆä¸€å¥è¯ JavaConfig is the preferred option for explicit configuration because itâ€™s more powerful, type-safe, and refactor-friendly ã€‚ä¸è¿‡å½“æ—¶å¹¶ä¸çŸ¥é“ JavaConfig æ˜¯ç¥é©¬ä¸œä¸œå°±é€‰æ‹©æ€§å¿½ç•¥äº†ã€‚æœ€è¿‘æ–°çš„é¡¹ç›®é‡‡ç”¨äº† Spring Boot + JavaConfig ,æ¥è§¦äº†ä¸€ä¸ªæ˜ŸæœŸçš„ JavaConfigï¼Œæ„Ÿè§‰è¿˜ä¸é”™ï¼Œç®€å•æ¯”è¾ƒä¸‹å®ƒå’Œ XMLã€‚ç”±äºæ¥è¿çœ‹äº† 4 éƒ¨éŸ©å›½ç¾éš¾ç‰‡å¿ƒæƒ…æ¯”è¾ƒè“ç˜¦ï¼Œå°±æš‚æ—¶ä¸è¦æŒ‡æ­£é”™è¯¯äº†ï¼Œé”™å°±é”™å§(ã¥ï½¡â—•â€¿â€¿â—•ï½¡)ã¥ XMLè™½ç„¶æ—©åœ¨ Spring 3 ä¸­å°±å¼€å§‹æ”¯æŒä»¥ JavaConfig çš„æ–¹å¼é…ç½®é¡¹ç›®ï¼Œä½†æ„Ÿè§‰ç›®å‰ä¸»æµçš„è¿˜æ˜¯ä»¥ XML + Annotation çš„æ–¹å¼ï¼Œå¾ˆå°‘è§åˆ°ä½¿ç”¨ JavaConfig çš„ã€‚å¯èƒ½æœ‰ç‚¹ä»¥åæ¦‚å…¨äº†ï¼Œä½†åœ¨å‰å¸å’Œå‰å‰å¸æ¥è§¦åˆ°çš„é¡¹ç›®éƒ½æ˜¯ä»¥ XML + Annotation æ··åˆçš„æ–¹å¼é…ç½®çš„ï¼Œå³åœ¨ XML é…ç½®æ–‡ä»¶ä¸­å¼€å¯æ³¨è§£æ‰«æ, ä¸šåŠ¡ bean çš„é…ç½®æ³¨å…¥é‡‡ç”¨æ³¨è§£( @Serivce, @Autowire ç­‰ç­‰)ï¼Œå…¨å±€çš„ä¸€äº›é…ç½®(å¦‚ MyBatis çš„ DataSource,SqlSessionFactory ï¼Œweb.xml ç­‰ç­‰)ä½¿ç”¨ XMLã€‚ è™½ç„¶ XML + Annotation çš„æ–¹å¼æ¯”çº¯ç”¨ XML é…ç½®çš„æ–¹å¼å°‘å†™äº†å¾ˆå¤š XMLï¼Œä½†æœ¬è´¨ä¸Šè¿˜æ˜¯åŸºäº XML çš„ã€‚ XML çš„é…ç½®æ–‡ä»¶æ¯”è¾ƒå†—é•¿ï¼Œä¸æ˜“ä¹¦å†™ï¼Œè€Œä¸”å¯è¯»æ€§ä¹Ÿä¸é«˜ã€‚ä¸çŸ¥é“å¤§å®¶æ„Ÿè§‰æ€ä¹ˆæ ·ï¼Œåæ­£æˆ‘çœ‹ç€æ˜¯æŒºå¤´ç–¼çš„â•¥ï¹â•¥â€¦ JavaConfigå…ˆç®€å•ä»‹ç»ä¸€ä¸‹ JavaConfigï¼ŒJavaConfigå³Java Configuration, å³ç”¨çº¯ Java çš„æ–¹å¼æ¥é…ç½® Spring IoC å®¹å™¨,å…è®¸å¼€å‘è€…ç”¨ä»£ç æ¥è¡¨ç¤ºé…ç½®é€»è¾‘ï¼Œä¸å†éœ€è¦ XMLã€‚ç²—ç•¥ç¿»äº†ä¸¤æœ¬å…³äº Spring Bootçš„ä¹¦ï¼Œ JavaConfig éƒ½æ˜¯æœ€æ¨èçš„é…ç½®æ–¹å¼ã€‚ ä½¿ç”¨ JavaConfig çš„å¥½å¤„ï¼ŒSpring å®˜æ–¹æ–‡æ¡£ä¸­è¯´çš„å¾ˆæ¸…æ¥šï¼š JavaConfig ä¸ºä¾èµ–æ³¨å…¥æä¾›äº†ä¸€ä¸ªçœŸæ­£é¢å‘å¯¹è±¡çš„æœºåˆ¶ï¼Œè¿™æ„å‘³ç€å¼€å‘è€…å¯ä»¥åœ¨é…ç½®ä»£ç ä¸­å……åˆ†åˆ©ç”¨ Java é‡ç”¨ã€ç»§æ‰¿å’Œå¤šæ€æ€§ç­‰ç‰¹æ€§ã€‚ å¼€å‘è€…å¯ä»¥å®Œå…¨æ§åˆ¶å®ä¾‹åŒ–å’Œä¾èµ–æ³¨å…¥ï¼Œå³ä½¿æ˜¯æœ€å¤æ‚çš„å¯¹è±¡ä¹Ÿå¯ä»¥å¾ˆä¼˜é›…åœ°å¤„ç†ã€‚ å› ä¸ºä½¿ç”¨ JavaConfig åªéœ€è¦ Javaï¼Œå¯ä»¥å¾ˆå®¹æ˜“çš„ refactor ä»£ç ï¼Œè€Œæ— éœ€å† IDE ä¹‹å¤–ä½¿ç”¨ç‰¹æ®Šçš„å·¥å…·æˆ–æ’ä»¶ã€‚ JavaConfig å…¶å®å¾ˆç®€å•ï¼Œä¸»è¦æ˜¯é€šè¿‡ @Configuration å’Œ @Bean æ¥è¿›è¡Œé…ç½®ã€‚@Configuration æ³¨è§£çš„ä½œç”¨æ˜¯å£°æ˜å½“å‰ç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼Œ å°±ç›¸å½“äºä¸€ä¸ª XML æ–‡ä»¶ã€‚ @Bean æ³¨è§£å£°æ˜å½“å‰æ–¹æ³•è¿”å›çš„æ˜¯ä¸€ä¸ª beanã€‚ å¯èƒ½è¿™æ ·è¯´å¯¹äºç”¨æƒ¯äº† XML çš„äººè¿˜æ˜¯æ¯”è¾ƒæŠ½è±¡çš„ï¼Œä¸‹é¢çœ‹çœ‹è¿™äº›æ³¨è§£ä¸ XML é…ç½®çš„å¯¹åº”å…³ç³»ã€‚ JavaConfig ä¸ XML1.JavaConfig: @ConfigurationXML: 1234567891011121314&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:tx=\"http://www.springframework.org/schema/tx\" xmlns:util=\"http://www.springframework.org/schema/util\" xmlns:p=\"http://www.springframework.org/schema/p\" xsi:schemaLocation=\"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd\"&gt; &lt;/beans&gt; 2.JavaConfig: @BeanXML: 12345&lt;bean id=\"dataSource\" class=\"com.alibaba.druid.pool.DruidDataSource\"&gt; &lt;property name=\"url\" value=\"jdbc:mysql://127.0.0.1:3307/giraffe\"/&gt; &lt;property name=\"username\" value=\"ymy\"/&gt; &lt;property name=\"password\" value=\"666666\"/&gt;&lt;/bean&gt; 3.JavaConfigï¼š@ComponentScanXMLï¼š 1&lt;context:component-scan&gt; 4.JavaConfigï¼š@ImportXMLï¼š 1&lt;import resource=\"XXX.xml\"/&gt; æ¯”å¦‚è¦é…ç½®ä¸€ä¸ª dataSourceï¼Œ åœ¨ XML ä¸­é€šå¸¸çš„åšæ³•æ˜¯è¿™æ ·çš„ï¼š 123456&lt;bean id=\"drMainDataSource\" class=\"com.alibaba.druid.pool.DruidDataSource\"&gt; &lt;property name=\"url\" value=\"$&#123;mysql.datasource.url&#125;\"/&gt; &lt;property name=\"username\" value=\"$&#123;mysql.datasource.username&#125;\"/&gt; &lt;property name=\"password\" value=\"$&#123;mysql.datasource.password&#125;\"/&gt; &lt;property name=\"maxActive\" value=\"&#123;mysql.datasource.max-active&#125;\"/&gt;&lt;/bean&gt; å¯¹åº”çš„ JavaConfig æ˜¯é…±ç´«çš„ï¼š 123456789101112131415161718@Configurationpublic class DataAccessConfig extends ConfigurationSupport &#123; @Bean(name = \"dataSource\") public DataSource mysqlDataSource(@Value(\"$&#123;mysql.datasource.url&#125;\") String url, @Value(\"$&#123;mysql.datasource.username&#125;\") String username, @Value(\"$&#123;mysql.datasource.password&#125;\") String password, @Value(\"$&#123;mysql.datasource.driverClass&#125;\") String driver, @Value(\"$&#123;mysql.datasource.max-active&#125;\") int maxActive) &#123; DruidAbstractDataSource dataSource = new DruidDataSource(); dataSource.setDriverClassName(driver); dataSource.setUrl(url); dataSource.setUsername(username); dataSource.setPassword(password); dataSource.setMaxActive(maxActive); return dataSource; &#125;&#125; æ€»ç»“è™½ç„¶æ‰æ¥è§¦äº†ä¸€å‘¨çš„ JavaConfig, ä½†æ˜¯ç›¸è§æ¨æ™šå•Š, ä¸ªäººè¿˜æ˜¯æ›´å–œæ¬¢ JavaConfig çš„é…ç½®æ–¹å¼çš„ã€‚JavaConfig çš„é…ç½®æ–‡ä»¶å¯è¯»æ€§æ›´é«˜ä¹Ÿæ›´å®¹æ˜“å­¦ä¹ ï¼Œè®°ä½ç®€å•çš„å‡ ä¸ªæ³¨è§£å³å¯ï¼›å€ŸåŠ© IDE çš„åŠ›é‡ï¼Œæ›´ä¸å®¹æ˜“å‡ºé”™ï¼›è€Œä¸”è„‘è¢‹å†ä¹Ÿä¸ç”¨åœ¨ Java å’Œ XML é—´æ¥å›åˆ‡æ¢äº†ï¼Œåœ¨æ­é…ä¸Š Gradle ç®€ç›´ç ´è´¹ç§‘ç‰¹ï¼ï¼ï¼ï¼ï¼ ç›¸å…³æ–‡æ¡£ Spring JavaConfig Document ã€ŠSpring Boot æ­ç§˜ã€‹ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-ç‰‡ å°¾ å½© è›‹ ğŸ‰ğŸ‰ğŸ‰â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å’³å’³ï¼Œé¢„è­¦é¢„è­¦ï¼ï¼ï¼ä¸‹é¢çš„éƒ¨åˆ†ä¸æœ¬æ–‡ä¸»æ—¨æ— å…³ã€‚ é¦–å…ˆï¼Œæ¢äº†ä¸ªæ–°é”…ï¼Œå¯ä»¥é¢„çº¦ç…®ç²¥ï¼Œå†ä¹Ÿä¸ç”¨æ—©èµ·ç…®ç²¥äº†ï¼Œå¹¸ç¦æ„Ÿæå‡ 200%ã€‚å…¶æ¬¡ï¼Œåœ¨åŒ¿åäººå£«çš„å¸®åŠ©ä¸‹ä¸Šçº¿äº†æ–°ç‰ˆæœªç¿»å¢™æ¨¡å¼ä¸‹çš„è¯„è®ºï¼Œä¼˜åŒ–äº†æ ·å¼ã€‚å”‰ï¼Œè¿™æ˜¯è°çš„ç”·æœ‹å‹è¿™ä¹ˆæœ‰æ‰åï¼Œå¥½ç¾¡æ…•å¥¹å“¦ï¸¿(ï¿£ï¸¶ï¿£)ï¸¿ æœ€åï¼Œå˜¿å˜¿ï¼Œå…³æ³¨ä¸ªå…¬ä¼—å·å†èµ°å§(^__^)","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"spring","slug":"spring","permalink":"http://yemengying.com/tags/spring/"}]},{"title":"ã€è¯‘ã€‘S.O.L.I.D åŸåˆ™åœ¨ Go ä¸­çš„åº”ç”¨ï¼ˆä¸Šï¼‰","slug":"solid-go-design-1","date":"2016-09-11T07:09:18.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/09/11/solid-go-design-1/","link":"","permalink":"http://yemengying.com/2016/09/11/solid-go-design-1/","excerpt":"æœ€è¿‘ä¸¤ä¸ªæœˆæ²¡æœ‰å¥½å¥½çš„çœ‹ä¹¦å­¦ä¹ ï¼Œå¯¼è‡´åšå®¢ä¹Ÿæ°´äº†ä¸¤ä¸ªæœˆæ²¡å†™ä»€ä¹ˆæ­£ç»çš„ã€‚ä¸Šå‘¨æ”¶åˆ°ä»“é¼ ğŸ¹å›èŒèŒå“’çš„é‚®ä»¶ä¹‹åï¼Œåˆæ¿€èµ·äº†æˆ‘å†™åšå®¢çš„æ¬²æœ›ã€‚ç”±äºè‡ªå·±æœ€è¿‘çµæ„Ÿæ¯ç«­ï¼Œæ‰€ä»¥æˆ‘å†³å®šç¿»è¯‘ä¸€ç¯‡åˆ«äººçš„O(âˆ©_âˆ©)O~ã€‚ä½œä¸ºä¸€ä¸ªä¸€ç›´æƒ³å­¦ Goï¼Œä½†æƒ³äº†å¥½ä¹…è¿˜æ²¡å…¥é—¨çš„äººï¼Œæˆ‘æŒ‘äº†ç¯‡å†™ Go çš„ï¼Œé¡ºä¾¿å¸®è‡ªå·±ç†Ÿæ‚‰ä¸€ä¸‹ Goã€‚åŸæ–‡æ˜¯ä½œè€…æ ¹æ®è‡ªå·± GolangUK çš„æ¼”è®²æ‰€æ•´ç†çš„ï¼Œå…¨æ–‡ä»¥ SOLID åŸåˆ™ä¸ºçº¿è·¯è®²è¿°äº†ä»€ä¹ˆæ ·çš„ Go ä»£ç æ‰ç®—æ˜¯å¥½ä»£ç ï¼Œå½“ç„¶ SOLID åŸåˆ™ä¹Ÿé€‚ç”¨äºå…¶ä»–è¯­è¨€ã€‚åŸæ–‡æ¯”è¾ƒé•¿ï¼Œæ‰€ä»¥å‡†å¤‡åˆ†æˆä¸Šä¸‹ä¸¤éƒ¨åˆ†ï¼Œä¹Ÿæœ‰ååˆ†éå¸¸ä»¥åŠç‰¹åˆ«å¤§çš„å¯èƒ½æ˜¯ä¸Šä¸­ä¸‹(æ‚è„¸)ã€‚ å’³å’³ï¼Œæˆ‘æœç„¶æ˜¯æ‰“è„¸ä½“è´¨ï¼Œä¸‹ç¿»è¯‘äº†ä¸€å¥å°±æ”¾å¼ƒäº†ã€‚ä¸è¿‡ï¼Œæˆ‘æŠŠå®ƒäº¤ç»™äº†è¶…é è°±çš„å°ä¼™ä¼´ã€‚æƒ³çœ‹ä¸‹çš„è¯·ç§»æ­¥ã€è¯‘ã€‘S.O.L.I.D åŸåˆ™åœ¨ Go ä¸­çš„åº”ç”¨ï¼ˆä¸‹ï¼‰ æ‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚è¿˜æ˜¯ä¸æ‚äº†ï¼Œè„¸å·²ç»ä¸¢æ²¡äº†ğŸ™ˆ","keywords":null,"text":"æœ€è¿‘ä¸¤ä¸ªæœˆæ²¡æœ‰å¥½å¥½çš„çœ‹ä¹¦å­¦ä¹ ï¼Œå¯¼è‡´åšå®¢ä¹Ÿæ°´äº†ä¸¤ä¸ªæœˆæ²¡å†™ä»€ä¹ˆæ­£ç»çš„ã€‚ä¸Šå‘¨æ”¶åˆ°ä»“é¼ ğŸ¹å›èŒèŒå“’çš„é‚®ä»¶ä¹‹åï¼Œåˆæ¿€èµ·äº†æˆ‘å†™åšå®¢çš„æ¬²æœ›ã€‚ç”±äºè‡ªå·±æœ€è¿‘çµæ„Ÿæ¯ç«­ï¼Œæ‰€ä»¥æˆ‘å†³å®šç¿»è¯‘ä¸€ç¯‡åˆ«äººçš„O(âˆ©_âˆ©)O~ã€‚ä½œä¸ºä¸€ä¸ªä¸€ç›´æƒ³å­¦ Goï¼Œä½†æƒ³äº†å¥½ä¹…è¿˜æ²¡å…¥é—¨çš„äººï¼Œæˆ‘æŒ‘äº†ç¯‡å†™ Go çš„ï¼Œé¡ºä¾¿å¸®è‡ªå·±ç†Ÿæ‚‰ä¸€ä¸‹ Goã€‚åŸæ–‡æ˜¯ä½œè€…æ ¹æ®è‡ªå·± GolangUK çš„æ¼”è®²æ‰€æ•´ç†çš„ï¼Œå…¨æ–‡ä»¥ SOLID åŸåˆ™ä¸ºçº¿è·¯è®²è¿°äº†ä»€ä¹ˆæ ·çš„ Go ä»£ç æ‰ç®—æ˜¯å¥½ä»£ç ï¼Œå½“ç„¶ SOLID åŸåˆ™ä¹Ÿé€‚ç”¨äºå…¶ä»–è¯­è¨€ã€‚åŸæ–‡æ¯”è¾ƒé•¿ï¼Œæ‰€ä»¥å‡†å¤‡åˆ†æˆä¸Šä¸‹ä¸¤éƒ¨åˆ†ï¼Œä¹Ÿæœ‰ååˆ†éå¸¸ä»¥åŠç‰¹åˆ«å¤§çš„å¯èƒ½æ˜¯ä¸Šä¸­ä¸‹(æ‚è„¸)ã€‚ å’³å’³ï¼Œæˆ‘æœç„¶æ˜¯æ‰“è„¸ä½“è´¨ï¼Œä¸‹ç¿»è¯‘äº†ä¸€å¥å°±æ”¾å¼ƒäº†ã€‚ä¸è¿‡ï¼Œæˆ‘æŠŠå®ƒäº¤ç»™äº†è¶…é è°±çš„å°ä¼™ä¼´ã€‚æƒ³çœ‹ä¸‹çš„è¯·ç§»æ­¥ã€è¯‘ã€‘S.O.L.I.D åŸåˆ™åœ¨ Go ä¸­çš„åº”ç”¨ï¼ˆä¸‹ï¼‰ æ‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚è¿˜æ˜¯ä¸æ‚äº†ï¼Œè„¸å·²ç»ä¸¢æ²¡äº†ğŸ™ˆ åŸæ–‡é“¾æ¥ï¼šhttp://dave.cheney.net/2016/08/20/solid-go-design?utm_source=wanqu.co&amp;utm_campaign=Wanqu+Daily&amp;utm_medium=websiteåŸæ–‡ä½œè€…ï¼šDave Cheney ä¸–ç•Œä¸Šæœ‰å¤šå°‘ä¸ª Go è¯­è¨€å¼€å‘è€…ï¼Ÿä»‹ä¸ªä¸–ç•Œä¸Šæœ‰å¤šå°‘ Go å¼€å‘è€…æï¼Ÿåœ¨è„‘æµ·ä¸­æƒ³ä¸€ä¸ªæ•°å­—ï¼Œæˆ‘ä»¬ä¼šåœ¨æœ€åå›åˆ°è¿™ä¸ªè¯é¢˜ã€‚ Code reviewæœ‰å¤šå°‘äººå°† code review å½“åšè‡ªå·±å·¥ä½œçš„ä¸€éƒ¨åˆ†?[å¬æ¼”è®²çš„äººéƒ½ä¸¾èµ·äº†æ‰‹]ã€‚ä¸ºä»€ä¹ˆè¦åš code reviewï¼Ÿ[ä¸€äº›äººå›ç­”ä¸ºäº†é˜»æ­¢ä¸å¥½çš„ä»£ç ] å¦‚æœ code review æ˜¯ä¸ºäº†æ•æ‰åˆ°ä¸å¥½çš„ä»£ç ï¼Œé‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä½ æ€ä¹ˆåˆ¤æ–­ä½ æ­£åœ¨ review çš„ä»£ç æ˜¯å¥½è¿˜æ˜¯ä¸å¥½å‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„è¯´å‡ºâ€œè¿™ä»£ç å¥½è¾£çœ¼ç›â€æˆ–è€…â€œè¿™æºç å†™çš„å¤ªåŠäº†â€ï¼Œå°±åƒè¯´â€œè¿™ç”»çœŸç¾â€ï¼Œâ€œè¿™å±‹å­çœŸå¤§æ°”â€ä¸€æ ·ã€‚ä½†æ˜¯è¿™äº›éƒ½æ˜¯ä¸»è§‚çš„ï¼Œæˆ‘å¸Œæœ›æ‰¾åˆ°ä¸€äº›å®¢è§‚çš„æ–¹æ³•æ¥è¡¡é‡ä»£ç æ˜¯å¥½è¿˜æ˜¯ä¸å¥½ã€‚ Bad codeä¸‹é¢çœ‹ä¸€ä¸‹åœ¨ code review ä¸­ï¼Œä¸€æ®µä»£ç æœ‰å“ªäº›ç‰¹ç‚¹ä¼šè¢«è®¤ä¸ºæ˜¯ä¸å¥½çš„ä»£ç ã€‚ Rigid ä»£ç æ˜¯ä¸æ˜¯å¾ˆåƒµç¡¬ï¼Ÿæ˜¯å¦ç”±äºä¸¥æ ¼çš„ç±»å‹å’Œå‚æ•°å¯¼è‡´ä¿®æ”¹ä»£ç çš„æˆæœ¬æé«˜ Fragile ä»£ç æ˜¯ä¸æ˜¯å¾ˆè„†å¼±ï¼Ÿæ˜¯å¦ä¸€ç‚¹å°çš„æ”¹åŠ¨å°±ä¼šé€ æˆå·¨å¤§çš„ç ´åï¼Ÿ Immobile ä»£ç æ˜¯å¦éš¾ä»¥é‡æ„ï¼Ÿ Complex ä»£ç æ˜¯å¦æ˜¯è¿‡åº¦è®¾è®¡ï¼Ÿ Verbose å½“ä½ è¯»è¿™æ®µä»£ç æ—¶ï¼Œèƒ½å¦æ¸…æ¥šçš„çŸ¥é“å®ƒæ˜¯åšä»€ä¹ˆçš„ï¼Ÿ ğŸ‘†è¿™äº›éƒ½ä¸æ˜¯ä»€ä¹ˆå¥½å¬çš„è¯ï¼Œæ²¡æœ‰äººå¸Œæœ›åœ¨åˆ«äºº review è‡ªå·±ä»£ç æ—¶å¬åˆ°è¿™äº›è¯ã€‚ Good designäº†è§£äº†ä»€ä¹ˆæ˜¯ä¸å¥½çš„ä»£ç ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥è¯´â€œæˆ‘ä¸å–œæ¬¢è¿™æ®µä»£ç å› ä¸ºå®ƒä¸æ˜“äºä¿®æ”¹â€æˆ–è€…â€œè¿™æ®µä»£ç å¹¶æ²¡æœ‰æ¸…æ™°çš„å‘Šè¯‰æˆ‘å®ƒè¦åšä»€ä¹ˆâ€ã€‚ä½†è¿™äº›å¹¶æ²¡æœ‰å¸¦æ¥ç§¯æçš„å¼•å¯¼ã€‚ å¦‚æœæˆ‘ä»¬ä¸ä»…ä»…å¯ä»¥æè¿°ä¸å¥½çš„è®¾è®¡ï¼Œè¿˜å¯ä»¥å®¢è§‚çš„æè¿°å¥½çš„è®¾è®¡ï¼Œæ˜¯ä¸æ˜¯æ›´æœ‰åŠ©äºæé«˜å‘¢ã€‚ SOLID2002å¹´ï¼ŒRobert Martin å‡ºç‰ˆäº†ã€Šæ•æ·è½¯ä»¶å¼€å‘:åŸåˆ™ã€æ¨¡å¼ä¸å®è·µã€‹ä¸€ä¹¦ï¼Œåœ¨ä¹¦ä¸­ä»–æè¿°äº†å¯é‡ç”¨è½¯ä»¶è®¾è®¡çš„äº”ä¸ªåŸåˆ™ï¼Œä»–ç§°ä¹‹ä¸º SOLID åŸåˆ™(æ¯ä¸ªåŸåˆ™çš„é¦–å­—æ¯ç»„åˆåœ¨ä¸€èµ·)ã€‚ å•ä¸€è´£ä»»åŸåˆ™ å¼€æ”¾å°é—­åŸåˆ™ é‡Œæ°æ›¿æ¢åŸåˆ™ æ¥å£åˆ†ç¦»åŸåˆ™ ä¾èµ–å€’ç½®åŸåˆ™ è¿™æœ¬ä¹¦æœ‰ç‚¹è¿‡æ—¶äº†ï¼Œä¹¦ä¸­è°ˆè®ºçš„è¯­è¨€éƒ½å·²ç»è¶…è¿‡äº†åå¹´ä¹‹ä¹…ã€‚å°½ç®¡å¦‚æ­¤ï¼Œåœ¨è°ˆè®ºä»€ä¹ˆæ ·çš„ Go ä»£ç æ‰æ˜¯å¥½ä»£ç æ—¶ï¼ŒSOLID çš„åŸåˆ™ä¾ç„¶å¯ä»¥ç»™æˆ‘ä»¬ä¸€äº›å¯å‘ã€‚ Soï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘èŠ±æ—¶é—´æƒ³åœ¨æœ¬æ–‡å’Œå¤§å®¶ä¸€èµ·è®¨è®ºçš„ã€‚ å•ä¸€è´£ä»»åŸåˆ™SOLID åŸåˆ™ä¸­çš„ç¬¬ä¸€ä¸ªåŸåˆ™å°±æ˜¯å•ä¸€è´£ä»»åŸåˆ™ã€‚Robert C Martin è¯´è¿‡ A class should have one, and only one, reason to change(ä¿®æ”¹æŸä¸ªç±»çš„æ—¶å€™ï¼ŒåŸå› æœ‰ä¸”åªæœ‰ä¸€ä¸ª)ï¼Œè¯´ç™½äº†å°±æ˜¯ï¼Œä¸€ä¸ªç±»åªè´Ÿè´£ä¸€é¡¹èŒè´£ã€‚ è™½ç„¶ Go è¯­è¨€ä¸­å¹¶æ²¡æœ‰ç±»çš„æ¦‚å¿µâ€“ä½†æˆ‘ä»¬æœ‰æ›´é¹…å¦¹å­å˜¤çš„ composition (ç»„åˆ)çš„ç‰¹æ€§ã€‚ ä¸ºä»€ä¹ˆä¿®æ”¹ä¸€æ®µä»£ç åªè´Ÿè´£ä¸€é¡¹èŒè´£å¦‚æ­¤é‡è¦å‘¢ï¼Ÿå¦‚æœä¸€ä¸ªç±»æœ‰ä¸¤ä¸ªèŒè´£R1ï¼ŒR2ï¼Œé‚£ä¹ˆä¿®æ”¹R1æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¹Ÿè¦ä¿®æ”¹R2ã€‚ä¿®æ”¹ä»£ç æ˜¯ç—›è‹¦çš„ï¼Œä½†æ›´ç—›è‹¦çš„æ˜¯ä¿®æ”¹ä»£ç çš„åŸå› æ˜¯ç”±äºä¿®æ”¹å…¶ä»–ä»£ç å¼•èµ·çš„ã€‚ æ‰€ä»¥å½“ä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½é¢†åŸŸä¸­çš„ç›¸åº”èŒè´£æ—¶ï¼Œå¯ä»¥ä¿®æ”¹çš„å®ƒçš„åŸå› ä¹Ÿå°±æœ€å¤§é™åº¦çš„å˜å°‘äº†ã€‚ è€¦åˆ &amp; å†…èšè¿™ä¸¤ä¸ªè¯æ˜¯ç”¨æ¥å½¢å®¹ä¸€æ®µä»£ç æ˜¯å¦æ˜“äºä¿®æ”¹çš„ã€‚ è€¦åˆæ˜¯æŒ‡ä¸¤ä¸ªä¸œè¥¿éœ€è¦ä¸€èµ·ä¿®æ”¹â€”å¯¹å…¶ä¸­ä¸€ä¸ªçš„æ”¹åŠ¨ä¼šå½±å“åˆ°å¦ä¸€ä¸ªã€‚ å¦ä¸€ä¸ªç›¸å…³ä½†ç‹¬ç«‹çš„æ¦‚å¿µæ˜¯å†…èšï¼Œä¸€èˆ¬æŒ‡ç›¸äº’å¸å¼•çš„è¿·ä¹‹åŠ›é‡ã€‚ åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸä¸­ï¼Œå†…èšå¸¸å¸¸ç”¨æ¥æè¿°ä¸€æ®µä»£ç å†…å„ä¸ªå…ƒç´ å½¼æ­¤ç»“åˆçš„ç´§å¯†ç¨‹åº¦ã€‚ ä¸‹é¢æˆ‘å‡†å¤‡ä» Go çš„åŒ…æ¨¡å‹å¼€å§‹ï¼ŒèŠèŠ Go å¼€å‘ä¸­çš„è€¦åˆä¸å†…èšã€‚ åŒ…ååœ¨Goä¸­ï¼Œæ‰€æœ‰ä»£ç éƒ½å¿…é¡»æœ‰ä¸€ä¸ªæ‰€å±çš„åŒ…ã€‚ä¸€ä¸ªåŒ…åè¦æè¿°å®ƒçš„ç”¨é€”ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å‘½åç©ºé—´çš„å‰ç¼€ã€‚ä¸‹é¢æ˜¯ Go æ ‡å‡†åº“ä¸­ä¸€äº›å¥½çš„åŒ…åï¼š net/httpï¼Œæä¾› http çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ã€‚ os/execï¼Œå¯ä»¥è¿è¡Œè¿è¡Œå¤–éƒ¨å‘½ä»¤ã€‚ encoding/jsonï¼Œå®ç°äº† JSON æ–‡ä»¶çš„ç¼–ç å’Œè§£ç ã€‚ ä¸å¥½çš„åŒ…åç°åœ¨è®©æˆ‘ä»¬æ¥å–·ä¸€äº›ä¸å¥½çš„åŒ…åã€‚è¿™äº›åŒ…åå¹¶æ²¡æœ‰å¾ˆå¥½çš„å±•ç°å‡ºå®ƒä»¬çš„ç”¨é€”ï¼Œå½“ç„¶äº†å‰ææ˜¯å®ƒä»¬æœ‰-_-|||ã€‚ package server æ˜¯æä¾›ä»€ä¹ˆï¼Ÿã€‚ã€‚ã€‚å¥½å§å°±å½“æ˜¯æä¾›ä¸€ä¸ªæœåŠ¡ç«¯å§ï¼Œä½†æ˜¯æ˜¯ä»€ä¹ˆåè®®å‘¢? package private æ˜¯æä¾›ä»€ä¹ˆï¼Ÿä¸€äº›æˆ‘ä¸åº”è¯¥çœ‹ğŸ‘€çš„ä¸œè¥¿ï¼Ÿ è¿˜æœ‰ package commonï¼Œ package utilsï¼ŒåŒæ ·æ— æ³•æ¸…æ¥šçš„è¡¨è¾¾å®ƒä»¬çš„ç”¨é€”ï¼Œå¼€å‘è€…ä¹Ÿä¸æ˜“ä¿æŒå®ƒä»¬åŠŸèƒ½çš„ä¸“ä¸€æ€§ã€‚ ä¸Šé¢è¿™äº›åŒ…å¾ˆå¿«å°±ä¼šå˜æˆå †æ”¾æ‚ä¸ƒæ‚å…«ä»£ç çš„åƒåœ¾å †ï¼Œè€Œä¸”ä¼šç”±äºåŠŸèƒ½å¤ªæ‚ä¹±è€Œé¢‘ç¹ä¿®æ”¹ã€‚ Go ä¸­çš„ UNIX å“²å­¦åœ¨æˆ‘çœ‹æ¥ï¼Œä»»ä½•å…³äºè§£è€¦è®¾è®¡çš„è®¨è®ºå¦‚æœæ²¡æœ‰æåˆ° Doug McIlroy çš„ UNIX å“²å­¦éƒ½æ˜¯ä¸å®Œæ•´çš„ã€‚UNIX å“²å­¦å°±æ˜¯ä¸»å¼ å°†è‹¥å¹²ç®€æ´ï¼Œæ¸…æ™°çš„æ¨¡å—ç»„åˆèµ·æ¥å®Œæˆå¤æ‚çš„ä»»åŠ¡ï¼Œè€Œä¸”é€šå¸¸æƒ…å†µä¸‹è¿™ä¸ªä»»åŠ¡éƒ½ä¸æ˜¯åŸä½œè€…æ‰€èƒ½é¢„æƒ³åˆ°çš„ã€‚ æˆ‘æƒ³ Go ä¸­çš„åŒ…æ­£ä½“ç°äº† UNIX å“²å­¦çš„ç²¾ç¥ã€‚å› ä¸ºæ¯ä¸€ä¸ªåŒ…éƒ½æ˜¯ä¸€ä¸ªæ‹¥æœ‰å•ä¸€è´£ä»»çš„ç®€æ´çš„ Go ç¨‹åºã€‚ å¼€æ”¾å°é—­åŸåˆ™ç¬¬äºŒä¸ªåŸåˆ™ï¼Œä¹Ÿå°±æ˜¯ SOLID å½“ä¸­çš„ Oï¼Œæ˜¯ç”± Bertrand Meyer æå‡ºçš„å¼€æ”¾å°é—­åŸåˆ™ã€‚1988å¹´ï¼ŒBertrand Mey åœ¨ä»–çš„è‘—ä½œã€Šé¢å‘å¯¹è±¡è½¯ä»¶æ„é€ ã€‹ä¸€ä¹¦ä¸­å†™é“ï¼šSoftware entities should be open for extension,but closed for modificationï¼ˆè½¯ä»¶å®ä½“åº”å½“å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ï¼‰ã€‚ é‚£ä¹ˆè¿™ä¸ªnå¹´å‰çš„å»ºè®®åœ¨ Go è¯­è¨€ä¸­æ˜¯å¦‚ä½•åº”ç”¨çš„å‘¢ï¼Ÿ123456789101112131415161718192021222324252627282930package mainimport ( \"fmt\")type A struct &#123; year int&#125;func (a A) Greet() &#123; fmt.Println(\"Hello GolangUK\", a.year)&#125;type B struct &#123; A&#125;func (b B) Greet() &#123; fmt.Println(\"Welcome to GolangUK\", b.year)&#125;func main()&#123; var a A a.year = 2016 var b B b.year = 2016 a.Greet()//Hello GolangUK 2016 b.Greet()//Welcome to GolangUK 2016&#125; ä¸Šé¢çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æœ‰ç±»å‹Aï¼ŒåŒ…å«å±æ€§ year å’Œä¸€ä¸ªæ–¹æ³• Greetã€‚æˆ‘ä»¬è¿˜æœ‰ç±»å‹Bï¼ŒBä¸­åµŒå…¥(embedding)äº†ç±»å‹Aï¼Œå¹¶ä¸”Bæä¾›äº†ä»–è‡ªå·±çš„ Greet æ–¹æ³•ï¼Œè¦†ç›–äº†Açš„ã€‚ åµŒå…¥ä¸ä»…ä»…æ˜¯é’ˆå¯¹æ–¹æ³•ï¼Œè¿˜å¯ä»¥é€šè¿‡åµŒå…¥ä½¿ç”¨è¢«åµŒå…¥ç±»å‹çš„å±æ€§ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå› ä¸ºAå’ŒBå®šä¹‰åœ¨åŒä¸€ä¸ªåŒ…ä¸­ï¼Œæ‰€ä»¥Bå¯ä»¥åƒä½¿ç”¨è‡ªå·±å®šä¹‰çš„å±æ€§ä¸€æ ·ä½¿ç”¨Aä¸­çš„ private çš„å±æ€§ yearã€‚ æ‰€ä»¥ï¼ŒåµŒå…¥æ˜¯å®ç° Go ç±»å‹å¯¹æ‰©å±•å¼€æ”¾éå¸¸é¹…å¦¹å­å˜¤çš„æ‰‹æ®µã€‚ 12345678910111213141516171819202122232425262728293031package mainimport ( \"fmt\")type Cat struct&#123; Name string&#125;func (c Cat) Legs() int &#123; return 4&#125;func (c Cat) PrintLegs() &#123; fmt.Printf(\"I have %d legs\\n\", c.Legs())&#125;type OctoCat struct &#123; Cat&#125;func (c OctoCat) Legs() int &#123; return 5&#125;func main() &#123; var octo OctoCat fmt.Printf(\"I have %d legs\\n\", octo.Legs())// I have 5 legs octo.PrintLegs()// I have 4 legs&#125; åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª Cat ç±»å‹ï¼Œå®ƒæ‹¥æœ‰ä¸€ä¸ª Legs æ–¹æ³•å¯ä»¥è·å¾—è…¿çš„æ•°ç›®ã€‚æˆ‘ä»¬å°† Cat ç±»å‹åµŒå…¥åˆ°ä¸€ä¸ªæ–°ç±»å‹ OctoCat ä¸­ï¼Œç„¶åå£°æ˜ Octocat æœ‰5æ¡è…¿ã€‚ç„¶è€Œï¼Œå°½ç®¡ OctoCat å®šä¹‰äº†å®ƒè‡ªå·±çš„ Legs æ–¹æ³•è¿”å›5ï¼Œåœ¨è°ƒç”¨ PrintLegs æ–¹æ³•æ—¶ä¾æ—§ä¼šæ‰“å°â€œI have 4 legsâ€ã€‚ è¿™æ˜¯å› ä¸º PrintLegs æ–¹æ³•æ˜¯å®šä¹‰åœ¨ Cat ç±»å‹ä¸­çš„ï¼Œå®ƒå°† Cat ä½œä¸ºæ¥æ”¶è€…ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨ Cat ç±»å‹çš„ Legs æ–¹æ³•ã€‚Cat ç±»å‹å¹¶ä¸ä¼šæ„ŸçŸ¥åˆ°å®ƒè¢«åµŒå…¥åˆ°å…¶ä»–ç±»å‹ä¸­ï¼Œæ‰€ä»¥å®ƒçš„æ–¹æ³•ä¹Ÿä¸ä¼šè¢«æ›´æ”¹ã€‚ æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥è¯´ Go çš„ç±»å‹æ˜¯å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­çš„ã€‚ å®é™…ä¸Šï¼ŒGo ç±»å‹ä¸­çš„æ–¹æ³•æ¯”æ™®é€šå‡½æ•°å¤šäº†ä¸€ç‚¹è¯­æ³•ç³–â€”-å°†æ¥æ”¶è€…ä½œä¸ºä¸€ä¸ªé¢„å…ˆå£°æ˜çš„å½¢å‚ã€‚(è¯‘è€…æ³¨ï¼šè¿™å—ç†è§£äº†å¥½ä¹…ğŸ˜–ã€‚ã€‚ã€‚ï¼Œä¸æ‡‚å¾—å¯ä»¥çœ‹è¿™ç¯‡å‚è€ƒæ–‡æ¡£)1234567func (c Cat) PrintLegs() &#123; fmt.Printf(\"I have %d legs\\n\", c.Legs())&#125;func PrintLegs(c Cat) &#123; fmt.Printf(\"I have %d legs\\n\", c.Legs())&#125; ç”±äº Go å¹¶ä¸æ”¯æŒå‡½æ•°é‡è½½ï¼Œæ‰€ä»¥ OctoCat ç±»å‹å¹¶ä¸èƒ½æ›¿ä»£ Cat ç±»å‹ã€‚è¿™ä¹Ÿå°†å¼•å‡ºä¸‹ä¸€ä¸ªåŸåˆ™â€”é‡Œæ°æ›¿æ¢åŸåˆ™ã€‚ ä¸”å¬ä¸‹å›åˆ†è§£ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”åˆ«çœ‹æˆ‘ï¼Œæˆ‘åªæ˜¯ä¸ªå‚²å¨‡çš„åˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç»ˆäºå®Œæˆäº†ä¸Šçš„éƒ¨åˆ†â†–(^Ï‰^)â†—ï¼Œå°½é‡åœ¨ä¸‹å‘¨å®Œæˆä¸‹ã€‚ç”±äºå¹¶ä¸äº†è§£ Go éš¾å…ä¼šæœ‰é”™è¯¯æˆ–ç¿»è¯‘ç”Ÿç¡¬çš„åœ°æ–¹ï¼Œæ¬¢è¿æŒ‡æ­£é”™è¯¯ï¼Œæ¬¢è¿ä¸€èµ·è®¨è®º~(â‰§â–½â‰¦)/~ã€‚ éƒ½çœ‹åˆ°è¿™äº†ï¼Œå…³æ³¨ä¸ªå…¬ä¼—å·å†èµ°å§ğŸ™ˆ","raw":null,"content":null,"categories":[{"name":"go","slug":"go","permalink":"http://yemengying.com/categories/go/"}],"tags":[{"name":"ç¿»è¯‘","slug":"ç¿»è¯‘","permalink":"http://yemengying.com/tags/ç¿»è¯‘/"},{"name":"go","slug":"go","permalink":"http://yemengying.com/tags/go/"}]},{"title":"å¦‚ä½•å¿«é€Ÿæ‹¥æœ‰äº§å“çš„sense","slug":"how-to-get-pm-sense","date":"2016-08-23T08:32:31.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/08/23/how-to-get-pm-sense/","link":"","permalink":"http://yemengying.com/2016/08/23/how-to-get-pm-sense/","excerpt":"è¶ç€åœ¨å®¶è‘›ä¼˜èººçš„å‡ å¤©ï¼ŒåŸ¹å…»åŸ¹å…»è‡ªå·±åœ¨äº§å“æ–¹é¢çš„æŠ€èƒ½ï¼Œç»è¿‡axure,sketch,xmindçš„é‡é‡ç£¨ç‚¼ï¼Œæ€»ç»“å‡ºæ¥è¿™ç¯‡æ–‡ç« ï¼Œä»ä¸‰ä¸ªæ–¹é¢è®²è®²å¦‚ä½•æ‰èƒ½åœ¨çŸ­æ—¶é—´å†…å¿«é€Ÿæ‹¥æœ‰äº§å“çš„senseï¼Œç”»å‡ºé«˜ä¿çœŸçš„åŸå‹ã€‚","keywords":null,"text":"è¶ç€åœ¨å®¶è‘›ä¼˜èººçš„å‡ å¤©ï¼ŒåŸ¹å…»åŸ¹å…»è‡ªå·±åœ¨äº§å“æ–¹é¢çš„æŠ€èƒ½ï¼Œç»è¿‡axure,sketch,xmindçš„é‡é‡ç£¨ç‚¼ï¼Œæ€»ç»“å‡ºæ¥è¿™ç¯‡æ–‡ç« ï¼Œä»ä¸‰ä¸ªæ–¹é¢è®²è®²å¦‚ä½•æ‰èƒ½åœ¨çŸ­æ—¶é—´å†…å¿«é€Ÿæ‹¥æœ‰äº§å“çš„senseï¼Œç”»å‡ºé«˜ä¿çœŸçš„åŸå‹ã€‚ ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚","raw":null,"content":null,"categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/categories/éšç¬”/"}],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/tags/éšç¬”/"}]},{"title":"ã€Springã€‘Xmlè§£æç›¸å…³","slug":"spring-xml","date":"2016-07-25T14:37:18.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/07/25/spring-xml/","link":"","permalink":"http://yemengying.com/2016/07/25/spring-xml/","excerpt":"å…ˆè¯·çœ‹ä¸‹å·¦ä¸Šè§’ï¼Œhiahiaï¼Œæ–°logoï¼Œsiä¸siå¾ˆæ¼‚é…¿ï¼Œæœ‰ä¸ªä¼šè®¾è®¡çš„è¡¨å“¥å°±æ˜¯å¥½ï¼Œåˆå¥½åˆå¿«ï¼Œè¿˜ä¸ç”¨é’±ã€‚","keywords":null,"text":"å…ˆè¯·çœ‹ä¸‹å·¦ä¸Šè§’ï¼Œhiahiaï¼Œæ–°logoï¼Œsiä¸siå¾ˆæ¼‚é…¿ï¼Œæœ‰ä¸ªä¼šè®¾è®¡çš„è¡¨å“¥å°±æ˜¯å¥½ï¼Œåˆå¥½åˆå¿«ï¼Œè¿˜ä¸ç”¨é’±ã€‚ æ€»ç»“ä¸‹æœ€è¿‘çœ‹çš„ Spring Xml è§£æç›¸å…³çš„ä¸€ç‚¹ç‚¹ä¸œä¸œï¼Œè¿˜æ²¡æœ‰çœ‹å®Œã€‚ã€‚ã€‚ã€‚ å‚è€ƒæ–‡æ¡£Spring èµ„æºè®¿é—®å‰–æå’Œç­–ç•¥æ¨¡å¼åº”ç”¨ é¢˜å¤–è¯å…ˆè¯´ä¸ªåœ¨çœ‹æºç æ—¶ï¼Œå‘ç°çš„ä¸€ä¸ªä»¥å‰æ²¡æœ‰å…³æ³¨è¿‡çš„ç‚¹ã€‚å¤§ç¥ä»¬åœ¨åˆ›å»ºé›†åˆçš„æ—¶å€™ï¼Œå¤§å¤šæ•°éƒ½è®¾ç½®äº†ä¸€ä¸ªé¢„ä¼°çš„åˆå§‹å®¹é‡(2çš„å¹‚æ•°)ï¼Œè€Œä¸æ˜¯ç›´æ¥é‡‡ç”¨é»˜è®¤çš„åˆå§‹å®¹é‡( HashMap ä¸­æ˜¯16)ï¼Œå°±åƒä¸‹é¢è¿™æ ·:1234567891011121314151617/** Map from dependency type to corresponding autowired value */private final Map&lt;Class&lt;?&gt;, Object&gt; resolvableDependencies = new ConcurrentHashMap&lt;Class&lt;?&gt;, Object&gt;(16);/** Map of bean definition objects, keyed by bean name */private final Map&lt;String, BeanDefinition&gt; beanDefinitionMap = new ConcurrentHashMap&lt;String, BeanDefinition&gt;(256);/** Map of singleton and non-singleton bean names, keyed by dependency type */private final Map&lt;Class&lt;?&gt;, String[]&gt; allBeanNamesByType = new ConcurrentHashMap&lt;Class&lt;?&gt;, String[]&gt;(64);/** Map of singleton-only bean names, keyed by dependency type */private final Map&lt;Class&lt;?&gt;, String[]&gt; singletonBeanNamesByType = new ConcurrentHashMap&lt;Class&lt;?&gt;, String[]&gt;(64);/** List of bean definition names, in registration order */private volatile List&lt;String&gt; beanDefinitionNames = new ArrayList&lt;String&gt;(256);/** List of names of manually registered singletons, in registration order */private volatile Set&lt;String&gt; manualSingletonNames = new LinkedHashSet&lt;String&gt;(16); å¤§ç¥ä»¬è¿™æ ·å†™è‚¯å®šæ˜¯æœ‰å¥½å¤„çš„ã€‚ä¸å¤ªäº†è§£å…¶å®ƒé›†åˆç±»çš„å®ç°ï¼Œå°±ä»¥ HashMap ä¸ºä¾‹çœ‹ä¸€ä¸‹ã€‚HashMap åº•å±‚çš„å­˜å‚¨ç»“æ„æ˜¯ä¸€ä¸ª Entry å¯¹è±¡çš„æ•°ç»„(Java 8ä¸­æ˜¯ Node å¯¹è±¡çš„æ•°ç»„)ï¼Œé»˜è®¤åˆå§‹å®¹é‡æ˜¯16ï¼Œè´Ÿè½½å› å­æ˜¯0.75ã€‚ä¹Ÿå°±æ˜¯è¯´å½“å…ƒç´ ä¸ªæ•°è¶…è¿‡16*0.75=12æ—¶ï¼Œå°±è¦è¿›è¡Œæ‰©å®¹ï¼Œå°†æ•°ç»„å¤§å°æ‰©å¤§ä¸€å€ï¼Œå¹¶è®¡ç®—å…ƒç´ åœ¨æ–°æ•°ç»„ä¸­çš„ä½ç½®ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯æ¯”è¾ƒè€—è´¹æ€§èƒ½çš„ã€‚æ‰€ä»¥ï¼Œä¸ªäººè§‰å¾—å¤§ç¥ä»¬è¿™æ ·å†™æ˜¯å› ä¸ºå¦‚æœç›´æ¥é‡‡ç”¨é»˜è®¤çš„åˆå§‹å®¹é‡ï¼Œé‚£ä¹ˆåœ¨å…ƒç´ ä¸ªæ•°è¾ƒå°‘æ—¶ï¼Œä¼šæµªè´¹ç©ºé—´ï¼›å…ƒç´ ä¸ªæ•°è¾ƒå¤šæ—¶ï¼Œåˆä¼šé€ æˆé¢‘ç¹çš„æ‰©å®¹ï¼Œè€—è´¹æ€§èƒ½ã€‚ æƒ³èµ·ä¸Šæ¬¡çš„éœ€æ±‚ï¼Œæ˜æ˜ç¡®å®šä¸€å®šä»¥åŠè‚¯å®šè¯„åˆ†åªæœ‰5ä¸ªï¼Œè¿˜æ˜¯newäº†ä¸ªé»˜è®¤å®¹é‡(16)çš„mapã€‚ ç›¸å…³æ¥å£å…ˆç†ä¸€ç†åŠ è½½xmlé…ç½®æ–‡ä»¶çš„ç›¸å…³æ¥å£1.Resourceï¼šé‡‡ç”¨äº†ç­–ç•¥æ¨¡å¼ï¼Œæ˜¯ Spring èµ„æºè®¿é—®ç­–ç•¥çš„æŠ½è±¡ï¼Œè¯¥æ¥å£æœ‰å¤šç§å®ç°ç±»ï¼Œæ¯ä¸ªå®ç°ç±»ä»£è¡¨ä¸€ç§èµ„æºè®¿é—®ç­–ç•¥ï¼Œè´Ÿè´£å…·ä½“çš„èµ„æºè®¿é—®ã€‚2.ResourceLoaderï¼šè¯¥æ¥å£çš„å®ç°ç±»å¯ä»¥è·å¾—ä¸€ä¸ª Resource çš„å®ä¾‹ã€‚3.BeanDefinitionReaderï¼š æ ¹æ®æŒ‡å®šçš„ Resource åŠ è½½bean definition. æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ æœ¬æ¥æ˜¯æƒ³å¤šæ•´ç†ä¸€ç‚¹çš„ï¼Œä½†æ˜¯ã€‚ã€‚ã€‚å¬è¯´æ–°ä¸€æœŸRMä¸»è§’æ˜¯wuliå…‰æ´™ï¼Œè¿™è¿˜èƒ½å¿ï¼Œæ»šå»çœ‹RMäº†ã€‚ã€‚ã€‚ã€‚","raw":null,"content":null,"categories":[{"name":"spring","slug":"spring","permalink":"http://yemengying.com/categories/spring/"}],"tags":[{"name":"spring","slug":"spring","permalink":"http://yemengying.com/tags/spring/"}]},{"title":"ã€Springã€‘Beançš„ç”Ÿå‘½å‘¨æœŸ","slug":"spring-bean-life-cycle","date":"2016-07-14T13:35:53.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/07/14/spring-bean-life-cycle/","link":"","permalink":"http://yemengying.com/2016/07/14/spring-bean-life-cycle/","excerpt":"æ™ºå•†æ‰é¸¡ğŸ”ï¼Œå®åœ¨æ²¡åŠæ³•ä¸€ä¸‹å­ç†è§£Spring IoCå’ŒAOPçš„å®ç°åŸç†ï¼Œçœ‹çš„é—¹å¿ƒä¹Ÿä¸å¤ªæ‡‚ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚å†³å®šæ‹†æˆå°çš„ä¸èƒ½åœ¨å°çš„ä¸€ä¸ªä¸ªé—®é¢˜ï¼Œä¸€ç‚¹ç‚¹å•ƒã€‚ä»Šå¤©å…ˆæ¥çœ‹çœ‹Springä¸­Beançš„ç”Ÿå‘½å‘¨æœŸã€‚","keywords":null,"text":"æ™ºå•†æ‰é¸¡ğŸ”ï¼Œå®åœ¨æ²¡åŠæ³•ä¸€ä¸‹å­ç†è§£Spring IoCå’ŒAOPçš„å®ç°åŸç†ï¼Œçœ‹çš„é—¹å¿ƒä¹Ÿä¸å¤ªæ‡‚ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚å†³å®šæ‹†æˆå°çš„ä¸èƒ½åœ¨å°çš„ä¸€ä¸ªä¸ªé—®é¢˜ï¼Œä¸€ç‚¹ç‚¹å•ƒã€‚ä»Šå¤©å…ˆæ¥çœ‹çœ‹Springä¸­Beançš„ç”Ÿå‘½å‘¨æœŸã€‚ Spring Beanæ˜¯Springåº”ç”¨ä¸­æœ€æœ€é‡è¦çš„éƒ¨åˆ†äº†ã€‚æ‰€ä»¥æ¥çœ‹çœ‹Springå®¹å™¨åœ¨åˆå§‹åŒ–ä¸€ä¸ªbeançš„æ—¶å€™ä¼šåšé‚£äº›äº‹æƒ…ï¼Œé¡ºåºæ˜¯æ€æ ·çš„ï¼Œåœ¨å®¹å™¨å…³é—­çš„æ—¶å€™ï¼Œåˆä¼šåšå“ªäº›äº‹æƒ…ã€‚ ç¤ºä¾‹ä»£ç gitåœ°å€ï¼š loadStyle(\"/hexo-github/style.css\"); loadStyle(\"/hexo-github/octicons/octicons.css\"); new Badge(\"#badge-container-giraffe0813-giraffeInSpring-giraffeInSpring\", \"giraffe0813\", \"giraffeInSpring\", \"giraffeInSpring\", false); springç‰ˆæœ¬ï¼š4.2.3.RELEASEé‰´äºSpringæºç æ˜¯ç”¨gradleæ„å»ºçš„ï¼Œæˆ‘ä¹Ÿå†³å®šèˆå¼ƒæˆ‘å¤§mavenï¼Œå°è¯•ä¸‹æ´ªèŠæ¨èè¿‡çš„gradleã€‚è¿è¡ŒbeanLifeCycleæ¨¡å—ä¸‹çš„junit testå³å¯åœ¨æ§åˆ¶å°çœ‹åˆ°å¦‚ä¸‹è¾“å‡ºï¼Œå¯ä»¥æ¸…æ¥šäº†è§£Springå®¹å™¨åœ¨åˆ›å»ºï¼Œåˆå§‹åŒ–å’Œé”€æ¯Beançš„æ—¶å€™ä¾æ¬¡åšäº†é‚£äº›äº‹æƒ…ã€‚ 12345678910111213141516171819202122232425Springå®¹å™¨åˆå§‹åŒ–=====================================è°ƒç”¨GiraffeServiceæ— å‚æ„é€ å‡½æ•°GiraffeServiceä¸­åˆ©ç”¨setæ–¹æ³•è®¾ç½®å±æ€§å€¼è°ƒç”¨setBeanName:: Bean Name defined in context=giraffeServiceè°ƒç”¨setBeanClassLoader,ClassLoader Name = sun.misc.Launcher$AppClassLoaderè°ƒç”¨setBeanFactory,setBeanFactory:: giraffe bean singleton=trueè°ƒç”¨setEnvironmentè°ƒç”¨setResourceLoader:: Resource File Name=spring-beans.xmlè°ƒç”¨setApplicationEventPublisherè°ƒç”¨setApplicationContext:: Bean Definition Names=[giraffeService, org.springframework.context.annotation.CommonAnnotationBeanPostProcessor#0, com.giraffe.spring.service.GiraffeServicePostProcessor#0]æ‰§è¡ŒBeanPostProcessorçš„postProcessBeforeInitializationæ–¹æ³•,beanName=giraffeServiceè°ƒç”¨PostConstructæ³¨è§£æ ‡æ³¨çš„æ–¹æ³•æ‰§è¡ŒInitializingBeanæ¥å£çš„afterPropertiesSetæ–¹æ³•æ‰§è¡Œé…ç½®çš„init-methodæ‰§è¡ŒBeanPostProcessorçš„postProcessAfterInitializationæ–¹æ³•,beanName=giraffeServiceSpringå®¹å™¨åˆå§‹åŒ–å®Œæ¯•=====================================ä»å®¹å™¨ä¸­è·å–Beangiraffe Name=æå…‰æ´™=====================================è°ƒç”¨preDestroyæ³¨è§£æ ‡æ³¨çš„æ–¹æ³•æ‰§è¡ŒDisposableBeanæ¥å£çš„destroyæ–¹æ³•æ‰§è¡Œé…ç½®çš„destroy-methodSpringå®¹å™¨å…³é—­ å‚è€ƒæ–‡æ¡£life cycle management of a spring beanSpring Bean Life Cycle Spring Beançš„ç”Ÿå‘½å‘¨æœŸå…ˆæ¥çœ‹çœ‹ï¼ŒSpringåœ¨Beanä»åˆ›å»ºåˆ°é”€æ¯çš„ç”Ÿå‘½å‘¨æœŸä¸­å¯èƒ½åšå¾—äº‹æƒ…ã€‚ initialization å’Œ destroyæœ‰æ—¶æˆ‘ä»¬éœ€è¦åœ¨Beanå±æ€§å€¼setå¥½ä¹‹åå’ŒBeané”€æ¯ä¹‹å‰åšä¸€äº›äº‹æƒ…ï¼Œæ¯”å¦‚æ£€æŸ¥Beanä¸­æŸä¸ªå±æ€§æ˜¯å¦è¢«æ­£å¸¸çš„è®¾ç½®å¥½å€¼äº†ã€‚Springæ¡†æ¶æä¾›äº†å¤šç§æ–¹æ³•è®©æˆ‘ä»¬å¯ä»¥åœ¨Spring Beançš„ç”Ÿå‘½å‘¨æœŸä¸­æ‰§è¡Œinitializationå’Œpre-destroyæ–¹æ³•ã€‚ 1.å®ç°InitializingBeanå’ŒDisposableBeanæ¥å£ è¿™ä¸¤ä¸ªæ¥å£éƒ½åªåŒ…å«ä¸€ä¸ªæ–¹æ³•ã€‚é€šè¿‡å®ç°InitializingBeanæ¥å£çš„afterPropertiesSet()æ–¹æ³•å¯ä»¥åœ¨Beanå±æ€§å€¼è®¾ç½®å¥½ä¹‹ååšä¸€äº›æ“ä½œï¼Œå®ç°DisposableBeanæ¥å£çš„destroy()æ–¹æ³•å¯ä»¥åœ¨é”€æ¯Beanä¹‹å‰åšä¸€äº›æ“ä½œã€‚ ğŸŒ°å¦‚ä¸‹ï¼š123456789101112public class GiraffeService implements InitializingBean,DisposableBean &#123; @Override public void afterPropertiesSet() throws Exception &#123; System.out.println(\"æ‰§è¡ŒInitializingBeanæ¥å£çš„afterPropertiesSetæ–¹æ³•\"); &#125; @Override public void destroy() throws Exception &#123; System.out.println(\"æ‰§è¡ŒDisposableBeanæ¥å£çš„destroyæ–¹æ³•\"); &#125;&#125; è¿™ç§æ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯ä¸å»ºè®®ä½¿ç”¨ã€‚å› ä¸ºè¿™æ ·ä¼šå°†Beançš„å®ç°å’ŒSpringæ¡†æ¶è€¦åˆåœ¨ä¸€èµ·ã€‚ 2.åœ¨beançš„é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šinit-methodå’Œdestroy-methodæ–¹æ³• Springå…è®¸æˆ‘ä»¬åˆ›å»ºè‡ªå·±çš„initæ–¹æ³•å’Œdestroyæ–¹æ³•ï¼Œåªè¦åœ¨Beançš„é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šinit-methodå’Œdestroy-methodçš„å€¼å°±å¯ä»¥åœ¨Beanåˆå§‹åŒ–æ—¶å’Œé”€æ¯ä¹‹å‰æ‰§è¡Œä¸€äº›æ“ä½œã€‚ğŸŒ°å¦‚ä¸‹ï¼š123456789101112public class GiraffeService &#123; //é€šè¿‡&lt;bean&gt;çš„destroy-methodå±æ€§æŒ‡å®šçš„é”€æ¯æ–¹æ³• public void destroyMethod() throws Exception &#123; System.out.println(\"æ‰§è¡Œé…ç½®çš„destroy-method\"); &#125; //é€šè¿‡&lt;bean&gt;çš„init-methodå±æ€§æŒ‡å®šçš„åˆå§‹åŒ–æ–¹æ³• public void initMethod() throws Exception &#123; System.out.println(\"æ‰§è¡Œé…ç½®çš„init-method\"); &#125;&#125; é…ç½®æ–‡ä»¶ä¸­çš„é…ç½®ï¼š 12&lt;bean name=\"giraffeService\" class=\"com.giraffe.spring.service.GiraffeService\" init-method=\"initMethod\" destroy-method=\"destroyMethod\"&gt;&lt;/bean&gt; éœ€è¦æ³¨æ„çš„æ˜¯è‡ªå®šä¹‰çš„init-methodå’Œpost-methodæ–¹æ³•å¯ä»¥æŠ›å¼‚å¸¸ä½†æ˜¯ä¸èƒ½æœ‰å‚æ•°ã€‚è¿™ç§æ–¹å¼æ¯”è¾ƒæ¨èï¼Œå› ä¸ºå¯ä»¥è‡ªå·±åˆ›å»ºæ–¹æ³•ï¼Œæ— éœ€å°†Beançš„å®ç°ç›´æ¥ä¾èµ–äºspringçš„æ¡†æ¶ã€‚ 3.ä½¿ç”¨@PostConstructå’Œ@PreDestroyæ³¨è§£ é™¤äº†xmlé…ç½®çš„æ–¹å¼ï¼ŒSpringä¹Ÿæ”¯æŒç”¨@PostConstructå’Œ @PreDestroyæ³¨è§£æ¥æŒ‡å®šinitå’Œdestroyæ–¹æ³•ã€‚è¿™ä¸¤ä¸ªæ³¨è§£å‡åœ¨javax.annotationåŒ…ä¸­ã€‚ä¸ºäº†æ³¨è§£å¯ä»¥ç”Ÿæ•ˆï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰org.springframework.context.annotation.CommonAnnotationBeanPostProcessoræˆ–context:annotation-configğŸŒ°å¦‚ä¸‹ï¼š123456789101112public class GiraffeService &#123; @PostConstruct public void initPostConstruct()&#123; System.out.println(\"æ‰§è¡ŒPostConstructæ³¨è§£æ ‡æ³¨çš„æ–¹æ³•\"); &#125; @PreDestroy public void preDestroy()&#123; System.out.println(\"æ‰§è¡ŒpreDestroyæ³¨è§£æ ‡æ³¨çš„æ–¹æ³•\"); &#125;&#125; é…ç½®æ–‡ä»¶:1&lt;bean class=\"org.springframework.context.annotation.CommonAnnotationBeanPostProcessor\" /&gt; å®ç°*Awareæ¥å£ åœ¨Beanä¸­ä½¿ç”¨Springæ¡†æ¶çš„ä¸€äº›å¯¹è±¡æœ‰äº›æ—¶å€™æˆ‘ä»¬éœ€è¦åœ¨Beançš„åˆå§‹åŒ–ä¸­ä½¿ç”¨Springæ¡†æ¶è‡ªèº«çš„ä¸€äº›å¯¹è±¡æ¥æ‰§è¡Œä¸€äº›æ“ä½œï¼Œæ¯”å¦‚è·å–ServletContextçš„ä¸€äº›å‚æ•°ï¼Œè·å–ApplicaitionContextä¸­çš„BeanDefinitionçš„åå­—ï¼Œè·å–Beanåœ¨å®¹å™¨ä¸­çš„åå­—ç­‰ç­‰ã€‚ä¸ºäº†è®©Beanå¯ä»¥è·å–åˆ°æ¡†æ¶è‡ªèº«çš„ä¸€äº›å¯¹è±¡ï¼ŒSpringæä¾›äº†ä¸€ç»„åä¸º*Awareçš„æ¥å£ã€‚è¿™äº›æ¥å£å‡ç»§æ‰¿äºorg.springframework.beans.factory.Awareæ ‡è®°æ¥å£ï¼Œå¹¶æä¾›ä¸€ä¸ªå°†ç”±Beanå®ç°çš„set*æ–¹æ³•,Springé€šè¿‡åŸºäºsetterçš„ä¾èµ–æ³¨å…¥æ–¹å¼ä½¿ç›¸åº”çš„å¯¹è±¡å¯ä»¥è¢«Beanä½¿ç”¨ã€‚ç½‘ä¸Šè¯´ï¼Œè¿™äº›æ¥å£æ˜¯åˆ©ç”¨è§‚å¯Ÿè€…æ¨¡å¼å®ç°çš„ï¼Œç±»ä¼¼äºservlet listenersï¼Œç›®å‰è¿˜ä¸æ˜ç™½ï¼Œä¸è¿‡è¿™ä¹Ÿä¸åœ¨æœ¬æ–‡çš„è®¨è®ºèŒƒå›´å†…ã€‚ä»‹ç»ä¸€äº›é‡è¦çš„Awareæ¥å£ï¼š ApplicationContextAware: è·å¾—ApplicationContextå¯¹è±¡,å¯ä»¥ç”¨æ¥è·å–æ‰€æœ‰Bean definitionçš„åå­—ã€‚ BeanFactoryAware:è·å¾—BeanFactoryå¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥æ£€æµ‹Beançš„ä½œç”¨åŸŸã€‚ BeanNameAware:è·å¾—Beanåœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰çš„åå­—ã€‚ ResourceLoaderAware:è·å¾—ResourceLoaderå¯¹è±¡ï¼Œå¯ä»¥è·å¾—classpathä¸­æŸä¸ªæ–‡ä»¶ã€‚ ServletContextAware:åœ¨ä¸€ä¸ªMVCåº”ç”¨ä¸­å¯ä»¥è·å–ServletContextå¯¹è±¡ï¼Œå¯ä»¥è¯»å–contextä¸­çš„å‚æ•°ã€‚ ServletConfigAwareåœ¨ä¸€ä¸ªMVCåº”ç”¨ä¸­å¯ä»¥è·å–ServletConfigå¯¹è±¡ï¼Œå¯ä»¥è¯»å–configä¸­çš„å‚æ•°ã€‚ ğŸŒ°å¦‚ä¸‹:1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950public class GiraffeService implements ApplicationContextAware, ApplicationEventPublisherAware, BeanClassLoaderAware, BeanFactoryAware, BeanNameAware, EnvironmentAware, ImportAware, ResourceLoaderAware&#123; @Override public void setBeanClassLoader(ClassLoader classLoader) &#123; System.out.println(\"æ‰§è¡ŒsetBeanClassLoader,ClassLoader Name = \" + classLoader.getClass().getName()); &#125; @Override public void setBeanFactory(BeanFactory beanFactory) throws BeansException &#123; System.out.println(\"æ‰§è¡ŒsetBeanFactory,setBeanFactory:: giraffe bean singleton=\" + beanFactory.isSingleton(\"giraffeService\")); &#125; @Override public void setBeanName(String s) &#123; System.out.println(\"æ‰§è¡ŒsetBeanName:: Bean Name defined in context=\" + s); &#125; @Override public void setApplicationContext(ApplicationContext applicationContext) throws BeansException &#123; System.out.println(\"æ‰§è¡ŒsetApplicationContext:: Bean Definition Names=\" + Arrays.toString(applicationContext.getBeanDefinitionNames())); &#125; @Override public void setApplicationEventPublisher(ApplicationEventPublisher applicationEventPublisher) &#123; System.out.println(\"æ‰§è¡ŒsetApplicationEventPublisher\"); &#125; @Override public void setEnvironment(Environment environment) &#123; System.out.println(\"æ‰§è¡ŒsetEnvironment\"); &#125; @Override public void setResourceLoader(ResourceLoader resourceLoader) &#123; Resource resource = resourceLoader.getResource(\"classpath:spring-beans.xml\"); System.out.println(\"æ‰§è¡ŒsetResourceLoader:: Resource File Name=\" + resource.getFilename()); &#125; @Override public void setImportMetadata(AnnotationMetadata annotationMetadata) &#123; System.out.println(\"æ‰§è¡ŒsetImportMetadata\"); &#125;&#125; BeanPostProcessorä¸Šé¢çš„*Awareæ¥å£æ˜¯é’ˆå¯¹æŸä¸ªå®ç°è¿™äº›æ¥å£çš„Beanå®šåˆ¶åˆå§‹åŒ–çš„è¿‡ç¨‹ï¼ŒSpringåŒæ ·å¯ä»¥é’ˆå¯¹å®¹å™¨ä¸­çš„æ‰€æœ‰Beanï¼Œæˆ–è€…æŸäº›Beanå®šåˆ¶åˆå§‹åŒ–è¿‡ç¨‹ï¼Œåªéœ€æä¾›ä¸€ä¸ªå®ç°BeanPostProcessoræ¥å£çš„ç±»å³å¯ã€‚ è¯¥æ¥å£ä¸­åŒ…å«ä¸¤ä¸ªæ–¹æ³•ï¼ŒpostProcessBeforeInitializationå’ŒpostProcessAfterInitializationã€‚ postProcessBeforeInitializationæ–¹æ³•ä¼šåœ¨å®¹å™¨ä¸­çš„Beanåˆå§‹åŒ–ä¹‹å‰æ‰§è¡Œï¼Œ postProcessAfterInitializationæ–¹æ³•åœ¨å®¹å™¨ä¸­çš„Beanåˆå§‹åŒ–ä¹‹åæ‰§è¡Œã€‚ğŸŒ°å¦‚ä¸‹ï¼š12345678910111213141516public class CustomerBeanPostProcessor implements BeanPostProcessor &#123; @Override public Object postProcessBeforeInitialization(Object bean, String beanName) throws BeansException &#123; System.out.println(\"æ‰§è¡ŒBeanPostProcessorçš„postProcessBeforeInitializationæ–¹æ³•,beanName=\" + beanName); return bean; &#125; @Override public Object postProcessAfterInitialization(Object bean, String beanName) throws BeansException &#123; System.out.println(\"æ‰§è¡ŒBeanPostProcessorçš„postProcessAfterInitializationæ–¹æ³•,beanName=\" + beanName); return bean; &#125;&#125; è¦å°†BeanPostProcessorçš„Beanåƒå…¶ä»–Beanä¸€æ ·å®šä¹‰åœ¨é…ç½®æ–‡ä»¶ä¸­1&lt;bean class=\"com.giraffe.spring.service.CustomerBeanPostProcessor\"/&gt; æ€»ç»“æ‰€ä»¥ã€‚ã€‚ã€‚ç»“åˆç¬¬ä¸€èŠ‚æ§åˆ¶å°è¾“å‡ºçš„å†…å®¹ï¼ŒSpring Beançš„ç”Ÿå‘½å‘¨æœŸæ˜¯è¿™æ ·çº¸çš„ï¼š Beanå®¹å™¨æ‰¾åˆ°é…ç½®æ–‡ä»¶ä¸­Spring Beançš„å®šä¹‰ã€‚ Beanå®¹å™¨åˆ©ç”¨Java Reflection APIåˆ›å»ºä¸€ä¸ªBeançš„å®ä¾‹ã€‚ å¦‚æœæ¶‰åŠåˆ°ä¸€äº›å±æ€§å€¼ åˆ©ç”¨setæ–¹æ³•è®¾ç½®ä¸€äº›å±æ€§å€¼ã€‚ å¦‚æœBeanå®ç°äº†BeanNameAwareæ¥å£ï¼Œè°ƒç”¨setBeanName()æ–¹æ³•ï¼Œä¼ å…¥Beançš„åå­—ã€‚ å¦‚æœBeanå®ç°äº†BeanClassLoaderAwareæ¥å£ï¼Œè°ƒç”¨setBeanClassLoader()æ–¹æ³•ï¼Œä¼ å…¥ClassLoaderå¯¹è±¡çš„å®ä¾‹ã€‚ å¦‚æœBeanå®ç°äº†BeanFactoryAwareæ¥å£ï¼Œè°ƒç”¨setBeanClassLoader()æ–¹æ³•ï¼Œä¼ å…¥ClassLoaderå¯¹è±¡çš„å®ä¾‹ã€‚ ä¸ä¸Šé¢çš„ç±»ä¼¼ï¼Œå¦‚æœå®ç°äº†å…¶ä»–*Awareæ¥å£ï¼Œå°±è°ƒç”¨ç›¸åº”çš„æ–¹æ³•ã€‚ å¦‚æœæœ‰å’ŒåŠ è½½è¿™ä¸ªBeançš„Springå®¹å™¨ç›¸å…³çš„BeanPostProcessorå¯¹è±¡ï¼Œæ‰§è¡ŒpostProcessBeforeInitialization()æ–¹æ³• å¦‚æœBeanå®ç°äº†InitializingBeanæ¥å£ï¼Œæ‰§è¡ŒafterPropertiesSet()æ–¹æ³•ã€‚ å¦‚æœBeanåœ¨é…ç½®æ–‡ä»¶ä¸­çš„å®šä¹‰åŒ…å«init-methodå±æ€§ï¼Œæ‰§è¡ŒæŒ‡å®šçš„æ–¹æ³•ã€‚ å¦‚æœæœ‰å’ŒåŠ è½½è¿™ä¸ªBeançš„Springå®¹å™¨ç›¸å…³çš„BeanPostProcessorå¯¹è±¡ï¼Œæ‰§è¡ŒpostProcessAfterInitialization()æ–¹æ³• å½“è¦é”€æ¯Beançš„æ—¶å€™ï¼Œå¦‚æœBeanå®ç°äº†DisposableBeanæ¥å£ï¼Œæ‰§è¡Œdestroy()æ–¹æ³•ã€‚ å½“è¦é”€æ¯Beançš„æ—¶å€™ï¼Œå¦‚æœBeanåœ¨é…ç½®æ–‡ä»¶ä¸­çš„å®šä¹‰åŒ…å«destroy-methodå±æ€§ï¼Œæ‰§è¡ŒæŒ‡å®šçš„æ–¹æ³•ã€‚ ç”¨å›¾è¡¨ç¤ºä¸€ä¸‹(å›¾æ¥æº)ï¼š å¸Œæœ›ä»Šæ™šèƒ½æˆåŠŸç©ä¸Špokemon goï¼Œå¥½æƒ³æŠ“ç²¾çµå•Š æ¬¢è¿æŒ‡æ­£é”™è¯¯ï¼Œæ¬¢è¿ä¸€èµ·è®¨è®º~~","raw":null,"content":null,"categories":[{"name":"spring","slug":"spring","permalink":"http://yemengying.com/categories/spring/"}],"tags":[{"name":"spring","slug":"spring","permalink":"http://yemengying.com/tags/spring/"}]},{"title":"Keep Going","slug":"keep-going","date":"2016-07-03T13:31:34.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/07/03/keep-going/","link":"","permalink":"http://yemengying.com/2016/07/03/keep-going/","excerpt":"ç¡å‰çœ‹äº†çœ¼Analysisçš„æ•°æ®ï¼Œæ¯”ä»¥å‰è¿›æ­¥å¤ªå¤šï¼Œå‘ä¸Šæ¥çºªå¿µä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæˆ‘çŸ¥é“ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ä¸‹å‘¨ã€‚ã€‚ã€‚ã€‚ã€‚å®ƒå°±ä¼šã€‚ã€‚ã€‚ã€‚é™ä¸‹å»äº†ğŸ˜±ã€‚","keywords":null,"text":"ç¡å‰çœ‹äº†çœ¼Analysisçš„æ•°æ®ï¼Œæ¯”ä»¥å‰è¿›æ­¥å¤ªå¤šï¼Œå‘ä¸Šæ¥çºªå¿µä¸€ä¸‹ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºæˆ‘çŸ¥é“ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ä¸‹å‘¨ã€‚ã€‚ã€‚ã€‚ã€‚å®ƒå°±ä¼šã€‚ã€‚ã€‚ã€‚é™ä¸‹å»äº†ğŸ˜±ã€‚ ä¸è¯´åºŸè¯ï¼Œç›´æ¥ä¸Šå›¾ã€‚ è¿™äº›æ•°æ®å®‰æŠšäº†æˆ‘å› ä¸ºä¸­åˆç«é”…è€Œå—ä¼¤çš„å¼±å°å¿ƒçµã€‚ã€‚ã€‚ã€‚ã€‚åƒä¸‡åˆ«åæ§½è¿™æ•°æ®å…¶å®æŒºlowçš„ï¼Œæˆ‘æ‰ä¸ä¼šå‘Šè¯‰ä½ ä»¬ä»¥å‰éƒ½è¶…ä¸è¿‡20çš„ã€‚ã€‚ã€‚ è¦æ˜¯å‘¨å…­çœ‹åˆ°è¿™ä¸ªæ•°æ®å°±å¥½äº†ï¼Œå‘¨æœ«è‚¯å®šä¼šå†™å†™å†™ï¼Œå°±ä¸ä¼šè’åºŸäº†ã€‚ã€‚ã€‚ã€‚ çœ‹åˆ°ç§è¯´æ³•ï¼Œäººåˆ†ä¸ºè‡ªç‡ƒå‹ï¼ŒåŠ©ç‡ƒå‹å’Œé˜»ç‡ƒå‹ï¼Œå—¯ï¼Œæˆ‘åº”è¯¥å°±å±äºåŠ©ç‡ƒå‹çš„å§~~ Keep going &amp; ç¢è§‰ã€‚ã€‚ã€‚ã€‚ğŸ˜‚","raw":null,"content":null,"categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/categories/éšç¬”/"}],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/tags/éšç¬”/"}]},{"title":"ã€è¯‘ã€‘å¦‚ä½•ç»™å˜é‡å–ä¸ªç®€çŸ­ä¸”æ— æ­§ä¹‰çš„åå­—","slug":"cleanCode4naming","date":"2016-06-25T08:23:39.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/06/25/cleanCode4naming/","link":"","permalink":"http://yemengying.com/2016/06/25/cleanCode4naming/","excerpt":"æ¹¾åŒºæ—¥æŠ¥ä¸Šåˆ†äº«çš„ä¸€ç¯‡æ–‡ç« ï¼Œæ–‡ç« çš„ä½œè€…åœ¨Googleè®¾è®¡Dartè¯­è¨€ï¼Œå°±å˜é‡å‘½åæ–¹é¢ç»™äº†4ç‚¹å»ºè®®ï¼Œæ–‡ä¸­ä¹Ÿåˆ—å‡ºäº†å¥½å˜é‡åã€åå˜é‡åçš„å¯¹æ¯”ã€‚ä¸ç®¡ä½œè€…çš„çœ‹æ³•ä¸ä½ å®é™…ä¸­çš„å‘½åä¹ æƒ¯æ˜¯å¦ä¸€è‡´ï¼Œçœ‹å®Œè¿™ç¯‡æ–‡ç« ï¼Œç›¸ä¿¡å¯ä»¥åœ¨å˜é‡å‘½åæ–¹é¢æœ‰ä¸€äº›æ–°çš„æ€è€ƒã€‚","keywords":null,"text":"æ¹¾åŒºæ—¥æŠ¥ä¸Šåˆ†äº«çš„ä¸€ç¯‡æ–‡ç« ï¼Œæ–‡ç« çš„ä½œè€…åœ¨Googleè®¾è®¡Dartè¯­è¨€ï¼Œå°±å˜é‡å‘½åæ–¹é¢ç»™äº†4ç‚¹å»ºè®®ï¼Œæ–‡ä¸­ä¹Ÿåˆ—å‡ºäº†å¥½å˜é‡åã€åå˜é‡åçš„å¯¹æ¯”ã€‚ä¸ç®¡ä½œè€…çš„çœ‹æ³•ä¸ä½ å®é™…ä¸­çš„å‘½åä¹ æƒ¯æ˜¯å¦ä¸€è‡´ï¼Œçœ‹å®Œè¿™ç¯‡æ–‡ç« ï¼Œç›¸ä¿¡å¯ä»¥åœ¨å˜é‡å‘½åæ–¹é¢æœ‰ä¸€äº›æ–°çš„æ€è€ƒã€‚ åŸæ–‡åœ°å€ï¼ˆåº·æ¡‘é˜¿ç±³è¾¾ï¼‰ï¼šhttp://journal.stuffwithstuff.com/2016/06/16/long-names-are-long/?utm_source=wanqu.co&amp;utm_campaign=Wanqu+Daily&amp;utm_medium=website googleåšçš„æœ€æ˜æ™ºçš„è§„å®šä¹‹ä¸€å°±æ˜¯ä¸¥æ ¼æ‰§è¡Œcode reviewã€‚æ¯ä¸€ä¸ªæ”¹åŠ¨åœ¨ä¸Šçº¿ä¹‹å‰ï¼Œéƒ½è¦ç»è¿‡ä¸¤ç§å½¢å¼çš„reviewã€‚é¦–å…ˆï¼Œå›¢é˜Ÿä¸­çš„äººä¼šè¿›è¡Œå¸¸è§„çš„reviewï¼Œä»¥ç¡®ä¿ä»£ç å®Œæˆäº†å®ƒåº”è¯¥å®Œæˆçš„åŠŸèƒ½ã€‚ æ¥ä¸‹æ¥è¿˜ä¼šè¿›è¡Œå¯è¯»æ€§å±‚é¢çš„reviewã€‚é¡¾åæ€ä¹‰ï¼Œå®ƒæ˜¯ä¸ºäº†ç¡®ä¿ä»£ç æ˜¯å¯è¯»æ€§é«˜çš„ï¼šæ˜¯å¦åˆ©äºç†è§£å’Œç»´æŠ¤ï¼Ÿæ˜¯å¦ç¬¦åˆè¯¥ç¼–ç¨‹è¯­è¨€çš„ä¸€äº›æƒ¯ä¾‹ï¼Ÿæ˜¯å¦æœ‰è‰¯å¥½çš„æ–‡æ¡£ï¼Ÿ Dartå·²ç»å¼€å§‹googleå†…éƒ¨ä½¿ç”¨ï¼Œæ‰€ä»¥æˆ‘æœ‰å¹¸å‚ä¸äº†næ¬¡ä¸Šé¢ç±»å‹çš„code reviewã€‚ä½œä¸ºè¯¥è¯­è¨€çš„è®¾è®¡è€…ï¼Œè¿™æ˜¯ä¸€é¡¹ä»¤äººç€è¿·çš„å·¥ä½œã€‚æˆ‘å¯ä»¥ç›´æ¥çœ‹åˆ°äººä»¬æ˜¯å¦‚ä½•ä½¿ç”¨Dartçš„ï¼Œè¿™å¯¹è¯­è¨€çš„è¿›ä¸€æ­¥å‘å±•å¾ˆæœ‰å¸®åŠ©ã€‚åœ¨reivewçš„åŒæ—¶ï¼Œæˆ‘ä¹Ÿèƒ½å¤Ÿæ¸…æ™°çš„äº†è§£åˆ°é‚£äº›æ¯”è¾ƒå¸¸è§çš„é”™è¯¯å’Œä½¿ç”¨æœ€å¤šçš„ç‰¹æ€§ï¼Œæˆ‘å°±å¥½åƒæ˜¯ä¸€ä¸ªè®°å½•æœ¬åœ°å±…æ°‘ç”Ÿæ´»çš„äººç±»å­¦è€…ã€‚ å½“ç„¶ï¼Œä¸Šé¢è¯´çš„ä¸æœ¬æ–‡çš„ä¸»æ—¨æ— å…³ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ç¯‡å…³äºDartçš„æ–‡ç« ã€‚æœ¬æ–‡ä¸»è¦æ˜¯æƒ³è®¨è®ºæˆ‘çœ‹åˆ°è¿‡çš„ä¸€äº›ä»¤äººæŠ“ç‹‚çš„ä»£ç ï¼šè¿™äº›ä»£ç çš„å˜é‡å‘½åå®åœ¨æ˜¯å¤ªå°¼ç›çš„é•¿äº†ã€‚ã€‚ã€‚ã€‚ã€‚ æ˜¯çš„ï¼Œå˜é‡çš„åç§°å¯ä»¥å¾ˆçŸ­ã€‚å›åˆ°å½“Cè¯­è¨€ä¸­å¤–éƒ¨æ ‡è¯†ç¬¦ä»…éœ€è¦ç”±å‰å…­ä¸ªå­—ç¬¦æ¥å”¯ä¸€çš„åŒºåˆ†; è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½è¿˜æ²¡æœ‰å‘æ˜; æ¯æ¬¡æŒ‰é”®ç›˜éƒ½åƒåœ¨é›ªåœ°ä¸Šå¡ä¸€æ ·è‰°éš¾çš„æ—¶å€™,é•¿çš„å‘½åå°±ä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ã€‚ä¸è¿‡å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬ç°åœ¨ç”Ÿæ´»çš„ä¸–ç•Œå¤ªç¾å¥½äº†ï¼Œé”®ç›˜æ“ä½œå˜å¾—å¦‚æ­¤ç®€å•ã€‚ ä½†æˆ‘ä»¬ç°åœ¨ä¼¼ä¹èµ°ä¸Šäº†å¦ä¸€ä¸ªæç«¯ï¼Œæˆ‘ä»¬ä¸åº”è¯¥åšæµ·æ˜å¨ï¼Œä½†æˆ‘ä»¬ä¹Ÿæ— éœ€æˆä¸ºç”°çº³è¥¿Â·å¨å»‰æ–¯ã€‚ä»£ç ä¸­ä½¿ç”¨äº†è¶…é•¿çš„å‘½åä¼šå½±å“ä»£ç çš„æ¸…æ™°æ€§ã€‚åŒæ—¶ï¼Œè¶…é•¿çš„å˜é‡å‘½åä¼šé€ æˆæ¢è¡Œï¼Œè¿™ä¼šå½±å“ä»£ç çš„ç»“æ„ï¼Œä¸æ˜“äºé˜…è¯»ã€‚ é•¿çš„ç±»åä¼šä½¿å¼€å‘è€…ä¸æ˜“å£°æ˜è¯¥ç±»å‹çš„å˜é‡ã€‚ é•¿çš„æ–¹æ³•å‘½åä¼šä½¿å®ƒå˜å¾—æ™¦æ¶©éš¾æ‡‚. é•¿çš„å˜é‡å‘½åä¸åˆ©äºä»£ç é‡ç”¨ï¼Œå¯¼è‡´è¿‡é•¿çš„æ–¹æ³•é“¾ã€‚ æˆ‘æ›¾è§è¿‡è¶…è¿‡60ä¸ªå­—ç¬¦çš„å˜é‡å‘½å,ä½ ç”šè‡³å¯ä»¥å†™é¦–è¯—ã€‚åˆ«æ…Œï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•è§£å†³è¿™ä¸€é—®é¢˜ã€‚ é€‰æ‹©ä¸€ä¸ªå¥½çš„å‘½åå‘½åæœ‰ä¸¤ä¸ªç›®æ ‡ï¼š æ¸…æ™°ï¼šä½ è¦çŸ¥é“è¯¥å‘½åä¸ä»€ä¹ˆæœ‰å…³ ç²¾ç¡®ï¼šä½ è¦çŸ¥é“è¯¥å‘½åä¸ä»€ä¹ˆæ— å…³ å½“ä¸€ä¸ªå‘½åå®Œæˆä¸Šé¢ä¸¤ä¸ªç›®æ ‡ä¹‹åï¼Œå…¶ä½™çš„å­—ç¬¦å°±æ˜¯å¤šä½™çš„äº†ã€‚ä¸‹é¢æ˜¯æˆ‘åœ¨å¼€å‘æ—¶çš„ä¸€äº›å‘½ååŸåˆ™ï¼š å‘½åä¸­æ— éœ€å«æœ‰è¡¨ç¤ºå˜é‡æˆ–å‚æ•°ç±»å‹çš„å•è¯å¦‚æœä½¿ç”¨å¦‚Javaä¹‹ç±»çš„é™æ€ç±»å‹è¯­è¨€, å¼€å‘è€…é€šå¸¸çŸ¥é“å˜é‡çš„ç±»å‹. ç”±äºæ–¹æ³•çš„å®ç°ä¸€èˆ¬éƒ½æ¯”è¾ƒç®€çŸ­, æ‰€ä»¥å³ä¾¿æ˜¯åœ¨æŸ¥çœ‹ä¸€ä¸ªéœ€è¦æ¨æ–­æ‰çŸ¥é“ç±»å‹çš„æœ¬åœ°å˜é‡, æˆ–è€…åœ¨code reviewç­‰é™æ€åˆ†æå™¨ä¸å¯ç”¨çš„æƒ…å†µä¸‹, æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡å¤šçœ‹å¾ˆå°‘çš„å‡ è¡Œä»£ç å°±èƒ½çŸ¥é“å˜é‡çš„ç±»å‹. æ‰€ä»¥å°†ç±»å‹è¯´æ˜åŠ å…¥åˆ°å˜é‡åä¸­æ˜¯å¤šä½™çš„. æˆ‘ä»¬åº”è¯¥èˆå¼ƒåŒˆç‰™åˆ©å‘½åæ³•ï¼Œå¦‚ä¸‹ï¼š1234567// ä¸å¥½çš„:String nameString;DockableModelessWindow dockableModelessWindow;// æ”¹è¿›:String name;DockableModelessWindow window; ç‰¹åˆ«æ˜¯å¯¹äºé›†åˆæ¥è¯´ï¼Œæœ€å¥½ä½¿ç”¨åè¯çš„å¤æ•°å½¢å¼æ¥æè¿°å…¶å†…å®¹, è€Œä¸æ˜¯ä½¿ç”¨åè¯çš„å•æ•°å½¢å¼æ¥æè¿°. å¦‚æœå¼€å‘è€…æ›´åœ¨ä¹é›†åˆä¸­å­˜å‚¨çš„å†…å®¹, é‚£ä¹ˆå˜é‡å‘½ååº”å½“åæ˜ è¿™ä¸€ç‚¹ã€‚1234567// ä¸å¥½çš„:List&lt;DateTime&gt; holidayDateList;Map&lt;Employee, Role&gt; employeeRoleHashMap;// æ”¹è¿›:List&lt;DateTime&gt; holidays;Map&lt;Employee, Role&gt; employeeRoles; è¿™ä¸€ç‚¹ä¹ŸåŒæ ·é€‚ç”¨äºæ–¹æ³•çš„å‘½åã€‚æ–¹æ³•åä¸éœ€è¦æè¿°å®ƒçš„å‚æ•°åŠå‚æ•°çš„ç±»å‹â€“å‚æ•°åˆ—è¡¨å·²ç»è¯´æ˜äº†è¿™äº›ã€‚12345678// ä¸å¥½çš„:mergeTableCells(List&lt;TableCell&gt; cells)sortEventsUsingComparator(List&lt;Event&gt; events, Comparator&lt;Event&gt; comparator)// æ”¹è¿›:merge(List&lt;TableCell&gt; cells)sort(List&lt;Event&gt; events, Comparator&lt;Event&gt; comparator) è¿™æ ·å¯ä»¥å¸®åŠ©è°ƒç”¨è€…æ›´å¥½çš„é˜…è¯»ï¼š 12mergeTableCells(tableCells);sortEventsUsingComparator(events, comparator); å½“ç„¶ï¼Œè¿™åªæ˜¯æˆ‘ä¸ªäººçš„çœ‹æ³•ï¼Œæ¬¢è¿å¤§å®¶ä¸€èµ·è®¨è®º~~ çœç•¥å‘½åä¸­ä¸æ˜¯ç”¨æ¥æ¶ˆé™¤æ­§ä¹‰çš„å•è¯æœ‰äº›å¼€å‘è€…å€¾å‘äºå°†ä»–ä»¬çŸ¥é“çš„æœ‰å…³è¿™ä¸ªå˜é‡çš„æ‰€æœ‰ä¿¡æ¯éƒ½å¡åˆ°å‘½åé‡Œã€‚è¦è®°ä½ï¼Œå‘½ååªæ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼šåªæ˜¯å‘Šè¯‰ä½ è¯¥å˜é‡æ˜¯åœ¨å“ªå®šä¹‰çš„ã€‚å¹¶ä¸æ˜¯ç”¨æ¥å‘Šè¯‰é˜…è¯»è€…æ‰€æœ‰ä»–ä»¬æƒ³çŸ¥é“çš„æœ‰å…³è¿™ä¸ªå¯¹è±¡çš„è¯¦ç»†ä¿¡æ¯ã€‚è¿™æ˜¯å®šä¹‰åº”è¯¥åšçš„äº‹æƒ…çš„ã€‚ å‘½ååªæ˜¯è®©ä½ æ‰¾åˆ°ä»–çš„å®šä¹‰ã€‚ å½“æˆ‘çœ‹åˆ°ä¸€ä¸ªå«recentlyUpdatedAnnualSalesBid(æœ€è¿‘æ›´æ–°çš„å…¨å¹´é”€å”®æŠ•æ ‡)çš„æ ‡è¯†ç¬¦æ—¶ï¼Œæˆ‘ä¼šé—®ï¼š å­˜åœ¨ä¸æ˜¯æœ€è¿‘æ›´æ–°çš„å…¨å¹´é”€å”®æŠ•æ ‡ä¹ˆï¼Ÿ å­˜åœ¨æ²¡æœ‰è¢«æ›´æ–°çš„æœ€è¿‘çš„å…¨å¹´é”€å”®æŠ•æ ‡ä¹ˆï¼Ÿ å­˜åœ¨æœ€è¿‘æ›´æ–°çš„éå…¨å¹´çš„é”€å”®æŠ•æ ‡ä¹ˆï¼Ÿ å­˜åœ¨æœ€è¿‘æ›´æ–°çš„å…¨å¹´éé”€å”®çš„æŠ•æ ‡ä¹ˆï¼Ÿ å­˜åœ¨æœ€è¿‘æ›´æ–°çš„å…¨å¹´é”€å”®éæŠ•æ ‡çš„ä¸œä¸œå—ï¼Ÿ ä¸Šé¢ä»»ä½•ä¸€ä¸ªé—®é¢˜çš„å›ç­”æ˜¯â€œä¸å­˜åœ¨â€ï¼Œå°±æ„å‘³ç€å‘½åä¸­å¼•å…¥äº†æ— ç”¨çš„å•è¯ã€‚ 1234567// ä¸å¥½çš„:finalBattleMostDangerousBossMonster;weaklingFirstEncounterMonster;// æ”¹è¿›:boss;firstMonster; å½“ç„¶ï¼Œä½ å¯èƒ½ä¼šè§‰å¾—è¿™æœ‰ä¸€äº›è¿‡äº†ã€‚æ¯”å¦‚å°†ç¬¬ä¸€ä¸ªä¾‹å­çš„æ ‡è¯†ç¬¦ç®€åŒ–ä¸ºbid,ä¼šè®©äººè§‰å¾—æœ‰ç‚¹æ¨¡ç³Šä¸æ¸…ã€‚ä½†ä½ å¯ä»¥æ”¾å¿ƒå¤§èƒ†çš„è¿™æ ·åšï¼Œå¦‚æœåœ¨ä¹‹åçš„å¼€å‘ä¸­è§‰å¾—è¯¥å‘½åä¼šé€ æˆå†²çªæˆ–ä¸æ˜ç¡®ï¼Œå¯ä»¥æ·»åŠ äº›ä¿®é¥°è¯æ¥å®Œå–„å®ƒã€‚åä¹‹ï¼Œå¦‚æœä¸€å¼€å§‹å°±å–äº†ä¸€ä¸ªå¾ˆé•¿çš„å‘½åï¼Œä½ æ˜¯ä¸å¯èƒ½åœ¨ä¹‹åé‡æ–°å›æ¥ç®€åŒ–å®ƒçš„ã€‚ çœç•¥å‘½åä¸­å¯ä»¥ä»ä¸Šä¸‹æ–‡è·å–çš„å•è¯æˆ‘å¯ä»¥åœ¨æ–‡ç« ä¸­ä½¿ç”¨â€æˆ‘â€ï¼Œå› ä¸ºè¯»è€…éƒ½çŸ¥é“è¿™æ˜¯ä¸€ç¯‡ç”±Bob Nystromæ‰€åšçš„åšå®¢ã€‚æˆ‘è ¢èŒçš„è„¸å°±æŒ‚åœ¨é‚£ï¼Œæˆ‘æ— éœ€ä¸åœçš„è¯´æˆ‘çš„åå­—ã€‚å†™ä»£ç ä¹Ÿæ˜¯ä¸€æ ·ï¼Œç±»ä¸­çš„æ–¹æ³•/å±æ€§å’Œæ–¹æ³•ä¸­çš„å˜é‡ï¼Œéƒ½æ˜¯å­˜åœ¨åœ¨ä¸Šä¸‹æ–‡ä¸­çš„ï¼Œæ— éœ€é‡å¤ã€‚ 1234567891011// Bad:class AnnualHolidaySale &#123; int _annualSaleRebate; void promoteHolidaySale() &#123; ... &#125;&#125;// Better:class AnnualHolidaySale &#123; int _rebate; void promote() &#123; ... &#125;&#125; å®é™…ä¸Š, ä¸€ä¸ªå‘½ååµŒå¥—çš„å±‚æ¬¡è¶Šå¤š, å®ƒå°±æœ‰æ›´å¤šçš„ç›¸å…³çš„ä¸Šä¸‹æ–‡ï¼Œä¹Ÿå°±æ›´ç®€çŸ­ã€‚æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªå˜é‡çš„ä½œç”¨åŸŸè¶Šå°ï¼Œå‘½åå°±è¶ŠçŸ­ã€‚ çœç•¥å‘½åä¸­æ— ä»»ä½•å«ä¹‰çš„å•è¯æˆ‘å¸¸å¸¸åœ¨è®¸å¤šæ¸¸æˆå¼€å‘ä¸­çœ‹åˆ°åŒ…å«æ— ä»»ä½•å«ä¹‰çš„å•è¯çš„å‘½åï¼Œä¸€äº›å¼€å‘è€…å–œæ¬¢åœ¨å‘½åä¸­æ·»åŠ ä¸€äº›çœ‹èµ·æ¥æœ‰ç‚¹ä¸¥è‚ƒçš„å•è¯ã€‚æˆ‘çŒœå¯èƒ½ä»–ä»¬è§‰å¾—è¿™æ ·åšå¯ä»¥è®©ä»–ä»¬çš„ä»£ç æ˜¾å¾—é‡è¦ï¼Œæˆ–è€…è¯´è®©ä»–ä»¬è§‰å¾—è‡ªå·±æ›´é‡è¦ã€‚ å®é™…ä¸Šï¼Œæœ‰ä¸€äº›è¯è¯­å¹¶æ²¡æœ‰å®é™…æ„ä¹‰ï¼Œåªæ˜¯ä¸€äº›å¥—è¯ã€‚æ¯”å¦‚ï¼šdata, state, amount, value, manager, engine, object, entityå’Œinstanceã€‚ ä¸€ä¸ªå¥½çš„å‘½åèƒ½å¤Ÿåœ¨é˜…è¯»è€…çš„è„‘æµ·ä¸­æç”»å‡ºä¸€å¹…å›¾ç”»ã€‚è€Œå°†æŸå˜é‡å‘½åä¸ºâ€managerâ€å¹¶ä¸èƒ½å‘è¯»è€…ä¼ è¾¾ä»»ä½•æœ‰å…³è¯¥å˜é‡æ˜¯åšä»€ä¹ˆçš„ä¿¡æ¯. å®ƒæ˜¯ç”¨æ¥åšç»©æ•ˆè¯„ä¼°çš„å—? å®ƒæ˜¯ç®¡ç†åŠ è–ªçš„å—? åœ¨å‘½åæ—¶å¯ä»¥é—®ä¸€ä¸‹è‡ªå·±ï¼ŒæŠŠè¿™ä¸ªå•è¯å»æ‰å«ä¹‰æ˜¯ä¸æ˜¯ä¸å˜ï¼Ÿå¦‚æœæ˜¯ï¼Œé‚£å°±æœæ–­æŠŠå®ƒå‰”é™¤å§~~ å®é™…ä¾‹å­â€”åå¤«é¥¼ä¸ºäº†è®©å¤§å®¶äº†è§£ä»¥ä¸Šçš„å‘½ååŸåˆ™åœ¨å®é™…ä¸­å¦‚ä½•åº”ç”¨ï¼Œè¿™æœ‰ä¸ªè¿æ³•äº†ä»¥ä¸Šæ‰€æœ‰åŸåˆ™çš„åä¾‹ã€‚è¿™ä¸ªä¾‹å­å’Œæˆ‘å®é™…ä¸Šreviewè¿‡çš„ä¸€æ®µä»£ç ä¸€æ ·ä»¤äººå¿ƒç¢ã€‚ã€‚ã€‚ã€‚12345// å¥½åƒçš„æ¯”åˆ©æ—¶åå¤«é¥¼class DeliciousBelgianWaffleObject &#123; void garnishDeliciousBelgianWaffleWithStrawberryList( List&lt;Strawberry&gt; strawberryList) &#123; ... &#125;&#125; é¦–å…ˆï¼Œé€šè¿‡å‚æ•°åˆ—è¡¨æˆ‘ä»¬å¯ä»¥çŸ¥é“æ–¹æ³•æ˜¯ç”¨æ¥å¤„ç†ä¸€ä¸ªstrawberryçš„åˆ—è¡¨ï¼Œæ‰€ä»¥å¯ä»¥åœ¨æ–¹æ³•å‘½åä¸­å»æ‰ï¼š1234class DeliciousBelgianWaffleObject &#123; void garnishDeliciousBelgianWaffle( List&lt;Strawberry&gt; strawberries) &#123; ... &#125;&#125; é™¤éç¨‹åºä¸­è¿˜åŒ…å«ä¸å¥½åƒçš„æ¯”åˆ©æ—¶åå¤«é¥¼æˆ–è€…å…¶ä»–å›½å®¶çš„åå¤«é¥¼ï¼Œä¸ç„¶æˆ‘ä»¬å¯ä»¥å°†è¿™äº›æ— ç”¨çš„å½¢å®¹è¯å»æ‰ï¼š123class WaffleObject &#123; void garnishWaffle(List&lt;Strawberry&gt; strawberries) &#123; ... &#125;&#125; æ–¹æ³•æ˜¯åŒ…å«åœ¨WaffleObjectç±»ä¸­çš„ï¼Œæ‰€ä»¥æ–¹æ³•åä¸­æ— éœ€Waffleçš„è¯´æ˜ï¼š123class WaffleObject &#123; void garnish(List&lt;Strawberry&gt; strawberries) &#123; ... &#125;&#125; å¾ˆæ˜æ˜¾å®ƒæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»»ä½•äº‹ç‰©éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¼ è¯´ä¸­çš„â€œé¢å‘å¯¹è±¡â€çš„å«ä¹‰ï¼Œæ‰€ä»¥å‘½åä¸­æ— éœ€å¸¦æœ‰Objectï¼š123class Waffle &#123; void garnish(List&lt;Strawberry&gt; strawberries) &#123; ... &#125;&#125; å¥½äº†ï¼Œè¿™æ ·çœ‹èµ·æ¥å¥½å¤šäº†ã€‚ ä»¥ä¸Šå°±æ˜¯æˆ‘æ€»ç»“çš„ç›¸å½“ç®€æ´çš„å‘½ååŸåˆ™ã€‚å¯èƒ½æœ‰äº›äººä¼šè§‰å¾—æ— éœ€åœ¨å‘½åä¸Šè€—è´¹å¤ªå¤šçš„ç²¾åŠ›ï¼Œä½†æˆ‘è®¤ä¸ºå‘½åæ˜¯å¼€å‘è¿‡ç¨‹ä¸­æœ€åŸºæœ¬çš„ä»»åŠ¡ä¹‹ä¸€ã€‚â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“æˆ‘æ˜¯èŒèŒå“’åˆ†ç•Œçº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-æ„Ÿè§‰å˜é‡æˆ–è€…æ–¹æ³•çš„å‘½åï¼Œçœ‹ä¼¼ç®€å•ï¼Œå®é™…å¾ˆéš¾ï¼Œç‰¹åˆ«æ˜¯æƒ³ä¸€ä¸ªç®€æ´æ˜äº†å¯è¯»æ€§é«˜çš„å‘½åã€‚è‡ªå·±ä¹Ÿç»å¸¸ç”¨ä»€ä¹ˆdata,xxxlistæ¥å‘½åï¼Œä½œè€…è¯´çš„æŒºå¯¹çš„ï¼Œå‰è€…æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œåè€…åˆæœ‰ç‚¹å•°å—¦ã€‚ä¸è¿‡å¯¹äºé›†åˆç±»å‹çš„å˜é‡ï¼Œç»Ÿä¸€ç”¨åè¯å¤æ•°å‘½åå®¹æ˜“æ··æ·†ã€‚ä¸¾ä¸ªä¾‹å­å¯¹äºAppleè¿™ä¸ªç±»æ¥è¯´ï¼Œå¯èƒ½å­˜åœ¨Listå’ŒMapä¸¤ç§é›†åˆç±»å‹çš„å˜é‡ã€‚ä¸ªäººè§‰å¾—å¯¹Listç±»å‹çš„å˜é‡å¯ä»¥é‡‡ç”¨åè¯å¤æ•°æ¥å‘½åï¼ŒMapç±»å‹çš„å˜é‡å¯ä»¥é‡‡ç”¨valueByKeyæ ¼å¼æ¥å‘½åï¼Œæ¯”è¾ƒå®¹æ˜“åŒºåˆ†ã€‚ æ¬¢è¿æŒ‡æ­£é”™è¯¯ï¼Œæ¬¢è¿ä¸€èµ·è®¨è®º~~~ éƒ½çœ‹åˆ°è¿™äº†ï¼Œå…³æ³¨ä¸ªå…¬ä¼—å·å†èµ°å§ğŸ™ˆ","raw":null,"content":null,"categories":[{"name":"Clean Code","slug":"Clean-Code","permalink":"http://yemengying.com/categories/Clean-Code/"}],"tags":[{"name":"ç¿»è¯‘","slug":"ç¿»è¯‘","permalink":"http://yemengying.com/tags/ç¿»è¯‘/"}]},{"title":"é¢è¯•æ€»ç»“","slug":"interview","date":"2016-06-05T02:12:59.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/06/05/interview/","link":"","permalink":"http://yemengying.com/2016/06/05/interview/","excerpt":"ä»å†³å®šç¦»èŒå¼€å§‹ï¼Œå‰å‰ååé¢è¯•äº†å‡ å®¶å…¬å¸ï¼ŒæŠŠè¿˜èƒ½è®°å¾—ä½çš„é¢è¯•é—®é¢˜æ€»ç»“ä¸€ä¸‹ï¼Œå¸®å°ä¼™ä¼´ä»¬æŸ¥æ¼è¡¥ç¼ºå§ï¼Œå¸Œæœ›å°ä¼™ä¼´ä»¬å¯ä»¥ä¸€ä¸¾æ‹¿ä¸‹offerã€‚ä¼šç®€è¦å†™ä¸€ä¸‹æˆ‘è§‰å¾—é—®é¢˜çš„å…³é”®ç‚¹ï¼Œä¸è¿‡æœ‰çš„å¯èƒ½å¹¶ä¸æ˜¯æ­£ç¡®çš„ç­”æ¡ˆï¼Œæœ‰çš„é—®é¢˜æˆ‘åˆ°ç°åœ¨ä¹Ÿè¿˜æ²¡æ˜ç™½ã€‚ã€‚ã€‚~~","keywords":null,"text":"ä»å†³å®šç¦»èŒå¼€å§‹ï¼Œå‰å‰ååé¢è¯•äº†å‡ å®¶å…¬å¸ï¼ŒæŠŠè¿˜èƒ½è®°å¾—ä½çš„é¢è¯•é—®é¢˜æ€»ç»“ä¸€ä¸‹ï¼Œå¸®å°ä¼™ä¼´ä»¬æŸ¥æ¼è¡¥ç¼ºå§ï¼Œå¸Œæœ›å°ä¼™ä¼´ä»¬å¯ä»¥ä¸€ä¸¾æ‹¿ä¸‹offerã€‚ä¼šç®€è¦å†™ä¸€ä¸‹æˆ‘è§‰å¾—é—®é¢˜çš„å…³é”®ç‚¹ï¼Œä¸è¿‡æœ‰çš„å¯èƒ½å¹¶ä¸æ˜¯æ­£ç¡®çš„ç­”æ¡ˆï¼Œæœ‰çš„é—®é¢˜æˆ‘åˆ°ç°åœ¨ä¹Ÿè¿˜æ²¡æ˜ç™½ã€‚ã€‚ã€‚~~ Javaç›¸å…³Java GCæœºåˆ¶(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜…) ä¸»è¦ä»ä¸‰ä¸ªæ–¹é¢å›ç­”:GCæ˜¯é’ˆå¯¹ä»€ä¹ˆå¯¹è±¡è¿›è¡Œå›æ”¶(å¯è¾¾æ€§åˆ†ææ³•)ï¼Œä»€ä¹ˆæ—¶å€™å¼€å§‹GC(å½“æ–°ç”Ÿä»£æ»¡äº†ä¼šè¿›è¡ŒMinor GCï¼Œå‡åˆ°è€å¹´ä»£çš„å¯¹è±¡å¤§äºè€å¹´ä»£å‰©ä½™ç©ºé—´æ—¶ä¼šè¿›è¡ŒMajor GC)ï¼ŒGCåšä»€ä¹ˆ(æ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ¸…é™¤æˆ–æ ‡è®°-æ•´ç†ç®—æ³•)ï¼Œæ„Ÿè§‰å›ç­”è¿™äº›å°±å·®ä¸å¤šäº†ï¼Œä¹Ÿå¯ä»¥è¡¥å……ä¸€ä¸‹å¯ä»¥è°ƒä¼˜çš„å‚æ•°(-XX:newRatio,-Xms,-Xmxç­‰ç­‰)ã€‚è¯¦ç»†çš„å¯ä»¥çœ‹æˆ‘å¦ä¸€ç¯‡åšå®¢(Javaä¸­çš„åƒåœ¾å›æ”¶æœºåˆ¶)ã€‚ å¦‚ä½•çº¿ç¨‹å®‰å…¨çš„ä½¿ç”¨HashMap(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜…) ä½œä¸ºJavaç¨‹åºå‘˜è¿˜æ˜¯ç»å¸¸å’ŒHashMapæ‰“äº¤é“çš„ï¼Œæ‰€ä»¥HashMapçš„ä¸€äº›åŸç†è¿˜æ˜¯æææ¸…é™¤æ¯”è¾ƒå¥½ã€‚è¿™ä¸ªé—®é¢˜æ„Ÿè§‰ä¸»è¦å°±æ˜¯é—®HashMapï¼ŒHashTableï¼ŒConcurrentHashMapï¼ŒsychronizedMapçš„åŸç†å’ŒåŒºåˆ«ã€‚å…·ä½“çš„å¯ä»¥çœ‹æˆ‘å¦ä¸€ç¯‡åšå®¢(å¦‚ä½•çº¿ç¨‹å®‰å…¨çš„ä½¿ç”¨HashMap)ã€‚ HashMapæ˜¯å¦‚ä½•è§£å†³å†²çªçš„(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜†) å…¶å®å°±æ˜¯é“¾æ¥æ³•ï¼Œå°†ç´¢å¼•å€¼ç›¸åŒçš„å…ƒç´ å­˜æ”¾åˆ°ä¸€ä¸ªå•é“¾è¡¨é‡Œã€‚ä½†ä¸ºäº†è§£å†³åœ¨é¢‘ç¹å†²çªæ—¶HashMapæ€§èƒ½é™ä½çš„é—®é¢˜ï¼ŒJava 8ä¸­åšäº†ä¸€ä¸ªå°ä¼˜åŒ–ï¼Œåœ¨å†²çªçš„å…ƒç´ ä¸ªæ•°è¶…è¿‡è®¾å®šçš„å€¼(é»˜è®¤ä¸º8)æ—¶ï¼Œä¼šä½¿ç”¨å¹³è¡¡æ ‘æ¥æ›¿ä»£é“¾è¡¨å­˜å‚¨å†²çªçš„å…ƒç´ ã€‚å…·ä½“çš„å¯ä»¥çœ‹æˆ‘å¦ä¸€ç¯‡åšå®¢(Java 8ä¸­HashMapå’ŒLinkedHashMapå¦‚ä½•è§£å†³å†²çª)ã€‚ Javaåˆ›å»ºå¯¹è±¡æœ‰å“ªå‡ ç§(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜†) è¿™ä¸ªé—®é¢˜è¿˜ç®—å¥½å›ç­”ï¼Œå¤§æ¦‚æœ‰å››ç§â€”newã€å·¥å‚æ¨¡å¼ã€åå°„å’Œå…‹éš†ï¼Œä¸è¿‡è¿™ä¸ªé—®é¢˜æœ‰å¯èƒ½è¡ç”Ÿå‡ºå…³äºè®¾è®¡æ¨¡å¼ï¼Œåå°„ï¼Œæ·±å…‹éš†ï¼Œæµ…å…‹éš†ç­‰ä¸€ç³»åˆ—é—®é¢˜ã€‚ã€‚ã€‚è¦åšå¥½å‡†å¤‡~å‚è€ƒèµ„æ–™ï¼šè®¾è®¡æ¨¡å¼Javaç‰ˆJavaåå°„è¯¦è§£æ·±å…‹éš†ä¸æµ…å…‹éš†çš„åŒºåˆ« æ³¨è§£(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜†â˜†) å¦‚æœç®€å†ä¸­æœ‰æåˆ°è¿‡æ›¾è‡ªå®šä¹‰è¿‡æ³¨è§£ï¼Œè¿˜æ˜¯äº†è§£æ¸…æ¥šæ¯”è¾ƒå¥½ã€‚ä¸»è¦æ˜¯äº†è§£åœ¨è‡ªå®šä¹‰æ³¨è§£æ—¶éœ€è¦ä½¿ç”¨çš„ä¸¤ä¸ªä¸»è¦çš„å…ƒæ³¨è§£@Retentionå’Œ@Targetã€‚@Retentionç”¨æ¥å£°æ˜æ³¨è§£çš„ä¿ç•™ç­–ç•¥ï¼Œæœ‰CLASSï¼ŒRUNTIME,SOURCEä¸‰ç§ï¼Œåˆ†åˆ«è¡¨ç¤ºæ³¨è§£ä¿å­˜åœ¨ç±»æ–‡ä»¶ï¼ŒJVMè¿è¡Œæ—¶åˆ»å’Œæºä»£ç ä¸­ã€‚@Targetç”¨æ¥å£°æ˜æ³¨è§£å¯ä»¥è¢«æ·»åŠ åˆ°å“ªäº›ç±»å‹çš„å…ƒç´ ä¸Šï¼Œå¦‚ç±»å‹ï¼Œæ–¹æ³•å’ŒåŸŸç­‰ã€‚å‚è€ƒèµ„æ–™ï¼šJavaæ³¨è§£ å¼‚å¸¸(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜†â˜†) ä¸€é“ç¬”è¯•é¢˜ï¼Œä»£ç å¦‚ä¸‹ï¼Œé—®è¿”å›å€¼æ˜¯ä»€ä¹ˆã€‚1234567891011int ret = 0;try&#123;throw new Exception();&#125;catch(Exception e)&#123;ret = 1;return ret;&#125;finally&#123;ret = 2;&#125; ä¸»è¦çš„è€ƒç‚¹å°±æ˜¯catchä¸­çš„returnåœ¨finallyä¹‹åæ‰§è¡Œ ä½†æ˜¯ä¼šå°†returnçš„å€¼æ”¾åˆ°ä¸€ä¸ªåœ°æ–¹å­˜èµ·æ¥ï¼Œæ‰€ä»¥finallyä¸­çš„ret=2ä¼šæ‰§è¡Œï¼Œä½†è¿”å›å€¼æ˜¯1ã€‚å‚è€ƒèµ„æ–™ï¼šæ·±å…¥ç†è§£Javaå¼‚å¸¸å¤„ç†æœºåˆ¶Javaå¼‚å¸¸å¤„ç† æ‚²è§‚é”å’Œä¹è§‚é”åŒºåˆ«ï¼Œä¹è§‚é”é€‚ç”¨äºä»€ä¹ˆæƒ…å†µ(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜†) æ‚²è§‚é”ï¼Œå°±æ˜¯æ€»è§‰å¾—æœ‰åˆæ°‘æƒ³å®³æœ•ï¼Œæ¯æ¬¡è®¿é—®æ•°æ®çš„æ—¶å€™éƒ½è§‰å¾—ä¼šæœ‰åˆ«äººä¿®æ”¹å®ƒï¼Œæ‰€ä»¥æ¯æ¬¡æ‹¿æ•°æ®æ—¶éƒ½ä¼šä¸Šé”ï¼Œç¡®ä¿åœ¨è‡ªå·±ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¸ä¼šè¢«ä»–äººè®¿é—®ã€‚ä¹è§‚é”å°±æ˜¯å¾ˆå•çº¯ï¼Œå¿ƒæ€å¥½ï¼Œæ‰€ä»¥æ¯æ¬¡æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¸ä¼šä¸Šé”ï¼Œåªæ˜¯åœ¨æ›´æ–°æ•°æ®çš„æ—¶å€™å»åˆ¤æ–­è¯¥æ•°æ®æ˜¯å¦è¢«åˆ«äººä¿®æ”¹è¿‡ã€‚å¤§å¤šæ•°çš„å…³ç³»æ•°æ®åº“å†™å…¥æ“ä½œéƒ½æ˜¯åŸºäºæ‚²è§‚é”ï¼Œç¼ºç‚¹åœ¨äºå¦‚æœæŒæœ‰é”çš„å®¢æˆ·ç«¯è¿è¡Œçš„å¾ˆæ…¢ï¼Œé‚£ä¹ˆç­‰å¾…è§£é”çš„å®¢æˆ·ç«¯è¢«é˜»å¡çš„æ—¶é—´å°±è¶Šé•¿ã€‚Redisçš„äº‹åŠ¡æ˜¯åŸºäºä¹è§‚é”çš„æœºåˆ¶ï¼Œä¸ä¼šåœ¨æ‰§è¡ŒWATCHå‘½ä»¤æ—¶å¯¹æ•°æ®è¿›è¡ŒåŠ é”ï¼Œåªæ˜¯ä¼šåœ¨æ•°æ®å·²ç»è¢«å…¶ä»–å®¢æˆ·ç«¯æŠ¢å…ˆä¿®æ”¹äº†çš„æƒ…å†µä¸‹ï¼Œé€šçŸ¥æ‰§è¡ŒWATCHå‘½ä»¤çš„å®¢æˆ·ç«¯ã€‚ä¹è§‚é”é€‚ç”¨äºè¯»å¤šå†™å°‘çš„æƒ…å†µï¼Œå› ä¸ºåœ¨å†™æ“ä½œæ¯”è¾ƒé¢‘ç¹çš„æ—¶å€™ï¼Œä¼šä¸æ–­åœ°retryï¼Œä»è€Œé™ä½æ€§èƒ½ã€‚å‚è€ƒèµ„æ–™ï¼šå…³äºæ‚²è§‚é”å’Œä¹è§‚é”çš„åŒºåˆ«ä¹è§‚é”å’Œæ‚²è§‚é” å•ä¾‹æ¨¡å¼æ‰¾é”™è¯¯(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜†) é”™è¯¯æ˜¯æ²¡æœ‰å°†æ„é€ å‡½æ•°ç§æœ‰åŒ–ï¼Œå•ä¾‹è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼ŒæŠŠå®ƒçš„é¥¿æ±‰å¼å’Œæ‡’æ±‰å¼çš„ä¸¤ç§å®ç°æ–¹å¼çœ‹æ˜ç™½äº†å°±å¯ä»¥äº†ã€‚å•ä¾‹æ¨¡å¼ __ Springç›¸å…³å…³äºSpringçš„é—®é¢˜ä¸»è¦å°±æ˜¯å›´ç»•ç€Iocå’ŒAOPï¼Œå®ƒä»¬çœŸæ˜¯Springçš„æ ¸å¿ƒå•Šã€‚ Spring Beançš„ç”Ÿå‘½å‘¨æœŸ(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜…) å°±ä¸å†™æˆ‘é‚£ä¹ˆlowçš„å›ç­”äº†ï¼Œç›´æ¥çœ‹å‚è€ƒèµ„æ–™å§ã€‚å‚è€ƒèµ„æ–™ï¼šSpring Beançš„ç”Ÿå‘½å‘¨æœŸTop 10 Spring Interview Questions Answers J2EE Springä¸­ç”¨åˆ°çš„è®¾è®¡æ¨¡å¼(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜…) å·¥å‚æ¨¡å¼:IOCå®¹å™¨ä»£ç†æ¨¡å¼:AOPç­–ç•¥æ¨¡å¼:åœ¨springé‡‡å–åŠ¨æ€ä»£ç†æ—¶ï¼Œæ ¹æ®ä»£ç†çš„ç±»æœ‰æ— å®ç°æ¥å£æœ‰JDKå’ŒCGLIBä¸¤ç§ä»£ç†æ–¹å¼ï¼Œå°±æ˜¯é‡‡ç”¨ç­–ç•¥æ¨¡å¼å®ç°çš„å•ä¾‹æ¨¡å¼:é»˜è®¤æƒ…å†µä¸‹springä¸­çš„beanåªå­˜åœ¨ä¸€ä¸ªå®ä¾‹åªçŸ¥é“è¿™å››ä¸ªã€‚ã€‚ã€‚ã€‚å‚è€ƒèµ„æ–™:Design Patterns Used in Java Spring Framework è®²ä¸€è®²Spring IoCå’ŒAOP(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜…) IoCçš„æ ¸å¿ƒæ˜¯ä¾èµ–åè½¬ï¼Œå°†åˆ›å»ºå¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´çš„ä¾èµ–ç®¡ç†äº¤ç»™IoCå®¹å™¨æ¥åšï¼Œå®Œæˆå¯¹è±¡ä¹‹é—´çš„è§£è€¦ã€‚AOPä¸»è¦æ˜¯åˆ©ç”¨ä»£ç†æ¨¡å¼ï¼ŒæŠŠè®¸å¤šæ¥å£éƒ½è¦ç”¨çš„åˆå’Œæ¥å£æœ¬èº«ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘æ— å…³çš„éƒ¨åˆ†æŠ½å‡ºæ¥ï¼Œå†™æˆä¸€ä¸ªåˆ‡é¢ï¼Œå•ç‹¬ç»´æŠ¤ï¼Œæ¯”å¦‚æƒé™éªŒè¯ã€‚è¿™æ ·å¯ä»¥ä½¿æ¥å£ç¬¦åˆâ€œå•ä¸€èŒè´£åŸåˆ™â€ï¼Œåªå…³æ³¨ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¹Ÿæé«˜äº†ä»£ç çš„é‡ç”¨æ€§ã€‚ AOPçš„åº”ç”¨åœºæ™¯(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜†) æƒé™ï¼Œæ—¥å¿—ï¼Œå¤„ç†å¼‚å¸¸ï¼Œäº‹åŠ¡ç­‰ç­‰ï¼Œä¸ªäººç†è§£å°±æ˜¯æŠŠè®¸å¤šæ¥å£éƒ½è¦ç”¨çš„åˆå’Œæ¥å£æœ¬èº«ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘æ— å…³çš„éƒ¨åˆ†æŠ½å‡ºæ¥ï¼Œå†™æˆä¸€ä¸ªåˆ‡é¢ï¼Œå•ç‹¬ç»´æŠ¤ï¼Œæ¯”å¦‚æƒé™éªŒè¯ã€‚è¿™æ ·å¯ä»¥ä½¿æ¥å£ç¬¦åˆâ€œå•ä¸€èŒè´£åŸåˆ™â€ï¼Œåªå…³æ³¨ä¸»è¦çš„ä¸šåŠ¡é€»è¾‘ï¼Œä¹Ÿæé«˜äº†ä»£ç çš„é‡ç”¨æ€§ã€‚ Springä¸­ç¼–ç ç»Ÿä¸€è¦å¦‚ä½•åš(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜†â˜†) é…ç½®ä¸€ä¸ªæ‹¦æˆªå™¨å°±è¡Œäº†12345678910111213141516&lt;filter&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;encoding&lt;/param-name&gt; &lt;param-value&gt;UTF-8&lt;/param-value&gt; &lt;/init-param&gt; &lt;init-param&gt; &lt;param-name&gt;forceEncoding&lt;/param-name&gt; &lt;param-value&gt;true&lt;/param-value&gt; &lt;/init-param&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;CharacterEncodingFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt; æ•°æ®åº“ç›¸å…³Mysqlç´¢å¼•çš„å†…éƒ¨ç»“æ„(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜†) B+æ ‘ï¼Œä¸‰å±‚ï¼ŒçœŸå®çš„æ•°æ®å­˜å‚¨åœ¨å¶å­èŠ‚ç‚¹å‚è€ƒèµ„æ–™:MySQLç´¢å¼•åŸç†åŠæ…¢æŸ¥è¯¢ä¼˜åŒ– å¦‚æœä¸€ä¸ªSQLæ‰§è¡Œæ—¶é—´æ¯”è¾ƒé•¿æ€ä¹ˆåŠ(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜†) å¯ä»¥åˆ©ç”¨pt-query-digestç­‰å·¥å…·åˆ†ææ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œä¹Ÿå¯ä»¥ç”¨explainæŸ¥çœ‹SQLçš„æ‰§è¡Œè®¡åˆ’ã€‚å…·ä½“å¯çœ‹æˆ‘çš„å¦ä¸€ç¯‡åšå®¢MySQLè°ƒä¼˜ å¦‚æœä¸€å¼ è¡¨ä¸­æœ‰ä¸Šåƒä¸‡æ¡æ•°æ®åº”è¯¥æ€ä¹ˆåšåˆ†é¡µ(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜†â˜†) è‚¯å®šä¸èƒ½ç›´æ¥limit,offsetï¼Œä¸»è¦å°±æ˜¯è¦æƒ³åŠæ³•é¿å…åœ¨æ•°æ®é‡å¤§æ—¶æ‰«æè¿‡å¤šçš„è®°å½•ã€‚å…·ä½“å¯çœ‹æˆ‘çš„å¦ä¸€ç¯‡åšå®¢ã€è¯‘ã€‘ä¼˜åŒ–MySQLä¸­çš„åˆ†é¡µ ä»€ä¹ˆæ ·çš„åˆ—é€‚åˆåŠ ç´¢å¼•ï¼Œå¦‚æœä¸€ä¸ªåˆ—çš„å€¼åªæœ‰1å’Œ2ï¼Œé‚£ä¹ˆå®ƒé€‚åˆåŠ ç´¢å¼•ä¹ˆ(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜†â˜†) åœ¨whereä»å¥ï¼Œgroup byä»å¥ï¼Œorder byä»å¥ï¼Œonä»å¥ä¸­å‡ºç°çš„åˆ— ç´¢å¼•çš„å­—æ®µè¶Šå°è¶Šå¥½ åœ¨å»ºç«‹è”åˆç´¢å¼•æ—¶ï¼Œç¦»æ•£åº¦å¤§çš„åˆ—æ”¾å¤§è”åˆç´¢å¼•çš„å‰é¢ åªæœ‰1å’Œ2ä¸é€‚åˆå»ºç´¢å¼• Redisç›¸å…³Redisæä¾›å“ªå‡ ç§æ•°æ®ç»“æ„(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜…) ä¸€å…±æœ‰5ç§ï¼Œå­—ç¬¦ä¸²ï¼Œæ•£åˆ—ï¼Œåˆ—è¡¨ï¼Œé›†åˆï¼Œæœ‰åºé›†åˆã€‚å‚è€ƒèµ„æ–™ï¼šRedisä¸­æ–‡å®˜ç½‘ Redisæ”¯æŒé›†ç¾¤ä¹ˆï¼Œä»å“ªä¸ªç‰ˆæœ¬å¼€å§‹æ”¯æŒé›†ç¾¤çš„(é‡è¦ç¨‹åº¦:â˜…â˜…â˜†â˜†â˜†) æ”¯æŒé›†ç¾¤ï¼Œä»3.0ç‰ˆæœ¬å¼€å§‹ã€‚å½“ç„¶é¢è¯•æ—¶æˆ‘ä¹Ÿæ²¡è®°ä½ç‰ˆæœ¬ã€‚ã€‚ã€‚ Redisé›†ç¾¤ä¸­ï¼Œå¦‚ä½•å°†ä¸€ä¸ªå¯¹è±¡æ˜ å°„åˆ°å¯¹åº”çš„ç¼“å­˜æœåŠ¡å™¨(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜†) ä¸€èˆ¬å°±æ˜¯hash%N,å°±æ˜¯ç”¨å¯¹è±¡çš„hashå€¼å¯¹ç¼“å­˜æœåŠ¡å™¨çš„ä¸ªæ•°å–ä½™ æ¥ä¸Šä¸ªé—®é¢˜ï¼Œç¼“å­˜é›†ç¾¤ä¸­å¦‚æœæ–°å¢ä¸€å°æœåŠ¡å™¨ï¼Œæ€ä¹ˆæ‰èƒ½ä¸å½±å“å¤§éƒ¨åˆ†ç¼“å­˜æ•°æ®çš„å‘½ä¸­ï¼Ÿ(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜†) å…¶å®å°±æ˜¯ä¸€è‡´æ€§Hashç®—æ³•ã€‚ä»¥å‰æœ‰çœ‹è¿‡ï¼Œå¯æƒœé¢è¯•çš„æ—¶å€™è„‘è¢‹å°±ç©ºäº†ï¼Œåªè®°å¾—ä¸€ä¸ªç¯ï¼Œæœç„¶è¿˜æ˜¯è¦å®è·µå•Šã€‚å‚è€ƒèµ„æ–™ï¼šConsistent Hashingäº”åˆ†é’Ÿç†è§£ä¸€è‡´æ€§å“ˆå¸Œç®—æ³•(consistent hashing) é¡¹ç›®ä¸­å…·ä½“æ˜¯æ€æ ·ä½¿ç”¨Redisçš„(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜†) æ ¹æ®å®é™…æƒ…å†µå›ç­”å§ã€‚ã€‚ã€‚ã€‚æˆ‘æ˜¯ä¸»è¦åšæƒé™æ§åˆ¶æ—¶ç”¨åˆ°äº†Redisï¼Œå°†ç”¨æˆ·Idå’Œæƒé™Codeæ‹¼æ¥åœ¨ä¸€èµ·ä½œä¸ºä¸€ä¸ªkeyï¼Œæ”¾åˆ°Redisçš„é›†åˆä¸­ï¼Œåœ¨éªŒè¯æŸä¸€ç”¨æˆ·æ˜¯å¦æœ‰æŒ‡å®šæƒé™æ—¶ï¼Œåªéœ€éªŒè¯é›†åˆä¸­æ˜¯å¦æœ‰ç”¨æˆ·Idå’Œæƒé™Codeæ‹¼æ¥çš„keyå³å¯ ç®—æ³•ç›¸å…³åˆ¤æ–­ä¸€ä¸ªæ•°å­—æ˜¯å¦ä¸ºå¿«ä¹æ•°å­—(é‡è¦ç¨‹åº¦:â˜…â˜†â˜†â˜†â˜†) leetcodeç¬¬202é¢˜é“¾æ¥ ç»™å®šä¸€ä¸ªä¹±åºæ•°ç»„å’Œä¸€ä¸ªç›®æ ‡æ•°å­— æ‰¾åˆ°å’Œä¸ºè¿™ä¸ªæ•°å­—çš„ä¸¤ä¸ªæ•°å­— æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘(é‡è¦ç¨‹åº¦:â˜…â˜†â˜†â˜†â˜†) leetcodeç¬¬ä¸€é¢˜é“¾æ¥ å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªé“¾è¡¨æœ‰æ²¡æœ‰ç¯(é‡è¦ç¨‹åº¦:â˜…â˜†â˜†â˜†â˜†) ç”¨å¿«æ…¢æŒ‡é’ˆ åˆ é™¤å­—ç¬¦ä¸²ä¸­çš„ç©ºæ ¼ åªç•™ä¸€ä¸ª(é‡è¦ç¨‹åº¦:â˜…â˜†â˜†â˜†â˜†) è¿™ä¸ªæ¯”è¾ƒç®€å•ã€‚ã€‚ã€‚ã€‚ äºŒå‰æ ‘å±‚åºéå†(é‡è¦ç¨‹åº¦:â˜…â˜…â˜†â˜†â˜†) åˆ©ç”¨é˜Ÿåˆ—å°±å¯ä»¥äº† åœ°é“ç¥¨ä»·æ˜¯å¦‚ä½•è®¡ç®—çš„(é‡è¦ç¨‹åº¦:â˜…â˜…â˜†â˜†â˜†) ä¸çŸ¥é“æ­£ç¡®ç­”æ¡ˆï¼Œæ„Ÿè§‰æ˜¯å›¾çš„æœ€çŸ­è·¯å¾„ç®—æ³•ç›¸å…³çš„ã€‚ Elasticsearchç›¸å…³ä¸ºä»€ä¹ˆè¦ç”¨Elasticsearch(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜†) å…¶å®å¯¹Esçš„äº†è§£è¿˜æ˜¯æ¯”è¾ƒå°‘çš„ï¼Œå› ä¸ºæ²¡åšå¤šä¹…å°±å»å†™å‘çˆ¹ä»£ç†å•†äº†ğŸ˜–ã€‚ä¸ªäººè§‰å¾—é¡¹ç›®ä¸­ç”¨Esçš„åŸå› ä¸€æ˜¯å¯ä»¥åšåˆ†è¯ï¼ŒäºŒæ˜¯Esä¸­é‡‡ç”¨çš„æ˜¯å€’æ’ç´¢å¼•æ‰€ä»¥æ€§èƒ½æ¯”è¾ƒå¥½ï¼Œä¸‰æ˜¯Esæ˜¯ä¸ªåˆ†å¸ƒå¼çš„æœç´¢æœåŠ¡ï¼Œå¯¹å„ä¸ªèŠ‚ç‚¹çš„é…ç½®è¿˜æ˜¯å¾ˆç®€å•æ–¹ä¾¿çš„ Elasticsearchä¸­çš„æ•°æ®æ¥æºæ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•åšåŒæ­¥(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜†) æ•°æ®æ˜¯æ¥è‡ªå…¶ä»–éƒ¨é—¨çš„æ•°æ®åº“ï¼Œä¼šåœ¨ä¸€å¼€å§‹å†™pythonè„šæœ¬åšå…¨é‡æ›´æ–°ï¼Œä¹‹ååˆ©ç”¨RabbitMQåšå¢é‡æ›´æ–°ï¼Œå°±æ˜¯æ•°æ®æ›´æ”¹ä¹‹åï¼Œæ•°æ®æä¾›æ–¹å°†æ›´æ”¹çš„æ•°æ®æ’å…¥åˆ°æŒ‡å®šæ¶ˆæ¯é˜Ÿåˆ—ï¼Œç”±å¯¹åº”çš„æ¶ˆè´¹è€…ç´¢å¼•åˆ°Esä¸­ æ¥ä¸Šä¸ªé—®é¢˜ï¼Œåˆ©ç”¨æ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¼šå¯¹å¯¹æ–¹ä»£ç é€ æˆä¾µå…¥çš„ï¼Œè¿˜æœ‰æ²¡æœ‰åˆ«çš„æ–¹å¼(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜†â˜†) è¿˜å¯ä»¥è¯»MySQLçš„binlog å‘æ•£æ€ç»´çš„é¢˜ä»¥ä¸‹é¢˜éƒ½æ˜¯æ²¡æœ‰æ­£ç¡®ç­”æ¡ˆçš„ï¼Œä¸çŸ¥é“æ˜¯æƒ³è€ƒæ€ç»´ï¼Œè¿˜æ˜¯å‹åŠ›é¢è¯•ï¼Œå°±åªå†™é¢˜ç›®ï¼Œä¸å†™å›ç­”äº†ã€‚ã€‚ã€‚ ç”»ä¸€ä¸‹å¿ƒä¸­æˆ¿æ ‘äººçš„å…³ç³»(é‡è¦ç¨‹åº¦:â˜…â˜†â˜†â˜†â˜†)ç»™ä½ ä¸€å—åœ°å»ºæˆ¿å¦‚ä½•è§„åˆ’(é‡è¦ç¨‹åº¦:â˜…â˜†â˜†â˜†â˜†)ä¼°è®¡äºŒå·çº¿æœ‰å‡ è¾†è½¦åœ¨è¿è¡Œ(é‡è¦ç¨‹åº¦:â˜…â˜†â˜†â˜†â˜†) å…¶ä»–Thrifté€šä¿¡åè®®(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜†â˜†) è¿™ä¸ªé—®é¢˜è¢«é—®äº†ä¸¤éï¼Œç„¶è€Œç°åœ¨è¿˜æ˜¯ä¸çŸ¥é“ã€‚ã€‚ã€‚ä»€ä¹ˆä¸œè¥¿éƒ½ä¸èƒ½åœç•™åœ¨åªä¼šç”¨çš„é˜¶æ®µå•Š~ gitç›¸å…³(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜…) ä¸€äº›gitç›¸å…³çš„é—®é¢˜ï¼Œæ¯”å¦‚å¦‚ä½•åšåˆ†æ”¯ç®¡ç†(git flow)ï¼Œrebaseå’Œmergeçš„åŒºåˆ«(mergeæ“ä½œä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„èŠ‚ç‚¹)ç­‰ç­‰ã€‚ã€‚ã€‚ å¦‚ä½•å­¦ä¹ ä¸€é—¨æ–°æŠ€æœ¯(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜†â˜†) google+å®˜ç½‘+stackoverflow+github æ¯”è¾ƒçˆ±é€›çš„ç½‘ç«™å’Œçˆ±çœ‹çš„ä¹¦(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜†â˜†) æ ¹æ®å®é™…æƒ…å†µå›ç­”å§ã€‚ã€‚ã€‚ äº†ä¸äº†è§£å¾®æœåŠ¡(é‡è¦ç¨‹åº¦:â˜…â˜…â˜†â˜†â˜†) ç®€å•äº†è§£è¿‡ã€‚ã€‚ã€‚å‚è€ƒèµ„æ–™ï¼šåŸºäºå¾®æœåŠ¡çš„è½¯ä»¶æ¶æ„æ¨¡å¼ é’ˆå¯¹ç®€å†ä¸­çš„é¡¹ç›®é—®ä¸€äº›é—®é¢˜(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜…) å°±æ˜¯æ ¹æ®ç®€å†ä¸Šçš„é¡¹ç›®é—®ä¸€äº›ä¸œè¥¿ï¼Œæ¯”å¦‚æƒé™æ§åˆ¶æ˜¯æ€ä¹ˆåšçš„ï¼Œæœ‰æ²¡æœ‰ç¢°åˆ°è¿‡æ¯”è¾ƒéš¾è§£å†³çš„é—®é¢˜ä¹‹ç±»çš„ï¼Œä¸å…·ä½“åˆ—ä¸¾äº†ï¼Œåªè¦ç®€å†ä¸Šçš„å†…å®¹æ˜¯çœŸå®çš„åŸºæœ¬éƒ½æ²¡å•¥é—®é¢˜ ä¸ºä»€ä¹ˆè¦ç¦»èŒ(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜…) è¢«é—®äº†néï¼ŒæŒºä¸å¥½å›ç­”çš„ä¸€ä¸ªé—®é¢˜ï¼Œæ¯•ç«Ÿä¸ç®—å®ä¹ æœŸå·¥ä½œè¿˜æ²¡æ»¡ä¸€å¹´ï¼Œè¿™ä¸ªæ—¶å€™è·³æ§½å¾ˆå®¹æ˜“è®©äººè§‰å¾—ä¸å®‰ç¨³ã€‚ã€‚ã€‚ã€‚ å¯¹å…¬å¸è¿˜æœ‰ä»€ä¹ˆé—®é¢˜(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜…) åŸºæœ¬æ¯è½®é¢è¯•ç»“æŸéƒ½ä¼šé—®çš„ä¸€ä¸ªé—®é¢˜ï¼Œä¸€å¼€å§‹ä¹Ÿæ²¡å½“å›äº‹ï¼Œç›´åˆ°æœ‰å®¶å…¬å¸å±…ç„¶æŒ‚åœ¨å››é¢çš„è¿™ä¸ªé—®é¢˜ä¸Šï¼Œæˆ‘ä¹Ÿæ˜¯è›®é†‰çš„ğŸ˜‚ï¼Œæœç„¶è¨€å¤šå¿…å¤±å•ŠğŸŒã€‚ã€‚ã€‚ åœ¨***å…¬å¸æœ€å¤§çš„æ”¶è·æ˜¯ä»€ä¹ˆ(é‡è¦ç¨‹åº¦:â˜…â˜…â˜…â˜…â˜…) å¯¹äºæˆ‘æ¥è¯´ï¼Œè§‰å¾—æœ€å¤§çš„æ”¶è·å°±æ˜¯å¯¹ä¼ä¸šçº§çš„åº”ç”¨æœ‰äº†ä¸€ä¸ªå¤§è‡´çš„äº†è§£ï¼Œä¼ä¸šé‡Œçš„é¡¹ç›®ä¸åƒå­¦æ ¡çš„è¯¾ç¨‹ä½œä¸šï¼Œåªè¦jdbcè¿æ¥æ•°æ®åº“å®ŒæˆåŠŸèƒ½å°±å¯ä»¥äº†ï¼Œä¼ä¸šçš„é¡¹ç›®è¦è€ƒè™‘å¾ˆå¤šä¸œè¥¿ï¼Œæ¯”å¦‚è¯´ä¸ºäº†æé«˜å¯ç”¨æ€§ï¼Œè¦éƒ¨ç½²åœ¨å¤šå°æœåŠ¡å™¨ä¸Šï¼Œç”¨nginxåšè´Ÿè½½å‡è¡¡ï¼Œè¿˜æœ‰å°±æ˜¯ç”¨ç¼“å­˜ï¼Œå¼‚æ­¥ä¹‹ç±»æ¥æé«˜æ¥å£æ€§èƒ½ã€‚ç„¶åï¼Œä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦åˆ°SOAï¼Œè¿™ç§é¢å‘æœåŠ¡çš„æ¶æ„ã€‚ä¹Ÿäº†è§£åˆ°ä¸€ä¸ªå¥½çš„åº”ç”¨ï¼Œé™¤äº†å¼€å‘æœ¬èº«ï¼Œä¸€äº›è‡ªåŠ¨åŒ–å‘å¸ƒç³»ç»Ÿå’Œç›‘æ§ç³»ç»Ÿä¹Ÿæ˜¯å¿…ä¸å¯å°‘çš„ã€‚å½“ç„¶ï¼Œè¿˜è®¤è¯†äº†ä¸€ç¾¤ä¸‰è§‚åˆçš„å°ä¼™ä¼´~~~ é¢è¯•çœŸçœŸæ˜¯ä»¶å¾ˆå¿ƒç´¯çš„äº‹æƒ…ï¼Œæ¯æ¬¡é¢å®Œéƒ½æ„Ÿè§‰è¢«æ‹”äº†å±‚çš®ï¼Œå¸Œæœ›ä¸¤å¹´å†…ä¸è¦åœ¨é¢è¯•äº†ğŸ˜‚ã€‚åå¤©å°±è¦å…¥èŒäº†ï¼Œæƒ³æƒ³è¿˜æœ‰ç‚¹å°ç´§å¼ å‘¢ï¼Œå»çœ‹å­¦å”æ¨èçš„ç¾å‰§å‹å‹æƒŠã€‚ã€‚ã€‚ éƒ½çœ‹åˆ°è¿™äº†ï¼Œå…³æ³¨ä¸ªå…¬ä¼—å·å†èµ°å§ğŸ™ˆ","raw":null,"content":null,"categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/categories/éšç¬”/"}],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/tags/éšç¬”/"}]},{"title":"ã€è¯‘ã€‘ä¼˜åŒ–MySQLä¸­çš„åˆ†é¡µ","slug":"optimized-pagiantion-mysql","date":"2016-05-28T01:45:42.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/05/28/optimized-pagiantion-mysql/","link":"","permalink":"http://yemengying.com/2016/05/28/optimized-pagiantion-mysql/","excerpt":"ä¸€é“é¢è¯•çš„é—®é¢˜ï¼Œå½“MySQLè¡¨ä¸­æœ‰æ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™å¦‚ä½•åšåˆ†é¡µã€‚ã€‚ã€‚ã€‚å½“æ—¶åªçŸ¥é“åœ¨æ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™å¯ä»¥åˆ†è¡¨ï¼Œä½†ä¸çŸ¥é“ä¸åˆ†è¡¨æ—¶å¯ä»¥æ€ä¹ˆåšã€‚ã€‚ã€‚ã€‚å”‰ï¼Œè°è®©ä»£ç†å•†å°±é‚£ä¹ˆå‡ æ¡æ•°æ®ï¼Œä¸€ä¸ªç®€å•çš„limitï¼Œoffsetå°±å®Œå…¨holdä½äº†(æ‚è„¸ğŸ™ˆ)ã€‚ã€‚ã€‚","keywords":null,"text":"ä¸€é“é¢è¯•çš„é—®é¢˜ï¼Œå½“MySQLè¡¨ä¸­æœ‰æ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™å¦‚ä½•åšåˆ†é¡µã€‚ã€‚ã€‚ã€‚å½“æ—¶åªçŸ¥é“åœ¨æ•°æ®é‡å¾ˆå¤§çš„æ—¶å€™å¯ä»¥åˆ†è¡¨ï¼Œä½†ä¸çŸ¥é“ä¸åˆ†è¡¨æ—¶å¯ä»¥æ€ä¹ˆåšã€‚ã€‚ã€‚ã€‚å”‰ï¼Œè°è®©ä»£ç†å•†å°±é‚£ä¹ˆå‡ æ¡æ•°æ®ï¼Œä¸€ä¸ªç®€å•çš„limitï¼Œoffsetå°±å®Œå…¨holdä½äº†(æ‚è„¸ğŸ™ˆ)ã€‚ã€‚ã€‚ ç¿»è¯‘ä¸€ç¯‡å…³äºä¼˜åŒ–MySQLä¸­çš„åˆ†é¡µçš„æ–‡ç« ï¼ŒåŸæ–‡åœ°å€ï¼šOptimized Pagination using MySQLï¼Œè°¢è°¢ï¼Œ3Qï¼Œåº·æ¡‘é˜¿ç±³è¾¾~~~ å¾ˆå¤šåº”ç”¨å¾€å¾€åªå±•ç¤ºæœ€æ–°æˆ–æœ€çƒ­é—¨çš„å‡ æ¡è®°å½•ï¼Œä½†ä¸ºäº†æ—§è®°å½•ä»ç„¶å¯è®¿é—®ï¼Œæ‰€ä»¥å°±éœ€è¦ä¸ªåˆ†é¡µçš„å¯¼èˆªæ ã€‚ç„¶è€Œï¼Œå¦‚ä½•é€šè¿‡MySQLæ›´å¥½çš„å®ç°åˆ†é¡µï¼Œå§‹ç»ˆæ˜¯æ¯”è¾ƒä»¤äººå¤´ç–¼çš„é—®é¢˜ã€‚è™½ç„¶æ²¡æœ‰æ‹¿æ¥å°±èƒ½ç”¨çš„è§£å†³åŠæ³•ï¼Œä½†äº†è§£æ•°æ®åº“çš„åº•å±‚æˆ–å¤šæˆ–å°‘æœ‰åŠ©äºä¼˜åŒ–åˆ†é¡µæŸ¥è¯¢ã€‚æˆ‘ä»¬å…ˆä»ä¸€ä¸ªå¸¸ç”¨ä½†æ€§èƒ½å¾ˆå·®çš„æŸ¥è¯¢æ¥çœ‹ä¸€çœ‹ã€‚1234SELECT *FROM cityORDER BY id DESCLIMIT 0, 15 è¿™ä¸ªæŸ¥è¯¢è€—æ—¶0.00secã€‚Soï¼Œè¿™ä¸ªæŸ¥è¯¢æœ‰ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿå®é™…ä¸Šï¼Œè¿™ä¸ªæŸ¥è¯¢è¯­å¥å’Œå‚æ•°éƒ½æ²¡æœ‰é—®é¢˜ï¼Œå› ä¸ºå®ƒç”¨åˆ°äº†ä¸‹é¢è¡¨çš„ä¸»é”®ï¼Œè€Œä¸”åªè¯»å–15æ¡è®°å½•ã€‚12345CREATE TABLE city ( id int(10) unsigned NOT NULL AUTO_INCREMENT, city varchar(128) NOT NULL, PRIMARY KEY (id)) ENGINE=InnoDB; çœŸæ­£çš„é—®é¢˜åœ¨äºoffset(åˆ†é¡µåç§»é‡)å¾ˆå¤§çš„æ—¶å€™ï¼Œåƒä¸‹é¢è¿™æ ·ï¼š1234SELECT *FROM cityORDER BY id DESCLIMIT 100000, 15; ä¸Šé¢çš„æŸ¥è¯¢åœ¨æœ‰2Mè¡Œè®°å½•æ—¶éœ€è¦0.22secï¼Œé€šè¿‡EXPLAINæŸ¥çœ‹SQLçš„æ‰§è¡Œè®¡åˆ’å¯ä»¥å‘ç°è¯¥SQLæ£€ç´¢äº†100015è¡Œï¼Œä½†æœ€ååªéœ€è¦15è¡Œã€‚å¤§çš„åˆ†é¡µåç§»é‡ä¼šå¢åŠ ä½¿ç”¨çš„æ•°æ®ï¼ŒMySQLä¼šå°†å¤§é‡æœ€ç»ˆä¸ä¼šä½¿ç”¨çš„æ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ã€‚å°±ç®—æˆ‘ä»¬å‡è®¾å¤§éƒ¨åˆ†ç½‘ç«™çš„ç”¨æˆ·åªè®¿é—®å‰å‡ é¡µæ•°æ®ï¼Œä½†å°‘é‡çš„å¤§çš„åˆ†é¡µåç§»é‡çš„è¯·æ±‚ä¹Ÿä¼šå¯¹æ•´ä¸ªç³»ç»Ÿé€ æˆå±å®³ã€‚Facebookæ„è¯†åˆ°äº†è¿™ä¸€ç‚¹ï¼Œä½†Facebookå¹¶æ²¡æœ‰ä¸ºäº†æ¯ç§’å¯ä»¥å¤„ç†æ›´å¤šçš„è¯·æ±‚è€Œå»ä¼˜åŒ–æ•°æ®åº“ï¼Œè€Œæ˜¯å°†é‡å¿ƒæ”¾åœ¨å°†è¯·æ±‚å“åº”æ—¶é—´çš„æ–¹å·®å˜å°ã€‚å¯¹äºåˆ†é¡µè¯·æ±‚ï¼Œè¿˜æœ‰ä¸€ä¸ªä¿¡æ¯ä¹Ÿå¾ˆé‡è¦ï¼Œå°±æ˜¯æ€»å…±çš„è®°å½•æ•°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æŸ¥è¯¢å¾ˆå®¹æ˜“çš„è·å–æ€»çš„è®°å½•æ•°ã€‚12SELECT COUNT(*)FROM city; ç„¶è€Œï¼Œä¸Šé¢çš„SQLåœ¨é‡‡ç”¨InnoDBä¸ºå­˜å‚¨å¼•æ“æ—¶éœ€è¦è€—è´¹9.28secã€‚ä¸€ä¸ªä¸æ­£ç¡®çš„ä¼˜åŒ–æ˜¯é‡‡ç”¨SQL_CALC_FOUND_ROWS,SQL_CALC_FOUND_ROWSå¯ä»¥åœ¨èƒ½å¤Ÿåœ¨åˆ†é¡µæŸ¥è¯¢æ—¶äº‹å…ˆå‡†å¤‡å¥½ç¬¦åˆæ¡ä»¶çš„è®°å½•æ•°ï¼Œéšååªè¦æ‰§è¡Œä¸€å¥select FOUND_ROWS(); å°±èƒ½è·å¾—æ€»è®°å½•æ•°ã€‚ä½†æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ŒæŸ¥è¯¢è¯­å¥ç®€çŸ­å¹¶ä¸æ„å‘³ç€æ€§èƒ½çš„æé«˜ã€‚ä¸å¹¸çš„æ˜¯ï¼Œè¿™ç§åˆ†é¡µæŸ¥è¯¢æ–¹å¼åœ¨è®¸å¤šä¸»æµæ¡†æ¶ä¸­éƒ½æœ‰ç”¨åˆ°ï¼Œä¸‹é¢çœ‹çœ‹è¿™ä¸ªè¯­å¥çš„æŸ¥è¯¢æ€§èƒ½ã€‚1234SELECT SQL_CALC_FOUND_ROWS *FROM cityORDER BY id DESCLIMIT 100000, 15; è¿™ä¸ªè¯­å¥è€—æ—¶20.02secï¼Œæ˜¯ä¸Šä¸€ä¸ªçš„ä¸¤å€ã€‚äº‹å®è¯æ˜ä½¿ç”¨SQL_CALC_FOUND_ROWSåšåˆ†é¡µæ˜¯å¾ˆç³Ÿç³•çš„æƒ³æ³•ã€‚ä¸‹é¢æ¥çœ‹çœ‹åˆ°åº•å¦‚ä½•ä¼˜åŒ–ã€‚æ–‡ç« åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œç¬¬ä¸€éƒ¨åˆ†æ˜¯å¦‚ä½•è·å–è®°å½•çš„æ€»æ•°ç›®ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯è·å–çœŸæ­£çš„è®°å½•ã€‚ é«˜æ•ˆçš„è®¡ç®—è¡Œæ•°å¦‚æœé‡‡ç”¨çš„å¼•æ“æ˜¯MyISAMï¼Œå¯ä»¥ç›´æ¥æ‰§è¡ŒCOUNT(*)å»è·å–è¡Œæ•°å³å¯ã€‚ç›¸ä¼¼çš„ï¼Œåœ¨å †è¡¨ä¸­ä¹Ÿä¼šå°†è¡Œæ•°å­˜å‚¨åˆ°è¡¨çš„å…ƒä¿¡æ¯ä¸­ã€‚ä½†å¦‚æœå¼•æ“æ˜¯InnoDBæƒ…å†µå°±ä¼šå¤æ‚ä¸€äº›ï¼Œå› ä¸ºInnoDBä¸ä¿å­˜è¡¨çš„å…·ä½“è¡Œæ•°ã€‚æˆ‘ä»¬å¯ä»¥å°†è¡Œæ•°ç¼“å­˜èµ·æ¥ï¼Œç„¶åå¯ä»¥é€šè¿‡ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹å®šæœŸæ›´æ–°æˆ–è€…ç”¨æˆ·çš„æŸäº›æ“ä½œå¯¼è‡´ç¼“å­˜å¤±æ•ˆæ—¶ï¼Œæ‰§è¡Œä¸‹é¢çš„è¯­å¥ï¼š123SELECT COUNT(*)FROM cityUSE INDEX(PRIMARY); è·å–è®°å½•ä¸‹é¢è¿›å…¥è¿™ç¯‡æ–‡ç« æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œè·å–åˆ†é¡µè¦å±•ç¤ºçš„è®°å½•ã€‚ä¸Šé¢å·²ç»è¯´è¿‡äº†ï¼Œå¤§çš„åç§»é‡ä¼šå½±å“æ€§èƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦é‡å†™æŸ¥è¯¢è¯­å¥ã€‚ä¸ºäº†æ¼”ç¤ºï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„è¡¨â€œnewsâ€ï¼ŒæŒ‰ç…§æ—¶äº‹æ€§æ’åº(æœ€æ–°å‘å¸ƒçš„åœ¨æœ€å‰é¢)ï¼Œå®ç°ä¸€ä¸ªé«˜æ€§èƒ½çš„åˆ†é¡µã€‚ä¸ºäº†ç®€å•ï¼Œæˆ‘ä»¬å°±å‡è®¾æœ€æ–°å‘å¸ƒçš„æ–°é—»çš„Idä¹Ÿæ˜¯æœ€å¤§çš„ã€‚1234CREATE TABLE news( id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT, title VARCHAR(128) NOT NULL) ENGINE=InnoDB; ä¸€ä¸ªæ¯”è¾ƒé«˜æ•ˆçš„æ–¹å¼æ˜¯åŸºäºç”¨æˆ·å±•ç¤ºçš„æœ€åä¸€ä¸ªæ–°é—»Idã€‚æŸ¥è¯¢ä¸‹ä¸€é¡µçš„è¯­å¥å¦‚ä¸‹ï¼Œéœ€è¦ä¼ å…¥å½“å‰é¡µé¢å±•ç¤ºçš„æœ€åä¸€ä¸ªIdã€‚1234SELECT *FROM news WHERE id &lt; $last_idORDER BY id DESCLIMIT $perpage æŸ¥è¯¢ä¸Šä¸€é¡µçš„è¯­å¥ç±»ä¼¼ï¼Œåªä¸è¿‡éœ€è¦ä¼ å…¥å½“å‰é¡µçš„ç¬¬ä¸€ä¸ªIdï¼Œå¹¶ä¸”è¦é€†åºã€‚1234SELECT *FROM news WHERE id &gt; $last_idORDER BY id ASCLIMIT $perpage ä¸Šé¢çš„æŸ¥è¯¢æ–¹å¼é€‚åˆå®ç°ç®€æ˜“çš„åˆ†é¡µï¼Œå³ä¸æ˜¾ç¤ºå…·ä½“çš„é¡µæ•°å¯¼èˆªï¼Œåªæ˜¾ç¤ºâ€œä¸Šä¸€é¡µâ€å’Œâ€œä¸‹ä¸€é¡µâ€ï¼Œä¾‹å¦‚åšå®¢ä¸­é¡µè„šæ˜¾ç¤ºâ€œä¸Šä¸€é¡µâ€ï¼Œâ€œä¸‹ä¸€é¡µâ€çš„æŒ‰é’®ã€‚ä½†å¦‚æœè¦å®ç°çœŸæ­£çš„é¡µé¢å¯¼èˆªè¿˜æ˜¯å¾ˆéš¾çš„,ä¸‹é¢çœ‹çœ‹å¦ä¸€ç§æ–¹å¼ã€‚12345678910SELECT idFROM ( SELECT id, ((@cnt:= @cnt + 1) + $perpage - 1) % $perpage cnt FROM news JOIN (SELECT @cnt:= 0)T WHERE id &lt; $last_id ORDER BY id DESC LIMIT $perpage * $buttons)CWHERE cnt = 0; é€šè¿‡ä¸Šé¢çš„è¯­å¥å¯ä»¥ä¸ºæ¯ä¸€ä¸ªåˆ†é¡µçš„æŒ‰é’®è®¡ç®—å‡ºä¸€ä¸ªoffsetå¯¹åº”çš„idã€‚è¿™ç§æ–¹æ³•è¿˜æœ‰ä¸€ä¸ªå¥½å¤„ã€‚å‡è®¾ï¼Œç½‘ç«™ä¸Šæ­£åœ¨å‘å¸ƒä¸€ç‰‡æ–°çš„æ–‡ç« ï¼Œé‚£ä¹ˆæ‰€æœ‰æ–‡ç« çš„ä½ç½®éƒ½ä¼šå¾€åç§»ä¸€ä½ï¼Œæ‰€ä»¥å¦‚æœç”¨æˆ·åœ¨å‘å¸ƒæ–‡ç« æ—¶æ¢é¡µï¼Œé‚£ä¹ˆä»–ä¼šçœ‹è§ä¸€ç¯‡æ–‡ç« ä¸¤æ¬¡ã€‚å¦‚æœå›ºå®šäº†æ¯ä¸ªæŒ‰é’®çš„offset Idï¼Œè¿™ä¸ªé—®é¢˜å°±è¿åˆƒè€Œè§£äº†ã€‚Mark Callaghanå‘è¡¨è¿‡ä¸€ç¯‡ç±»ä¼¼çš„åšå®¢ï¼Œåˆ©ç”¨äº†ç»„åˆç´¢å¼•å’Œä¸¤ä¸ªä½ç½®å˜é‡ï¼Œä½†æ˜¯åŸºæœ¬æ€æƒ³æ˜¯ä¸€è‡´çš„ã€‚å¦‚æœè¡¨ä¸­çš„è®°å½•å¾ˆå°‘è¢«åˆ é™¤ã€ä¿®æ”¹ï¼Œè¿˜å¯ä»¥å°†è®°å½•å¯¹åº”çš„é¡µç å­˜å‚¨åˆ°è¡¨ä¸­ï¼Œå¹¶åœ¨è¯¥åˆ—ä¸Šåˆ›å»ºåˆé€‚çš„ç´¢å¼•ã€‚é‡‡ç”¨è¿™ç§æ–¹å¼ï¼Œå½“æ–°å¢ä¸€ä¸ªè®°å½•çš„æ—¶å€™ï¼Œéœ€è¦æ‰§è¡Œä¸‹é¢çš„æŸ¥è¯¢é‡æ–°ç”Ÿæˆå¯¹åº”çš„é¡µå·ã€‚12SET @p:= 0;UPDATE news SET page=CEIL((@p:= @p + 1) / $perpage) ORDER BY id DESC; å½“ç„¶ï¼Œä¹Ÿå¯ä»¥æ–°å¢ä¸€ä¸ªä¸“ç”¨äºåˆ†é¡µçš„è¡¨ï¼Œå¯ä»¥ç”¨ä¸ªåå°ç¨‹åºæ¥ç»´æŠ¤ã€‚12345678UPDATE pagination TJOIN ( SELECT id, CEIL((@p:= @p + 1) / $perpage) page FROM news ORDER BY id)CON C.id = T.idSET T.page = C.page; ç°åœ¨æƒ³è·å–ä»»æ„ä¸€é¡µçš„å…ƒç´ å°±å¾ˆç®€å•äº†ï¼š1234SELECT *FROM news AJOIN pagination B ON A.id=B.IDWHERE page=$offset; è¿˜æœ‰å¦å¤–ä¸€ç§ä¸ä¸Šç§æ–¹æ³•æ¯”è¾ƒç›¸ä¼¼çš„æ–¹æ³•æ¥åšåˆ†é¡µï¼Œè¿™ç§æ–¹å¼æ¯”è¾ƒè¯•ç”¨äºæ•°æ®é›†ç›¸å¯¹å°ï¼Œå¹¶ä¸”æ²¡æœ‰å¯ç”¨çš„ç´¢å¼•çš„æƒ…å†µä¸‹â€”æ¯”å¦‚å¤„ç†æœç´¢ç»“æœæ—¶ã€‚åœ¨ä¸€ä¸ªæ™®é€šçš„æœåŠ¡å™¨ä¸Šæ‰§è¡Œä¸‹é¢çš„æŸ¥è¯¢ï¼Œå½“æœ‰2Mæ¡è®°å½•æ—¶ï¼Œè¦è€—è´¹2secå·¦å³ã€‚è¿™ç§æ–¹å¼æ¯”è¾ƒç®€å•ï¼Œåˆ›å»ºä¸€ä¸ªç”¨æ¥å­˜å‚¨æ‰€æœ‰Idçš„ä¸´æ—¶è¡¨å³å¯(è¿™ä¹Ÿæ˜¯æœ€è€—è´¹æ€§èƒ½çš„åœ°æ–¹)ã€‚12345CREATE TEMPORARY TABLE _tmp (KEY SORT(random))SELECT id, FLOOR(RAND() * 0x8000000) randomFROM city;ALTER TABLE _tmp ADD OFFSET INT UNSIGNED PRIMARY KEY AUTO_INCREMENT, DROP INDEX SORT, ORDER BY random; æ¥ä¸‹æ¥å°±å¯ä»¥å‘ä¸‹é¢ä¸€æ ·æ‰§è¡Œåˆ†é¡µæŸ¥è¯¢äº†ã€‚12345SELECT *FROM _tmpWHERE OFFSET &gt;= $offsetORDER BY OFFSETLIMIT $perpage; â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ä¿ºåªæ˜¯ä¸ªåˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-ç®€å•æ¥è¯´ï¼Œå¯¹äºåˆ†é¡µçš„ä¼˜åŒ–å°±æ˜¯ã€‚ã€‚ã€‚é¿å…æ•°æ®é‡å¤§æ—¶æ‰«æè¿‡å¤šçš„è®°å½•ã€‚åšå®¢æ¯”è¾ƒé•¿ï¼Œæ‰€ä»¥ç¿»è¯‘çš„æœ‰äº›ç²—ç³™ã€‚ã€‚ã€‚ï¼Œä¹‹åä¼šåœ¨å¥½å¥½æ£€æŸ¥ä¸€éçš„ã€‚åœ¨è‡ªå·±åšæµ‹è¯•æ—¶ï¼Œæœ‰äº›æŸ¥è¯¢æ—¶é—´ä¸ä½œè€…æœ‰ç‚¹ä¸ä¸€è‡´ï¼Œä¸è¿‡ä½œè€…è¿™ç¯‡åšå®¢æ˜¯å†™äº2011å¹´çš„ï¼Œso~ä¸è¦åœ¨æ„å…·ä½“æ•°æ®ï¼Œé¢†ä¼šç²¾ç¥å§~~ æ¬¢è¿æŒ‡æ­£é”™è¯¯ï¼Œæ¬¢è¿ä¸€èµ·è®¨è®ºï¼ï¼ï¼ å›½é™…æƒ¯ä¾‹ï¼Œwuliå…‰æ´™ç»“å°¾~~","raw":null,"content":null,"categories":[{"name":"MySQL","slug":"MySQL","permalink":"http://yemengying.com/categories/MySQL/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"http://yemengying.com/tags/MySQL/"}]},{"title":"MySQLè°ƒä¼˜","slug":"mysql-tuning","date":"2016-05-24T13:16:33.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/05/24/mysql-tuning/","link":"","permalink":"http://yemengying.com/2016/05/24/mysql-tuning/","excerpt":"å•¦å•¦å•¦ï¼Œå•¦å•¦å•¦ï¼Œæˆ‘æ˜¯å–æŠ¥çš„å°è¡Œå®¶~~","keywords":null,"text":"å•¦å•¦å•¦ï¼Œå•¦å•¦å•¦ï¼Œæˆ‘æ˜¯å–æŠ¥çš„å°è¡Œå®¶~~ å…ˆåˆ†äº«ä¸ªè„‘æ´æ‰“å¼€çš„mvï¼Œcoldplayæ–°å•up&amp;upï¼Œçœ‹çœ‹ä¼šé£çš„æµ·é¾ŸğŸ¢ï¼Œä¸€ç‚¹ä¹Ÿä¸ç²¾å½©ï¼Œå°±çœ‹äº†30å¤šéè€Œå·²ğŸ˜‚ã€‚ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-æˆ‘æ˜¯é¢„ç¤ºç”»é£è½¬å˜åˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-æ ¹æ®è§†é¢‘(é“¾æ¥)æ•´ç†ã€‚ ä¸ºä»€ä¹ˆè¦è¿›è¡Œä¼˜åŒ–ï¼Ÿ é¿å…ç”±æ•°æ®åº“é“¾æ¥timeoutäº§ç”Ÿé¡µé¢5xxçš„é”™è¯¯ é¿å…ç”±äºæ…¢æŸ¥è¯¢é€ æˆé¡µé¢æ— æ³•åŠ è½½ é¿å…ç”±äºé˜»å¡é€ æˆæ•°æ®æ— æ³•æäº¤ ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ å¯ä»¥ä»å“ªå‡ ä¸ªæ–¹é¢è¿›è¡Œæ•°æ®åº“ä¼˜åŒ–ï¼Ÿä»å›¾ä¸­å¯ä»¥çœ‹å‡ºï¼ŒSQLåŠç´¢å¼•çš„ä¼˜åŒ–æ˜¯æœ€é‡è¦çš„ï¼Œæˆæœ¬æœ€ä½æ•ˆæœæœ€å¥½ã€‚ä¸‹é¢åˆ†åˆ«æ¥çœ‹çœ‹å¦‚ä½•ä¼˜åŒ–SQLå’Œç´¢å¼•ã€‚ SQLä¼˜åŒ–æ…¢æŸ¥è¯¢æ—¥å¿—é…ç½®å¯ä»¥ä½¿ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—å¯¹æœ‰æ•ˆç‡é—®é¢˜çš„SQLè¿›è¡Œç›‘æ§ã€‚ä¸‹é¢æ˜¯å…³äºå¦‚ä½•å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—å’Œæ…¢æŸ¥è¯¢æ—¥å¿—çš„ä¸€äº›é…ç½®ã€‚12345show variables like 'slow_query_log'; //æŸ¥çœ‹æ˜¯å¦å¼€å¯äº†æ…¢æŸ¥è¯¢set global slow_query_log_file='/home/mysql/sql_log/mysql-slow.log'; //è®¾ç½®æ…¢æŸ¥è¯¢æ—¥å¿—çš„ä½ç½®set global log_queries_not_using_indexes=ON; //æ˜¯å¦è®°å½•æœªä½¿ç”¨ç´¢å¼•çš„æŸ¥è¯¢set global long_query_time=1;//è®¾ç½®è®°å½•è¶…è¿‡å¤šé•¿æ—¶é—´çš„SQLè¯­å¥set global slow_query_log=ON;//è®¾ç½®æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯å¦å¼€å¯ æ…¢æŸ¥è¯¢æ—¥å¿—çš„æ ¼å¼ï¼šè¯¦ç»†çœ‹ä¸€ä¸‹æ¯ä¸€è¡Œéƒ½æ˜¯ä»€ä¹ˆæ„æ€ã€‚æŸ¥è¯¢çš„æ‰§è¡Œæ—¶é—´ Time:140606 12:30:17æ‰§è¡ŒSQLçš„ä¸»æœºä¿¡æ¯ User@Host:root[root] @ localhost []SQLçš„æ‰§è¡Œä¿¡æ¯ Query_time: 0.000024 Lock_time:0.000000 Rows_sent:0 Rows_examined: 0SQLæ‰§è¡Œæ—¶é—´ SET timestamp=1402389328SQLçš„å†…å®¹:show tables åˆ†ææ…¢æŸ¥æ—¥å¿—çš„å·¥å…·1.mysqldumpslowå¯ä»¥ä½¿ç”¨MySQLè‡ªå¸¦çš„æ…¢æŸ¥è¯¢åˆ†æå·¥å…·mysqldumpslowï¼Œå¯ä»¥é€šè¿‡mysqldumpslow -hæ¥æŸ¥çœ‹å…·ä½“çš„ä½¿ç”¨æ–¹æ³•ã€‚eg:mysqldumpslow -t 3 /path/to/mysql-slow-query.log | moreä¸Šé¢çš„å‘½ä»¤ä¼šåˆ—å‡ºæŸ¥è¯¢æ—¶é—´top 3çš„SQLè¯­å¥ï¼Œå…·ä½“æ ¼å¼å¦‚ä¸‹å›¾ï¼Œä¼šåˆ—å‡ºSQLæ‰§è¡Œçš„æ¬¡æ•°ï¼ŒSQLæ¥æ‰§è¡Œçš„æ—¶é—´ï¼Œé”å®šçš„æ—¶é—´ï¼Œå‘é€çš„å‡½æ•°ï¼Œç”±è°åœ¨å“ªä¸ªæœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„å’Œå…·ä½“çš„SQLå†…å®¹ã€‚mysqldumpslowæ˜¯æ¯”è¾ƒå¸¸ç”¨çš„æ…¢æŸ¥è¯¢æ—¥å¿—åˆ†æå·¥å…·ï¼Œä½†æ˜¯åˆ†æç»“æœåŒ…å«çš„ä¿¡æ¯æ¯”è¾ƒå°‘ï¼Œå¯¹äºSQLä¼˜åŒ–æ¥è¯´å¯èƒ½è¿˜ä¸å¤ªå¤Ÿã€‚ä¸‹é¢çœ‹çœ‹å¦ä¸€ç§åˆ†æå·¥å…·ã€‚ 2.pt-query-digestpt-query-digestæ”¯æŒå°†åˆ†æç»“æœä¿å­˜åˆ°æ–‡ä»¶æˆ–æ•°æ®è¡¨ä¸­ã€‚1234567è¾“å‡ºåˆ°æ–‡ä»¶pt-query-digest slow.log &gt; slow_log.reportè¾“å‡ºåˆ°æ•°æ®åº“è¡¨pt-query-digest slow.log -review \\h=127.0.0.1,D=test,p=root,P=3306,u=root,t=query_review \\--creat-reviewtable \\--review-history t=hostname_slow é€šè¿‡pt-query-digest --helpå¯ä»¥æŸ¥çœ‹å…·ä½“çš„ä½¿ç”¨æ–¹å¼ã€‚eg: pt-query-digest /home/mysql/data/mysql-slow.log | moreé€šè¿‡ä¸Šé¢çš„å‘½ä»¤ï¼Œä¼šåˆ—å‡ºæ…¢æŸ¥è¯¢æ—¥å¿—çš„åˆ†æç»“æœï¼Œåˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ã€‚ç¬¬ä¸€éƒ¨åˆ†ä¸­åŒ…å«æ—¥å¿—ä¸­æœ‰å¤šå°‘ä¸ªSQLï¼Œå¤šå°‘ä¸ªä¸åŒçš„SQLï¼ŒSQLæ‰§è¡Œçš„æ—¶é—´èŒƒå›´ï¼Œæ€»çš„æ‰§è¡Œæ—¶é—´ï¼Œæœ€çŸ­çš„æ‰§è¡Œæ—¶é—´ï¼Œæœ€é•¿çš„æ‰§è¡Œæ—¶é—´ï¼Œå¹³å‡æ‰§è¡Œæ—¶é—´ï¼Œæ€»é”å®šæ—¶é—´ï¼Œæ€»å‘é€è¡Œæ•°ï¼Œæ€»æ£€ç´¢è¡Œæ•°ç­‰ç­‰ã€‚ç¬¬äºŒéƒ¨åˆ†åŒ…å«å…³äº è¡¨å’Œæ‰§è¡Œè¯­å¥çš„ç»Ÿè®¡ï¼Œå¯ä»¥çœ‹åˆ°å“ªä¸ªè¡¨çš„å“ªä¸ªæ“ä½œçš„å®è¡Œæ—¶é—´æ˜¯æœ€å¤šçš„ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°å¯¹åº”çš„å“åº”æ—¶é—´å’Œè°ƒç”¨æ¬¡æ•°ã€‚ç¬¬ä¸‰éƒ¨åˆ†å°±æ˜¯å…·ä½“çš„SQLçš„åˆ†æï¼ŒåŒ…æ‹¬å¯¹åº”è¯­å¥æ‰§è¡Œæ—¶é—´ï¼Œé”å®šæ—¶é—´ï¼Œå‘é€è¡Œæ•°ï¼Œæ£€ç´¢è¡Œæ•°ç­‰ç­‰ã€‚ å®šä½æœ‰é—®é¢˜çš„SQLé€šè¿‡ä¸Šé¢çš„æ…¢æŸ¥è¯¢æ—¥å¿—åˆ†ææˆ‘ä»¬å¯ä»¥å®šä½éœ€è¦ä¼˜åŒ–çš„SQL,é€šå¸¸æœ‰ä¸‰ç§ï¼š æŸ¥è¯¢æ¬¡æ•°å¤šä¸”æ¯æ¬¡æŸ¥è¯¢å ç”¨æ—¶é—´é•¿çš„SQLï¼šé€šå¸¸ä¸ºpt-query-digeståˆ†æçš„å‰å‡ ä¸ªæŸ¥è¯¢ã€‚ IOå¤§çš„SQLï¼šæ³¨æ„pt-query-digeståˆ†æä¸­çš„Rows examineé¡¹ æœªå‘½ä¸­ç´¢å¼•çš„SQLï¼š æ³¨æ„pt-query-digeståˆ†æä¸­Rows examineå’ŒRows Sendçš„å¯¹æ¯”ã€‚ é€šè¿‡ExplainæŸ¥è¯¢å’Œåˆ†æSQLçš„æ‰§è¡Œè®¡åˆ’å¯ä»¥é€šè¿‡ExplainæŸ¥è¯¢SQLçš„æ‰§è¡Œè®¡åˆ’ï¼Œä¾‹å­å¦‚ä¸‹ï¼šexplainè¿”å›çš„å„åˆ—çš„å«ä¹‰ï¼š åˆ— å«ä¹‰ table æ˜¾ç¤ºæŸ¥è¯¢æ˜¯å…³äºå“ªä¸ªè¡¨çš„ type å¾ˆé‡è¦çš„åˆ—ï¼Œæ˜¾ç¤ºè¿æ¥ä½¿ç”¨äº†ä½•ç§ç±»å‹ã€‚ä»æœ€å¥½åˆ°æœ€å·®çš„è¿æ¥ç±»å‹ä¸ºconstã€eq_regã€refã€rangeã€indexå’ŒALL possible_keys æ˜¾ç¤ºå¯èƒ½åº”ç”¨åœ¨è¿™å¼ è¡¨ä¸­çš„ç´¢å¼•ã€‚å¦‚æœä¸ºç©ºï¼Œæ²¡æœ‰å¯èƒ½åº”ç”¨çš„ç´¢å¼• key å®é™…ä½¿ç”¨çš„ç´¢å¼•ã€‚å¦‚æœä¸ºNULLï¼Œåˆ™æ²¡æœ‰ä½¿ç”¨ç´¢å¼• key_len ä½¿ç”¨çš„ç´¢å¼•çš„é•¿åº¦ã€‚åœ¨ä¸æŸå¤±ç²¾ç¡®æ€§çš„æƒ…å†µä¸‹ï¼Œé•¿åº¦è¶ŠçŸ­è¶Šå¥½ ref æ˜¾ç¤ºç´¢å¼•çš„å“ªä¸€åˆ—è¢«ä½¿ç”¨äº† rows MYSQLè®¤ä¸ºå¿…é¡»æ£€æŸ¥çš„ç”¨æ¥è¿”å›è¯·æ±‚çš„è¡Œæ•° extra å½“è¿™ä¸€åˆ—çš„å€¼æ˜¯Using filesortæˆ–Using temporaryæ—¶ï¼Œè¯´æ˜æŸ¥è¯¢éœ€è¦ä¼˜åŒ–äº† ç´¢å¼•ä¼˜åŒ–å¦‚ä½•é€‰æ‹©åˆé€‚çš„åˆ—æ¥å»ºç«‹ç´¢å¼• åœ¨whereä»å¥ï¼Œgroup byä»å¥ï¼Œorder byä»å¥ï¼Œonä»å¥ä¸­å‡ºç°çš„åˆ— ç´¢å¼•çš„å­—æ®µè¶Šå°è¶Šå¥½ åœ¨å»ºç«‹è”åˆç´¢å¼•æ—¶ï¼Œç¦»æ•£åº¦å¤§çš„åˆ—æ”¾å¤§è”åˆç´¢å¼•çš„å‰é¢ å¦‚ä½•ç»´æŠ¤å’Œä¼˜åŒ–ç´¢å¼•è¦é¿å…é‡å¤åŠå†—ä½™ç´¢å¼•ï¼Œé‡å¤ç´¢å¼•æ˜¯æŒ‡ç›¸åŒçš„åˆ—ä»¥ç›¸åŒçš„é¡ºåºå»ºç«‹çš„åŒç±»å‹çš„ç´¢å¼•ã€‚å†—ä½™ç´¢å¼•æ˜¯æŒ‡å¤šä¸ªç´¢å¼•çš„å‰ç¼€åˆ—ç›¸åŒï¼Œæˆ–æ˜¯åœ¨è”åˆç´¢å¼•ä¸­åŒ…å«äº†ä¸»é”®çš„ç´¢å¼•ã€‚å¯ä»¥ä½¿ç”¨pt-duplicate-key-checkerå·¥å…·å¯ä»¥æ£€æŸ¥é‡å¤åŠå†—ä½™ç´¢å¼•ã€‚åŒæ—¶è¿˜è¦æ³¨æ„åŠæ—¶åˆ é™¤ç”±äºä¸šåŠ¡å˜æ›´ä¸å†ä½¿ç”¨çš„ç´¢å¼•ã€‚ç›®å‰MySQLä¸­è¿˜æ²¡æœ‰è®°å½•ç´¢å¼•çš„ä½¿ç”¨æƒ…å†µï¼Œä½†åœ¨PerconMuSQLå’ŒMariaDBä¸­å¯ä»¥é€šè¿‡INDEX_STATISTICSè¡¨æ¥æŸ¥çœ‹å“ªäº›ç´¢å¼•æœªä½¿ç”¨ï¼Œåœ¨MySQLä¸­ç›®å‰åªèƒ½é€šè¿‡æ…¢æŸ¥è¯¢æ—¥å¿—é…åˆpt-index-usageå·¥å…·æ¥è¿›è¡Œç´¢å¼•çš„ä½¿ç”¨æƒ…å†µçš„åˆ†æã€‚ æ¬¢è¿æŒ‡æ­£é”™è¯¯ï¼Œæ¬¢è¿ä¸€èµ·è®¨è®º~~","raw":null,"content":null,"categories":[{"name":"MySQL","slug":"MySQL","permalink":"http://yemengying.com/categories/MySQL/"}],"tags":[{"name":"MySQL","slug":"MySQL","permalink":"http://yemengying.com/tags/MySQL/"}]},{"title":"è°ˆè°ˆç ´çª—ç†è®º","slug":"broken-window-theory","date":"2016-05-15T06:02:14.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/05/15/broken-window-theory/","link":"","permalink":"http://yemengying.com/2016/05/15/broken-window-theory/","excerpt":"åœ¨æ¹¾åŒºæ—¥æŠ¥ä¸Šçœ‹åˆ°ç¯‡å…³äºç ´çª—ç†è®º(Broken Window Theory)çš„æ–‡ç« ï¼ŒçœŸæ˜¯é¢‡æœ‰æ„Ÿè§¦ï¼Œæ‰€ä»¥å†³å®šå†™ç¯‡åšå®¢ï¼Œç»“åˆè¿™å‡ ä¸ªæœˆå¼€å‘ä»£ç†å•†ç½‘ç«™çš„å¿ƒ(keng)è·¯(die)å†ç¨‹,è°ˆè°ˆä¸ºä½•ä¸èƒ½å¿½è§†ä¸€ç‚¹ç‚¹ç³Ÿç³•çš„ä»£ç æˆ–è€…ä¸å¥½çš„è®¾è®¡ã€‚","keywords":null,"text":"åœ¨æ¹¾åŒºæ—¥æŠ¥ä¸Šçœ‹åˆ°ç¯‡å…³äºç ´çª—ç†è®º(Broken Window Theory)çš„æ–‡ç« ï¼ŒçœŸæ˜¯é¢‡æœ‰æ„Ÿè§¦ï¼Œæ‰€ä»¥å†³å®šå†™ç¯‡åšå®¢ï¼Œç»“åˆè¿™å‡ ä¸ªæœˆå¼€å‘ä»£ç†å•†ç½‘ç«™çš„å¿ƒ(keng)è·¯(die)å†ç¨‹,è°ˆè°ˆä¸ºä½•ä¸èƒ½å¿½è§†ä¸€ç‚¹ç‚¹ç³Ÿç³•çš„ä»£ç æˆ–è€…ä¸å¥½çš„è®¾è®¡ã€‚ ç ´çª—ç†è®ºå…ˆç®€å•è§£é‡Šä¸‹ä»€ä¹ˆæ˜¯â€œç ´çª—ç†è®ºâ€ï¼Œâ€œç ´çª—ç†è®ºâ€æ˜¯æŒ‡ï¼šå¦‚æœæœ‰äººæ‰“åäº†ä¸€å¹¢å»ºç­‘ç‰©çš„çª—æˆ·ç»ç’ƒï¼Œè€Œè¿™æ‰‡çª—æˆ·åˆå¾—ä¸åˆ°åŠæ—¶çš„ç»´ä¿®ï¼Œåˆ«äººå°±å¯èƒ½å—åˆ°æŸäº›æš—ç¤ºæ€§çš„çºµå®¹å»æ‰“çƒ‚æ›´å¤šçš„çª—æˆ·ã€‚æ¹¾åŒºæ—¥æŠ¥ä¸Šçš„æ–‡ç« ä¸­æ˜¯è¿™æ ·æè¿°ç ´çª—ç†è®ºçš„ï¼š Donâ€™t leave â€œbroken windowsâ€ (bad designs, wrong decisions, or poor code) unrepaired. Fix each one as soon as it is discovered. If there is insufficient time to fix it properly, then board it up. Perhaps you can comment out the offending code, or display a â€œNot Implementedâ€ message, or substitute dummy data instead. Take some action to prevent further damage and to show that youâ€™re on top of the situation.Weâ€™ve seen clean, functional systems deteriorate pretty quickly once windows start breaking. There are other factors that can contribute to software rot, and weâ€™ll touch on some of them elsewhere, but neglect accelerates the rot faster than any other factor. ç®€å•ç¿»è¯‘ä¸€ä¸‹å°±æ˜¯ï¼š ä¸è¦æ”¾ä»»â€œç ´çª—æˆ·â€(ä¸å¥½çš„è®¾è®¡ï¼Œé”™è¯¯çš„å†³å®šæˆ–ç³Ÿç³•çš„ä»£ç )ä¸ç®¡ã€‚è¦å°½é‡åœ¨å‘ç°æ—¶ç«‹åˆ»ä¿®å¤ã€‚å¦‚æœæ²¡æœ‰è¶³å¤Ÿçš„æ—¶é—´è¿›è¡Œé€‚å½“çš„ä¿®å¤ï¼Œå°±å…ˆæŠŠå®ƒä¿ç•™èµ·æ¥ã€‚å¯ä»¥æŠŠå‡ºé—®é¢˜çš„ä»£ç æ”¾åˆ°æ³¨é‡Šä¸­ï¼Œæˆ–æ˜¯æ˜¾ç¤ºâ€œæœªå®ç°â€æ¶ˆæ¯ï¼Œä¹Ÿå¯ç”¨è™šæ‹Ÿæ•°æ®åŠ ä»¥æ›¿ä»£ã€‚æ€»ä¹‹ï¼Œè¦é‡‡å–ä¸€äº›æªæ–½ï¼Œé˜²æ­¢è¿›ä¸€æ­¥çš„æ¶åŒ–ã€‚è¡¨æ˜å±€åŠ¿å°šåœ¨æŒæ§ä¹‹ä¸­ã€‚æœ‰è®¸å¤šæ•´æ´è‰¯å¥½çš„ç³»ç»Ÿåœ¨å‡ºç°â€œç ´çª—â€ä¹‹åç«‹é©¬å´©æºƒã€‚è™½ç„¶ä¿ƒä½¿è½¯ä»¶å´©æºƒçš„åŸå› è¿˜æœ‰å…¶ä»–å› ç´ ï¼ˆæˆ‘ä»¬å°†åœ¨å…¶ä»–åœ°æ–¹æ¥è§¦åˆ°ï¼‰ï¼Œä½†å¯¹â€œç ´çª—â€ç½®ä¹‹ä¸ç†ï¼Œè‚¯å®šä¼šæ›´å¿«åœ°åŠ é€Ÿç³»ç»Ÿå´©æºƒã€‚ äº²èº«æ„Ÿå—å…ˆè¯´è¯´èƒŒæ™¯ï¼Œæ•…äº‹è¦ä»ä¸‰ä¸ªæœˆå‰å¼€å§‹è®²èµ·äº†ï¼Œå½“æ—¶åˆšåˆšè½¬å»æœç´¢ç»„åšéƒ¨é—¨å†…éƒ¨çš„æœç´¢ï¼Œç»„å†…æ€»å…±3ä¸ªäººã€‚æœ¬ä»¥ä¸ºå¯ä»¥è¿œç¦»ä¸šåŠ¡ä»£ç ï¼Œä¸“å¿ƒæŠ€æœ¯ï¼Œå¯ä¸‡ä¸‡æ²¡æƒ³åˆ°Elasticsearchçš„ä¹¦è¿˜æ²¡ç„çƒ­å°±è¢«éƒ¨é—¨leaderå«å»å¼€ä¼šï¼Œè¯´è¦åšä¸€ä¸ªä»£ç†å•†ç³»ç»Ÿï¼Œå¾ˆç´§æ€¥ï¼Œæ˜¯å…¬å¸P0çº§åˆ«çš„é¡¹ç›®ï¼Œå…¨å…¬å¸çš„èµ„æºéƒ½è¦ç»™æˆ‘ä»¬è®©è·¯(äº‹å®è¯æ˜åªæ˜¯ç”»é¥¼ï¼Œå› ä¸ºç°åœ¨è¿ä¸€ä¸ªå›ºå®šå‰ç«¯éƒ½æ²¡äº†)ã€‚å…¶å®è¿™ä¸ªé¡¹ç›®ä¸€å¬å°±æ˜¯ä¸ªæ·±å‘ï¼Œä»å¤´å‘åˆ°è„šéƒ½æ˜¯æ‹’ç»çš„ã€‚å› ä¸ºä¸»æ•°æ®ï¼ˆé¤å…ï¼Œæ´»åŠ¨ï¼Œè®¢å•ï¼‰å…¨åœ¨åˆ«çš„éƒ¨é—¨ï¼Œ85%çš„åŠŸèƒ½éƒ½ä¾èµ–äºå…¶ä»–éƒ¨é—¨çš„æ¥å£(siä¸siå¾ˆç¥å¥‡)ï¼Œæ‰€ä»¥åšè¿™ä¸ªé¡¹ç›®ä¸»è¦å·¥ä½œå°±æ˜¯ã€‚ã€‚ã€‚ã€‚ã€‚é€šè¿‡SOAæˆ–è€…Thriftè°ƒåˆ«äººçš„æ¥å£ã€‚ä¸è¿‡å³ä¾¿çŸ¥é“æ˜¯å‘ä¹Ÿæ²¡åŠæ³•ï¼Œåªæœ‰æœç´¢ç»„åˆšåˆšæˆç«‹æ¯”è¾ƒé—²ï¼Œåªèƒ½æˆ‘ä»¬åš-_-|||ã€‚å½“æ—¶éƒ¨é—¨leaderçš„è¦æ±‚æ˜¯å°é—­å¼€å‘ä¸€å‘¨åŠï¼Œæ‹¿å‡ºä¸ªå¯ç”¨çš„ç‰ˆæœ¬å°±è¡Œï¼Œä¸€å®šè¦å¿«ï¼ï¼ã€‚æ‰€ä»¥æˆ‘ä»¬æœç´¢ç»„çš„ä¸‰ä¸ªäººåŠ ä¸Šä»åˆ«çš„ç»„å€Ÿè°ƒçš„ä¸¤ä¸ªå®ä¹ ç”Ÿå†åŠ ä¸Šä¸¤ä¸ªå‰ç«¯å°±æ¬å»äº†å°é»‘å±‹ï¼Œå¼€å§‹äº†è¿‘ä¸¤å‘¨çš„å°é—­å¼€å‘ã€‚ å¥½äº†ï¼ŒèƒŒæ™¯èŠå®Œäº†ï¼Œè¿›å…¥æ­£é¢˜ï¼ŒèŠèŠä»£ç†å•†æ˜¯æ€ä¹ˆå˜å¾—è¶Šæ¥è¶Šéš¾ç»´æŠ¤çš„ã€‚ä»£ç†å•†çš„å¼€å‘leaderæ˜¯ä¸ªæœç´¢å¤§ç‰›ï¼Œä½†æ²¡åšè¿‡Webå¼€å‘ï¼Œå¯¹Java Webå¼€å‘å¹¶ä¸æ˜¯ååˆ†äº†è§£ã€‚å› ä¸ºéƒ¨é—¨leaderè¦æ±‚å¿«å¿«å¿«ï¼Œæ‰€ä»¥å°†è®¸å¤šå¿…è¦çš„æ­¥éª¤çœç•¥äº†ã€‚æ¯”å¦‚å®šä¹‰æ–¹æ³•å‚æ•°å‘½åè§„èŒƒï¼Œå®šä¹‰apiè§„èŒƒï¼Œä»£ç reviewç­‰ç­‰ã€‚ã€‚ã€‚æ¯å¤©å°±æ˜¯åˆ’åˆ†ä¸‹æ¥å£ï¼Œæ¯äººå¼€å‘å‡ ä¸ªæ¥å£ï¼Œå’Œå‰ç«¯å®šä¹‰æ¥å£æ–‡æ¡£ï¼Œå°±å¼€å§‹å¼€å‘ææµ‹äº†ã€‚è®²çœŸï¼Œå…¶å®æ‰€æœ‰äººéƒ½æ˜¯æœ‰è´£ä»»çš„ï¼Œå¯èƒ½æ˜¯å¯¹è¿™ä¸ªé¡¹ç›®ä¸€å¼€å§‹å°±å¾ˆåæ„Ÿï¼Œæœ‰æŠµè§¦å¿ƒç†ï¼Œæ‰€ä»¥ä»å†…å¿ƒå°±æ²¡æ‰“ç®—å¥½å¥½åšï¼Œä¸€äº›è§‰å¾—å¯ä»¥æ”¹è¿›çš„åœ°æ–¹ä¹Ÿå°±å¾—è¿‡ä¸”è¿‡äº†ã€‚åé¢çš„äº‹å®è¯æ˜ï¼Œå½“è§‰å¾—è®¾è®¡æˆ–è§„èŒƒæœ‰ä¸åˆç†çš„æ—¶å€™ï¼Œä¸€å®šè¦åŠæ—¶æå‡ºæ¥ï¼Œä¸èƒ½å¿ï¼Œå¿çš„åæœå°±æ˜¯ä¸€æ¬¡ä¸€æ¬¡é™ä½è‡ªå·±çš„åº•çº¿ï¼Œç„¶åäº²æ‰‹é€ å°±ä¸€ä¸ªéš¾ç»´æŠ¤çš„ç³»ç»Ÿï¼Œåˆ°æ—¶å€™å³ä¾¿æœ‰å¿ƒæƒ³é‡æ„ä¹Ÿæ˜¯å¿ƒæœ‰ä½™åŠ›ä¸è¶³äº†ã€‚ å…¬å¸é¡¹ç›®å°±ä¸è´´å®é™…ä»£ç äº†ï¼Œç®€å•ä¸¾å‡ ä¸ªä¾‹å­ï¼Œçœ‹çœ‹å¼€å‘å‰å®šä¹‰å¿…è¦çš„è§„èŒƒæ˜¯å¤šä¹ˆçš„é‡è¦ã€‚ç”±äºä»£ç†å•†æ²¡æœ‰äº‹å…ˆè§„å®šapiçš„å®šä¹‰è¦ç¬¦åˆRESTFulçš„è§„èŒƒï¼Œæ‰€ä»¥é¡¹ç›®ä¸­apiçš„é£æ ¼æœ‰ä¸¤ç§ï¼Œç¬¦åˆRESTFulçš„å’Œä¸ç¬¦åˆçš„ã€‚æ¯”å¦‚è·å–é¤å…ä¿¡æ¯çš„apiå®šä¹‰æ˜¯GET /restaurant/{id}ï¼Œè€Œåˆ›å»ºé¤å…çš„apiå®šä¹‰æ˜¯POST /restaurant/createï¼Œsoã€‚ã€‚ã€‚å¦‚æœåé¢çš„äººæƒ³è®¾è®¡æ›´æ–°é¤å…ä¿¡æ¯çš„apiæ˜¯PUT /restaurant/{id}è¿˜æ˜¯PUT /restaurant/updateå‘¢ï¼ŒçœŸæ˜¯ä¸€è„¸æ‡µé€¼ã€‚æ¥å£çš„å‘½åå°±æ›´æ˜¯äº”èŠ±å…«é—¨äº†ï¼Œå› ä¸ºå¤§å®¶æ˜¯æ¥è‡ªä¸åŒç»„ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰å®šä¹‰ç»Ÿä¸€çš„å‘½åçš„è§„èŒƒï¼Œæ¯”å¦‚ï¼šä¸€ä¸ªç®€å•çš„è·å–ä¿¡æ¯ï¼Œè·å–é¤å…ä¿¡æ¯çš„æ¥å£æ˜¯getRestaurant,è·å–æ´»åŠ¨ä¿¡æ¯æ˜¯activityInfo,è·å–ä»£ç†å•†ä¿¡æ¯æ¥å£æ˜¯getAgentDtoï¼Œè·å–è®¢å•ä¿¡æ¯åˆå˜æˆäº†getOrderData,soã€‚ã€‚ã€‚è°èƒ½å‘Šè¯‰æˆ‘ä¹‹åæƒ³æ·»åŠ ä¸ªè·å–ä¿¡æ¯çš„æ¥å£åˆ°åº•è¯¥å«ä»€ä¹ˆã€‚ã€‚ã€‚ä¼°è®¡åªèƒ½çœ‹å½“æ—¶çš„å¿ƒæƒ…éšä¾¿å–äº†ã€‚ã€‚ã€‚è¿˜æœ‰å°±æ˜¯é¡¹ç›®ä¸­å­˜åœ¨å¤§é‡é‡å¤ä»£ç ï¼Œè·å–é¤å…ç®¡ç†å‘˜ä¿¡æ¯åŸºæœ¬ä¸Šæ¯ä¸ªäººéƒ½å†™äº†ä¸€éï¼Œå› ä¸ºç®¡ç†å‘˜çš„ä¿¡æ¯åœ¨è·å–é¤å…ï¼Œæ´»åŠ¨ä¿¡æ¯æ—¶éƒ½ç”¨çš„åˆ°ï¼Œç”±äºæ²¡æœ‰ä»£ç reviewï¼Œæ‰€ä»¥ä¸€å¼€å§‹å¤§å®¶ä¹Ÿä¸çŸ¥é“ï¼Œå°±å„å†™å„çš„ï¼Œä¹Ÿæ˜¯è›®é†‰çš„ã€‚ ä¸Šé¢çš„ä¾‹å­åªæ˜¯ä¸€ç‚¹ç‚¹ï¼Œå®é™…è¿˜æœ‰å¾ˆå¤šå¾ˆå¤šå¾ˆå¤šçš„æ§½ç‚¹ï¼Œéƒ½æ˜¯æ³ªå•Šã€‚ç”±äºç¬¬ä¸€ç‰ˆæœ¬ä¸ºäº†å‹ç¼©å·¥æ—¶(è‡³ä»Šä¹Ÿä¸æ˜ç™½ä¸ºå•¥è¦é‚£ä¹ˆæ€¥ã€‚ã€‚ã€‚)å°±è¿™æ ·è‰è‰äº¤å·¥ï¼Œå¯¼è‡´åé¢çš„å‡ ä¸ªè¿­ä»£å¼€å‘ä¹Ÿéšä¹‹å˜å¾—è¶Šæ¥è¶Šéšæ„ï¼Œéšæ„å‘½åï¼Œéšæ„å®šä¹‰apiï¼Œç¼ºä¹junitæµ‹è¯•ï¼Œè¶Šæ¥è¶Šä¸ä¸Šå¿ƒã€‚å¬è¯´ä»£ç†å•†è¦ç§»äº¤ç»™BDç»„ï¼Œä½†ä¼°è®¡æƒ…å†µä¹Ÿåªä¼šè¶Šæ¥è¶Šç³Ÿï¼Œå› ä¸ºæ²¡äººæ„¿æ„å»æ•´ç†ä¸€å¨å¨ç³Ÿç³•çš„ä»£ç ï¼Œåªä¼šåœ¨å‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œéšæ„çš„æ‰“è¡¥ä¸ã€‚ã€‚ã€‚ æ€»ç»“å…¶å®ä¹Ÿæ²¡å•¥å¥½æ€»ç»“çš„ï¼Œä¸€å¥è¯ï¼Œä»¥åä¸€å®šè¦å†™å¹²å‡€ï¼Œæ•´æ´çš„ä»£ç ï¼Œæ³¨æ„è§„èŒƒï¼Œä¸èƒ½å¿½è§†ä¸€ç‚¹ç‚¹ç³Ÿç³•çš„ä»£ç æˆ–è€…è®¾è®¡å¯¹é¡¹ç›®å¸¦æ¥çš„è´Ÿé¢å½±å“ã€‚ æ¬¢è¿ä¸€èµ·è®¨è®º~~","raw":null,"content":null,"categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/categories/éšç¬”/"}],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/tags/éšç¬”/"}]},{"title":"ã€è¯‘ã€‘Javaä¸­çš„åƒåœ¾å›æ”¶æœºåˆ¶","slug":"jvm-GC","date":"2016-05-13T15:28:15.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/05/13/jvm-GC/","link":"","permalink":"http://yemengying.com/2016/05/13/jvm-GC/","excerpt":"æ„Ÿè§‰äººç”Ÿå°±æ˜¯while(true){ä¸€ä¸ªé€‰æ‹©æ¥ç€ä¸€ä¸ªé€‰æ‹©æ¥ç€ä¸€ä¸ªé€‰æ‹©;},å¥½æ€•è‡ªå·±ä¸€ä¸å°å¿ƒå°±åšäº†é”™è¯¯çš„å†³å®šå•ŠğŸ˜­ã€‚å µä¸Šå…¨éƒ¨äººå“,å¸Œæœ›æ–°å…¬å¸æŠ€æœ¯æ°›å›´æµ“åš,æœ‰å¤§ç‰›å¸¦æˆ‘,åˆ‡æ‹œğŸ™ŠğŸ™ã€‚ ä¸æ‰¯æœ‰çš„æ²¡çš„äº†ï¼Œç¿»è¯‘ä¸€ç¯‡å…³äºåƒåœ¾å›æ”¶(ä»¥ä¸‹ç®€ç§°GC)æœºåˆ¶çš„åšå®¢(åŸæ–‡åœ°å€)ã€‚åšå®¢å†…å®¹åŒ…æ‹¬ï¼šJavaä¸­GCæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¸¸è§çš„GCç®—æ³•(æ¯”å¦‚:æ ‡è®°æ¸…é™¤)ï¼ŒJavaä¸­ä¸åŒçš„åƒåœ¾æ”¶é›†å™¨(æ¯”å¦‚:serial)ã€‚","keywords":null,"text":"æ„Ÿè§‰äººç”Ÿå°±æ˜¯while(true){ä¸€ä¸ªé€‰æ‹©æ¥ç€ä¸€ä¸ªé€‰æ‹©æ¥ç€ä¸€ä¸ªé€‰æ‹©;},å¥½æ€•è‡ªå·±ä¸€ä¸å°å¿ƒå°±åšäº†é”™è¯¯çš„å†³å®šå•ŠğŸ˜­ã€‚å µä¸Šå…¨éƒ¨äººå“,å¸Œæœ›æ–°å…¬å¸æŠ€æœ¯æ°›å›´æµ“åš,æœ‰å¤§ç‰›å¸¦æˆ‘,åˆ‡æ‹œğŸ™ŠğŸ™ã€‚ ä¸æ‰¯æœ‰çš„æ²¡çš„äº†ï¼Œç¿»è¯‘ä¸€ç¯‡å…³äºåƒåœ¾å›æ”¶(ä»¥ä¸‹ç®€ç§°GC)æœºåˆ¶çš„åšå®¢(åŸæ–‡åœ°å€)ã€‚åšå®¢å†…å®¹åŒ…æ‹¬ï¼šJavaä¸­GCæ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¸¸è§çš„GCç®—æ³•(æ¯”å¦‚:æ ‡è®°æ¸…é™¤)ï¼ŒJavaä¸­ä¸åŒçš„åƒåœ¾æ”¶é›†å™¨(æ¯”å¦‚:serial)ã€‚ å…³é”®å­—çº¦å®š Young generation â€“&gt;æ–°ç”Ÿä»£ Tenured / Old Generation â€“&gt;è€å¹´ä»£ Perm Area â€“&gt;æ°¸ä¹…ä»£ é‡è¦çš„ä¸œä¸œ åœ¨Javaä¸­ï¼Œå¯¹è±¡å®ä¾‹éƒ½æ˜¯åœ¨å †ä¸Šåˆ›å»ºã€‚ä¸€äº›ç±»ä¿¡æ¯ï¼Œå¸¸é‡ï¼Œé™æ€å˜é‡ç­‰å­˜å‚¨åœ¨æ–¹æ³•åŒºã€‚å †å’Œæ–¹æ³•åŒºéƒ½æ˜¯çº¿ç¨‹å…±äº«çš„ã€‚ GCæœºåˆ¶æ˜¯ç”±JVMæä¾›ï¼Œç”¨æ¥æ¸…ç†éœ€è¦æ¸…é™¤çš„å¯¹è±¡ï¼Œå›æ”¶å †å†…å­˜ã€‚ GCæœºåˆ¶å°†Javaç¨‹åºå‘˜ä»å†…å­˜ç®¡ç†ä¸­è§£æ”¾äº†å‡ºæ¥ï¼Œå¯ä»¥æ›´å…³æ³¨äºä¸šåŠ¡é€»è¾‘ã€‚ åœ¨Javaä¸­ï¼ŒGCæ˜¯ç”±ä¸€ä¸ªè¢«ç§°ä¸ºåƒåœ¾å›æ”¶å™¨çš„å®ˆæŠ¤çº¿ç¨‹æ‰§è¡Œçš„ã€‚ åœ¨ä»å†…å­˜å›æ”¶ä¸€ä¸ªå¯¹è±¡ä¹‹å‰ä¼šè°ƒç”¨å¯¹è±¡çš„finalize()æ–¹æ³•ã€‚ ä½œä¸ºä¸€ä¸ªJavaå¼€å‘è€…ä¸èƒ½å¼ºåˆ¶JVMæ‰§è¡ŒGCï¼›GCçš„è§¦å‘ç”±JVMä¾æ®å †å†…å­˜çš„å¤§å°æ¥å†³å®šã€‚ System.gc()å’ŒRuntime.gc()ä¼šå‘JVMå‘é€æ‰§è¡ŒGCçš„è¯·æ±‚ï¼Œä½†æ˜¯JVMä¸ä¿è¯ä¸€å®šä¼šæ‰§è¡ŒGCã€‚ å¦‚æœå †æ²¡æœ‰å†…å­˜åˆ›å»ºæ–°çš„å¯¹è±¡äº†ï¼Œä¼šæŠ›å‡ºOutOfMemoryErrorã€‚ GCé’ˆå¯¹ä»€ä¹ˆå¯¹è±¡ï¼Ÿäº†è§£GCæœºåˆ¶çš„ç¬¬ä¸€æ­¥å°±æ˜¯ç†è§£ä»€ä¹ˆæ ·çš„å¯¹è±¡ä¼šè¢«å›æ”¶ã€‚å½“ä¸€ä¸ªå¯¹è±¡é€šè¿‡ä¸€ç³»åˆ—æ ¹å¯¹è±¡(æ¯”å¦‚ï¼šé™æ€å±æ€§å¼•ç”¨çš„å¸¸é‡)éƒ½ä¸å¯è¾¾æ—¶å°±ä¼šè¢«å›æ”¶ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½ä¸ºnullã€‚å¾ªç¯ä¾èµ–ä¸ç®—åšå¼•ç”¨ï¼Œå¦‚æœå¯¹è±¡Aæœ‰ä¸€ä¸ªæŒ‡å‘å¯¹è±¡Bçš„å¼•ç”¨ï¼Œå¯¹è±¡Bä¹Ÿæœ‰ä¸€ä¸ªæŒ‡å‘å¯¹è±¡Açš„å¼•ç”¨ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œå®ƒä»¬æ²¡æœ‰å…¶ä»–å¼•ç”¨ï¼Œé‚£ä¹ˆå¯¹è±¡Aå’Œå¯¹è±¡Béƒ½ã€éœ€è¦è¢«å›æ”¶(å¦‚ä¸‹å›¾,ObjAå’ŒObjBéœ€è¦è¢«å›æ”¶)ã€‚ å †å†…å­˜æ˜¯å¦‚ä½•åˆ’åˆ†çš„ï¼ŸJavaä¸­å¯¹è±¡éƒ½åœ¨å †ä¸Šåˆ›å»ºã€‚ä¸ºäº†GCï¼Œå †å†…å­˜åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œä¹Ÿå¯ä»¥è¯´ä¸‰ä»£ï¼Œåˆ†åˆ«ç§°ä¸ºæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£å’Œæ°¸ä¹…ä»£ã€‚å…¶ä¸­æ–°ç”Ÿä»£åˆè¿›ä¸€æ­¥åˆ†ä¸ºEdenåŒºï¼ŒSurvivor 1åŒºå’ŒSurvivor 2åŒº(å¦‚ä¸‹å›¾)ã€‚æ–°åˆ›å»ºçš„å¯¹è±¡ä¼šåˆ†é…åœ¨EdenåŒº,åœ¨ç»å†ä¸€æ¬¡Minor GCåä¼šè¢«ç§»åˆ°Survivor 1åŒºï¼Œå†ç»å†ä¸€æ¬¡Minor GCåä¼šè¢«ç§»åˆ°Survivor 2åŒºï¼Œç›´åˆ°å‡è‡³è€å¹´ä»£,éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸€äº›å¤§å¯¹è±¡(é•¿å­—ç¬¦ä¸²æˆ–æ•°ç»„)å¯èƒ½ä¼šç›´æ¥å­˜æ”¾åˆ°è€å¹´ä»£ã€‚æ°¸ä¹…ä»£æœ‰ä¸€äº›ç‰¹æ®Šï¼Œå®ƒç”¨æ¥å­˜å‚¨ç±»çš„å…ƒä¿¡æ¯ã€‚å¯¹äºGCæ˜¯å¦å‘ç”Ÿåœ¨æ°¸ä¹…ä»£æœ‰è®¸å¤šä¸åŒçš„çœ‹æ³•ï¼Œåœ¨æˆ‘çœ‹æ¥è¿™å–å†³äºé‡‡ç”¨çš„JVMã€‚å¤§å®¶å¯ä»¥é€šè¿‡åˆ›å»ºå¤§é‡çš„å­—ç¬¦ä¸²æ¥è§‚å¯Ÿæ˜¯å‘ç”Ÿäº†GCè¿˜æ˜¯æŠ›å‡ºäº†OutOfMemoryErrorã€‚ GCç®—æ³• æ ‡è®°æ¸…é™¤ç®—æ³•åˆ†ä¸ºæ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªé˜¶æ®µï¼šé¦–å…ˆæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰€æœ‰è¢«æ ‡è®°çš„å¯¹è±¡ã€‚è¯¥ç®—æ³•çš„ç¼ºç‚¹æ˜¯æ•ˆç‡ä¸é«˜å¹¶ä¸”ä¼šäº§ç”Ÿä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡ã€‚ å¤åˆ¶ç®—æ³•æŠŠå†…å­˜ç©ºé—´åˆ’ä¸ºä¸¤ä¸ªåŒºåŸŸï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€ä¸ªåŒºåŸŸã€‚åƒåœ¾å›æ”¶æ—¶ï¼Œéå†å½“å‰ä½¿ç”¨åŒºåŸŸï¼ŒæŠŠæ­£åœ¨ä½¿ç”¨ä¸­çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€ä¸ªåŒºåŸŸä¸­ã€‚æ¬¡ç®—æ³•æ¯æ¬¡åªå¤„ç†æ­£åœ¨ä½¿ç”¨ä¸­çš„å¯¹è±¡ï¼Œå› æ­¤å¤åˆ¶æˆæœ¬æ¯”è¾ƒå°ï¼ŒåŒæ—¶å¤åˆ¶è¿‡å»ä»¥åè¿˜èƒ½è¿›è¡Œç›¸åº”çš„å†…å­˜æ•´ç†ï¼Œä¸ä¼šå‡ºç°â€œç¢ç‰‡â€é—®é¢˜ã€‚ä¼˜ç‚¹ï¼šå®ç°ç®€å•ï¼Œè¿è¡Œé«˜æ•ˆã€‚ç¼ºç‚¹ï¼šä¼šæµªè´¹ä¸€å®šçš„å†…å­˜ã€‚ä¸€èˆ¬æ–°ç”Ÿä»£é‡‡ç”¨è¿™ç§ç®—æ³•ã€‚ æ ‡è®°æ•´ç†ç®—æ³•æ ‡è®°é˜¶æ®µä¸æ ‡è®°æ¸…é™¤ç®—æ³•ä¸€æ ·ã€‚ä½†åç»­å¹¶ä¸æ˜¯ç›´æ¥å¯¹å¯å›æ”¶çš„å¯¹è±¡è¿›è¡Œæ¸…ç†ï¼Œè€Œæ˜¯è®©æ‰€æœ‰å­˜æ´»å¯¹è±¡éƒ½æƒ³ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åæ¸…ç†ã€‚ä¼˜ç‚¹æ˜¯ä¸ä¼šé€ æˆå†…å­˜ç¢ç‰‡ã€‚ Javaä¸­åƒåœ¾å›æ”¶å™¨çš„ç±»å‹Javaæä¾›å¤šç§ç±»å‹çš„åƒåœ¾å›æ”¶å™¨ã€‚JVMä¸­çš„åƒåœ¾æ”¶é›†ä¸€èˆ¬éƒ½é‡‡ç”¨â€œåˆ†ä»£æ”¶é›†â€ï¼Œä¸åŒçš„å †å†…å­˜åŒºåŸŸé‡‡ç”¨ä¸åŒçš„æ”¶é›†ç®—æ³•ï¼Œä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†å¢åŠ ååé‡æˆ–é™ä½åœé¡¿æ—¶é—´ã€‚ Serialæ”¶é›†å™¨ï¼šæ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡ŒGCï¼Œä¸²è¡Œï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹æš‚åœã€‚ ParNewæ”¶é›†å™¨ï¼šæ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼ŒSerialæ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆï¼Œç”¨å¤šä¸ªçº¿ç¨‹è¿›è¡ŒGCï¼Œå¹¶è¡Œï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹æš‚åœã€‚ä½¿ç”¨-XX:+UseParNewGCå¼€å…³æ¥æ§åˆ¶ä½¿ç”¨ParNew+Serial Oldæ”¶é›†å™¨ç»„åˆæ”¶é›†å†…å­˜ï¼›ä½¿ç”¨-XX:ParallelGCThreadsæ¥è®¾ç½®æ‰§è¡Œå†…å­˜å›æ”¶çš„çº¿ç¨‹æ•°ã€‚ Parallel Scavenge æ”¶é›†å™¨ï¼šååé‡ä¼˜å…ˆçš„åƒåœ¾å›æ”¶å™¨ï¼Œä½œç”¨åœ¨æ–°ç”Ÿä»£ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œå…³æ³¨CPUååé‡ï¼Œå³è¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´/æ€»æ—¶é—´ã€‚ä½¿ç”¨-XX:+UseParallelGCå¼€å…³æ§åˆ¶ä½¿ç”¨Parallel Scavenge+Serial Oldæ”¶é›†å™¨ç»„åˆå›æ”¶åƒåœ¾ã€‚ Serial Oldæ”¶é›†å™¨ï¼šè€å¹´ä»£æ”¶é›†å™¨ï¼Œå•çº¿ç¨‹æ”¶é›†å™¨ï¼Œä¸²è¡Œï¼Œä½¿ç”¨æ ‡è®°æ•´ç†ç®—æ³•ï¼Œä½¿ç”¨å•çº¿ç¨‹è¿›è¡ŒGCï¼Œå…¶å®ƒå·¥ä½œçº¿ç¨‹æš‚åœã€‚ Parallel Oldæ”¶é›†å™¨ï¼šååé‡ä¼˜å…ˆçš„åƒåœ¾å›æ”¶å™¨ï¼Œä½œç”¨åœ¨è€å¹´ä»£ï¼Œå¤šçº¿ç¨‹ï¼Œå¹¶è¡Œï¼Œå¤šçº¿ç¨‹æœºåˆ¶ä¸Parallel Scavengeå·®ä¸é”™ï¼Œä½¿ç”¨æ ‡è®°æ•´ç†ç®—æ³•ï¼Œåœ¨Parallel Oldæ‰§è¡Œæ—¶ï¼Œä»ç„¶éœ€è¦æš‚åœå…¶å®ƒçº¿ç¨‹ã€‚ CMSï¼ˆConcurrent Mark Sweepï¼‰æ”¶é›†å™¨ï¼šè€å¹´ä»£æ”¶é›†å™¨ï¼Œè‡´åŠ›äºè·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ï¼ˆå³ç¼©çŸ­åƒåœ¾å›æ”¶çš„æ—¶é—´ï¼‰ï¼Œä½¿ç”¨æ ‡è®°æ¸…é™¤ç®—æ³•ï¼Œå¤šçº¿ç¨‹ï¼Œä¼˜ç‚¹æ˜¯å¹¶å‘æ”¶é›†ï¼ˆç”¨æˆ·çº¿ç¨‹å¯ä»¥å’ŒGCçº¿ç¨‹åŒæ—¶å·¥ä½œï¼‰ï¼Œåœé¡¿å°ã€‚ä½¿ç”¨-XX:+UseConcMarkSweepGCè¿›è¡ŒParNew+CMS+Serial Oldè¿›è¡Œå†…å­˜å›æ”¶ï¼Œä¼˜å…ˆä½¿ç”¨ParNew+CMSï¼ˆåŸå› è§Full GCå’Œå¹¶å‘åƒåœ¾å›æ”¶ä¸€èŠ‚ï¼‰ï¼Œå½“ç”¨æˆ·çº¿ç¨‹å†…å­˜ä¸è¶³æ—¶ï¼Œé‡‡ç”¨å¤‡ç”¨æ–¹æ¡ˆSerial Oldæ”¶é›†ã€‚ å¯ä»¥çœ‹Java Performanceä¸€ä¹¦æ¥è·å–æ›´å¤šå…³äºGCè°ƒä¼˜çš„ä¿¡æ¯ã€‚ ä¸GCæœ‰å…³çš„JVMå‚æ•°åšGCè°ƒä¼˜éœ€è¦å¤§é‡çš„å®è·µï¼Œè€å¿ƒå’Œå¯¹é¡¹ç›®çš„åˆ†æã€‚æˆ‘æ›¾ç»å‚ä¸è¿‡é«˜å®¹é‡ï¼Œä½å»¶è¿Ÿçš„ç”µå•†ç³»ç»Ÿï¼Œåœ¨å¼€å‘ä¸­æˆ‘ä»¬éœ€è¦é€šè¿‡åˆ†æé€ æˆFull GCçš„åŸå› æ¥æé«˜ç³»ç»Ÿæ€§èƒ½ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘å‘ç°åšGCçš„è°ƒä¼˜å¾ˆå¤§ç¨‹åº¦ä¸Šä¾èµ–äºå¯¹ç³»ç»Ÿçš„åˆ†æï¼Œç³»ç»Ÿæ‹¥æœ‰æ€æ ·çš„å¯¹è±¡ä»¥åŠä»–ä»¬çš„å¹³å‡ç”Ÿå‘½å‘¨æœŸã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœä¸€ä¸ªåº”ç”¨å¤§å¤šæ˜¯çŸ­ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ï¼Œé‚£ä¹ˆåº”è¯¥ç¡®ä¿EdenåŒºè¶³å¤Ÿå¤§ï¼Œè¿™æ ·å¯ä»¥å‡å°‘Minor GCçš„æ¬¡æ•°ã€‚å¯ä»¥é€šè¿‡-XX:NewRatioæ¥æ§åˆ¶æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ¯”ä¾‹ï¼Œæ¯”å¦‚-XX:NewRatio=3ä»£è¡¨æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ¯”ä¾‹ä¸º1ï¼š3ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ‰©å¤§æ–°ç”Ÿä»£çš„å¤§å°ä¼šå‡å°‘è€å¹´ä»£çš„å¤§å°ï¼Œè¿™ä¼šå¯¼è‡´Major GCæ‰§è¡Œçš„æ›´é¢‘ç¹ï¼Œè€ŒMajor GCå¯èƒ½ä¼šé€ æˆç”¨æˆ·çº¿ç¨‹çš„åœé¡¿ä»è€Œé™ä½ç³»ç»Ÿååé‡ã€‚JVMä¸­å¯ä»¥ç”¨NewSizeå’ŒMaxNewSizeå‚æ•°æ¥æŒ‡å®šæ–°ç”Ÿä»£å†…å­˜æœ€å°å’Œæœ€å¤§å€¼ï¼Œå¦‚æœä¸¤ä¸ªå‚æ•°å€¼ä¸€æ ·ï¼Œé‚£ä¹ˆå°±ç›¸å½“äºå›ºå®šäº†æ–°ç”Ÿä»£çš„å¤§å°ã€‚ä¸ªäººå»ºè®®ï¼Œåœ¨åšGCè°ƒä¼˜ä¹‹å‰æœ€å¥½æ·±å…¥ç†è§£Javaä¸­GCæœºåˆ¶ï¼Œæ¨èé˜…è¯»Sun Microsystemsæä¾›çš„æœ‰å…³GCçš„æ–‡æ¡£ã€‚è¿™ä¸ªé“¾æ¥å¯èƒ½ä¼šå¯¹ç†è§£GCæœºåˆ¶æä¾›ä¸€äº›å¸®åŠ©ã€‚ä¸‹é¢çš„å›¾åˆ—å‡ºäº†å„ä¸ªåŒºå¯ç”¨çš„ä¸€äº›JVMå‚æ•°ã€‚ Full GCå’Œå¹¶å‘åƒåœ¾å›æ”¶å¹¶å‘åƒåœ¾å›æ”¶å™¨çš„å†…å­˜å›æ”¶è¿‡ç¨‹æ˜¯ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å¹¶å‘æ‰§è¡Œçš„ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå¹¶å‘åƒåœ¾å›æ”¶å™¨å¯ä»¥åœ¨ç”¨æˆ·çº¿ç¨‹è¿è¡Œçš„æƒ…å†µä¸‹å®Œæˆå¤§éƒ¨åˆ†çš„å›æ”¶å·¥ä½œï¼Œæ‰€ä»¥åº”ç”¨åœé¡¿æ—¶é—´å¾ˆçŸ­ã€‚ä½†ç”±äºå¹¶å‘åƒåœ¾å›æ”¶æ—¶ç”¨æˆ·çº¿ç¨‹è¿˜åœ¨è¿è¡Œï¼Œæ‰€ä»¥ä¼šæœ‰æ–°çš„åƒåœ¾ä¸æ–­äº§ç”Ÿã€‚ä½œä¸ºæ‹…ä¿ï¼Œå¦‚æœåœ¨è€å¹´ä»£å†…å­˜éƒ½è¢«å ç”¨ä¹‹å‰ï¼Œå¦‚æœå¹¶å‘åƒåœ¾å›æ”¶å™¨è¿˜æ²¡ç»“æŸå·¥ä½œï¼Œé‚£ä¹ˆåº”ç”¨ä¼šæš‚åœï¼Œåœ¨æ‰€æœ‰ç”¨æˆ·çº¿ç¨‹åœæ­¢çš„æƒ…å†µä¸‹å®Œæˆå›æ”¶ã€‚è¿™ç§æƒ…å†µç§°ä½œFull GCï¼Œè¿™æ„å‘³ç€éœ€è¦è°ƒæ•´æœ‰å…³å¹¶å‘å›æ”¶çš„å‚æ•°äº†ã€‚ç”±äºFull GCå¾ˆå½±å“åº”ç”¨çš„æ€§èƒ½ï¼Œè¦å°½é‡é¿å…æˆ–å‡å°‘ã€‚ç‰¹åˆ«æ˜¯å¦‚æœå¯¹äºé«˜å®¹é‡ä½å»¶è¿Ÿçš„ç”µå•†ç³»ç»Ÿï¼Œè¦å°½é‡é¿å…åœ¨äº¤æ˜“æ—¶é—´æ®µå‘ç”ŸFull GCã€‚ æ€»ç»“ ä¸ºäº†åˆ†ä»£åƒåœ¾å›æ”¶ï¼ŒJavaå †å†…å­˜åˆ†ä¸º3ä»£ï¼šæ–°ç”Ÿä»£ï¼Œè€å¹´ä»£å’Œæ°¸ä¹…ä»£ã€‚ æ–°çš„å¯¹è±¡å®ä¾‹ä¼šä¼˜å…ˆåˆ†é…åœ¨æ–°ç”Ÿä»£ï¼Œåœ¨ç»å†å‡ æ¬¡Minor GCå(é»˜è®¤15æ¬¡)ï¼Œè¿˜å­˜æ´»çš„ä¼šè¢«ç§»è‡³è€å¹´ä»£(æŸäº›å¤§å¯¹è±¡ä¼šç›´æ¥åœ¨è€å¹´ä»£åˆ†é…)ã€‚ æ°¸ä¹…ä»£æ˜¯å¦æ‰§è¡ŒGCï¼Œå–å†³äºé‡‡ç”¨çš„JVMã€‚ Minor GCå‘ç”Ÿåœ¨æ–°ç”Ÿä»£ï¼Œå½“EdenåŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´æ—¶ï¼Œä¼šå‘èµ·ä¸€æ¬¡Minor GCï¼Œå°†EdenåŒºä¸­çš„å­˜æ´»å¯¹è±¡ç§»è‡³SurvivoråŒºã€‚Major GCå‘ç”Ÿåœ¨è€å¹´ä»£ï¼Œå½“å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡å¤§äºè€å¹´ä»£å‰©ä½™ç©ºé—´æ—¶ä¼šå‘ç”ŸMajor GCã€‚ å‘ç”ŸMajor GCæ—¶ç”¨æˆ·çº¿ç¨‹ä¼šæš‚åœï¼Œä¼šé™ä½ç³»ç»Ÿæ€§èƒ½å’Œååé‡ã€‚ JVMçš„å‚æ•°-Xmxå’Œ-Xmsç”¨æ¥è®¾ç½®Javaå †å†…å­˜çš„åˆå§‹å¤§å°å’Œæœ€å¤§å€¼ã€‚ä¾æ®ä¸ªäººç»éªŒè¿™ä¸ªå€¼çš„æ¯”ä¾‹æœ€å¥½æ˜¯1:1æˆ–è€…1:1.5ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥å°†-Xmxå’Œ-Xmséƒ½è®¾ä¸º1GBï¼Œæˆ–è€…-Xmxå’Œ-Xmsè®¾ä¸º1.2GBå’Œ1.8GBã€‚ Javaä¸­ä¸èƒ½æ‰‹åŠ¨è§¦å‘GCï¼Œä½†å¯ä»¥ç”¨ä¸åŒçš„å¼•ç”¨ç±»æ¥è¾…åŠ©åƒåœ¾å›æ”¶å™¨å·¥ä½œ(æ¯”å¦‚ï¼šå¼±å¼•ç”¨æˆ–è½¯å¼•ç”¨)ã€‚ ä»¥ä¸Šå°±æ˜¯å…³äºJavaä¸­GCçš„ä¸€äº›å†…å®¹ã€‚é€šè¿‡è¿™ç¯‡åšå®¢ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å †å†…å­˜æ˜¯å¦‚ä½•åˆ’åˆ†çš„ï¼›ä¸€ä¸ªå¯¹è±¡åœ¨æ²¡æœ‰ä»»ä½•å¼ºå¼•ç”¨æŒ‡å‘ä»–æˆ–è¯¥å¯¹è±¡é€šè¿‡æ ¹èŠ‚ç‚¹ä¸å¯è¾¾æ—¶éœ€è¦è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ï¼›å½“åƒåœ¾æ”¶é›†å™¨æ„è¯†åˆ°éœ€è¦è¿›è¡ŒGCæ—¶ä¼šè§¦å‘Minor GCæˆ–Major GCï¼Œæ˜¯è‡ªåŠ¨çš„ï¼Œæ— æ³•å¼ºåˆ¶æ‰§è¡Œã€‚ å‚è€ƒæ–‡æ¡£(åº·æ¡‘é˜¿ç±³è¾¾~) http://icyfenix.iteye.com/blog/715301 http://www.cnblogs.com/zhguang/p/3257367.html ã€Šæ·±å…¥ç†è§£javaè™šæ‹Ÿæœºã€‹ â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”å…¶å®æˆ‘åªæ˜¯ä¸€æ¡åˆ†å‰²çº¿â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” å…³äºæ°¸ä¹…ä»£åˆ°åº•æœ‰æ²¡æœ‰GCè¿˜æ˜¯å¾ˆæ‡µé€¼ï¼Œå¾ˆå¤šåœ°æ–¹çœ‹åˆ°çš„è¯´æ³•éƒ½ä¸ä¸€è‡´ã€‚æ¬¢è¿æŒ‡æ­£é”™è¯¯ï¼Œæ¬¢è¿ä¸€èµ·è®¨è®º~~ æŒ‰å›½é™…æƒ¯ä¾‹ï¼Œwuliå…‰æ´™ç»“å°¾~~","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"jvm","slug":"jvm","permalink":"http://yemengying.com/tags/jvm/"}]},{"title":"å¦‚ä½•çº¿ç¨‹å®‰å…¨çš„ä½¿ç”¨ HashMap","slug":"threadsafe-hashmap","date":"2016-05-07T09:21:06.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/05/07/threadsafe-hashmap/","link":"","permalink":"http://yemengying.com/2016/05/07/threadsafe-hashmap/","excerpt":"è¿™å‘¨çœŸæ˜¯å‘ç”Ÿäº†ä¸å°‘äº‹ï¼Œè„‘è¢‹å’Œå¿ƒé‡Œä¸€ç›´éƒ½å¾ˆä¹±ï¼Œå‘¨äºŒå‚åŠ äº†ä¸€åœºé¢è¯•ï¼Œç»å†äº†ç¬”è¯•+3è½®é¢è¯•ï¼Œå‘¨äº”æ­£å¼æäº¤äº†ç¦»èŒç”³è¯·ã€‚è¦å¼€å§‹æ–°çš„å¾ç¨‹äº†ï¼Œæ„å¤–çš„æœ‰äº›å¤±è½å’Œä¸èˆï¼Œæ¯•ç«Ÿæ˜¯æ¯•ä¸šåçš„ç¬¬ä¸€ä»½å·¥ä½œï¼Œæ¯•ç«Ÿåœ¨è¿™è®¤è¯†äº†ä¸€ç¾¤å¯çˆ±çš„äººï¼Œæ¯•ç«Ÿåœ¨è¿™å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿,æ¯•ç«Ÿè¿™æœ‰8000+çš„aeron chair!!!ã€‚å¯æ—¢ç„¶å·²ç»åšäº†é€‰æ‹©å°±æ²¡æœ‰é€€è·¯äº†ï¼Œå‹‡æ•¢å¾€ä¸‹èµ°å§ï¼Œå¸Œæœ›æ¥ä¸‹æ¥çš„ä¸‰å‘¨å¯ä»¥æŠŠæ‰‹å¤´ä¸Šçš„å·¥ä½œåšå¥½äº¤æ¥å–„å§‹å–„ç»ˆï¼Œä¹Ÿå¸Œæœ›ä»¥åä¸ä¼šåæ‚”ä»Šå¤©çš„é€‰æ‹©ã€‚","keywords":null,"text":"è¿™å‘¨çœŸæ˜¯å‘ç”Ÿäº†ä¸å°‘äº‹ï¼Œè„‘è¢‹å’Œå¿ƒé‡Œä¸€ç›´éƒ½å¾ˆä¹±ï¼Œå‘¨äºŒå‚åŠ äº†ä¸€åœºé¢è¯•ï¼Œç»å†äº†ç¬”è¯•+3è½®é¢è¯•ï¼Œå‘¨äº”æ­£å¼æäº¤äº†ç¦»èŒç”³è¯·ã€‚è¦å¼€å§‹æ–°çš„å¾ç¨‹äº†ï¼Œæ„å¤–çš„æœ‰äº›å¤±è½å’Œä¸èˆï¼Œæ¯•ç«Ÿæ˜¯æ¯•ä¸šåçš„ç¬¬ä¸€ä»½å·¥ä½œï¼Œæ¯•ç«Ÿåœ¨è¿™è®¤è¯†äº†ä¸€ç¾¤å¯çˆ±çš„äººï¼Œæ¯•ç«Ÿåœ¨è¿™å­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿,æ¯•ç«Ÿè¿™æœ‰8000+çš„aeron chair!!!ã€‚å¯æ—¢ç„¶å·²ç»åšäº†é€‰æ‹©å°±æ²¡æœ‰é€€è·¯äº†ï¼Œå‹‡æ•¢å¾€ä¸‹èµ°å§ï¼Œå¸Œæœ›æ¥ä¸‹æ¥çš„ä¸‰å‘¨å¯ä»¥æŠŠæ‰‹å¤´ä¸Šçš„å·¥ä½œåšå¥½äº¤æ¥å–„å§‹å–„ç»ˆï¼Œä¹Ÿå¸Œæœ›ä»¥åä¸ä¼šåæ‚”ä»Šå¤©çš„é€‰æ‹©ã€‚ è¿›å…¥æ­£é¢˜ï¼Œåœ¨å‘¨äºŒé¢è¯•æ—¶ï¼Œä¸€é¢çš„é¢è¯•å®˜æœ‰é—®åˆ° HashMap æ˜¯å¦æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¦‚ä½•åœ¨çº¿ç¨‹å®‰å…¨çš„å‰æä¸‹ä½¿ç”¨ HashMap,å…¶å®ä¹Ÿå°±æ˜¯ HashMapï¼ŒHashtableï¼ŒConcurrentHashMap å’Œ synchronized Map çš„åŸç†å’ŒåŒºåˆ«ã€‚å½“æ—¶æœ‰äº›ç´§å¼ åªæ˜¯ç®€å•è¯´äº†ä¸‹HashMapä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼›Hashtable çº¿ç¨‹å®‰å…¨ï¼Œä½†æ•ˆç‡ä½ï¼Œå› ä¸ºæ˜¯ Hashtable æ˜¯ä½¿ç”¨ synchronized çš„ï¼Œæ‰€æœ‰çº¿ç¨‹ç«äº‰åŒä¸€æŠŠé”ï¼›è€Œ ConcurrentHashMap ä¸ä»…çº¿ç¨‹å®‰å…¨è€Œä¸”æ•ˆç‡é«˜ï¼Œå› ä¸ºå®ƒåŒ…å«ä¸€ä¸ª segment æ•°ç»„ï¼Œå°†æ•°æ®åˆ†æ®µå­˜å‚¨ï¼Œç»™æ¯ä¸€æ®µæ•°æ®é…ä¸€æŠŠé”ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„é”åˆ†æ®µæŠ€æœ¯ã€‚å½“æ—¶å¿˜è®°äº† synchronized Map å’Œè§£é‡Šä¸€ä¸‹ HashMap ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨ã€‚é¢è¯•ç»“æŸåé—®äº†ä¸‹é¢è¯•å®˜å“ªé‡Œæœ‰äº›ä¸è¶³ï¼Œé¢è¯•å®˜è¯´ä¸Šé¢è¿™ä¸ªé—®é¢˜çš„å›ç­”ç®—è¿‡å…³ï¼Œä½†å¯ä»¥åœ¨æ·±å…¥ä¸€äº›æˆ–è€…è‡ªå·±åŠ¨æ‰‹å°è¯•ä¸€ä¸‹ã€‚so~~~è™½ç„¶æ‹¿åˆ°äº† offerï¼Œä½†è¿˜æ˜¯å†æ•´ç†ä¸€ä¸‹ï¼Œä¸èƒ½å¾—è¿‡ä¸”è¿‡å•Šã€‚ ä¸ºä»€ä¹ˆHashMapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„æ€»è¯´ HashMap æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä¸å®‰å…¨çš„ï¼Œä¸å®‰å…¨çš„ï¼Œé‚£ä¹ˆåˆ°åº•ä¸ºä»€ä¹ˆå®ƒæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„å‘¢ï¼Ÿè¦å›ç­”è¿™ä¸ªé—®é¢˜å°±è¦å…ˆæ¥ç®€å•äº†è§£ä¸€ä¸‹ HashMap æºç ä¸­çš„ä½¿ç”¨çš„å­˜å‚¨ç»“æ„(è¿™é‡Œå¼•ç”¨çš„æ˜¯ Java 8 çš„æºç ï¼Œä¸7æ˜¯ä¸ä¸€æ ·çš„)å’Œå®ƒçš„æ‰©å®¹æœºåˆ¶ã€‚ HashMapçš„å†…éƒ¨å­˜å‚¨ç»“æ„ä¸‹é¢æ˜¯ HashMap ä½¿ç”¨çš„å­˜å‚¨ç»“æ„:12345678transient Node&lt;K,V&gt;[] table;static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; &#123; final int hash; final K key; V value; Node&lt;K,V&gt; next;&#125; å¯ä»¥çœ‹åˆ° HashMap å†…éƒ¨å­˜å‚¨ä½¿ç”¨äº†ä¸€ä¸ª Node æ•°ç»„(é»˜è®¤å¤§å°æ˜¯16)ï¼Œè€Œ Node ç±»åŒ…å«ä¸€ä¸ªç±»å‹ä¸º Node çš„ next çš„å˜é‡ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºä¸€ä¸ªé“¾è¡¨ï¼Œæ‰€æœ‰æ ¹æ® hash å€¼è®¡ç®—çš„ bucket ä¸€æ ·çš„ key ä¼šå­˜å‚¨åˆ°åŒä¸€ä¸ªé“¾è¡¨é‡Œ(å³äº§ç”Ÿäº†å†²çª)ï¼Œå¤§æ¦‚å°±æ˜¯ä¸‹é¢å›¾çš„æ ·å­(é¡ºä¾¿æ¨èä¸ªåœ¨çº¿ç”»å›¾çš„ç½‘ç«™Creately)ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨ Java 8 ä¸­å¦‚æœ hash å€¼ç›¸åŒçš„ key æ•°é‡å¤§äºæŒ‡å®šå€¼(é»˜è®¤æ˜¯8)æ—¶ä½¿ç”¨å¹³è¡¡æ ‘æ¥ä»£æ›¿é“¾è¡¨ï¼Œè¿™ä¼šå°†get()æ–¹æ³•çš„æ€§èƒ½ä»O(n)æé«˜åˆ°O(logn)ã€‚å…·ä½“çš„å¯ä»¥çœ‹æˆ‘çš„å¦ä¸€ç¯‡åšå®¢Java 8ä¸­HashMapå’ŒLinkedHashMapå¦‚ä½•è§£å†³å†²çªã€‚ HashMapçš„è‡ªåŠ¨æ‰©å®¹æœºåˆ¶HashMap å†…éƒ¨çš„ Node æ•°ç»„é»˜è®¤çš„å¤§å°æ˜¯16ï¼Œå‡è®¾æœ‰100ä¸‡ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆæœ€å¥½çš„æƒ…å†µä¸‹æ¯ä¸ª hash æ¡¶é‡Œéƒ½æœ‰62500ä¸ªå…ƒç´ ğŸ˜±ï¼Œè¿™æ—¶get(),put(),remove()ç­‰æ–¹æ³•æ•ˆç‡éƒ½ä¼šé™ä½ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒHashMap æä¾›äº†è‡ªåŠ¨æ‰©å®¹æœºåˆ¶ï¼Œå½“å…ƒç´ ä¸ªæ•°è¾¾åˆ°æ•°ç»„å¤§å° loadFactor åä¼šæ‰©å¤§æ•°ç»„çš„å¤§å°ï¼Œåœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ•°ç»„å¤§å°ä¸º16ï¼ŒloadFactor ä¸º0.75ï¼Œä¹Ÿå°±æ˜¯è¯´å½“ HashMap ä¸­çš„å…ƒç´ è¶…è¿‡16\\0.75=12æ—¶ï¼Œä¼šæŠŠæ•°ç»„å¤§å°æ‰©å±•ä¸º2*16=32ï¼Œå¹¶ä¸”é‡æ–°è®¡ç®—æ¯ä¸ªå…ƒç´ åœ¨æ–°æ•°ç»„ä¸­çš„ä½ç½®ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º(å›¾ç‰‡æ¥æºï¼Œæƒä¾µåˆ )ã€‚ä»å›¾ä¸­å¯ä»¥çœ‹åˆ°æ²¡æ‰©å®¹å‰ï¼Œè·å– EntryE éœ€è¦éå†5ä¸ªå…ƒç´ ï¼Œæ‰©å®¹ä¹‹ååªéœ€è¦2æ¬¡ã€‚ ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨ä¸ªäººè§‰å¾— HashMap åœ¨å¹¶å‘æ—¶å¯èƒ½å‡ºç°çš„é—®é¢˜ä¸»è¦æ˜¯ä¸¤æ–¹é¢,é¦–å…ˆå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶ä½¿ç”¨putæ–¹æ³•æ·»åŠ å…ƒç´ ï¼Œè€Œä¸”å‡è®¾æ­£å¥½å­˜åœ¨ä¸¤ä¸ª put çš„ key å‘ç”Ÿäº†ç¢°æ’(æ ¹æ® hash å€¼è®¡ç®—çš„ bucket ä¸€æ ·)ï¼Œé‚£ä¹ˆæ ¹æ® HashMap çš„å®ç°ï¼Œè¿™ä¸¤ä¸ª key ä¼šæ·»åŠ åˆ°æ•°ç»„çš„åŒä¸€ä¸ªä½ç½®ï¼Œè¿™æ ·æœ€ç»ˆå°±ä¼šå‘ç”Ÿå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹çš„ put çš„æ•°æ®è¢«è¦†ç›–ã€‚ç¬¬äºŒå°±æ˜¯å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶æ£€æµ‹åˆ°å…ƒç´ ä¸ªæ•°è¶…è¿‡æ•°ç»„å¤§å°* loadFactor ï¼Œè¿™æ ·å°±ä¼šå‘ç”Ÿå¤šä¸ªçº¿ç¨‹åŒæ—¶å¯¹ Node æ•°ç»„è¿›è¡Œæ‰©å®¹ï¼Œéƒ½åœ¨é‡æ–°è®¡ç®—å…ƒç´ ä½ç½®ä»¥åŠå¤åˆ¶æ•°æ®ï¼Œä½†æ˜¯æœ€ç»ˆåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰©å®¹åçš„æ•°ç»„ä¼šèµ‹ç»™ tableï¼Œä¹Ÿå°±æ˜¯è¯´å…¶ä»–çº¿ç¨‹çš„éƒ½ä¼šä¸¢å¤±ï¼Œå¹¶ä¸”å„è‡ªçº¿ç¨‹ put çš„æ•°æ®ä¹Ÿä¸¢å¤±ã€‚å…³äº HashMap çº¿ç¨‹ä¸å®‰å…¨è¿™ä¸€ç‚¹ï¼Œã€ŠJavaå¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯ã€‹ä¸€ä¹¦ä¸­æ˜¯è¿™æ ·è¯´çš„ï¼š HashMap åœ¨å¹¶å‘æ‰§è¡Œ put æ“ä½œæ—¶ä¼šå¼•èµ·æ­»å¾ªç¯ï¼Œå¯¼è‡´ CPU åˆ©ç”¨ç‡æ¥è¿‘100%ã€‚å› ä¸ºå¤šçº¿ç¨‹ä¼šå¯¼è‡´ HashMap çš„ Node é“¾è¡¨å½¢æˆç¯å½¢æ•°æ®ç»“æ„ï¼Œä¸€æ—¦å½¢æˆç¯å½¢æ•°æ®ç»“æ„ï¼ŒNode çš„ next èŠ‚ç‚¹æ°¸è¿œä¸ä¸ºç©ºï¼Œå°±ä¼šåœ¨è·å– Node æ—¶äº§ç”Ÿæ­»å¾ªç¯ã€‚ å“‡å¡ï¼Œå¬ä¸Šå»siä¸siå¥½ç¥å¥‡ï¼Œå±…ç„¶ä¼šäº§ç”Ÿæ­»å¾ªç¯ã€‚ã€‚ã€‚ã€‚ google äº†ä¸€ä¸‹ï¼Œæ‰çŸ¥é“æ­»å¾ªç¯å¹¶ä¸æ˜¯å‘ç”Ÿåœ¨ put æ“ä½œæ—¶ï¼Œè€Œæ˜¯å‘ç”Ÿåœ¨æ‰©å®¹æ—¶ã€‚è¯¦ç»†çš„è§£é‡Šå¯ä»¥çœ‹ä¸‹é¢å‡ ç¯‡åšå®¢ï¼š é…·å£³-Java HashMapçš„æ­»å¾ªç¯ HashMapåœ¨javaå¹¶å‘ä¸­å¦‚ä½•å‘ç”Ÿæ­»å¾ªç¯ How does a HashMap work in JAVA å¦‚ä½•çº¿ç¨‹å®‰å…¨çš„ä½¿ç”¨HashMapäº†è§£äº† HashMap ä¸ºä»€ä¹ˆçº¿ç¨‹ä¸å®‰å…¨ï¼Œé‚£ç°åœ¨çœ‹çœ‹å¦‚ä½•çº¿ç¨‹å®‰å…¨çš„ä½¿ç”¨ HashMapã€‚è¿™ä¸ªæ— éå°±æ˜¯ä»¥ä¸‹ä¸‰ç§æ–¹å¼ï¼š Hashtable ConcurrentHashMap Synchronized Map ä¾‹å­ï¼š12345678//HashtableMap&lt;String, String&gt; hashtable = new Hashtable&lt;&gt;();//synchronizedMapMap&lt;String, String&gt; synchronizedHashMap = Collections.synchronizedMap(new HashMap&lt;String, String&gt;());//ConcurrentHashMapMap&lt;String, String&gt; concurrentHashMap = new ConcurrentHashMap&lt;&gt;(); ä¾æ¬¡æ¥çœ‹çœ‹ã€‚ Hashtableå…ˆç¨å¾®åæ§½ä¸€ä¸‹ï¼Œä¸ºå•¥å‘½åä¸æ˜¯ HashTable å•Šï¼Œçœ‹ç€å¥½éš¾å—ğŸ˜–ï¼Œä¸ç®¡äº†å°±è£…ä½œå®ƒå«HashTable å§ã€‚è¿™è´§å·²ç»ä¸å¸¸ç”¨äº†ï¼Œå°±ç®€å•è¯´è¯´å§ã€‚HashTable æºç ä¸­æ˜¯ä½¿ç”¨ synchronized æ¥ä¿è¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ¯”å¦‚ä¸‹é¢çš„ get æ–¹æ³•å’Œ put æ–¹æ³•ï¼š123456public synchronized V get(Object key) &#123; // çœç•¥å®ç° &#125;public synchronized V put(K key, V value) &#123; // çœç•¥å®ç° &#125; æ‰€ä»¥å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—® HashTable çš„åŒæ­¥æ–¹æ³•æ—¶ï¼Œå…¶ä»–çº¿ç¨‹å¦‚æœä¹Ÿè¦è®¿é—®åŒæ­¥æ–¹æ³•ï¼Œä¼šè¢«é˜»å¡ä½ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ put æ–¹æ³•æ—¶ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¸ä½†ä¸å¯ä»¥ä½¿ç”¨ put æ–¹æ³•ï¼Œè¿ get æ–¹æ³•éƒ½ä¸å¯ä»¥ï¼Œå¥½éœ¸é“å•Šï¼ï¼ï¼so~~ï¼Œæ•ˆç‡å¾ˆä½ï¼Œç°åœ¨åŸºæœ¬ä¸ä¼šé€‰æ‹©å®ƒäº†ã€‚ ConcurrentHashMapConcurrentHashMap (ä»¥ä¸‹ç®€ç§°CHM)æ˜¯ JUC åŒ…ä¸­çš„ä¸€ä¸ªç±»ï¼ŒSpring çš„æºç ä¸­æœ‰å¾ˆå¤šä½¿ç”¨ CHM çš„åœ°æ–¹ã€‚ä¹‹å‰å·²ç»ç¿»è¯‘è¿‡ä¸€ç¯‡å…³äº ConcurrentHashMap çš„åšå®¢ï¼Œå¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMapï¼Œé‡Œé¢ä»‹ç»äº† CHM åœ¨ Java ä¸­çš„å®ç°ï¼ŒCHM çš„ä¸€äº›é‡è¦ç‰¹æ€§å’Œä»€ä¹ˆæƒ…å†µä¸‹åº”è¯¥ä½¿ç”¨ CHMã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šé¢åšå®¢æ˜¯åŸºäº Java 7 çš„ï¼Œå’Œ8æœ‰åŒºåˆ«,åœ¨8ä¸­ CHM æ‘’å¼ƒäº† Segmentï¼ˆé”æ®µï¼‰çš„æ¦‚å¿µï¼Œè€Œæ˜¯å¯ç”¨äº†ä¸€ç§å…¨æ–°çš„æ–¹å¼å®ç°,åˆ©ç”¨ CAS ç®—æ³•ï¼Œæœ‰æ—¶é—´ä¼šé‡æ–°æ€»ç»“ä¸€ä¸‹ã€‚ SynchronizedMapçœ‹äº†ä¸€ä¸‹æºç ï¼ŒSynchronizedMap çš„å®ç°è¿˜æ˜¯å¾ˆç®€å•çš„ã€‚12345678910111213141516171819202122232425262728293031323334353637383940414243444546// synchronizedMapæ–¹æ³•public static &lt;K,V&gt; Map&lt;K,V&gt; synchronizedMap(Map&lt;K,V&gt; m) &#123; return new SynchronizedMap&lt;&gt;(m); &#125;// SynchronizedMapç±»private static class SynchronizedMap&lt;K,V&gt; implements Map&lt;K,V&gt;, Serializable &#123; private static final long serialVersionUID = 1978198479659022715L; private final Map&lt;K,V&gt; m; // Backing Map final Object mutex; // Object on which to synchronize SynchronizedMap(Map&lt;K,V&gt; m) &#123; this.m = Objects.requireNonNull(m); mutex = this; &#125; SynchronizedMap(Map&lt;K,V&gt; m, Object mutex) &#123; this.m = m; this.mutex = mutex; &#125; public int size() &#123; synchronized (mutex) &#123;return m.size();&#125; &#125; public boolean isEmpty() &#123; synchronized (mutex) &#123;return m.isEmpty();&#125; &#125; public boolean containsKey(Object key) &#123; synchronized (mutex) &#123;return m.containsKey(key);&#125; &#125; public boolean containsValue(Object value) &#123; synchronized (mutex) &#123;return m.containsValue(value);&#125; &#125; public V get(Object key) &#123; synchronized (mutex) &#123;return m.get(key);&#125; &#125; public V put(K key, V value) &#123; synchronized (mutex) &#123;return m.put(key, value);&#125; &#125; public V remove(Object key) &#123; synchronized (mutex) &#123;return m.remove(key);&#125; &#125; // çœç•¥å…¶ä»–æ–¹æ³• &#125; ä»æºç ä¸­å¯ä»¥çœ‹å‡ºè°ƒç”¨ synchronizedMap() æ–¹æ³•åä¼šè¿”å›ä¸€ä¸ª SynchronizedMap ç±»çš„å¯¹è±¡ï¼Œè€Œåœ¨ SynchronizedMap ç±»ä¸­ä½¿ç”¨äº† synchronized åŒæ­¥å…³é”®å­—æ¥ä¿è¯å¯¹ Map çš„æ“ä½œæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ æ€§èƒ½å¯¹æ¯”è¿™æ˜¯è¦é æ•°æ®è¯´è¯çš„æ—¶ä»£ï¼Œæ‰€ä»¥ä¸èƒ½åªé å˜´è¯´ CHM å¿«ï¼Œå®ƒå°±å¿«äº†ã€‚å†™ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œå®é™…çš„æ¯”è¾ƒä¸€ä¸‹è¿™ä¸‰ç§æ–¹å¼çš„æ•ˆç‡(æºç æ¥æº)ï¼Œä¸‹é¢çš„ä»£ç åˆ†åˆ«é€šè¿‡ä¸‰ç§æ–¹å¼åˆ›å»º Map å¯¹è±¡ï¼Œä½¿ç”¨ ExecutorService æ¥å¹¶å‘è¿è¡Œ5ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹æ·»åŠ /è·å–500Kä¸ªå…ƒç´ ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566public class CrunchifyConcurrentHashMapVsSynchronizedMap &#123; public final static int THREAD_POOL_SIZE = 5; public static Map&lt;String, Integer&gt; crunchifyHashTableObject = null; public static Map&lt;String, Integer&gt; crunchifySynchronizedMapObject = null; public static Map&lt;String, Integer&gt; crunchifyConcurrentHashMapObject = null; public static void main(String[] args) throws InterruptedException &#123; // Test with Hashtable Object crunchifyHashTableObject = new Hashtable&lt;&gt;(); crunchifyPerformTest(crunchifyHashTableObject); // Test with synchronizedMap Object crunchifySynchronizedMapObject = Collections.synchronizedMap(new HashMap&lt;String, Integer&gt;()); crunchifyPerformTest(crunchifySynchronizedMapObject); // Test with ConcurrentHashMap Object crunchifyConcurrentHashMapObject = new ConcurrentHashMap&lt;&gt;(); crunchifyPerformTest(crunchifyConcurrentHashMapObject); &#125; public static void crunchifyPerformTest(final Map&lt;String, Integer&gt; crunchifyThreads) throws InterruptedException &#123; System.out.println(\"Test started for: \" + crunchifyThreads.getClass()); long averageTime = 0; for (int i = 0; i &lt; 5; i++) &#123; long startTime = System.nanoTime(); ExecutorService crunchifyExServer = Executors.newFixedThreadPool(THREAD_POOL_SIZE); for (int j = 0; j &lt; THREAD_POOL_SIZE; j++) &#123; crunchifyExServer.execute(new Runnable() &#123; @SuppressWarnings(\"unused\") @Override public void run() &#123; for (int i = 0; i &lt; 500000; i++) &#123; Integer crunchifyRandomNumber = (int) Math.ceil(Math.random() * 550000); // Retrieve value. We are not using it anywhere Integer crunchifyValue = crunchifyThreads.get(String.valueOf(crunchifyRandomNumber)); // Put value crunchifyThreads.put(String.valueOf(crunchifyRandomNumber), crunchifyRandomNumber); &#125; &#125; &#125;); &#125; // Make sure executor stops crunchifyExServer.shutdown(); // Blocks until all tasks have completed execution after a shutdown request crunchifyExServer.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS); long entTime = System.nanoTime(); long totalTime = (entTime - startTime) / 1000000L; averageTime += totalTime; System.out.println(\"2500K entried added/retrieved in \" + totalTime + \" ms\"); &#125; System.out.println(\"For \" + crunchifyThreads.getClass() + \" the average time is \" + averageTime / 5 + \" ms\\n\"); &#125;&#125; æµ‹è¯•ç»“æœï¼š 1234567891011121314151617181920212223Test started for: class java.util.Hashtable2500K entried added/retrieved in 2018 ms2500K entried added/retrieved in 1746 ms2500K entried added/retrieved in 1806 ms2500K entried added/retrieved in 1801 ms2500K entried added/retrieved in 1804 msFor class java.util.Hashtable the average time is 1835 msTest started for: class java.util.Collections$SynchronizedMap2500K entried added/retrieved in 3041 ms2500K entried added/retrieved in 1690 ms2500K entried added/retrieved in 1740 ms2500K entried added/retrieved in 1649 ms2500K entried added/retrieved in 1696 msFor class java.util.Collections$SynchronizedMap the average time is 1963 msTest started for: class java.util.concurrent.ConcurrentHashMap2500K entried added/retrieved in 738 ms2500K entried added/retrieved in 696 ms2500K entried added/retrieved in 548 ms2500K entried added/retrieved in 1447 ms2500K entried added/retrieved in 531 msFor class java.util.concurrent.ConcurrentHashMap the average time is 792 ms è¿™ä¸ªå°±ä¸ç”¨åºŸè¯äº†ï¼ŒCHM æ€§èƒ½æ˜¯æ˜æ˜¾ä¼˜äº Hashtable å’Œ SynchronizedMap çš„,CHM èŠ±è´¹çš„æ—¶é—´æ¯”å‰ä¸¤ä¸ªçš„ä¸€åŠè¿˜å°‘ï¼Œå“ˆå“ˆï¼Œä»¥åå†æœ‰äººé—®å°±å¯ä»¥ç”©æ•°æ®äº†ã€‚ æ¬¢è¿æŒ‡æ­£é”™è¯¯ï¼Œæ¬¢è¿ä¸€èµ·è®¨è®ºã€‚å¦å¤–ï¼Œé’ˆå¯¹æç¦»èŒå½“å¤©å‘ç”Ÿçš„ä¸€ä¸ªå°æ’æ›²ï¼ŒçœŸçœŸæ˜¯ç»™æˆ‘ä¸Šäº†ä¸€è¯¾ï¼Œä¸æ˜¯æ‰€æœ‰äººéƒ½èƒ½æ¥å—å®è¯çš„ï¼Œåªæƒ³å¼•ç”¨æ¬¢ä¹é¢‚é‡Œå®‰è¿ªçš„ä¸€å¥è¯:å¸¸ä¸åŒå¥½äº‰é«˜ä¸‹,ä¸ä¸å‚»ç“œè®ºçŸ­é•¿ã€‚ éƒ½çœ‹åˆ°è¿™äº†ï¼Œå…³æ³¨ä¸ªå…¬ä¼—å·å†èµ°å§ğŸ™ˆ","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"},{"name":"hashmap","slug":"java/hashmap","permalink":"http://yemengying.com/categories/java/hashmap/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"hashMap","slug":"hashMap","permalink":"http://yemengying.com/tags/hashMap/"}]},{"title":"è§‰å¾—è¿˜ä¸é”™çš„ç½‘ç«™","slug":"good-website","date":"2016-04-24T13:35:44.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/04/24/good-website/","link":"","permalink":"http://yemengying.com/2016/04/24/good-website/","excerpt":"æ•´ç†ä¸‹æ”¶è—å¤¹ä¸­è§‰å¾—è¿˜ä¸é”™çš„ç½‘ç«™æˆ–èµ„æ–™ï¼Œä¸æ¶‰åŠè®¢é˜…çš„åšå®¢ï¼Œä¸»è¦æ˜¯å› ä¸ºä¸€å¼€å§‹æ”¶è—å¤¹å¹¶æ²¡æœ‰åˆ†ç±»æ‰€ä»¥å°±ä¹±äº†ï¼Œä¸æ–¹ä¾¿æ‰¾ğŸ˜‚ï¼Œå«‘åæ§½æˆ‘ã€‚ã€‚ã€‚ã€‚","keywords":null,"text":"æ•´ç†ä¸‹æ”¶è—å¤¹ä¸­è§‰å¾—è¿˜ä¸é”™çš„ç½‘ç«™æˆ–èµ„æ–™ï¼Œä¸æ¶‰åŠè®¢é˜…çš„åšå®¢ï¼Œä¸»è¦æ˜¯å› ä¸ºä¸€å¼€å§‹æ”¶è—å¤¹å¹¶æ²¡æœ‰åˆ†ç±»æ‰€ä»¥å°±ä¹±äº†ï¼Œä¸æ–¹ä¾¿æ‰¾ğŸ˜‚ï¼Œå«‘åæ§½æˆ‘ã€‚ã€‚ã€‚ã€‚ é•‡æ¥¼1.https://www.google.com2.http://stackoverflow.com/3.https://github.com/è¿™ä¸‰ä¸ªå¤§å®¶éƒ½æ‡‚ã€‚ã€‚æŠŠå®ƒä»¬æ”¾ä¸Šæ¥çš„ä¸»è¦ç›®çš„æ˜¯ã€‚ã€‚ã€‚æ’‘åœºå­ã€‚ã€‚ã€‚ Redisç›¸å…³ å®˜ç½‘1.http://redis.io/(è‹±æ–‡ç‰ˆ)2.http://www.redis.cn/(ä¸­æ–‡ç‰ˆ) å…¶å®ƒç½‘ç«™1.http://try.redis.io/(å¯ä»¥åœ¨çº¿ç»ƒä¹ rediså¸¸ç”¨å‘½ä»¤)2.http://redisdoc.com/(æŸ¥æ‰¾rediså‘½ä»¤çš„è¯¦ç»†ä¿¡æ¯ åŒ…æ‹¬æŸ¥çœ‹å‘½ä»¤çš„è¿”å›å€¼å’Œæ—¶é—´å¤æ‚åº¦) ä¸€æœ¬çŸ­å°ç²¾æ‚çš„ç”µå­ä¹¦1.https://github.com/karlseguin/the-little-redis-book(è‹±æ–‡åŸç‰ˆ)2.https://github.com/JasonLai256/the-little-redis-book/blob/master/cn/redis.md(ä¸­æ–‡è¯‘ç‰ˆ) ç®—æ³•å’Œæ•°æ®ç»“æ„ç›¸å…³ å…¬å¼€è¯¾http://open.163.com/special/opencourse/(ç½‘æ˜“å…¬å¼€è¯¾ä¸Šçš„éº»çœç†å·¥ç®—æ³•å¯¼è®ºè¯¾ç¨‹) åšé¢˜https://leetcode.com/(leetcode,ç±»ä¼¼ç½‘ç«™æœ‰å¥½å‡ ä¸ªï¼Œæœ‰é€‰æ‹©ææƒ§ç—‡å°±æ”¾ä¸€ä¸ªå§ï¼‰ å…¶å®ƒç½‘ç«™http://algorithms.tutorialhorizon.com/(æœ€è¿‘ç‰¹åˆ«çˆ±çš„ä¸€ä¸ªç½‘ç«™ï¼Œè®²è§£å„ç§ç®—æ³•çš„ï¼Œæœ‰å›¾è§£ï¼Œæœ‰codeï¼Œç®€ç›´ä¸èƒ½æ›´èµï¼Œåªèƒ½æ„ä¼šä¸å¯è¨€ä¼ ï¼Œç‚¹è¿›å»çœ‹çœ‹å§)http://visualgo.net/ ï¼ˆä¸€ä¸ªé€šè¿‡åŠ¨å›¾å¸®åŠ©ç†è§£æ•°æ®ç»“æ„çš„ç½‘ç«™ æ¯”è¾ƒé€‚åˆåˆå­¦è€… è‹±æ–‡ç‰ˆï¼‰http://zh.visualgo.net/ï¼ˆä¸Šé¢ç½‘ç«™çš„ä¸­æ–‡ç‰ˆï¼‰ ä»€ä¹ˆéƒ½èƒ½å­¦ æ•™ç¨‹ç½‘ç«™1.http://tutorials.jenkov.com/(å…³äºJavaï¼ŒWeb ï¼ŒMobile and so on)2.http://www.sitepoint.com(æ„Ÿè§‰æ˜¯ä¸ªä¸é”™çš„ç½‘ç«™ï¼Œä¸è¿‡å…³äºJavaçš„å†…å®¹ä¸å¤ªå¤šï¼Œæ‰€ä»¥ä¹Ÿæ²¡å¸¸çœ‹) ä¸çŸ¥é“æ€ä¹ˆåˆ†ç±»1.http://overapi.com/(ç½‘ç«™æ”¶é›†äº†å¾ˆå¤šå¾ˆæœ‰ç”¨çš„æ‰‹å†Œï¼Œå¼€å‘æ—¶å¯ä»¥èŠ‚çœå¾ˆå¤šæ—¶é—´)2.https://www.reddit.com/(ä¿¡æ¯é‡æ¯”è¾ƒå¤§çš„ç½‘ç«™ï¼Œæ¯”è¾ƒå–œæ¬¢å»ä¸Šé¢çœ‹äº›æç¬‘çš„å›¾ç‰‡)3.https://news.ycombinator.com/(ä¸æ˜¯å¾ˆå–œæ¬¢å®ƒçš„é¡µé¢ã€‚ã€‚ã€‚)4.https://www.v2ex.com/ï¼ˆå¯ä»¥ä¸Šå»æ‰¾å·¥ä½œ å“ˆå“ˆï¼‰5.https://wanqu.co/(æ¹¾åŒºæ—¥æŠ¥ æ¯å¤©æ¨é€5ç¯‡ä¼˜è´¨è‹±æ–‡æ–‡ç« ) çªç„¶å‘ç°ç›®å‰æœ€å¹¸ç¦çš„äº‹å°±æ˜¯åœ¨é‡çœ‹ä»¥å‰çš„Running Manæ—¶ï¼Œå‘ç°æœ‰ä¸€é›†æ²¡çœ‹è¿‡ğŸ˜œã€‚ã€‚ä¸å†™äº† å»çœ‹wuliå…‰æ´™äº†ğŸ˜","raw":null,"content":null,"categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/categories/éšç¬”/"}],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/tags/éšç¬”/"}]},{"title":"Redisç›¸å…³---RedisæŒä¹…åŒ–(AOF&Snapshot)","slug":"Redis-Persistence","date":"2016-04-24T07:09:18.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/04/24/Redis-Persistence/","link":"","permalink":"http://yemengying.com/2016/04/24/Redis-Persistence/","excerpt":"æ©ï¼Œå…ˆè¯´ç‚¹é¢˜å¤–è¯ã€‚ä¸Šå‘¨è¢«å°è™äº†ä¸€ä¸¢ä¸¢,ä½†æœ‰å¾ˆå¤§æ”¶è·,äº†è§£äº†è‡ªå·±çš„ä¸è¶³,çŸ¥é“äº†è‡ªå·±è¿˜åœ¨å“ªäº›æ–¹é¢æœ‰æ¬ ç¼ºã€‚æ›´åšå®šäº†ä¸€ç›´ä»¥æ¥çš„æƒ³æ³•,åº”å±Šç”Ÿæˆ–è€…å·¥ä½œæ—¶é—´ä¸é•¿çš„äººæ‰¾å·¥ä½œå…¬å¸è§„æ¨¡ï¼Œç¦åˆ©è–ªèµ„éƒ½æ˜¯æµ®äº‘ï¼Œè·Ÿå¯¹äººæ‰æ˜¯æœ€é‡è¦çš„,éå¸¸åŠå…¶ä»¥åŠç‰¹åˆ«çš„é‡è¦,ä¸€ä¸ªäººå¥½æŠ€æœ¯ç‰›çš„éƒ¨é—¨leaderç»å¯¹æŠµå¾—ä¸Š5Kçš„è–ªèµ„ã€‚è¿™ä¹Ÿå®Œç¾è§£é‡Šäº†ä¸ºä½•éƒ¨é—¨æ‹†åˆ†,è€å¤§å’Œç£Šå“¥èµ°äº†ä¹‹åè¿™ä¹ˆä¸èˆ’æœ,è¿™å°¼ç›ç›¸å½“äºç»™æˆ‘å‡äº†5Kçš„å·¥èµ„å•Š,æ‰¯è¿œäº†ã€‚ã€‚ã€‚ã€‚è¿˜æ˜¯æ¥çœ‹Rediså§ï¼Œæ•´ç†ä¸‹RedisæŒä¹…åŒ–çš„ç›¸å…³å†…å®¹ï¼ŒåŠ æ·±ä¸‹å°è±¡ã€‚ä¸æƒ³çœ‹æ–‡å­—çš„å¯ç›´æ¥çœ‹ä¸‹é¢çš„å›¾ğŸ˜‚ã€‚","keywords":null,"text":"æ©ï¼Œå…ˆè¯´ç‚¹é¢˜å¤–è¯ã€‚ä¸Šå‘¨è¢«å°è™äº†ä¸€ä¸¢ä¸¢,ä½†æœ‰å¾ˆå¤§æ”¶è·,äº†è§£äº†è‡ªå·±çš„ä¸è¶³,çŸ¥é“äº†è‡ªå·±è¿˜åœ¨å“ªäº›æ–¹é¢æœ‰æ¬ ç¼ºã€‚æ›´åšå®šäº†ä¸€ç›´ä»¥æ¥çš„æƒ³æ³•,åº”å±Šç”Ÿæˆ–è€…å·¥ä½œæ—¶é—´ä¸é•¿çš„äººæ‰¾å·¥ä½œå…¬å¸è§„æ¨¡ï¼Œç¦åˆ©è–ªèµ„éƒ½æ˜¯æµ®äº‘ï¼Œè·Ÿå¯¹äººæ‰æ˜¯æœ€é‡è¦çš„,éå¸¸åŠå…¶ä»¥åŠç‰¹åˆ«çš„é‡è¦,ä¸€ä¸ªäººå¥½æŠ€æœ¯ç‰›çš„éƒ¨é—¨leaderç»å¯¹æŠµå¾—ä¸Š5Kçš„è–ªèµ„ã€‚è¿™ä¹Ÿå®Œç¾è§£é‡Šäº†ä¸ºä½•éƒ¨é—¨æ‹†åˆ†,è€å¤§å’Œç£Šå“¥èµ°äº†ä¹‹åè¿™ä¹ˆä¸èˆ’æœ,è¿™å°¼ç›ç›¸å½“äºç»™æˆ‘å‡äº†5Kçš„å·¥èµ„å•Š,æ‰¯è¿œäº†ã€‚ã€‚ã€‚ã€‚è¿˜æ˜¯æ¥çœ‹Rediså§ï¼Œæ•´ç†ä¸‹RedisæŒä¹…åŒ–çš„ç›¸å…³å†…å®¹ï¼ŒåŠ æ·±ä¸‹å°è±¡ã€‚ä¸æƒ³çœ‹æ–‡å­—çš„å¯ç›´æ¥çœ‹ä¸‹é¢çš„å›¾ğŸ˜‚ã€‚ AOFæŒä¹…åŒ–AOF(append-only fileåªè¿½åŠ æ–‡ä»¶)æŒä¹…åŒ–ä¼šå°†æ‰§è¡Œçš„å†™å‘½ä»¤è¿½åŠ åˆ°AOFæ–‡ä»¶çš„æœ«å°¾ã€‚åœ¨æ¢å¤æ•°æ®æ—¶ï¼Œåªè¦ä»å¤´åˆ°å°¾çš„æ‰§è¡ŒAOFæ–‡ä»¶ä¸­åŒ…å«çš„æ‰€æœ‰å†™å‘½ä»¤å³å¯ AOFå¯ç”¨é…ç½® é…ç½®é¡¹ å«ä¹‰ å¯é€‰å€¼ appendonly æ˜¯å¦å¼€å¯AOFæŒä¹…åŒ– no,yes appendfsync å°†å†™å‘½ä»¤åŒæ­¥åˆ°ç¡¬ç›˜çš„é—´éš” everysec,always,no no-appendfsync-on-rewrite å¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©æ—¶èƒ½å¦æ‰§è¡ŒåŒæ­¥æ“ä½œ no,yes auto-aof-rewrite-percentage å½“å‰æ–‡ä»¶å¤§å°æ˜¯ä¸Šä¸€æ¬¡å‹ç¼©åAOFæ–‡ä»¶å¤§å°çš„å¤šå°‘æ—¶æ‰§è¡Œè‡ªåŠ¨å‹ç¼© auto-aof-rewrite-min-size å½“å‰æ–‡ä»¶å¤§å°æ˜¯å¤šå°‘æ—¶æ‰§è¡Œè‡ªåŠ¨å‹ç¼© dir path/to/appendonly.aof æ–‡ä»¶å­˜æ”¾ä½ç½® å…¶å®ä¸»è¦çš„å°±æ˜¯appendfsyncé…ç½®é¡¹ï¼Œæœ‰ä¸‰ä¸ªå¯é€‰å€¼ï¼Œalways(æ¯æ¬¡æ‰§è¡Œå†™æ“ä½œéƒ½è¦åŒæ­¥å†™å…¥ç¡¬ç›˜),everysec(æ¯ç§’æ‰§è¡Œä¸€æ¬¡åŒæ­¥),no(è®©ç³»ç»Ÿå†³å®šä½•æ—¶æ‰§è¡ŒåŒæ­¥)ã€‚è™½ç„¶é€‰æ‹©alwayså¯å°†æ•°æ®ä¸¢å¤±å‡å°‘åˆ°æœ€å°‘ï¼Œä½†è¿™ç§ç­–ç•¥ä¼šå¯¹ç¡¬ç›˜è¿›è¡Œå¤§é‡çš„å†™å…¥æ“ä½œï¼Œå¤„ç†å‘½ä»¤é€Ÿåº¦å—åˆ°ç¡¬ç›˜é™åˆ¶ã€‚å»ºè®®é€‰æ‹©everysecã€‚ AOFä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼š æ¯”å¿«ç…§æ–¹å¼å¯é ï¼Œé»˜è®¤æ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼Œæ„å‘³ç€æœ€å¤šä¸¢å¤±ä¸€ç§’çš„æ•°æ® ç¼ºç‚¹ï¼š ç›¸åŒæ•°æ®é›†å¤§å°ï¼ŒAOFæ–‡ä»¶ä¼šæ¯”å¿«ç…§æ–‡ä»¶å¤§ AOFæ–‡ä»¶æ ¼å¼ä¸€å¼€å§‹ä»¥ä¸ºRediså°±æ˜¯å°†å†™å‘½ä»¤åŸå°ä¸åŠ¨çš„å­˜å‚¨åˆ°AOFæ–‡ä»¶ä¸­ï¼Œè‡ªå·±è¯•äº†ä¸€ä¸‹æ‰çŸ¥é“ï¼ŒAOFæ–‡ä»¶æ˜¯ä½¿ç”¨Redisç½‘ç»œé€šè®¯åè®®çš„æ ¼å¼æ¥ä¿å­˜è¿™äº›å‘½ä»¤ã€‚ä¸¾ä¸ªğŸŒ°ï¼š12127.0.0.1:6379&gt; set number 21OK å°†ä¸Šé¢çš„å‘½ä»¤å­˜å‚¨åˆ°AOFæ–‡ä»¶å°±æ˜¯ä¸‹é¢çš„æ ·å­ï¼ˆselect 0å‘½ä»¤æ˜¯ä»£è¡¨é€‰æ‹©idä¸º0çš„æ•°æ®åº“ï¼‰ï¼š 123456789101112*2$6SELECT$10*3$3SET$6number$221 æ¥çœ‹ä¸‹AOFæ–‡ä»¶çš„æ ¼å¼ï¼Œäº†è§£å®ƒçš„æ ¼å¼å¯ä»¥è®©æˆ‘ä»¬å¾ˆå®¹æ˜“çš„è§£æå®ƒï¼ŒæŒ‡ä¸å®šå“ªå¤©èƒ½ç”¨åˆ°å•ŠğŸŒã€‚*å·ä»£è¡¨å‘½ä»¤å‚æ•°çš„ä¸ªæ•°(åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­å‚æ•°ä¸ºsetã€numberã€21,å…±3ä¸ª)ï¼Œ$å·ä»£è¡¨ç¬¬Nä¸ªå‚æ•°çš„é•¿åº¦ï¼Œåœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œä¸‰ä¸ªå‚æ•°çš„é•¿åº¦åˆ†åˆ«ä¸º3ï¼Œ6ï¼Œ2ã€‚ å‹ç¼©AOFæ–‡ä»¶Rediså¯ä»¥è‡ªåŠ¨å‹ç¼©(ä¹Ÿå¯ä»¥å«é‡å†™)AOFæ–‡ä»¶ï¼Œç”¨æˆ·ä¹Ÿå¯ä»¥é€šè¿‡BGREWRITEAOFå‘½ä»¤æ¥å‹ç¼©AOFæ–‡ä»¶ã€‚è¿™é‡Œçš„å‹ç¼©ï¼Œä¸æ˜¯å¹³æ—¶è¯´çš„å‹ç¼©çš„æ„æ€ï¼Œæ˜¯æŒ‡åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶æ¥æ›¿æ¢æ—§çš„æ–‡ä»¶ï¼Œä¸¤ä¸ªæ–‡ä»¶ä¿å­˜çš„æ•°æ®çŠ¶æ€å®Œå…¨ä¸€è‡´ã€‚å¦‚æœåœ¨æœ¬åœ°æ‰‹åŠ¨æ‰§è¡ŒBGREWRITEAOFå‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°ä¼šç”Ÿæˆä¸€ä¸ªtemp-rewriteaof-*.aofçš„ä¸´æ—¶æ–‡ä»¶ï¼Œåœ¨ç»“æŸåæ›¿æ¢appendonly.aofæ–‡ä»¶ï¼Œä»è€Œå‡å°appendonly.aofæ–‡ä»¶çš„å¤§å°ã€‚æˆ‘çŸ¥é“è¿™æ ·è¯´å…¶å®è¿˜æ˜¯ä¸å¥½ç†è§£ï¼Œè¿˜æ˜¯ä¸Šå›¾å§ã€‚ä¸ºäº†æ–¹ä¾¿ç”»å›¾ï¼Œæˆ‘å°±é»˜é»˜å‡è£…Redisç›´æ¥å°†å‘½ä»¤æŒ‰è¾“å…¥çš„æ ·å­å­˜å‚¨åˆ°AOFæ–‡ä»¶ä¸­ï¼Œä¸è¦æ‹†ç©¿æˆ‘ğŸ™ˆã€‚å‡è®¾æ‰§è¡Œçš„å†™å‘½ä»¤æ˜¯ä¸‹é¢çš„æ ·å­ï¼šé‚£ä¹ˆçœ‹çœ‹åœ¨å‹ç¼©å‰AOFæ–‡ä»¶çš„æ ·å­(å°±æ˜¯å­˜å‚¨äº†é™¤getå‘½ä»¤å¤–çš„æ‰€æœ‰å†™å‘½ä»¤)ï¼šæ¥ç€æ‰§è¡ŒBGREWRITEAOFå‘½ä»¤ï¼ŒRedisä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æ–‡ä»¶æ¥æ›¿æ¢æ—§çš„AOFæ–‡ä»¶ï¼Œä»è€Œè¾¾åˆ°å‹ç¼©çš„ç›®çš„ï¼š å¯ä»¥çœ‹åˆ°å‹ç¼©å‰æ–‡ä»¶ä¸­å­˜å‚¨äº†7æ¡å†™å‘½ä»¤ï¼Œå‹ç¼©ååªå­˜å‚¨ä¸€æ¡ã€‚è€Œä¸”æ‰§è¡Œset number 1å’Œ6æ¬¡incr numberå‘½ä»¤ ï¼Œä¸æ‰§è¡Œset number 7å‘½ä»¤æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚ä»è€Œå³ä¿è¯äº†æ•°æ®çš„æ­£ç¡®æ€§åˆå‹ç¼©äº†æ–‡ä»¶çš„å¤§å°ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒRedisæ˜¯å¯ç”¨å­è¿›ç¨‹æ¥è¿›è¡ŒAOFæ–‡ä»¶çš„å‹ç¼©ï¼Œåœ¨è¿™æœŸé—´ä¸»è¿›ç¨‹è¿˜æ˜¯å¯ä»¥ç»§ç»­å¤„ç†è¯·æ±‚çš„ï¼Œå¦‚æœè¿™æ—¶è¯·æ±‚æœ‰å†™æ“ä½œå°±å¯èƒ½å¯¼è‡´å½“å‰æ•°æ®åº“ä¸å‹ç¼©åçš„AOFä¸ä¸€è‡´ã€‚Rediså¢åŠ äº†ä¸€ä¸ªç¼“å­˜æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸»è¿›ç¨‹åœ¨æ¥æ”¶åˆ°æ–°çš„å†™æ“ä½œå‘½ä»¤ä¹‹åï¼Œä¼šå°†å‘½ä»¤å†™å…¥ç°æœ‰çš„AOFæ–‡ä»¶å’Œç¼“å­˜ä¸­ã€‚åœ¨å­è¿›ç¨‹å®Œæˆæ–°çš„AOFæ–‡ä»¶ä¹‹åä¼šå°†ç¼“å­˜çš„å†…å®¹å†™å…¥åˆ°æ–°çš„AOFæ–‡ä»¶ä¸­ï¼Œå¹¶æ”¹åè¦†ç›–æ—§çš„AOFæ–‡ä»¶ã€‚ å¿«ç…§æŒä¹…åŒ–å¿«ç…§å¯ç”¨é…ç½® é…ç½®é¡¹ å«ä¹‰ å¯é€‰å€¼ save m n mç§’å†…æœ‰næ¬¡å†™å…¥æ—¶åˆ›å»ºå¿«ç…§ stop-writes-on-bgsave-error åˆ›å»ºå¿«ç…§å¤±è´¥åæ˜¯å¦ç»§ç»­æ‰§è¡Œå†™å‘½ä»¤ no,yes rdbcomression æ˜¯å¦å‹ç¼©å¿«ç…§æ–‡ä»¶ no,yes dbfilename å‘½åå¿«ç…§æ–‡ä»¶ dir path/to/dump.rdb æ–‡ä»¶å­˜æ”¾ä½ç½® RDBæ–‡ä»¶ç»“æ„RDBæ–‡ä»¶æ˜¯ä¸€ä¸ªç»è¿‡å‹ç¼©çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸åŒç±»å‹çš„é”®å€¼å¯¹ä¼šé‡‡ç”¨ä¸åŒçš„æ–¹å¼æ¥ä¿å­˜å®ƒä»¬ã€‚å…·ä½“çš„ç»“æ„æˆ‘ä¹Ÿè¿˜æ²¡ç†æ¸…æ¥šã€‚ã€‚å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« http://redisbook.com/preview/rdb/rdb_struct.html åˆ›å»ºå¿«ç…§åˆ›å»ºå¿«ç…§çš„æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š å®¢æˆ·ç«¯å‘é€BGSAVEå‘½ä»¤ã€‚ä¸å‹ç¼©AOFæ–‡ä»¶ä¸€æ ·ï¼ŒRedisä¼šforkå‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œç”±å­è¿›ç¨‹è´Ÿè´£å°†å¿«ç…§å†™å…¥ç¡¬ç›˜ã€‚ å®¢æˆ·ç«¯å‘é€SAVEå‘½ä»¤ã€‚Redisä¼šå¼€å§‹åˆ›å»ºå¿«ç…§ï¼Œå¹¶ä¸”åœ¨å¿«ç…§åˆ›å»ºå®Œæˆä¹‹å‰ä¸å†å¤„ç†å…¶ä»–å‘½ä»¤ã€‚ä¸å¸¸ä½¿ç”¨SAVEå‘½ä»¤ åœ¨æ»¡è¶³é…ç½®çš„save m né€‰é¡¹æ—¶ã€‚æ¯”å¦‚ï¼Œé…ç½®äº†save 60 1000,ä¼šåœ¨æ»¡è¶³60ç§’å†…æœ‰1000æ¬¡å†™å…¥çš„æ—¶å€™å¼€å§‹åˆ›å»ºå¿«ç…§ã€‚ å½“æ¥æ”¶åˆ°SHUTDOWNè¯·æ±‚æ—¶ï¼ŒRedisä¼šæ‰§è¡ŒSAVEå‘½ä»¤,å¹¶ä¸”ä¸å†æ‰§è¡Œä»»ä½•å…¶ä»–å‘½ä»¤ã€‚ å½“ä»æœåŠ¡å™¨å‘ä¸»æœåŠ¡å™¨å‘é€SYNCå‘½ä»¤æ—¶ï¼Œå¦‚æœä¸»æœåŠ¡å™¨ä¸æ˜¯åˆšåˆšæ‰§è¡Œè¿‡BGSAVEå‘½ä»¤,å°±ä¼šå¼€å§‹æ‰§è¡ŒBGSAVEæ¥åˆ›å»ºå¿«ç…§ã€‚ å¿«ç…§ä¼˜ç¼ºç‚¹ä¼˜ç‚¹ï¼š æ–‡ä»¶ç´§å‡‘,é€‚ç”¨äºåšä¸åŒç‰ˆæœ¬çš„æ•°æ®å¤‡ä»½ ä¸AOFç›¸æ¯”åœ¨æ¢å¤å¤§æ•°æ®é›†æ—¶ï¼Œæ›´å¿« å¾ˆæ–¹ä¾¿ä¼ é€åˆ°å¦ä¸€ä¸ªæ•°æ®ä¸­å¿ƒ ç¼ºç‚¹ï¼š ä¸€æ—¦Rediså‡ºç°é—®é¢˜ï¼Œä¸Šä¸€æ¬¡åˆ›å»ºå¿«ç…§ä¹‹åçš„æ•°æ®å°±ä¸¢å¤±äº† å‚è€ƒæ–‡æ¡£ã€ŠRedis In Actionã€‹http://www.redis.cn/topics/persistence.htmlhttp://redisbook.readthedocs.org/en/latest/internal/aof.html","raw":null,"content":null,"categories":[{"name":"redis","slug":"redis","permalink":"http://yemengying.com/categories/redis/"}],"tags":[{"name":"redis","slug":"redis","permalink":"http://yemengying.com/tags/redis/"}]},{"title":"Redisç›¸å…³---ã€è¯‘ã€‘åˆ©ç”¨Redisèµ·é£å§","slug":"take-advantage-of-Redis","date":"2016-04-02T02:56:03.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/04/02/take-advantage-of-Redis/","link":"","permalink":"http://yemengying.com/2016/04/02/take-advantage-of-Redis/","excerpt":"ä¸€ç›´ä»¥æ¥å¯¹Redisçš„ä½¿ç”¨éƒ½å¾ˆæ˜¯ç®€å•ç²—æš´ï¼Œä¸å¾—ç²¾é«“ï¼Œè¶å‡æœŸå¥½å¥½è¡¥è¡¥ã€‚ç¿»è¯‘ä¸€ç¯‡Redisä¹‹çˆ¶Antirezçš„åšå®¢ï¼Œæ–‡ç« ä¸­è®²è¿°äº†å‡ ä¸ªåˆ©ç”¨Redisè§£å†³å®é™…é—®é¢˜çš„ä¾‹å­ã€‚å¹¶éé€å­—é€å¥çš„ç¿»è¯‘ï¼Œæœ‰äº›ä¸å¤ªæ‡‚çš„åœ°æ–¹å°±ä»»æ€§çš„è·³è¿‡äº†ğŸ˜‹ï¼Œç¿»è¯‘è¿™ç¯‡åšå®¢åªåšåŠ æ·±å°è±¡ä¹‹ç”¨ï¼Œå»ºè®®å¤§å®¶è¿˜æ˜¯å‡ºé—¨å·¦è½¬çœ‹åŸæ–‡å§ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ åŸæ–‡åœ°å€ï¼šhttp://oldblog.antirez.com/post/take-advantage-of-redis-adding-it-to-your-stack.html","keywords":null,"text":"ä¸€ç›´ä»¥æ¥å¯¹Redisçš„ä½¿ç”¨éƒ½å¾ˆæ˜¯ç®€å•ç²—æš´ï¼Œä¸å¾—ç²¾é«“ï¼Œè¶å‡æœŸå¥½å¥½è¡¥è¡¥ã€‚ç¿»è¯‘ä¸€ç¯‡Redisä¹‹çˆ¶Antirezçš„åšå®¢ï¼Œæ–‡ç« ä¸­è®²è¿°äº†å‡ ä¸ªåˆ©ç”¨Redisè§£å†³å®é™…é—®é¢˜çš„ä¾‹å­ã€‚å¹¶éé€å­—é€å¥çš„ç¿»è¯‘ï¼Œæœ‰äº›ä¸å¤ªæ‡‚çš„åœ°æ–¹å°±ä»»æ€§çš„è·³è¿‡äº†ğŸ˜‹ï¼Œç¿»è¯‘è¿™ç¯‡åšå®¢åªåšåŠ æ·±å°è±¡ä¹‹ç”¨ï¼Œå»ºè®®å¤§å®¶è¿˜æ˜¯å‡ºé—¨å·¦è½¬çœ‹åŸæ–‡å§ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ åŸæ–‡åœ°å€ï¼šhttp://oldblog.antirez.com/post/take-advantage-of-redis-adding-it-to-your-stack.html å†™åœ¨å‰é¢ Redisåœ¨å¾ˆå¤šæ–¹é¢ä¸åŒäºMySqlç­‰æ•°æ®åº“ï¼šæ¯”å¦‚ï¼ŒRedisä½¿ç”¨å†…å­˜åšä¸»è¦çš„å­˜å‚¨ï¼Œä½¿ç”¨ç£ç›˜å®ç°æ•°æ®æŒä¹…åŒ–ï¼›æ•°æ®æ¨¡å‹ä¸åŒï¼›Redisæ˜¯å•çº¿ç¨‹çš„ç­‰ç­‰ã€‚ä½†æˆ‘è®¤ä¸ºæœ€å¤§çš„ä¸åŒæ˜¯å¦‚æœå¼€å‘è€…æƒ³è¦ä½¿ç”¨Redisï¼Œæ— éœ€åˆ‡æ¢åˆ°Redisã€‚å¯ä»¥åœ¨ä¸æŠŠRedisä½œä¸ºæ•°æ®åº“çš„å‰æä¸‹ï¼Œåˆ©ç”¨Rediså®ç°ä¸€äº›ä»¥å‰ä¸å¥½å®ç°çš„åŠŸèƒ½æˆ–è€…ä¼˜åŒ–é—ç•™çš„é—®é¢˜ã€‚ å®Œå…¨åˆ‡æ¢åˆ°Rediså½“ç„¶ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œè®¸å¤šå¼€å‘è€…åœ¨æƒ³ä½¿ç”¨Redisçš„ä¸€äº›ç‰¹æ€§æ—¶ï¼Œä¼šå°†Rediså½“åšä¸»æ•°æ®åº“ï¼Œä½†å°†ä¸€ä¸ªå·²ç»åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œçš„é¡¹ç›®åˆ‡æ¢åˆ°Redisæ˜¾ç„¶æ˜¯ä¸ªå¤§å·¥ç¨‹ã€‚è€Œä¸”æœ‰ä¸€äº›åº”ç”¨å¹¶ä¸é€‚åˆå°†Redisä½œä¸ºæ•°æ®åº“ï¼šæ¯”å¦‚Redisçš„æ•°æ®é›†ä¸èƒ½æ¯”å¯ç”¨å†…å­˜å¤§ï¼Œæ‰€ä»¥å¯¹äºå¤§æ•°æ®é‡çš„åº”ç”¨ï¼ŒRediså¯èƒ½ä¸æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ã€‚ä¸‹é¢ä¼šä»‹ç»ä¸€äº›åœ¨å·²æœ‰é¡¹ç›®ä¸­åŠ å…¥Redisçš„ä¾‹å­ï¼Œä¼šå‘å¤§å®¶å±•ç¤ºå¦‚ä½•åœ¨ä¸æŠŠRediså½“åšä¸»è¦æ•°æ®åº“çš„æƒ…å†µä¸‹åˆ©ç”¨Redisçš„æŸäº›ç‰¹æ€§è§£å†³é—®é¢˜ã€‚ åœ¨ä¸»é¡µå±•ç¤ºæœ€æ–°çš„è¯„è®ºåˆ—è¡¨æˆ‘æ•¢æ‰“èµŒï¼Œå¦‚æœæ¯æ¬¡éƒ½é€šè¿‡ä¸‹é¢çš„æŸ¥è¯¢è¯­å¥è·å–æœ€æ–°è¯„è®ºï¼Œé‚£ä¹ˆç½‘ç«™æ€§èƒ½ä¼šå¾ˆå·®ã€‚1SELECT * FROM foo WHERE ... ORDER BY time DESC LIMIT 10 å±•ç°æœ€æ–°æ·»åŠ çš„æŸäº›ä¸œè¥¿åœ¨ç½‘ç«™åº”ç”¨ä¸­ååˆ†å¸¸è§ï¼Œä¸‹é¢çœ‹çœ‹å¦‚ä½•åˆ©ç”¨Redisä¼˜åŒ–è¿™ç±»é—®é¢˜ã€‚å‡è®¾ç½‘ç«™æƒ³è¦å±•ç¤ºæœ€æ–°çš„20æ¡è¯„è®ºï¼Œå¹¶ä¸”è¿˜æœ‰ä¸ªâ€œå±•ç¤ºå…¨éƒ¨è¯„è®ºâ€çš„é“¾æ¥ï¼Œé€šè¿‡è¿™ä¸ªé“¾æ¥å¯ä»¥é€šè¿‡åˆ†é¡µçš„å½¢å¼æŸ¥çœ‹å†å²è¯„è®ºè®°å½•ã€‚æˆ‘ä»¬è¿˜å‡è®¾æ¯æ¡è¯„è®ºéƒ½å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªè‡ªå¢çš„Idã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå¾ˆç®€å•çš„RedisåŒæ—¶è§£å†³å±•ç°æœ€æ–°è¯„è®ºå’Œåˆ†é¡µå±•ç°å†å²è¯„è®ºçš„é—®é¢˜ã€‚ æ¯å½“åˆ›å»ºä¸€æ¡æ–°çš„è¯„è®ºï¼Œå°†è¯„è®ºçš„Idæ’å…¥åˆ°Redisçš„ä¸€ä¸ªåˆ—è¡¨ä¸­:LPUSH latest.comments Redisæ”¯æŒå°†åˆ—è¡¨ä¿®å‰ªåˆ°æŒ‡å®šé•¿åº¦ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡LTRIM latest.comments 0 5000.æ“ä½œç»´æŒåˆ—è¡¨ä¸­å§‹ç»ˆå­˜å‚¨5000ä¸ªæœ€æ–°çš„è¯„è®ºId. æ¯æ¬¡æƒ³è¦è·å–æŒ‡å®šèŒƒå›´å†…çš„è¯„è®ºæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‡½æ•°ï¼ˆä¼ªä»£ç ï¼‰.1234567FUNCTION get_latest_comments(start,num_items): id_list = redis.lrange(\"latest.comments\",start,start+num_items-1) IF id_list.length &lt; num_items id_list = SQL_DB(\"SELECT ... ORDER BY time LIMIT ...\") END RETURN id_listEND è¿™æ®µä»£ç çš„åŠŸèƒ½å¾ˆç®€å•ã€‚åœ¨Redisä¸­ç»´æŠ¤ä¸€ä¸ªâ€œåŠ¨æ€ç¼“å­˜â€ï¼Œç»å¸¸æ›´æ–°,å­˜å‚¨æœ€æ–°è¯„è®ºçš„Id,ç¼“å­˜ä¸­é™åˆ¶æœ€å¤šåªå­˜5000ä¸ªIdã€‚åœ¨ç³»ç»Ÿç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶,ç¼“å­˜åˆ—è¡¨ä¸­çš„Idä¸ªæ•°ä¸º0ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸Šé¢å®ç°çš„æ–¹æ³•ä¼šåœ¨å…ˆè®¿é—®Redisï¼Œå¦‚æœå‚æ•°(start/count)çš„è¶…è¿‡äº†åˆ—è¡¨èŒƒå›´ï¼Œå†å»è®¿é—®æ•°æ®åº“ã€‚æˆ‘ä»¬æ— éœ€åˆ·æ–°ç¼“å­˜ï¼Œå¹¶ä¸”åªä¼šåœ¨ç”¨æˆ·æƒ³è¦æŸ¥çœ‹æœ€æ–°5000æ¡è¯„è®ºä¹‹å¤–çš„è¯„è®ºæ—¶æ‰ä¼šè®¿é—®æ•°æ®åº“ã€‚ä¹Ÿå°±æ˜¯è¯´å±•ç¤ºæœ€æ–°è¯„è®ºçš„ä¸»é¡µï¼Œå’ŒæŸ¥çœ‹å†å²è¯„è®ºå‰å‡ é¡µéƒ½æ— éœ€è®¿é—®æ•°æ®åº“ã€‚ åˆ é™¤å’Œè¿‡æ»¤åœ¨é‡åˆ°è¯„è®ºè¢«åˆ é™¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨LREMå‘½ä»¤æ¥åˆ é™¤Redisåˆ—è¡¨ä¸­ç¼“å­˜çš„è¯„è®ºIdã€‚å¦‚æœåˆ é™¤è¯„è®ºçš„æƒ…å†µä¸å¸¸è§ï¼Œä¹Ÿå¯ä»¥åœ¨å±•ç¤ºæŒ‡å®šè¯„è®ºæ—¶è·³è¿‡å®ƒï¼Œå› ä¸ºæˆ‘ä»¬åœ¨æ ¹æ®è¯„è®ºIdå»æ•°æ®åº“æŸ¥è¯¢è¯„è®ºå…·ä½“å†…å®¹æ—¶ï¼Œæ•°æ®åº“ä¼šå‘Šè¯‰æˆ‘ä»¬æŸæ¡è¯„è®ºå·²ç»ä¸å­˜åœ¨äº†ã€‚ é€‰æ‰‹ç§¯åˆ†æ¦œåŠç›¸å…³é—®é¢˜å¦ä¸€ä¸ªæ¯”è¾ƒå¸¸è§çš„ï¼Œç”¨æ•°æ®åº“å®ç°æ€§èƒ½è¾ƒå·®çš„éœ€æ±‚æ˜¯æŒ‰åˆ†æ•°æ’åºï¼Œå±•ç°åˆ—è¡¨ï¼Œå¹¶ä¸”å®æ—¶æ›´æ–°ï¼Œä¸€ä¸ªå¸¸è§çš„ä¾‹å­å°±æ˜¯åœ¨çº¿æ¸¸æˆä¸­çš„é€‰æ‰‹ç§¯åˆ†æ¦œã€‚åœ¨åœ¨çº¿æ¸¸æˆä¸­ï¼Œéœ€è¦æ¥å—é«˜é¢‘ç‡çš„æ¥è‡ªä¸åŒç”¨æˆ·çš„åˆ†æ•°æ›´æ–°ï¼Œé€šè¿‡è¿™äº›åˆ†æ•°å®ç°ä»¥ä¸‹éœ€æ±‚ï¼š åœ¨ç§¯åˆ†æ¦œä¸­å±•ç°åˆ†æ•°æœ€é«˜çš„100ä½é€‰æ‰‹ å±•ç°ç”¨æˆ·çš„å½“å‰æ’å è¿™äº›æ“ä½œç”¨Redisçš„æœ‰åºé›†åˆæ¥å®ç°æ˜¯å¾ˆç®€å•çš„ï¼Œå“ªæ€•ä½ çš„ç³»ç»Ÿæ¯åˆ†é’Ÿè¦æ›´æ–°ä¸Šç™¾ä¸‡çš„åˆ†æ•°ã€‚æ¯å½“æ¥å—åˆ°ä¸€ä¸ªç”¨æˆ·çš„æ–°åˆ†æ•°æ—¶ï¼Œæˆ‘ä»¬å¯¹Redisåšå¦‚ä¸‹çš„æ“ä½œï¼š1ZADD leaderboard &lt;score&gt; &lt;username&gt; ps:ä¹Ÿå¯ä»¥ä½¿ç”¨userIdï¼Œè€Œä¸æ˜¯ç”¨æˆ·å, çœ‹å¼€å‘è€…çš„ä¸ªäººå–œå¥½ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆç®€å•çš„é€šè¿‡ä¸‹é¢çš„æ“ä½œè·å¾—åˆ†æ•°æ’åå‰100çš„ç”¨æˆ·1ZREVRANGE leaderboard 0 99 ä¹Ÿå¯ä»¥é€šè¿‡1ZRANK leaderboard &lt;username&gt; æ¥è·å–ç”¨æˆ·çš„å½“å‰æ’åã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è·å¾—æ’åé è¿‘å½“å‰ç”¨æˆ·çš„ç”¨æˆ·ï¼Œä»¥åŠç­‰ç­‰ç­‰ç­‰ã€‚ã€‚ã€‚ã€‚ã€‚ æŒ‰ç…§ç”¨æˆ·æŠ•ç¥¨å’Œæ—¶é—´æ’åºä¸‹é¢è°ˆè°ˆé€‰æ‰‹ç§¯åˆ†æ¦œé—®é¢˜çš„ä¸€ä¸ªå˜ç§é—®é¢˜ã€‚åœ¨è¯¸å¦‚Redditå’ŒHacker Newsè¿™ç±»çš„ç½‘ç«™ä¸­ï¼Œæ–°é—»æ˜¯æŒ‰ç…§ç±»ä¼¼ä¸‹é¢å…¬å¼è®¡ç®—å¾—å‡ºçš„åˆ†æ•°æ¥æ’åºçš„ã€‚1score = points / time^alpha ä¹Ÿå°±æ˜¯è¯´ç”¨æˆ·çš„æŠ•ç¥¨ä¼šåœ¨ä¸€å®šå¾ˆå°ç¨‹åº¦ä¸Šæå‡æ–°é—»çš„æ’åï¼Œè€Œæ—¶é—´æµé€åˆ™ä¼šä½¿æ–°é—»çš„æ’åå‘ˆæŒ‡æ•°çº§ä¸‹é™ã€‚å®é™…çš„ç®—æ³•ä¼šæ¯”æˆ‘ä»¬çš„ä¾‹å­æ›´å¤æ‚ï¼Œä½†è§£å†³çš„æ–¹å¼æ˜¯ä¸€æ ·çš„ã€‚é¦–å…ˆå‡è®¾åªæœ‰æœ€æ–°å‘å¸ƒçš„1000æ¡æ–°é—»æ‰æœ‰èµ„æ ¼å‡ºç°åœ¨é¦–é¡µä¸Šï¼Œæ‰€ä»¥æˆ‘ä»¬åªå…³æ³¨æœ€æ–°å‘å¸ƒçš„1000æ¡æ–°é—»ï¼Œå¿½ç•¥å¤ªè€çš„æ–°é—»ï¼Œå¤§è‡´è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š æ¯å½“æ–°å‘å¸ƒä¸€æ¡æ–°é—»ï¼Œå°†å…¶IdåŠ å…¥åˆ°Redisçš„åˆ—è¡¨ä¸­ï¼Œé€šè¿‡LPUSH+LTRIMå°†åˆ—è¡¨ç»´æŒåˆ°åªä¿å­˜æœ€æ–°å‘å¸ƒçš„1000æ¡æ–°é—»çš„Idã€‚ é€šè¿‡ä¸€ä¸ªå®šæ—¶ä»»åŠ¡è·å–Redisä¸­Idåˆ—è¡¨ï¼Œå¹¶ä¸”ä¸æ–­çš„è®¡ç®—åˆ—è¡¨ä¸­æ–°é—»çš„åˆ†æ•°ã€‚å°†è®¡ç®—ç»“æœé€šè¿‡ZADDæ“ä½œå­˜å‚¨åˆ°ä¸€ä¸ªæœ‰åºé›†åˆä¸­ï¼ŒåŒæ—¶å°†æ—§çš„æ–°é—»ä»æœ‰åºåˆ—è¡¨ä¸­æ¸…é™¤ã€‚ä¸»è¦æ€æƒ³å°±æ˜¯ï¼Œæœ‰åºé›†åˆä¸­å­˜å‚¨ç€1000æ¡æœ€æ–°æ–°é—»ï¼Œå¹¶æŒ‰åˆ†æ•°æ’åºã€‚åˆ†æ•°çš„æ’åºæ˜¯é€šè¿‡åå°ç¨‹åºå®Œæˆçš„ï¼Œä¸æµè§ˆç½‘ç«™çš„ç”¨æˆ·æ•°æ— å…³ã€‚ å°†å…ƒç´ è¿‡æœŸæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨æœ‰åºé›†åˆå®ç°å°†è¶…è¿‡æŒ‡å®šæ—¶é—´çš„å…ƒç´ åœ¨æ•°æ®åº“ä¸­åˆ é™¤æˆ–ç½®ä¸ºè¿‡æœŸã€‚å…·ä½“åšæ³•å¦‚ä¸‹ï¼š æ¯å½“æ•°æ®åº“ä¸­æ–°åŠ å…¥ä¸€ä¸ªå…ƒç´ æ—¶ï¼ŒåŒæ—¶å°†å…¶æ·»åŠ åˆ°æœ‰åºé›†åˆä¸­ï¼Œåˆ†æ•°æ˜¯å½“å‰æ—¶é—´åŠ ä¸ŠæŒ‡å®šçš„å­˜æ´»æ—¶é—´ è®©ä¸€ä¸ªåå°ä»»åŠ¡æŸ¥è¯¢æœ‰åºé›†åˆï¼Œåˆ©ç”¨ZRANGE â€¦WITHSCORESè·å–å…ƒç´ ï¼Œå¦‚æœå…ƒç´ å¯¹åº”çš„åˆ†æ•°å°äºå½“å‰æ—¶é—´ï¼Œè¯´æ˜å…ƒç´ å·²è¿‡æœŸï¼Œåœ¨æ•°æ®åº“ä¸­åˆ é™¤å¯¹åº”è®°å½•ã€‚ è®¡æ•°å™¨Rediså¯ä»¥ç”¨æ¥å®ç°è®¡æ•°å™¨,ä½¿ç”¨INCRBYæ“ä½œå³å¯ã€‚ç›¸ä¿¡å¾ˆå¤šäººéƒ½æ›¾æƒ³è¿‡åœ¨æ•°æ®åº“ä¸­æ·»åŠ ä¸€å¼ è®¡æ•°å™¨è¡¨ï¼Œç”¨æ¥ä¸ºç”¨æˆ·å±•ç°ä¸€äº›ç»Ÿè®¡ä¿¡æ¯ï¼Œä½†åˆè€ƒè™‘åˆ°éœ€è¦å¯¹è¿™å¼ è¡¨è¿›è¡Œå¤§é‡çš„å†™æ“ä½œè€Œæ”¾å¼ƒï¼Œæœ¬å®å®æ›¾ç»æ— æ•°æ¬¡é‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Redisæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚é€šè¿‡Redisæˆ‘ä»¬å¯ä»¥ä¸ºè®¡æ•°å™¨åŸå­æ€§çš„å¢åŠ è®¡æ•°,ä¹Ÿå¯ä»¥ä½¿ç”¨GETSETå‘½ä»¤é‡ç½®è®¡æ•°å™¨æˆ–è€…ä¸ºè®¡æ•°å™¨è®¾ç½®è¿‡æœŸæ—¶é—´ã€‚æ¯”å¦‚æˆ‘ä»¬å¯ä»¥æŒ‰ç…§å¦‚ä¸‹åšæ³•å®ç°è®¡æ•°ä¸€ä¸ªç”¨æˆ·æŒ‡å®šæ—¶é—´å†…çš„é¡µé¢è®¿é—®é‡ï¼Œå¦‚æœè¶…è¿‡äº†æŒ‡å®šå€¼ï¼Œæ¯”å¦‚20ï¼Œå°±å¼¹å‡ºä¸€ä¸ªæç¤ºã€‚12INCR user:&lt;id&gt;EXPIRE user:&lt;id&gt; 60 ç»Ÿè®¡æŒ‡å®šæ—¶é—´å†…ä¸åŒçš„ç”¨æˆ·å¦ä¸€ä¸ªç”¨æ•°æ®åº“å®ç°æ¯”è¾ƒå›°éš¾ï¼Œä½†æ˜¯ç”¨Rediså´å¾ˆç®€å•çš„åŠŸèƒ½å°±æ˜¯ç»Ÿè®¡æŒ‡å®šæ—¶é—´å†…è®¿é—®æŸèµ„æºçš„ç”¨æˆ·æ•°ã€‚æ¯”å¦‚æˆ‘æƒ³çŸ¥é“è®¿é—®æŒ‡å®šé¡µé¢çš„ç”¨æˆ·æ•°(ç›¸åŒç”¨æˆ·è®¿é—®å¤šæ¬¡åªè®¡ç®—ä¸€æ¬¡)ï¼Œæˆ‘åªéœ€è¦åœ¨æ–°å¢ä¸€ä¸ªé¡µé¢æµè§ˆ(PV)æ—¶,æ‰§è¡Œä¸‹é¢çš„æ“ä½œï¼š1SADD page:day1:&lt;page_id&gt; &lt;user_id&gt; æƒ³è·å¾—æŸé¡µé¢çš„ç”¨æˆ·è®¿é—®æ•°ï¼Œåªéœ€æ‰§è¡ŒSCARD page:day1:å³å¯ã€‚ å®æ—¶åˆ†ææˆ‘ä»¬å·²ç»çœ‹è¿‡äº†å‡ ä¸ªåˆ©ç”¨Rediså¦‚ä½•å®ç°ä¸€äº›åˆ©ç”¨æ•°æ®åº“ä¸å¥½å®ç°çš„åŠŸèƒ½ï¼Œå¦‚æœæ·±å…¥å­¦ä¹ Redisçš„å‘½ä»¤é›†ï¼Œæ´»ç”¨Redisä¸­çš„æ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“çš„å®ç°å®æ—¶ç»Ÿè®¡çš„åŠŸèƒ½ï¼Œç”¨æ¥å¢å¼ºååƒåœ¾é‚®ä»¶ç³»ç»Ÿï¼Œæˆ–è€…é€šè¿‡åˆ†æå¾—åˆ°çš„ä¸€äº›æ•°æ®æ¥æé«˜ç½‘ç«™çš„è´¨é‡ã€‚ å‘å¸ƒ/è®¢é˜…Redisä¸­å®ç°äº†ä¸€ä¸ªé«˜æ€§èƒ½çš„å‘å¸ƒ/è®¢é˜…ç³»ç»Ÿï¼Œæ˜“äºä½¿ç”¨ï¼Œç¨³å®šï¼Œæ€§èƒ½é«˜ï¼Œå¹¶ä¸”æ”¯æŒæ¨¡å¼åŒ¹é…ã€‚è¯¦ç»†çš„ä¿¡æ¯å¯ä»¥é˜…è¯»Rediså®˜æ–¹æ–‡æ¡£ é˜Ÿåˆ—å¤§å®¶å¯èƒ½å·²ç»æ³¨æ„åˆ°äº†ï¼Œé€šè¿‡Rediså¯¹åˆ—è¡¨æ’å…¥å…ƒç´ å’Œå¼¹å‡ºå…ƒç´ çš„å‘½ä»¤ï¼Œå¾ˆé€‚åˆç”¨æ¥å®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚ä½†Redisèƒ½åšçš„è¿œè¿œä¸æ­¢è¿™äº›ï¼Œæ¯”å¦‚Rediså¼¹å‡ºåˆ—è¡¨å…ƒç´ æ—¶è¿˜æœ‰æä¾›BLPOPå‘½ä»¤ï¼Œå¯ä»¥åœ¨åˆ—è¡¨ä¸ºç©ºæ—¶ï¼Œå°†è¿æ¥é˜»å¡ã€‚é™¤æ­¤ä¹‹å¤–åˆ©ç”¨æœ‰åºé›†åˆä¹Ÿå¯ä»¥å¾ˆå®¹æ˜“çš„å®ç°ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—ã€‚Redisåœ¨é˜Ÿåˆ—æ–¹é¢è¿˜æœ‰å¾ˆå¤šç”¨æ³•(æ¯”å¦‚RPOPLPUSH,Resque)ï¼Œå¤§å®¶å¯ä»¥æ…¢æ…¢å‘æ˜ã€‚ ç¼“å­˜å…³äºè¿™ä¸€èŠ‚å…¶å®å°±å¤Ÿå†å†™ä¸€ç¯‡åšå®¢äº†ã€‚ç®€å•æ¥è¯´ï¼ŒRediså¯ä»¥ä½œä¸ºmemcachedçš„æ›¿ä»£å“ï¼Œä½¿æˆ‘ä»¬çš„ç¼“å­˜æ—¢å¯ä»¥å­˜å‚¨æ•°æ®åˆæ˜“äºæ›´æ–°ã€‚ å¿«åœ¨Redisçš„å¸®åŠ©ä¸‹èµ·é£å§å¿«ä½¿ç”¨Redisæ¥å¢å¼ºç”¨æˆ·ä½“éªŒï¼Œé™ä½ç³»ç»Ÿå¤æ‚åº¦ï¼ŒåŠ å¿«è¯·æ±‚å“åº”å§~~ï¼Œæ— éœ€å…¨éƒ¨åˆ‡æ¢åˆ°Redisï¼Œå¯ä»…ä»…åˆ©ç”¨Rediså®ç°ç”¨æ•°æ®åº“ä¸å¥½å®ç°æˆ–æ€§èƒ½ä¸é«˜çš„æ–°åŠŸèƒ½ã€‚ åˆ†äº«ä¸ªè§‰å¾—è¿˜ä¸é”™çš„è§†é¢‘ï¼Œæ‹–å»¶ç—‡æ‚£è€…å¯ä»¥çœ‹çœ‹ï¼Œä¸è¿‡ä¼°è®¡ä¹Ÿæ²¡ä»€ä¹ˆåµç”¨ï¼Œè¯¥æ‹–è¿˜å¾—æ‹–ï¼Œå“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ~~~","raw":null,"content":null,"categories":[{"name":"redis","slug":"redis","permalink":"http://yemengying.com/categories/redis/"}],"tags":[{"name":"ç¿»è¯‘","slug":"ç¿»è¯‘","permalink":"http://yemengying.com/tags/ç¿»è¯‘/"},{"name":"redis","slug":"redis","permalink":"http://yemengying.com/tags/redis/"}]},{"title":"[Elasticsearché…ç½®é¡¹(äºŒ)]Node,Threadpoolæ¨¡å—é…ç½®","slug":"elasticsearch-settings2","date":"2016-03-21T13:32:41.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/03/21/elasticsearch-settings2/","link":"","permalink":"http://yemengying.com/2016/03/21/elasticsearch-settings2/","excerpt":"æ¥ä¸Šæ–‡ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚æŒ‰ç…§å®˜æ–¹æ–‡æ¡£(ç‰ˆæœ¬2.2)å’Œä¸€äº›å‚è€ƒèµ„æ–™æ•´ç†ä¸€ä¸‹elasticsearchçš„å¯é…ç½®é¡¹ã€‚å…ˆæ•´ç†äº†Nodeï¼ŒThreadPoolä¸¤ä¸ªæ¨¡å—çš„å¯é…ç½®é¡¹ï¼Œå…¶ä»–æ¨¡å—(æ¯”å¦‚Cluster)ä¼šåœ¨ä¹‹åæ…¢æ…¢æ•´ç†çš„ã€‚æœ¬æ–‡åªåŒ…å«ä¸¤ä¸ªæ¨¡å—å¯ç”¨é…ç½®é¡¹çš„å«ä¹‰åŠç”¨æ³•ï¼Œå¹¶ä¸æ¶‰åŠåº”è¯¥å¦‚ä½•ä¼˜åŒ–ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºä¿ºä¹Ÿä¸ä¼šã€‚ã€‚ã€‚ã€‚ã€‚(æ¬¢è¿æŒ‡æ­£é”™è¯¯ï¼Œåº·æ¡‘é˜¿ç±³è¾¾) ç›¸å…³åšå®¢ï¼šelasticsearch é…ç½®é¡¹(ä¸€)","keywords":null,"text":"æ¥ä¸Šæ–‡ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚æŒ‰ç…§å®˜æ–¹æ–‡æ¡£(ç‰ˆæœ¬2.2)å’Œä¸€äº›å‚è€ƒèµ„æ–™æ•´ç†ä¸€ä¸‹elasticsearchçš„å¯é…ç½®é¡¹ã€‚å…ˆæ•´ç†äº†Nodeï¼ŒThreadPoolä¸¤ä¸ªæ¨¡å—çš„å¯é…ç½®é¡¹ï¼Œå…¶ä»–æ¨¡å—(æ¯”å¦‚Cluster)ä¼šåœ¨ä¹‹åæ…¢æ…¢æ•´ç†çš„ã€‚æœ¬æ–‡åªåŒ…å«ä¸¤ä¸ªæ¨¡å—å¯ç”¨é…ç½®é¡¹çš„å«ä¹‰åŠç”¨æ³•ï¼Œå¹¶ä¸æ¶‰åŠåº”è¯¥å¦‚ä½•ä¼˜åŒ–ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºä¿ºä¹Ÿä¸ä¼šã€‚ã€‚ã€‚ã€‚ã€‚(æ¬¢è¿æŒ‡æ­£é”™è¯¯ï¼Œåº·æ¡‘é˜¿ç±³è¾¾) ç›¸å…³åšå®¢ï¼šelasticsearch é…ç½®é¡¹(ä¸€)wuliå…‰æ´™é•‡æ¥¼~~ å‚è€ƒæ–‡æ¡£ï¼ˆä¸‡åˆ†æ„Ÿè°¢ï¼‰ http://www.opscoder.info/es_threadpool.html http://www.voidcn.com/blog/BrotherDong90/article/p-3851633.html Node(èŠ‚ç‚¹)æ¯å½“å¯åŠ¨ä¸€ä¸ªEså®ä¾‹ï¼Œå°±æ˜¯å¯åŠ¨äº†ä¸€ä¸ªèŠ‚ç‚¹ã€‚å¤šä¸ªè¿æ¥åœ¨ä¸€èµ·çš„èŠ‚ç‚¹ç»„æˆçš„é›†åˆå°±æ˜¯é›†ç¾¤ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥é€šè¿‡HTTPå’ŒTransporté€šä¿¡ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½çŸ¥é“é›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ï¼Œå¯ä»¥å°†å®¢æˆ·ç«¯çš„è¯·æ±‚è½¬å‘åˆ°åˆé€‚çš„èŠ‚ç‚¹ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ¯ä¸ªèŠ‚ç‚¹è¿˜æœ‰ç€ä»¥ä¸‹ä¸€ç§æˆ–å¤šç§å…·ä½“è§’è‰²ã€‚ Master-eligible node (å€™é€‰ä¸»èŠ‚ç‚¹) å½“ä¸€ä¸ªèŠ‚ç‚¹çš„node.masterè¢«è®¾ç½®ä¸ºtrue(é»˜è®¤ä¸ºtrue)æ—¶ï¼Œè¯¥èŠ‚ç‚¹å°±æœ‰èµ„æ ¼è¢«é€‰ä¸ºmasterèŠ‚ç‚¹ï¼Œæ§åˆ¶é›†ç¾¤ã€‚ Data node (æ•°æ®èŠ‚ç‚¹) é…ç½®é¡¹node.dataè®¾ç½®ä¸ºtrueçš„èŠ‚ç‚¹ç§°ä¸ºæ•°æ®èŠ‚ç‚¹ã€‚æ•°æ®èŠ‚ç‚¹å­˜å‚¨æ•°æ®å¹¶ä¸”å¤„ç†å’Œæ•°æ®ç›¸å…³çš„ä¸€äº›æ“ä½œï¼Œæ¯”å¦‚CRUDï¼ŒæŸ¥æ‰¾å’Œèšåˆç­‰ã€‚ Client node (å®¢æˆ·ç«¯èŠ‚ç‚¹) å½“ä¸€ä¸ªèŠ‚ç‚¹çš„node.masterå’Œnode.dataå‡è¢«è®¾ç½®ä¸ºfalseæ—¶ï¼Œå®ƒæ—¢ä¸èƒ½å­˜å‚¨æ•°æ®ä¹Ÿä¸èƒ½ä½œä¸ºä¸€ä¸ªä¸»èŠ‚ç‚¹ã€‚å®ƒè¢«çœ‹åšä¸€ä¸ªâ€œè·¯ç”±å™¨â€ï¼Œè´Ÿè´£å°†é›†ç¾¤å±‚é¢çš„è¯·æ±‚è½¬å‘åˆ°ä¸»èŠ‚ç‚¹ï¼Œå°†æ•°æ®ç›¸å…³çš„è¯·æ±‚è½¬å‘åˆ°æ•°æ®èŠ‚ç‚¹ã€‚ Tribe node (éƒ¨è½èŠ‚ç‚¹) éƒ¨è½èŠ‚ç‚¹æ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„å®¢æˆ·ç«¯èŠ‚ç‚¹ï¼Œå¯é€šè¿‡tribe.*é…ç½®é¡¹é…ç½®ã€‚éƒ¨è½èŠ‚ç‚¹å¯ä»¥è¿æ¥å¤šä¸ªé›†ç¾¤ï¼Œå¹¶ä¸”å¯ä»¥è·¨é›†ç¾¤æ‰§è¡ŒæŸ¥æ‰¾å’Œå…¶ä»–æ“ä½œã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹å³æ˜¯ä¸»èŠ‚ç‚¹ä¹Ÿæ˜¯æ•°æ®èŠ‚ç‚¹ã€‚ä½†æ˜¯å½“é›†ç¾¤æ‰©å¤§åï¼Œæ›´å¥½çš„åšæ³•æ˜¯å°†ä¸»èŠ‚ç‚¹å’Œæ•°æ®èŠ‚ç‚¹ç‹¬ç«‹å¼€ã€‚ Coordinating node(åè°ƒèŠ‚ç‚¹)ï¼šä¸€äº›è¯·æ±‚å¯èƒ½ä¼šæ¶‰åŠåˆ°å¤šä¸ªæ•°æ®èŠ‚ç‚¹ï¼Œæ¯”å¦‚æœç´¢æˆ–æ‰¹é‡ç´¢å¼•ã€‚æœç´¢è¯·æ±‚ä¸€èˆ¬åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œç”±æ¥å—å®¢æˆ·ç«¯è¯·æ±‚çš„èŠ‚ç‚¹åšåè°ƒï¼Œç§°ä¸ºåè°ƒèŠ‚ç‚¹ã€‚åœ¨æœç´¢çš„ç¬¬ä¸€é˜¶æ®µåè°ƒèŠ‚ç‚¹ä¼šå°†è¯·æ±‚è½¬å‘åˆ°æ•°æ®èŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹åœ¨æœ¬åœ°æ‰§è¡Œè¯·æ±‚ï¼Œå¹¶å°†ç»“æœè¿”ç»™åè°ƒèŠ‚ç‚¹ã€‚åœ¨ç¬¬äºŒé˜¶æ®µï¼Œåè°ƒèŠ‚ç‚¹ä¼šå°†å„ä¸ªç»“æœæ±‡æ€»åœ¨ä¸€èµ·ã€‚è¿™æ„å‘³ç€è´Ÿè´£æ¥å—è¯·æ±‚çš„å®¢æˆ·ç«¯èŠ‚ç‚¹(ä¹Ÿå°±æ˜¯åè°ƒèŠ‚ç‚¹)éœ€è¦ç”¨è¶³å¤Ÿçš„å†…å­˜å’ŒCPUæ¥å¤„ç†æŸ¥è¯¢ç»“æœçš„æ±‡æ€»ã€‚ Master-eligible node(å€™é€‰ä¸»èŠ‚ç‚¹)ä¸»èŠ‚ç‚¹ä¸»è¦è´Ÿè´£åˆ›å»ºç´¢å¼•ï¼Œåˆ é™¤ç´¢å¼•ï¼Œè¿½è¸ªé›†ç¾¤ä¸­çš„èŠ‚ç‚¹ï¼Œåˆ†é…åˆ†ç‰‡ç­‰ï¼Œæ‰€ä»¥æœ‰ä¸€ä¸ªç¨³å®šçš„ä¸»èŠ‚ç‚¹å¯¹äºé›†ç¾¤æ¥è¯´éå¸¸é‡è¦ï¼Œéå¸¸é‡è¦ï¼Œéå¸¸é‡è¦ï¼ˆè¯´ä¸‰éï¼Œå“ˆå“ˆå“ˆï¼‰ã€‚é›†ç¾¤ä¸­ä»»ä½•æœ‰èµ„æ ¼æˆä¸ºä¸»èŠ‚ç‚¹çš„èŠ‚ç‚¹éƒ½å¯èƒ½è¢«é€‰ä¸ºä¸»èŠ‚ç‚¹ã€‚ç”±äºç´¢å¼•å’Œæœç´¢ä¼šå¯¹èŠ‚ç‚¹èµ„æºé€ æˆå‹åŠ›ï¼Œåœ¨é›†ç¾¤æ¯”è¾ƒå¤§æ—¶ï¼Œæœ€å¥½å°†ä¸»èŠ‚ç‚¹å’Œæ•°æ®èŠ‚ç‚¹çš„è§’è‰²åŒºåˆ†ï¼Œå³ä¸è¦è®©ä¸»èŠ‚ç‚¹åŒæ—¶ä¹Ÿæ˜¯æ•°æ®èŠ‚ç‚¹ã€‚é€šè¿‡ä¸‹é¢çš„é…ç½®å¯ä»¥è®¾ç½®ä¸€ä¸ªä¸“é—¨çš„ä¸»èŠ‚ç‚¹(åªæ˜¯ä¸»èŠ‚ç‚¹ä¸æ˜¯æ•°æ®èŠ‚ç‚¹)ã€‚12node.master: truenode.data: false é€šè¿‡minimum_master_nodesæ¥é¿å…è„‘è£‚ç°è±¡ discovery.zen.minimum_master_nodesé…ç½®é¡¹è¯´æ˜å½¢æˆé›†ç¾¤æ—¶ï¼Œé›†ç¾¤ä¸­æœ‰èµ„æ ¼æˆä¸ºä¸»èŠ‚ç‚¹çš„èŠ‚ç‚¹æ•°æœ€å°‘æ˜¯å¤šå°‘ï¼Œé»˜è®¤ä¸º1.è„‘è£‚ç°è±¡ï¼šå‡è®¾é›†ç¾¤ä¸­æœ‰ä¸¤ä¸ªæœ‰èµ„æ ¼æˆä¸ºä¸»èŠ‚ç‚¹çš„å€™é€‰ä¸»èŠ‚ç‚¹ï¼Œdiscovery.zen.minimum_master_nodesé…ç½®é»˜è®¤ä¸º1ã€‚å½“ç”±äºç½‘ç»œé—®é¢˜ä¸­æ–­äº†ä¸¤ä¸ªèŠ‚ç‚¹é—´çš„é€šä¿¡ï¼Œè¿™æ—¶ä¸¤ä¸ªèŠ‚ç‚¹éƒ½åªä¼šå‘ç°ä¸€ä¸ªæœ‰èµ„æ ¼æˆä¸ºä¸»èŠ‚ç‚¹çš„èŠ‚ç‚¹ï¼ˆè‡ªå·±æœ¬èº«ï¼‰ï¼Œ æ ¹æ®é…ç½®(minimum_master_nodes = 1),ç¬¦åˆç»„æˆä¸€ä¸ªé›†ç¾¤çš„æ¡ä»¶ï¼Œæ‰€ä»¥æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šæˆä¸ºæ–°çš„masterèŠ‚ç‚¹ï¼Œä»è€Œå¯¼è‡´å½¢æˆäº†ä¸¤ä¸ªé›†ç¾¤ï¼Œä¹Ÿå°±æ˜¯è„‘è£‚ã€‚ç›´åˆ°å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹é‡å¯ï¼Œæ‰ä¼šé‡æ–°å½¢æˆé›†ç¾¤ï¼Œå¹¶ä¸”å†™å…¥é‡å¯èŠ‚ç‚¹çš„æ•°æ®ä¼šä¸¢å¤±ã€‚å‡è®¾é›†ç¾¤ä¸­æœ‰ä¸‰ä¸ªæœ‰èµ„æ ¼æˆä¸ºä¸»èŠ‚ç‚¹çš„å€™é€‰ä¸»èŠ‚ç‚¹ï¼Œè€Œè¿™æ—¶minimum_master_nodesè®¾ç½®ä¸º2ï¼Œå¦‚æœä¸€ä¸ªèŠ‚ç‚¹ä¸å…¶ä»–ä¸¤ä¸ªå¤±å»äº†é€šä¿¡ï¼Œè¢«ç‹¬ç«‹çš„èŠ‚ç‚¹ä¼šå‘ç°ä¸æ»¡è¶³è®¾ç½®çš„æ¡ä»¶(æœ‰ä¸¤ä¸ªå€™é€‰ä¸»èŠ‚ç‚¹)ï¼Œæ‰€ä»¥ä¸ä¼šé€‰ä¸¾è‡ªå·±ä¸ºä¸»èŠ‚ç‚¹ã€‚è€Œå‰©ä¸‹ä¸¤ä¸ªèŠ‚ç‚¹ä¼šé€‰ä¸¾å‡ºä¸€ä¸ªæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œç¡®ä¿æ­£å¸¸è¿è¡Œã€‚discovery.zen.minimum_master_nodesæœ€å¥½è®¾ç½®ä¸º(å€™é€‰ä¸»èŠ‚ç‚¹æ•°/2) + 1, ä¸¾ä¸ªä¾‹å­ï¼Œå½“æœ‰ä¸‰ä¸ªå€™é€‰ä¸»èŠ‚ç‚¹æ—¶ï¼Œè¯¥é…ç½®é¡¹çš„å€¼ä¸º(3/2)+1=2ã€‚ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹é¢çš„APIåŠ¨æ€çš„æ›´æ–°è¿™ä¸ªå€¼ï¼š123456PUT _cluster/settings&#123; \"transient\": &#123; \"discovery.zen.minimum_master_nodes\": 2 &#125;&#125; Data node(æ•°æ®èŠ‚ç‚¹)æ•°æ®èŠ‚ç‚¹åŒ…å«ç€ç´¢å¼•æ–‡æ¡£çš„åˆ†ç‰‡ï¼Œè´Ÿè´£å¤„ç†å’Œæ•°æ®ç›¸å…³çš„æ“ä½œï¼Œæ¯”å¦‚CRUDï¼Œæœç´¢å’Œèšåˆã€‚è¿™äº›æ“ä½œä¼šæ¶‰åŠåˆ°IO,å†…å­˜å’ŒCPUï¼Œæ‰€ä»¥è¦æ³¨æ„ç›‘æ§è¿™äº›èµ„æºï¼Œæ·»åŠ æ›´å¤šçš„æ•°æ®èŠ‚ç‚¹ä»¥é˜²è´Ÿè½½è¿‡é‡ã€‚é€šè¿‡ä¸‹é¢çš„é…ç½®å¯ä»¥è®¾ç½®ä¸€ä¸ªä¸“é—¨çš„æ•°æ®èŠ‚ç‚¹(åªæ˜¯æ•°æ®èŠ‚ç‚¹ä¸æ˜¯ä¸»èŠ‚ç‚¹)ã€‚12node.master: falsenode.data: true Client node(å®¢æˆ·ç«¯èŠ‚ç‚¹)å®¢æˆ·ç«¯èŠ‚ç‚¹ä¸»è¦è´Ÿè´£è·¯ç”±è¯·æ±‚ï¼Œæ±‡æ€»æœç´¢ç»“æœç­‰ï¼Œæœ¬è´¨ä¸Šæ¥çœ‹ï¼Œå®¢æˆ·ç«¯èŠ‚ç‚¹æ›´åƒä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ã€‚ æ³¨æ„ï¼šé›†ç¾¤ä¸­æ·»åŠ è¿‡å¤šçš„å®¢æˆ·ç«¯èŠ‚ç‚¹ä¼šå¢åŠ æ•´ä¸ªé›†ç¾¤çš„è´Ÿæ‹…ã€‚æ‰€ä»¥ä¸è¦è¿‡å¤§å¤¸å¤§å®¢æˆ·ç«¯èŠ‚ç‚¹çš„å¥½å¤„ï¼Œæ•°æ®èŠ‚ç‚¹ä¹Ÿå¯ä»¥åƒå®¢æˆ·ç«¯èŠ‚ç‚¹ä¸€æ ·æœåŠ¡ã€‚ é€šè¿‡ä¸‹é¢çš„é…ç½®å¯ä»¥è®¾ç½®ä¸€ä¸ªä¸“é—¨çš„å®¢æˆ·ç«¯èŠ‚ç‚¹(ä¸æ˜¯æ•°æ®èŠ‚ç‚¹ä¹Ÿä¸æ˜¯ä¸»èŠ‚ç‚¹)ã€‚ 12node.master: falsenode.data: false è®¾ç½®èŠ‚ç‚¹çš„æ•°æ®è·¯å¾„path.dataæ¯ä¸ªæ•°æ®èŠ‚ç‚¹å’Œä¸»èŠ‚ç‚¹éƒ½éœ€è¦åœ¨æ–‡ä»¶ä¸­å­˜å‚¨ä¸€äº›å…³äºåˆ†ç‰‡ï¼Œç´¢å¼•å’Œé›†ç¾¤çš„å…ƒæ•°æ®ã€‚elasticsearch.ymlæ–‡ä»¶ä¸­çš„path.dataå¯ä»¥é…ç½®æ–‡ä»¶çš„ç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„ï¼Œé»˜è®¤å€¼æ˜¯$ES_HOME/dataï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤é…ç½®ã€‚1./bin/elasticsearch --path.data /var/elasticsearch/data node.max_local_storage-nodesä¸Šé¢çš„è®¾ç½®å¯ä»¥è¢«ä¸åŒçš„èŠ‚ç‚¹å…±äº«ï¼ˆåœ¨ç”Ÿäº§ç¯å¢ƒä¸‹å»ºè®®ä¸€ä¸ªæœåŠ¡å™¨åªè¿è¡Œä¸€ä¸ªèŠ‚ç‚¹ï¼‰ã€‚ä¸ºäº†é¿å…å¤šä¸ªèŠ‚ç‚¹å…±äº«åŒä¸€ä¸ªè·¯å¾„ï¼Œå¯ä»¥åœ¨elasticsearch.ymlä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ã€‚1node.max_local_storage_nodes: 1 æ³¨æ„ï¼Œä¸è¦å°†ä¸åŒç±»å‹èŠ‚ç‚¹çš„ä¿¡æ¯å­˜å‚¨åˆ°åŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œå¯èƒ½ä¼šé€ ç§°æ•°æ®ä¸¢å¤±ã€‚ Thread Pool(çº¿ç¨‹æ± )ä¸ºäº†æå‡çº¿ç¨‹å†…å­˜æ¶ˆè€—çš„ç®¡ç†ï¼Œæ¯ä¸ªEsèŠ‚ç‚¹éƒ½æœ‰å¤šä¸ªçº¿ç¨‹æ± ã€‚ çº¿ç¨‹æ± ç±»å‹ä¸‹é¢ä»‹ç»ä¸€ä¸‹çº¿ç¨‹æ± çš„ä¸‰ç§ç±»å‹å’Œå„è‡ªçš„ä¸€äº›å‚æ•°ï¼šcached: cachedç±»å‹çš„çº¿ç¨‹æ± æ²¡æœ‰é™åˆ¶å¤§å°ï¼Œå½“æœ‰pendingçš„è¯·æ±‚æ—¶å°±ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹ã€‚è¿™ç±»çº¿ç¨‹æ± å¯ä»¥é˜²æ­¢è¯·æ±‚é˜»å¡æˆ–è¢«æ‹’ç»ã€‚æœªä½¿ç”¨çš„çº¿ç¨‹ä¼šåœ¨è¿‡æœŸ(é»˜è®¤5åˆ†é’Ÿ)ä¹‹åæ¶ˆäº¡ã€‚cacheç±»å‹ä¸“é—¨ä¸ºgenericçº¿ç¨‹æ± ä¿ç•™çš„ã€‚ keep_aliveå‚æ•°å®šä¹‰äº†æœªä½¿ç”¨çš„çº¿ç¨‹çš„å­˜æ´»æ—¶é—´ã€‚ 123threadpool: generic: keep_alive: 2m fixed: fixedç±»å‹çš„çº¿ç¨‹æ± æŒæœ‰å›ºå®šä¸ªæ•°çš„çº¿ç¨‹å¤„ç†è¯·æ±‚é˜Ÿåˆ—ã€‚sizeå‚æ•°ç”¨æ¥æ§åˆ¶çº¿ç¨‹çš„ä¸ªæ•°ï¼Œé»˜è®¤ä¸ºcpuæ ¸å¿ƒæ•°çš„5å€ã€‚queue_sizeå‚æ•°ç”¨æ¥æ§åˆ¶è¯·æ±‚é˜Ÿåˆ—çš„å¤§å°ã€‚é»˜è®¤å€¼ä¸º-1ï¼Œæ„å‘³ç€æ— ä¸Šé™ã€‚å¦‚æœè¯·æ±‚é˜Ÿåˆ—å·²æ»¡ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥åˆ°æ¥çš„è¯·æ±‚ä¼šè¢«ç»ˆæ­¢ã€‚ 1234threadpool: index: size: 30 queue_size: 1000 scaling: scalingçº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°å¯åŠ¨æ€å˜åŒ–ã€‚çº¿ç¨‹æ•°åœ¨1å’Œsizeå‚æ•°å€¼çš„ä¸­é—´ã€‚ keep_aliveå‚æ•°å®šä¹‰äº†æœªä½¿ç”¨çš„çº¿ç¨‹çš„å­˜æ´»æ—¶é—´ã€‚ 1234threadpool: warmer: size: 8 keep_alive: 2m Esä¸­é‡è¦çš„çº¿ç¨‹æ± ä»¥ä¸‹æ˜¯Esä¸­å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„çº¿ç¨‹æ± åŠä»–ä»¬çš„ç±»å‹: çº¿ç¨‹æ±  ä½œç”¨ generic è´Ÿè´£ä¸€äº›è¯¸å¦‚å‘ç°èŠ‚ç‚¹ä¹‹ç±»çš„é€šç”¨æ“ä½œã€‚è¯¥çº¿ç¨‹æ± ç±»å‹ä¸ºcacheã€‚ index è´Ÿè´£ç´¢å¼•æ•°æ®/åˆ é™¤æ•°æ®æ“ä½œï¼Œç±»å‹ä¸ºfixedï¼Œé»˜è®¤çº¿ç¨‹æ•°ä¸ºavailable processors,é˜Ÿåˆ—å¤§å°ä¸º200ã€‚ search è´Ÿè´£ç»Ÿè®¡/æœç´¢æ“ä½œï¼Œç±»å‹ä¸ºfixed,é»˜è®¤çº¿ç¨‹æ•°ä¸ºint((available_processors * 3) / 2) + 1,é˜Ÿåˆ—å¤§å°ä¸º1000ã€‚ suggest è´Ÿè´£è·å–æç¤ºæ“ä½œï¼Œç±»å‹ä¸ºfixed,é»˜è®¤çº¿ç¨‹æ•°ä¸ºavailable processors,é˜Ÿåˆ—å¤§å°ä¸º1000ã€‚ get è´Ÿè´£getæ“ä½œï¼Œç±»å‹ä¸ºfixed,é»˜è®¤çº¿ç¨‹æ•°ä¸ºavailable processors,é˜Ÿåˆ—å¤§å°ä¸º1000ã€‚ bulk è´Ÿè´£æ‰¹é‡æ“ä½œï¼Œç±»å‹ä¸ºfixed,é»˜è®¤çº¿ç¨‹æ•°ä¸ºavailable processors,é˜Ÿåˆ—å¤§å°ä¸º50ã€‚ percolate è´Ÿè´£è¿‡æ»¤æ“ä½œï¼Œç±»å‹ä¸ºfixed,é»˜è®¤çº¿ç¨‹æ•°ä¸ºavailable processors,é˜Ÿåˆ—å¤§å°ä¸º1000ã€‚ snapshot è´Ÿè´£å¿«ç…§/æ¢å¤æ“ä½œï¼Œç±»å‹ä¸ºscaling,é»˜è®¤çº¿ç¨‹æ•°ä¸ºmin(5, (available processors)/2),é»˜è®¤æœªä½¿ç”¨çº¿ç¨‹çš„å­˜æ´»æ—¶é—´ä¸º5mã€‚ warmer è´Ÿè´£warm-upæ“ä½œï¼Œç±»å‹ä¸ºscaling,é»˜è®¤çº¿ç¨‹æ•°ä¸ºmin(5, (available processors)/2),é»˜è®¤æœªä½¿ç”¨çº¿ç¨‹çš„å­˜æ´»æ—¶é—´ä¸º5mã€‚ refresh è´Ÿè´£æ›´æ–°æ“ä½œï¼Œç±»å‹ä¸ºscaling,é»˜è®¤çº¿ç¨‹æ•°ä¸ºmin(10, (available processors)/2),é»˜è®¤æœªä½¿ç”¨çº¿ç¨‹çš„å­˜æ´»æ—¶é—´ä¸º5mã€‚ listener è´Ÿè´£java clientçš„æ‰§è¡Œï¼Œç±»å‹ä¸ºscaling,é»˜è®¤çº¿ç¨‹æ•°ä¸ºmin(10, (available processors)/2),é»˜è®¤æœªä½¿ç”¨çº¿ç¨‹çš„å­˜æ´»æ—¶é—´ä¸º5mã€‚ å¤„ç†å™¨è®¾ç½®Eså¯ä»¥è‡ªåŠ¨æ£€æµ‹å¤„ç†å™¨çš„æ•°é‡ï¼Œçº¿ç¨‹æ± çš„é…ç½®ä¹Ÿä¼šåŸºäºè¿™ä¸ªå€¼ã€‚å¯èƒ½å­˜åœ¨æ£€æµ‹å¤±è´¥çš„æƒ…å†µï¼Œè¿™æ˜¯å¯ä»¥é€šè¿‡processorsé…ç½®æ˜¾å¼è®¾ç½®è¿™ä¸ªå€¼ã€‚ æ³¨æ„ä»¥ä¸Šè¿™äº›é…ç½®å¦‚æœä¸æ˜¯å¾ˆäº†è§£ï¼Œè¿˜æ˜¯ä¸è¦è½»æ˜“æ”¹åŠ¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®å³å¯ã€‚ çœ‹ç´¯äº†å§ï¼Œåˆ†äº«ä¸ªè§‰å¾—è¿˜ä¸é”™çš„TEDè§†é¢‘~~","raw":null,"content":null,"categories":[{"name":"elasticsearch","slug":"elasticsearch","permalink":"http://yemengying.com/categories/elasticsearch/"}],"tags":[{"name":"elasticsearch","slug":"elasticsearch","permalink":"http://yemengying.com/tags/elasticsearch/"}]},{"title":"[Elasticsearché…ç½®é¡¹(ä¸€)]Local gateway,HTTP,Indices,Network Settingsæ¨¡å—é…ç½®","slug":"Elasticsearché…ç½®é¡¹-Local-gateway-HTTP-Indices-Network-Settingsæ¨¡å—é…ç½®","date":"2016-03-18T09:48:10.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/03/18/Elasticsearché…ç½®é¡¹-Local-gateway-HTTP-Indices-Network-Settingsæ¨¡å—é…ç½®/","link":"","permalink":"http://yemengying.com/2016/03/18/Elasticsearché…ç½®é¡¹-Local-gateway-HTTP-Indices-Network-Settingsæ¨¡å—é…ç½®/","excerpt":"è¿‘ä¸¤å‘¨çº¿ä¸Šçš„æœç´¢æ¥å£é—´éš”æ€§è«åå…¶å¦™çš„å‡ºç°è«åå…¶å¦™çš„å¼‚å¸¸ï¼Œæ¯”å¦‚ç¥é©¬NoAvailableThreadï¼ŒNoAvailableWorkerä¹‹ç±»çš„ã€‚å¯èƒ½æ˜¯ç”±äºéƒ¨é—¨ä¸­æ²¡æœ‰å¾ˆæ‡‚elasticsearchçš„äººï¼Œåªèƒ½æ‘¸ç€çŸ³å¤´è¿‡æ²³ï¼Œæ‰€ä»¥ä¸€ç›´ä½¿ç”¨elasticsearchçš„é»˜è®¤é…ç½®å¹¶æ²¡æœ‰å¯¹å…¶çº¿ç¨‹æ± å’Œå†…å­˜åˆ†é…è¿›è¡Œä¼˜åŒ–é€ æˆçš„ã€‚æ‰€ä»¥æŒ‰ç…§å®˜æ–¹æ–‡æ¡£(ç‰ˆæœ¬2.2)å’Œä¸€äº›å‚è€ƒèµ„æ–™æ•´ç†ä¸€ä¸‹elasticsearchçš„å¯é…ç½®é¡¹ï¼Œçœ‹çœ‹å¯ä¸å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹ã€‚å…ˆæ•´ç†äº†Local gateway,HTTP,Indices,Network Settingså››ä¸ªæ¨¡å—çš„å¯é…ç½®é¡¹ï¼Œå…¶ä»–æ¨¡å—(æ¯”å¦‚Cluster)ä¼šåœ¨ä¹‹åæ…¢æ…¢æ•´ç†çš„ã€‚æœ¬æ–‡åªåŒ…å«å››ä¸ªæ¨¡å—å¯ç”¨é…ç½®é¡¹çš„å«ä¹‰åŠç”¨æ³•ï¼Œå¹¶ä¸æ¶‰åŠåº”è¯¥å¦‚ä½•ä¼˜åŒ–ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºä¿ºä¹Ÿä¸ä¼šã€‚ã€‚ã€‚ã€‚ã€‚(æ¬¢è¿æŒ‡æ­£é”™è¯¯ï¼Œåº·æ¡‘é˜¿ç±³è¾¾) ç›¸å…³åšå®¢ï¼šelasticsearch é…ç½®é¡¹(äºŒ)","keywords":null,"text":"è¿‘ä¸¤å‘¨çº¿ä¸Šçš„æœç´¢æ¥å£é—´éš”æ€§è«åå…¶å¦™çš„å‡ºç°è«åå…¶å¦™çš„å¼‚å¸¸ï¼Œæ¯”å¦‚ç¥é©¬NoAvailableThreadï¼ŒNoAvailableWorkerä¹‹ç±»çš„ã€‚å¯èƒ½æ˜¯ç”±äºéƒ¨é—¨ä¸­æ²¡æœ‰å¾ˆæ‡‚elasticsearchçš„äººï¼Œåªèƒ½æ‘¸ç€çŸ³å¤´è¿‡æ²³ï¼Œæ‰€ä»¥ä¸€ç›´ä½¿ç”¨elasticsearchçš„é»˜è®¤é…ç½®å¹¶æ²¡æœ‰å¯¹å…¶çº¿ç¨‹æ± å’Œå†…å­˜åˆ†é…è¿›è¡Œä¼˜åŒ–é€ æˆçš„ã€‚æ‰€ä»¥æŒ‰ç…§å®˜æ–¹æ–‡æ¡£(ç‰ˆæœ¬2.2)å’Œä¸€äº›å‚è€ƒèµ„æ–™æ•´ç†ä¸€ä¸‹elasticsearchçš„å¯é…ç½®é¡¹ï¼Œçœ‹çœ‹å¯ä¸å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹ã€‚å…ˆæ•´ç†äº†Local gateway,HTTP,Indices,Network Settingså››ä¸ªæ¨¡å—çš„å¯é…ç½®é¡¹ï¼Œå…¶ä»–æ¨¡å—(æ¯”å¦‚Cluster)ä¼šåœ¨ä¹‹åæ…¢æ…¢æ•´ç†çš„ã€‚æœ¬æ–‡åªåŒ…å«å››ä¸ªæ¨¡å—å¯ç”¨é…ç½®é¡¹çš„å«ä¹‰åŠç”¨æ³•ï¼Œå¹¶ä¸æ¶‰åŠåº”è¯¥å¦‚ä½•ä¼˜åŒ–ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºä¿ºä¹Ÿä¸ä¼šã€‚ã€‚ã€‚ã€‚ã€‚(æ¬¢è¿æŒ‡æ­£é”™è¯¯ï¼Œåº·æ¡‘é˜¿ç±³è¾¾) ç›¸å…³åšå®¢ï¼šelasticsearch é…ç½®é¡¹(äºŒ) å‚è€ƒèµ„æ–™(ä¸‡åˆ†æ„Ÿè°¢)ï¼š http://donlianli.iteye.com/blog/2115979 http://aoyouzi.iteye.com/blog/2164820 http://blog.csdn.net/jingkyks/article/details/41081261 http://m.oschina.net/blog/387512 http://my.oschina.net/secisland/blog/618702?fromerr=ZGR1hlby#OSC_h4_5 https://github.com/chenryn/ELKstack-guide-cn/blob/master/elasticsearch/performance/cache.md Local gatewayæ¨¡å—å®˜ç½‘å¯¹åº”é“¾æ¥ï¼šLocal gatewayè¯¥æ¨¡å—ç”¨äºå­˜å‚¨é›†ç¾¤ä¿¡æ¯å’Œåˆ†ç‰‡æ•°æ®ï¼Œä»¥ä¾¿æ•´ä¸ªé›†ç¾¤é‡å¯åå¯ä»¥æ¢å¤ã€‚ä»¥ä¸‹çš„ä¸€äº›é™æ€é…ç½®ï¼Œéœ€è¦åœ¨é›†ç¾¤çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šè®¾ç½®ï¼Œç”¨æ¥æ§åˆ¶èŠ‚ç‚¹éœ€è¦ç­‰å¾…å¤šé•¿æ—¶é—´ä¹‹åå†å°è¯•æ¢å¤å­˜å‚¨åœ¨æœ¬åœ°çš„æ•°æ®ã€‚ é…ç½®é¡¹ å«ä¹‰ gateway.expected_nodes æœŸæœ›çš„é›†ç¾¤ä¸­èŠ‚ç‚¹çš„æ•°é‡ï¼Œå½“é›†ç¾¤ä¸­çš„èŠ‚ç‚¹æ•°è¾¾åˆ°è®¾å®šå€¼æ—¶ç«‹å³å¼€å§‹å¯åŠ¨æ¢å¤æœ¬åœ°æ•°æ®çš„è¿›ç¨‹(ä¼šå¿½ç•¥recover_after_timeé…ç½®)ï¼Œé»˜è®¤ä¸º0 gateway.expected_master_nodes æœŸæœ›çš„é›†ç¾¤ä¸­masterèŠ‚ç‚¹çš„æ•°é‡ï¼Œå½“é›†ç¾¤ä¸­çš„èŠ‚ç‚¹æ•°è¾¾åˆ°è®¾å®šå€¼æ—¶ç«‹å³å¼€å§‹å¯åŠ¨æ¢å¤æœ¬åœ°æ•°æ®çš„è¿›ç¨‹(ä¼šå¿½ç•¥recover_after_timeé…ç½®)ï¼Œé»˜è®¤ä¸º0 gateway.expected_data_nodes æœŸæœ›çš„é›†ç¾¤ä¸­masterèŠ‚ç‚¹çš„æ•°é‡ï¼Œå½“é›†ç¾¤ä¸­çš„èŠ‚ç‚¹æ•°è¾¾åˆ°è®¾å®šå€¼æ—¶ç«‹å³å¼€å§‹å¯åŠ¨æ¢å¤æœ¬åœ°æ•°æ®çš„è¿›ç¨‹(ä¼šå¿½ç•¥recover_after_timeé…ç½®)ï¼Œé»˜è®¤ä¸º0 gateway.recover_after_time å½“æ²¡æœ‰è¾¾åˆ°æœŸæœ›çš„èŠ‚ç‚¹æ•°æ—¶ï¼Œæ¢å¤è¿›ç¨‹ä¼šåœ¨ç­‰å¾…é…ç½®æ—¶é—´ä¹‹åå°è¯•å¯åŠ¨ã€‚å½“æœŸæœ›çš„èŠ‚ç‚¹æ•°è®¾ç½®ä¸º1æ—¶ï¼Œç­‰å¾…æ—¶é—´é»˜è®¤ä¸º5m ä¸€æ—¦åˆ°è¾¾äº†recover_after_timeè®¾ç½®çš„æ—¶é—´ï¼Œè¿˜è¦æ»¡è¶³ä»¥ä¸‹çš„é…ç½®æ¡ä»¶ï¼Œæ¢å¤è¿›ç¨‹æ‰ä¼šå¯åŠ¨ã€‚ é…ç½®é¡¹ å«ä¹‰ gateway.recover_after_nodes éœ€è¦å¤šå°‘ä¸ªèŠ‚ç‚¹åŠ å…¥é›†ç¾¤ gateway.recover_after_master_nodes éœ€è¦å¤šå°‘ä¸ªmasterèŠ‚ç‚¹åŠ å…¥é›†ç¾¤ gateway.recover_after_data_nodes éœ€è¦å¤šå°‘ä¸ªdataèŠ‚ç‚¹åŠ å…¥é›†ç¾¤ æ³¨æ„ï¼šè¿™äº›é…ç½®åªæœ‰åœ¨æ•´ä¸ªé›†ç¾¤é‡å¯æ—¶æ‰ä¼šæœ‰ç”¨ã€‚ HTTPæ¨¡å—å®˜ç½‘å¯¹åº”é“¾æ¥ï¼šHTTPHTTPæ¨¡å—ç”¨æ¥é€šè¿‡HTTPæš´éœ²Esçš„APIã€‚å› ä¸ºHTTPæœºåˆ¶æ˜¯å®Œå…¨å¼‚æ­¥çš„ï¼Œè¿™æ„å‘³ç€ç­‰å¾…å“åº”æ—¶ä¸ä¼šé˜»å¡çº¿ç¨‹ã€‚ä½¿ç”¨å¼‚æ­¥çš„é€šä¿¡å¯ä»¥è§£å†³C10kçš„é—®é¢˜ã€‚å¦‚æœå¯ä»¥ï¼Œå¯è€ƒè™‘ä½¿ç”¨HTTP keep aliveæ¥è¿æ¥ä»¥ä¾¿æå‡æ€§èƒ½ã€‚å¹¶ä¸”ä¸è¦åœ¨å®¢æˆ·ç«¯ä½¿ç”¨HTTP chunkingã€‚ é…ç½®ä¸‹é¢è¡¨ä¸­æ˜¯å…³äºHTTPæ¨¡å—çš„ä¸€äº›é…ç½®ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒä»¬éƒ½ä¸èƒ½åŠ¨æ€æ›´æ–°ï¼Œå¿…é¡»é…ç½®åœ¨elasticsearch.ymlæ–‡ä»¶ä¸­ã€‚ é…ç½®é¡¹ å«ä¹‰ http.port ç»‘å®šç«¯å£çš„èŒƒå›´ é»˜è®¤9200-9300 http.publish_port å®¢æˆ·ç«¯ä¸èŠ‚ç‚¹äº¤äº’æ—¶éœ€è¦ä½¿ç”¨çš„ç«¯å£ã€‚è¿™ä¸€é…ç½®åœ¨é›†ç¾¤èŠ‚ç‚¹å¤„äºé˜²ç«å¢™åæ—¶å¾ˆæœ‰ç”¨ï¼Œé»˜è®¤å’Œhttp.portä¸­åˆ†é…çš„ç«¯å£ä¸€è‡´ã€‚ http.bind_host ç»‘å®šhttpæœåŠ¡çš„hoståœ°å€ï¼Œé»˜è®¤å’Œhttp.host(å¦‚æœè®¾ç½®äº†)æˆ–è€…network.bind_hostä¸€è‡´ http.publish_host å®¢æˆ·ç«¯è®¿é—®çš„hoståœ°å€ï¼Œé»˜è®¤å’Œhttp.host(å¦‚æœè®¾ç½®äº†)æˆ–è€…network.public_hostä¸€è‡´ http.host ç”¨æ¥è®¾ç½®http.bind_hostå’Œhttp.publish_host,é»˜è®¤ä¸ºhttp.hostæˆ–è€…network.host http.max_content_length è®¾ç½®è¯·æ±‚å†…å®¹çš„æœ€å¤§å¤§å°ã€‚é»˜è®¤100mbã€‚å¦‚æœè®¾ç½®çš„æ•°å€¼è¶…è¿‡äº†Integer.MAX_VALUE,ä¼šè¢«é‡ç½®ä¸º100mbã€‚ http.max_initial_line_length HTTPè¯·æ±‚URLçš„æœ€å¤§é•¿åº¦ï¼Œé»˜è®¤4kb http.max_header_size è¯·æ±‚å¤´çš„æœ€å¤§å¤§å°ï¼Œé»˜è®¤8kb http.compression æ˜¯å¦æ”¯æŒå‹ç¼©(ä½¿ç”¨Accept-Encoding)ï¼Œé»˜è®¤false http.compression_level å®šä¹‰ä½¿ç”¨çš„å‹ç¼©çº§åˆ«ï¼Œé»˜è®¤ä¸º6 http.cors.enabled æ˜¯å¦å…è®¸è·¨åŸŸè¯·æ±‚ã€‚é»˜è®¤ä¸ºfalse http.cors.allow-origin å®šä¹‰å…è®¸å“ªäº›æºè¯·æ±‚ã€‚å¯ä»¥ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¾‹å¦‚/https?:\\/\\/localhost(:[0-9]+)?/å¯è®¾ç½®æ”¯æŒæœ¬åœ°HTTPå’ŒHTTPSè¯·æ±‚ã€‚ä¹Ÿå¯ä»¥è®¾ç½®ä¸º*,ä½†æ˜¯ä¼šå­˜åœ¨å®‰å…¨éšæ‚£ï¼Œå› ä¸ºä»»ä½•æ¥æºéƒ½å¯è®¿é—®Elasticsearch(ä»¥ä¸‹ç®€ç§°ä¸ºEs)å®ä¾‹ã€‚ http.cors.max-age æµè§ˆå™¨ä¼šå‘é€ä¸€ä¸ªâ€œé¢„æ£€â€çš„OPTIONSè¯·æ±‚ï¼Œæ¥æ£€æŸ¥CORSè®¾ç½®ã€‚max-ageå®šä¹‰åº”è¯¥ç¼“å­˜å¤šé•¿æ—¶é—´çš„ç»“æœã€‚é»˜è®¤ä¸º1728000ï¼ˆ20å¤©ï¼‰ http.cors.allow-methods å®šä¹‰äº†å…è®¸çš„è¯·æ±‚æ–¹å¼ï¼Œé»˜è®¤å…è®¸OPTIONS, HEAD, GET, POST, PUT, DELETE http.cors.allow-headers å®šä¹‰äº†å…è®¸çš„è¯·æ±‚å¤´ä¿¡æ¯ã€‚é»˜è®¤å…è®¸X-Requested-With, Content-Type, Content-Length http.cors.allow-credentials æ˜¯å¦è¿”å›è®¾ç½®çš„Access-Control-Allow-Credentialså¤´ä¿¡æ¯ã€‚é»˜è®¤ä¸ºfalse http.detailed_errors.enabled æ˜¯å¦è¾“å‡ºè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå †æ ˆã€‚é»˜è®¤ä¸ºtrue http.pipelining æ˜¯å¦å¯ç”¨HTTPç®¡é“æ”¯æŒ, é»˜è®¤ä¸ºtrue http.pipelining.max_events åœ¨ä¸€ä¸ªHTTPè¿æ¥è¢«å…³é—­ä¹‹å‰å†…å­˜é˜Ÿåˆ—ä¸­å…è®¸çš„æœ€å¤§çš„äº‹ä»¶æ•°é‡ï¼Œé»˜è®¤ä¸º10000 è¯¥æ¨¡å—ä¹Ÿå¯ä½¿ç”¨ä¸€äº›å…¬å…±çš„ç½‘ç»œé…ç½®(è§ç½‘ç»œè®¾ç½®ä¸€èŠ‚)ã€‚ ç¦ç”¨HTTPHTTPæ¨¡å—å¯ä»¥é€šè¿‡å°†http.enableè®¾ç½®ä¸ºfalseæ¥ç¦ç”¨ã€‚EsèŠ‚ç‚¹(å’ŒJavaå®¢æˆ·ç«¯)çš„å†…éƒ¨é€šä¿¡ä½¿ç”¨transportæ¥å£ï¼Œè€ŒéHTTPã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†ä¸æ¥å—ç›´æ¥RESTè¯·æ±‚çš„èŠ‚ç‚¹çš„HTTPç¦ç”¨ã€‚æ¯”å¦‚ï¼Œå¯ä»¥å°†æ•°æ®èŠ‚ç‚¹çš„httpç¦ç”¨ï¼Œåˆ›å»ºéæ•°æ®èŠ‚ç‚¹ç”¨æ¥å¤„ç†æ‰€æœ‰çš„RESTè¯·æ±‚ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸èƒ½å‘ä¸€ä¸ªå·²ç»ç¦ç”¨äº†HTTPçš„èŠ‚ç‚¹ç›´æ¥å‘é€ä»»ä½•RESTè¯·æ±‚ã€‚ Indices(ç´¢å¼•æ¨¡å—)å®˜ç½‘å¯¹åº”é“¾æ¥ï¼šIndicesè¿™ä¸€æ¨¡å—å¯ä»¥å¯¹æ‰€æœ‰ç´¢å¼•çš„ç´¢å¼•ç›¸å…³é…ç½®è¿›è¡Œå…¨å±€æ§åˆ¶ã€‚ç›¸å…³çš„é…ç½®å¦‚ä¸‹ï¼š Circuit breaker(æ–­è·¯å™¨)å®˜ç½‘å¯¹åº”é“¾æ¥ï¼šCircuit breakerè¯¥æ¨¡å—ç”¨æ¥é™åˆ¶å†…å­˜çš„ä½¿ç”¨ï¼Œé¿å…å‡ºç°å†…å­˜æº¢å‡ºã€‚Esä¸­åŒ…å«å¤šä¸ªCircuit breaker(æ–­è·¯å™¨)ç”¨æ¥é˜»æ­¢å¯èƒ½é€ æˆOutOfMemoryErrorå¼‚å¸¸çš„æ“ä½œã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªçˆ¶çº§åˆ«æ–­è·¯å™¨é™åˆ¶äº†å¯ä»¥ä½¿ç”¨çš„æ€»å†…å­˜ã€‚è¿™äº›é…ç½®éƒ½å¯é€šè¿‡Cluster-update-settingsåŠ¨æ€æ›´æ–°ã€‚çˆ¶æ–­è·¯å™¨çˆ¶çº§åˆ«çš„æ–­è·¯å™¨å¯ä»¥é€šè¿‡indices.breaker.total.limitæ¥è®¾ç½®ï¼Œé»˜è®¤æ˜¯JVMå †çš„70% Filed dataæ–­è·¯å™¨å…è®¸Esæå‰ä¼°è®¡åŠ è½½ä¸€ä¸ªå­—æ®µéœ€è¦çš„å†…å­˜ï¼Œç„¶åæ£€æŸ¥åŠ è½½éœ€è¦çš„fielddataä¼šä¸ä¼šå¯¼è‡´æ€»çš„å†…å­˜å¤§å°è¶…è¿‡è®¾ç½®çš„ç™¾åˆ†æ¯”ã€‚è¿™æ ·å¯ä»¥é¢„é˜²åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­äº§ç”Ÿå¼‚å¸¸ã€‚é»˜è®¤çš„é™åˆ¶æ˜¯60%çš„JVMå †ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹å‚æ•°é…ç½®ã€‚indices.breaker.fielddata.limitï¼šé™åˆ¶fielddataæ‰€èƒ½å ç”¨çš„æœ€å¤§å†…å­˜ï¼Œé»˜è®¤ä¸ºJVMå †çš„60%indices.breaker.fielddata.overhead:ä¸€ä¸ªå¸¸é‡ã€‚eså°†ä½¿ç”¨è¿™ä¸ªå€¼ä¹˜ä»¥fieldå®é™…çš„å¤§å°ä½œFieldä¼°ç®—å€¼ï¼Œé»˜è®¤ä¸º1.03è¯·æ±‚æ–­è·¯å™¨å…è®¸Esé˜»æ­¢ä½¿ç”¨å†…å­˜è¶…è¿‡é™åˆ¶çš„è¯·æ±‚ã€‚indices.breaker.request.limit:é»˜è®¤JVMå †çš„40%indices.breaker.request.overhead:ä¸€ä¸ªå¸¸é‡ã€‚æ‰€æœ‰è¯·æ±‚çš„é¢„ä¼°å†…å­˜ä¹˜ä»¥è¿™ä¸ªå¸¸é‡å°±æ˜¯æœ€ç»ˆçš„ä¼°è®¡å€¼ã€‚é»˜è®¤ä¸º1 Fielddata cache(å­—æ®µæ•°æ®ç¼“å­˜)é™åˆ¶å†…å­˜ä¸­çš„æ•°æ®ç¼“å­˜å¯ä»¥ä½¿ç”¨å¤šå¤§çš„å †å†…å­˜field dataç¼“å­˜ä¸»è¦ç”¨äºé’ˆå¯¹ä¸€ä¸ªå­—æ®µæ’åºå’Œåšèšåˆè®¡ç®—ã€‚ä¸ºäº†å¿«é€Ÿçš„è®¿é—®æŸäº›å€¼ï¼ŒEsä¼šå°†è¿™äº›å­—æ®µå€¼åŠ è½½åˆ°å†…å­˜ä¸­ã€‚éœ€è¦æ³¨æ„çš„æ˜¯å°†å­—æ®µåŠ è½½åˆ°å†…å­˜å¾ˆè€—è´¹èµ„æºï¼Œæ‰€ä»¥å®˜æ–¹å»ºè®®ä¿è¯æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œå¹¶ä¸”ä¿æŒæ‰€æœ‰å­—æ®µè¢«åŠ è½½ã€‚field dataå†…å­˜çš„å¤§å°å¯é€šè¿‡indices.fielddata.cache.sizeé…ç½®é¡¹æ§åˆ¶ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œå½“è¿™ä¸ªç¼“å­˜ä¸å¤Ÿç”¨æ—¶ï¼Œä¸ºäº†è…¾å‡ºç©ºé—´ç»™æ–°çš„ç¼“å­˜ï¼ŒåŸæ¥ç¼“å­˜çš„å­—æ®µä¼šè¢«æŒ¤å‡ºæ¥ï¼Œè¿™ä¼šå¯¼è‡´ç³»ç»Ÿæ€§èƒ½ä¸‹é™ã€‚indices.fielddata.cache.size:field dataç¼“å­˜çš„æœ€å¤§å€¼ã€‚å¯ä»¥è®¾ä¸ºèŠ‚ç‚¹å †ç©ºé—´çš„30%ï¼Œä¹Ÿå¯è®¾ç½®ä¸ºä¸€ä¸ªç¡®å®šçš„å€¼ï¼Œæ¯”å¦‚12GBã€‚é»˜è®¤æ— é™å¤§ï¼Œç”Ÿäº§ç¯å¢ƒè¦æ³¨æ„è®¾ç½®è¿™ä¸ªå€¼ã€‚ æ³¨æ„ï¼šè¿™äº›é™æ€é…ç½®éœ€è¦åœ¨é›†ç¾¤çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šè®¾ç½®ã€‚ ç›‘æ§field dataå¯ä»¥é€šè¿‡Node Stats APIç›‘æ§å†…å­˜ä½¿ç”¨æƒ…å†µã€‚ Node query cache(æŸ¥è¯¢ç¼“å­˜)é…ç½®ç¼“å­˜æŸ¥è¯¢ç»“æœå¯ä»¥ä½¿ç”¨å¤šå°‘å †å†…å­˜æŸ¥è¯¢ç¼“å­˜è´Ÿè´£å¯¹æŸ¥è¯¢ç»“æœè¿›è¡Œç¼“å­˜ã€‚æ¯ä¸€ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªæŸ¥è¯¢ç¼“å­˜ï¼Œç”±æ‰€æœ‰åˆ†ç‰‡å…±äº«ã€‚ç¼“å­˜é‡‡ç”¨LRUæœºåˆ¶ï¼Œå°†æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„å†…å®¹æ›¿æ¢æˆæ–°æ•°æ®ã€‚æŸ¥è¯¢ç¼“å­˜åªä¼šç¼“å­˜filterçš„å†…å®¹ã€‚ä¸‹é¢çš„é…ç½®éœ€è¦åœ¨é›†ç¾¤çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šé…ç½®ã€‚indices.queries.cache.size: æ§åˆ¶è¿‡æ»¤ç»“æœç¼“å­˜çš„å¤§å°ã€‚é»˜è®¤æ˜¯10%ã€‚ä¹Ÿå¯è®¾ç½®ä¸ºä¸€ä¸ªç¡®å®šçš„å€¼ï¼Œå¦‚512mbã€‚ Indexing buffer(ç´¢å¼•ç¼“å†²)æ§åˆ¶åˆ†é…å¤šå°‘å†…å­˜ç»™ç´¢å¼•è¿›ç¨‹ç´¢å¼•ç¼“å†²ç”¨æ¥å­˜å‚¨æ–°ç´¢å¼•çš„æ–‡æ¡£ã€‚å½“ç¼“å†²åŒºæ»¡äº†æ—¶ï¼Œç¼“å†²çš„æ–‡æ¡£ä¼šè¢«å†™åˆ°ç£ç›˜çš„ä¸€ä¸ªæ®µï¼Œåˆ’åˆ†åˆ°è¯¥èŠ‚ç‚¹çš„æ‰€æœ‰åˆ†ç‰‡ä¸Šã€‚ä»¥ä¸‹è¿™äº›é™æ€é…ç½®éœ€è¦åœ¨é›†ç¾¤çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¸Šè®¾ç½®ã€‚ é…ç½®é¡¹ å«ä¹‰ indices.memory.index_buffer_size è®¾ç½®ç´¢å¼•ç¼“å†²åŒºçš„å¤§å°ã€‚å¯è®¾ç½®ä¸€ä¸ªç™¾åˆ†æ¯”æˆ–è€…å­—èŠ‚å¤§å°ã€‚é»˜è®¤ä¸º10%ï¼Œæ„å‘³ç€èŠ‚ç‚¹çš„10%çš„ indices.memory.min_index_buffer_size å¦‚æœindices.memory.index_buffer_sizeè¢«è®¾ç½®æˆäº†ä¸€ä¸ªç™¾åˆ†æ¯”ï¼Œæœ¬é…ç½®é¡¹å¯ä»¥ç”¨æ¥ä»£è¡¨ç¼“å†²åŒºçš„æœ€å°å€¼ï¼Œé»˜è®¤ä¸º48mbã€‚ indices.memory.max_index_buffer_size å¦‚æœindices.memory.index_buffer_sizeè¢«è®¾ç½®æˆäº†ä¸€ä¸ªç™¾åˆ†æ¯”ï¼Œæœ¬é…ç½®é¡¹å¯ä»¥ç”¨æ¥ä»£è¡¨ç¼“å†²åŒºçš„æœ€å¤§å€¼ï¼Œé»˜è®¤æ— é™å¤§ã€‚ indices.memory.min_shard_index_buffer_size ä¸ºæ¯ä¸ªåˆ†ç‰‡è‡ªå·±çš„ç´¢å¼•ç¼“å†²åŒºè®¾ç½®æœ€å°å€¼ã€‚é»˜è®¤4mb Shard request cache(åˆ†ç‰‡è¯·æ±‚ç¼“å­˜)æ§åˆ¶åˆ†ç‰‡çº§åˆ«çš„æŸ¥è¯¢ç¼“å­˜çš„è¡Œä¸ºã€‚å½“ä¸€ä¸ªæœç´¢è¯·æ±‚æ˜¯é’ˆå¯¹ä¸€ä¸ªç´¢å¼•æˆ–è€…å¤šä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ªæ¶‰åŠåˆ°çš„åˆ†ç‰‡éƒ½ä¼šåœ¨æœ¬åœ°è¿›è¡Œæœç´¢ï¼Œç„¶åæŠŠç»“æœè¿”å›åˆ°åè°ƒèŠ‚ç‚¹ï¼Œåœ¨ç”±åè°ƒèŠ‚ç‚¹æŠŠè¿™äº›ç»“æœåˆå¹¶åˆ°ä¸€èµ·ã€‚ç”±äºåˆ†ç‰‡ç¼“å­˜æ¨¡å—ä¼šå°†æœ¬åœ°çš„æŸ¥è¯¢ç»“æœç¼“å­˜ï¼Œæ‰€ä»¥é¢‘ç‡é«˜çš„æœç´¢è¯·æ±‚ä¼šç«‹åˆ»è¿”å›ç»“æœã€‚ æ³¨æ„ï¼šç›®å‰ï¼Œè¯·æ±‚ç¼“å­˜åªç¼“å­˜æŸ¥è¯¢æ¡ä»¶size=0çš„æœç´¢ï¼Œç¼“å­˜çš„å†…å®¹æœ‰hits.total, aggregations,suggestionsï¼Œè€Œä¸ç¼“å­˜åŸå§‹çš„hitsã€‚å¹¶ä¸”é€šè¿‡nowæŸ¥è¯¢çš„ç»“æœä¹Ÿä¸ç¼“å­˜ã€‚ åªç¼“å­˜æŸ¥è¯¢æ¡ä»¶size=0çš„æœç´¢åŸå› å¦‚ä¸‹(å¼•ç”¨è‡ªELKstack-guide-cn):ESå¯¹è¯·æ±‚çš„å¤„ç†è¿‡ç¨‹æ˜¯æœ‰ä¸åŒç±»å‹çš„ï¼Œé»˜è®¤çš„å« query_then_fetchã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå„æ•°æ®èŠ‚ç‚¹å¤„ç†æ£€ç´¢è¯·æ±‚åï¼Œè¿”å›çš„æ˜¯åªåŒ…å«æ–‡æ¡£idå’Œç›¸å…³æ€§åˆ†å€¼çš„ç»“æœï¼Œè¿™ä¸€æ®µå¤„ç†ï¼Œå«åšqueryé˜¶æ®µï¼›æ±‡èšåˆ°è¿™ä»½ç»“æœåï¼ŒæŒ‰ç…§åˆ†å€¼æ’åºï¼Œå¾—åˆ°ä¸€ä¸ªå…¨é›†ç¾¤æœ€ç»ˆéœ€è¦çš„æ–‡æ¡£idï¼Œå†å‘å¯¹åº”èŠ‚ç‚¹å‘é€ä¸€æ¬¡æ–‡æ¡£è·å–è¯·æ±‚ï¼Œæ‹¿åˆ°æ–‡æ¡£å†…å®¹ï¼Œè¿™ä¸€æ®µå¤„ç†ï¼Œå«åš fetché˜¶æ®µã€‚ä¸¤æ®µéƒ½ç»“æŸåæ‰è¿”å›å“åº”ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰DFS_query_then_fetchç±»å‹ï¼Œæé«˜å°æ•°æ®é‡æ—¶çš„ç²¾ç¡®åº¦;query_and_fetchç±»å‹ï¼Œåœ¨æœ‰æ˜ç¡®routingæ—¶å¯ä»¥çœç•¥ä¸€ä¸ªæ•°æ®æ¥å›;countç±»å‹ï¼Œä¸å…³å¿ƒæ–‡æ¡£å†…å®¹åªéœ€è¦è®¡æ•°æ—¶çœç•¥ fetché˜¶æ®µ;scanç±»å‹ï¼Œæ‰¹é‡è·å–æ•°æ®çœç•¥queryé˜¶æ®µï¼Œåœ¨reindexæ—¶å°±æ˜¯ä½¿ç”¨è¿™ç§ç±»å‹ã€‚å›åˆ°query cacheï¼Œè¿™é‡Œè¿™ä¸ªqueryï¼Œå°±æ˜¯å¤„ç†è¿‡ç¨‹ä¸­queryé˜¶æ®µçš„æ„æ€ã€‚å„ä¸ªèŠ‚ç‚¹ä¸Šçš„æ•°æ®åˆ†ç‰‡ï¼Œä¼šåœ¨å¤„ç†å®Œqueryé˜¶æ®µæ—¶ï¼Œå°†å¾—åˆ°çš„æœ¬åˆ†ç‰‡æœ‰å…³è¯¥è¯·æ±‚çš„è®¡æ•°å€¼ï¼Œç¼“å­˜èµ·æ¥ã€‚æ ¹æ®ä¸Šé¢çš„è¯·æ±‚ç±»å‹ä»‹ç»ï¼Œæ˜¾ç„¶,åªæœ‰å½“?search_type=countçš„æ—¶å€™ï¼Œè¿™ä¸ªquery cacheæ‰èƒ½èµ·åˆ°ä½œç”¨ã€‚ç¼“å­˜å¤±æ•ˆåœ¨åˆ†ç‰‡æ•°æ®çœŸæ­£å‘ç”Ÿå˜åŒ–æ—¶åˆ·æ–°ç´¢å¼•åˆ†ç‰‡ï¼Œç¼“å­˜çš„ç»“æœä¼šè‡ªåŠ¨å¤±æ•ˆã€‚åˆ·æ–°é—´éš”è¶Šé•¿ç¼“å­˜çš„æ•°æ®è¶Šå¤šã€‚å½“ç¼“å­˜æ»¡äº†çš„æ—¶å€™ï¼Œä¼šå°†æœ€å°‘ä½¿ç”¨çš„æ•°æ®åˆ é™¤ã€‚ç¼“å­˜å¯ä»¥é€šè¿‡clear-cache APIæ‰‹åŠ¨è®¾ç½®è¿‡æœŸã€‚ 1curl -XPOST 'localhost:9200/kimchy,elasticsearch/_cache/clear?request_cache=true' é»˜è®¤å¯åŠ¨ç¼“å­˜åˆ†ç‰‡è¯·æ±‚ç¼“å­˜é»˜è®¤æ˜¯ä¸å¯åŠ¨çš„ï¼Œä½†å¯ä»¥åœ¨åˆ›å»ºæ–°çš„ç´¢å¼•æ—¶é€šè¿‡ä¸‹é¢çš„æ–¹å¼å¯åŠ¨ï¼š 123456curl -XPUT localhost:9200/my_index -d'&#123; \"settings\": &#123; \"index.requests.cache.enable\": true &#125;&#125; ä¹Ÿå¯ä»¥é€šè¿‡update-settings APIä¸ºå°±ç´¢å¼•åŠ¨æ€çš„å¯åŠ¨å’Œå…³é—­ç¼“å­˜ã€‚ 12curl -XPUT localhost:9200/my_index/_settings -d'&#123; \"index.requests.cache.enable\": true &#125; ä¸ºæ¯ä¸ªè¯·æ±‚å¯åŠ¨ç¼“å­˜å¯ä»¥åœ¨è¯·æ±‚æ—¶é€šè¿‡è¯·æ±‚å‚æ•°request_cacheæ¥ä¸ºæ¯ä¸ªè¯·æ±‚å¯åŠ¨å’Œå…³é—­ç¼“å­˜ã€‚1234567891011curl 'localhost:9200/my_index/_search?request_cache=true' -d'&#123; \"size\": 0, \"aggs\": &#123; \"popular_colors\": &#123; \"terms\": &#123; \"field\": \"colors\" &#125; &#125; &#125;&#125; ç¼“å­˜è®¾ç½®ç¼“å­˜æ˜¯åœ¨èŠ‚ç‚¹çº§åˆ«ç®¡ç†ï¼Œé»˜è®¤JVMå †å†…å­˜çš„1%ã€‚å¯åœ¨config/elasticsearch.ymlæ–‡ä»¶ä¸­æ›´æ”¹ã€‚1indices.requests.cache.size: 2% ä¹Ÿå¯ä»¥é€šè¿‡indices.requests.cache.expireè®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œä½†æ˜¯æ²¡æœ‰å¿…è¦ï¼Œå› ä¸ºæ—§çš„ç»“æœä¼šåœ¨ç´¢å¼•åˆ·æ–°æ—¶è‡ªåŠ¨å¤±æ•ˆã€‚ æ£€æµ‹ç¼“å­˜ä½¿ç”¨å¯é€šè¿‡indices-stats APIæ£€æµ‹ç´¢å¼•ä¸­ç¼“å­˜çš„ä½¿ç”¨æƒ…å†µ1curl 'localhost:9200/_stats/request_cache?pretty&amp;human' æˆ–é€šè¿‡nodes-stats APIæŸ¥çœ‹èŠ‚ç‚¹çš„ä½¿ç”¨æƒ…å†µã€‚1curl 'localhost:9200/_nodes/stats/indices/request_cache?pretty&amp;human' Indices Recovery(ç´¢å¼•æ¢å¤)é™åˆ¶åˆ†ç‰‡æ¢å¤è¿›ç¨‹çš„èµ„æºä»¥ä¸‹çš„é…ç½®ç”¨æ¥ç®¡ç†æ¢å¤ç­–ç•¥ï¼š é…ç½®é¡¹ å«ä¹‰ indices.recovery.concurrent_streams é»˜è®¤æ˜¯3 indices.recovery.concurrent_small_file_streams é»˜è®¤2 indices.recovery.file_chunk_size é»˜è®¤512kb indices.recovery.translog_ops é»˜è®¤1000 indices.recovery.translog_size é»˜è®¤512kb indices.recovery.compress é»˜è®¤true indices.recovery.max_bytes_per_sec é»˜è®¤40mb è¿™äº›é…ç½®éƒ½å¯é€šè¿‡Cluster-update-settingsåŠ¨æ€æ›´æ–°ã€‚ TTL intervalæ§åˆ¶è¿‡æœŸæ–‡æ¡£çš„åˆ é™¤è®¾æœ‰ttlå€¼çš„æ–‡æ¡£ä¼šåœ¨è¿‡æœŸä¹‹åè¢«åˆ é™¤ã€‚ä»¥ä¸‹åŠ¨æ€é…ç½®æ§åˆ¶äº†åˆ é™¤æ–‡æ¡£çš„æ£€æŸ¥é—´éš”ï¼Œå’Œæ‰¹é‡åˆ é™¤çš„å¤§å°ã€‚indices.ttl.intervalï¼šåˆ é™¤è¿›ç¨‹å¯åŠ¨é—´éš”ã€‚é»˜è®¤60sindices.ttl.bulk_sizeï¼šåˆ é™¤è¿›ç¨‹çš„æ•°é‡ã€‚é»˜è®¤ä¸º1000 NetWork Settings(ç½‘ç»œè®¾ç½®)Esé»˜è®¤åªå’Œlocalhostç»‘å®šã€‚å¦‚æœæƒ³è¦åœ¨å¤šä¸ªæœåŠ¡å™¨ä¸Šå¯åŠ¨ç”Ÿäº§ç¯å¢ƒçš„é›†ç¾¤éœ€è¦é…ç½®ä¸€äº›åŸºæœ¬çš„ç½‘ç»œè®¾ç½®ã€‚ æ³¨æ„ï¼šè¦å°å¿ƒä½¿ç”¨ç½‘ç»œé…ç½®ï¼Œä¸è¦å°†ä¸å—ä¿æŠ¤çš„èŠ‚ç‚¹æš´éœ²åœ¨å…¬å…±ç½‘ç»œä¸­ã€‚ å¸¸ç”¨çš„ç½‘ç»œè®¾ç½® é…ç½®é¡¹ å«ä¹‰ network.host å°†èŠ‚ç‚¹ç»‘å®šåˆ°è®¾ç½®çš„hostnameæˆ–ipåœ°å€ï¼Œå¹¶é€šçŸ¥é›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ã€‚è¯¥é…ç½®é¡¹æ¥å—IPåœ°å€ï¼Œä¸»æœºåï¼Œä¸€äº›ç‰¹å®šå€¼(è§ä¸‹ä¸€ä¸ªè¡¨)å’Œç”±ä¸Šé¢å‡ é¡¹ç»„æˆçš„æ•°ç»„ã€‚é»˜è®¤ä¸º_local_ã€‚ discovery.zen.ping.unicast.hosts å¦‚æœä¸€ä¸ªèŠ‚ç‚¹åŠ å…¥ä¸€ä¸ªé›†ç¾¤ï¼Œéœ€è¦çŸ¥é“é›†ç¾¤ä¸­å…¶ä»–èŠ‚ç‚¹hostnameå’Œipåœ°å€ã€‚æœ¬é…ç½®é¡¹ä¸ºèŠ‚ç‚¹æä¾›äº†å…¶ä»–èŠ‚ç‚¹çš„åˆå§‹åˆ—è¡¨ã€‚é»˜è®¤[&quot;127.0.0.1&quot;,&quot;[::1]&quot;] http.port ä¸ºHTTPè¯·æ±‚ç»‘å®šç«¯å£ï¼Œå¯è®¾ç½®å•ä¸ªç«¯å£ï¼Œä¹Ÿå¯è®¾ç½®ä¸€ä¸ªèŒƒå›´ã€‚å¦‚æœè®¾å®šäº†ä¸€ä¸ªèŒƒå›´ï¼ŒèŠ‚ç‚¹ä¼šç»‘å®šåœ¨èŒƒå›´ä¸­ç¬¬ä¸€ä¸ªå¯ç”¨çš„ç«¯å£ã€‚é»˜è®¤9200-9300ã€‚ transport.tcp.port èŠ‚ç‚¹é—´å†…éƒ¨é€šä¿¡ç»‘å®šçš„ç«¯å£ï¼Œå¯è®¾ç½®å•ä¸ªç«¯å£ï¼Œä¹Ÿå¯è®¾ç½®ä¸€ä¸ªèŒƒå›´ã€‚å¦‚æœè®¾å®šäº†ä¸€ä¸ªèŒƒå›´ï¼ŒèŠ‚ç‚¹ä¼šç»‘å®šåœ¨èŒƒå›´ä¸­ç¬¬ä¸€ä¸ªå¯ç”¨çš„ç«¯å£ã€‚é»˜è®¤9300-9400 network.hostå¯ä½¿ç”¨çš„ä¸€äº›ç‰¹æ®Šå€¼ ç‰¹æ®Šå€¼ å«ä¹‰ _[networkInterface]_ æŒ‡å®šç½‘å¡çš„IPåœ°å€ï¼Œå¦‚_en0_ _local_ æœ¬æœºipåœ°å€ï¼Œå¦‚127.0.0.1 _site_ ä»»æ„ä¸€ä¸ªsite-localåœ°å€ï¼Œå¦‚192.168.0.1 _global_ ä»»æ„ä¸€ä¸ªglobally-scopedåœ°å€ï¼Œå¦‚8.8.8.8 IPv4 vs IPv6ä»¥ä¸Šç‰¹æ®Šå€¼é»˜è®¤åœ¨IPV4å’ŒIPv6ä¸‹å‡å¯ä½¿ç”¨ï¼Œå¯ä»¥é€šè¿‡:ipv4å’Œ:ipv6æ ‡è¯†ç¬¦æ¥åšé™åˆ¶ã€‚ä¾‹å¦‚,_en0:ipv4_ã€‚ é«˜çº§ç½‘ç»œè®¾ç½®å¸¸ç”¨ç½‘ç»œè®¾ç½®ä¸€èŠ‚ä¸­æåˆ°çš„network.hosté…ç½®é¡¹åªæ˜¯ä¸€ä¸ªä¸ºäº†åŒæ—¶è®¾ç½®band_hostå’Œpublish_hostçš„å¿«æ·è®¾ç½®ã€‚ä¸ºäº†ä¸€ä¸‹æ›´å¤æ‚çš„æƒ…å†µï¼Œæ¯”å¦‚åœ¨ä¸€ä¸ªä»£ç†æœåŠ¡å™¨åè¿è¡ŒèŠ‚ç‚¹ï¼Œå¯èƒ½éœ€è¦ä¸€äº›ä¸åŒçš„é…ç½®ã€‚ é…ç½®é¡¹ å«ä¹‰ network.bind_host è®¾ç½®èŠ‚ç‚¹ç»‘å®šçš„ipåœ°å€ï¼Œç”¨æ¥ç›‘å¬è¯·æ±‚ã€‚é»˜è®¤network.hostã€‚ network.publish_host é…ç½®å…¶ä»–èŠ‚ç‚¹ä¸æœ¬èŠ‚ç‚¹é€šä¿¡çš„åœ°å€ï¼Œé»˜è®¤ä¸ºnetwork.bind_hostä¸­çš„æœ€ä½³åœ°å€ã€‚ ä»¥ä¸Šé…ç½®éƒ½å’Œnetwork.hostä¸€æ ·ï¼Œå¯é…ç½®ipåœ°å€ï¼Œhostnameå’ŒæŸäº›ç‰¹æ®Šå€¼ã€‚ é«˜çº§TCPè®¾ç½®ä»»ä½•ä½¿ç”¨TCPçš„æ¨¡å—ï¼ˆå¦‚HTTPå’ŒTransportï¼‰å…±äº«ä»¥ä¸‹çš„é…ç½®ã€‚ é…ç½®é¡¹ å«ä¹‰ network.tcp.no_delay æ˜¯å¦å¯ç”¨TCP no delayã€‚é»˜è®¤ä¸ºtrue network.tcp.keep_alive æ˜¯å¦å¯ç”¨TCP keep aliveã€‚é»˜è®¤ä¸ºtrue network.tcp.reuse_address ä¸€ä¸ªåœ°å€æ˜¯å¦å¯ä»¥é‡å¤ä½¿ç”¨ network.tcp.send_buffer_size TCPå‘é€ç¼“å†²åŒºçš„å¤§å°ï¼Œé»˜è®¤ä¸è®¾ç½® network.tcp.receive_buffer_size TCPæ¥æ”¶ç¼“å†²åŒºçš„å¤§å°ï¼Œé»˜è®¤ä¸è®¾ç½® Transportå’ŒHTTPåè®®Esä¼šåŸºäºä¸Šé¢çš„é…ç½®æš´éœ²ä¸¤ç§ç½‘ç»œåè®®ï¼Œå®ƒä»¬ä¹Ÿå¯ä»¥è¿›ä¸€æ­¥ç‹¬ç«‹é…ç½®ã€‚TCP transport ç”¨äºèŠ‚ç‚¹ä¹‹é—´é€šä¿¡ å…·ä½“å¯è§Transportæ¨¡å—ä¸€èŠ‚ã€‚HTTP ç”¨äºæš´éœ²åŸºäºJSONçš„httpæ¥å£ã€‚å…·ä½“å¯è§HTTPæ¨¡å—ä¸€èŠ‚ã€‚ éƒ½çœ‹åˆ°è¿™äº†ï¼Œå¬é¦–æ­Œå†èµ°å§ã€‚åˆ†äº«é¦–é€‚åˆæŠ–è…¿çš„æ­Œï¼Œå†™åšå®¢æ—¶å¬è¿™ç§æ­ŒçœŸæ˜¯åˆ†åˆ†é’Ÿéƒ½è¦æŠŠé”®ç›˜æŒ‰ç©¿ã€‚ã€‚ã€‚","raw":null,"content":null,"categories":[{"name":"elasticsearch","slug":"elasticsearch","permalink":"http://yemengying.com/categories/elasticsearch/"}],"tags":[{"name":"elasticsearch","slug":"elasticsearch","permalink":"http://yemengying.com/tags/elasticsearch/"}]},{"title":"ç–¯ç‹‚åŠ¨ç‰©åŸ","slug":"zootopia","date":"2016-03-15T04:44:12.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/03/15/zootopia/","link":"","permalink":"http://yemengying.com/2016/03/15/zootopia/","excerpt":"çœŸçš„æ˜¯å¤ªå–œæ¬¢ç–¯ç‹‚åŠ¨ç‰©åŸè¿™éƒ¨ç”µå½±äº†ï¼ŒäºŒåˆ·ä¹‹åè¿˜æ˜¯æƒ³å»ç”µå½±é™¢æ¥ç€çœ‹ï¼Œå¯¹è¿™ç§æ¯›èŒ¸èŒ¸çš„å°åŠ¨ç‰©çœŸæ˜¯ä¸€ç‚¹æŠµæŠ—åŠ›éƒ½æ²¡æœ‰ï¼Œå°¤å…¶æ˜¯è‹è‹çš„ç‹å°¼å…‹ã€‚æ”¾ç‚¹ç½‘ä¸Šæœæ¥çš„å›¾(æƒä¾µåˆ )ï¼Œæ–¹ä¾¿çœ‹åˆ°å®ƒä»¬ï¼Œå“‡å’”å’”å’”å’”ã€‚","keywords":null,"text":"çœŸçš„æ˜¯å¤ªå–œæ¬¢ç–¯ç‹‚åŠ¨ç‰©åŸè¿™éƒ¨ç”µå½±äº†ï¼ŒäºŒåˆ·ä¹‹åè¿˜æ˜¯æƒ³å»ç”µå½±é™¢æ¥ç€çœ‹ï¼Œå¯¹è¿™ç§æ¯›èŒ¸èŒ¸çš„å°åŠ¨ç‰©çœŸæ˜¯ä¸€ç‚¹æŠµæŠ—åŠ›éƒ½æ²¡æœ‰ï¼Œå°¤å…¶æ˜¯è‹è‹çš„ç‹å°¼å…‹ã€‚æ”¾ç‚¹ç½‘ä¸Šæœæ¥çš„å›¾(æƒä¾µåˆ )ï¼Œæ–¹ä¾¿çœ‹åˆ°å®ƒä»¬ï¼Œå“‡å’”å’”å’”å’”ã€‚ è ¢èŒè ¢èŒï¼Œæ…¢çš„å‡ºå¥‡ï¼Œæˆ³ä¸­ç¬‘ç‚¹çš„æ ‘æ‡’flash è¢«åœˆé¥­çš„å…”ç‹CP æœ€çˆ±çš„ç‹å°¼å…‹ å‹‡æ•¢çš„å…”æœ±è¿ª è‡´æ•¬æ•™çˆ¶çš„Mr. Big å°‘å¥³å¿ƒçš„è±¹è­¦å®˜ å¤§åˆç…§ ä»å†°é›ªå¥‡ç¼˜åˆ°è¶…èƒ½é™†æˆ˜é˜Ÿå†åˆ°ç–¯ç‹‚åŠ¨ç‰©åŸï¼Œä¸å¾—ä¸è¯´è¿ªæ–¯å°¼çš„åŠ¨ç”»è¶Šæ¥è¶Šå¥½çœ‹äº†ã€‚å¥½çš„åŠ¨ç”»ç‰‡çœŸçš„æ˜¯è€å°‘çš†å®œçš„ï¼Œè®©äººåœ¨æ§è…¹å¤§ç¬‘çš„åŒæ—¶åˆèƒ½æœ‰æ‰€æ€è€ƒï¼Œä¸ç®¡æ˜¯å…³äºæ¶ˆé™¤åè§ï¼Œæ¢¦æƒ³è¿˜æ˜¯æˆé•¿~~~~ã€‚","raw":null,"content":null,"categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/categories/éšç¬”/"}],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/tags/éšç¬”/"},{"name":"ç”µå½±","slug":"ç”µå½±","permalink":"http://yemengying.com/tags/ç”µå½±/"}]},{"title":"Java 8 --è¡Œä¸ºå‚æ•°åŒ–(behavior parameterization)","slug":"Java-8-è¡Œä¸ºå‚æ•°åŒ–-behavior-parameterization","date":"2016-02-20T11:33:21.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/02/20/Java-8-è¡Œä¸ºå‚æ•°åŒ–-behavior-parameterization/","link":"","permalink":"http://yemengying.com/2016/02/20/Java-8-è¡Œä¸ºå‚æ•°åŒ–-behavior-parameterization/","excerpt":"æ ¹æ®ä¹¦ &lt;&lt; Java 8 in action &gt;&gt;ç¬¬äºŒç« çš„ä¸€ä¸ªä¾‹å­æ•´ç†ã€‚ä¹¦ä¸­é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œè®²è¿°äº†å¦‚ä½•åˆ©ç”¨behavior parameterizationæ¥åº”å¯¹ä¸åœå˜åŒ–çš„éœ€æ±‚ã€‚æƒ³æƒ³ä¹‹å‰è‡ªå·±å†™çš„å·¥å…·ç±»ï¼ŒçœŸæ˜¯å¤§å†™çš„Lowå•Šã€‚ã€‚ã€‚ã€‚ é¢˜å¤–è¯ï¼šè¦æ—¶åˆ»è°¨è®° Later equals never,Later equals never,Later equals neverï¼ï¼ï¼ï¼ï¼ï¼ï¼","keywords":null,"text":"æ ¹æ®ä¹¦ &lt;&lt; Java 8 in action &gt;&gt;ç¬¬äºŒç« çš„ä¸€ä¸ªä¾‹å­æ•´ç†ã€‚ä¹¦ä¸­é€šè¿‡ä¸€ä¸ªä¾‹å­ï¼Œè®²è¿°äº†å¦‚ä½•åˆ©ç”¨behavior parameterizationæ¥åº”å¯¹ä¸åœå˜åŒ–çš„éœ€æ±‚ã€‚æƒ³æƒ³ä¹‹å‰è‡ªå·±å†™çš„å·¥å…·ç±»ï¼ŒçœŸæ˜¯å¤§å†™çš„Lowå•Šã€‚ã€‚ã€‚ã€‚ é¢˜å¤–è¯ï¼šè¦æ—¶åˆ»è°¨è®° Later equals never,Later equals never,Later equals neverï¼ï¼ï¼ï¼ï¼ï¼ï¼ è¡Œä¸ºå‚æ•°åŒ–åœ¨è½¯ä»¶å¼€å‘ä¸­ï¼Œä¸€ä¸ªä¼—æ‰€å‘¨çŸ¥çš„é—®é¢˜å°±æ˜¯æ— è®ºä½ åšä»€ä¹ˆ,ç”¨æˆ·çš„éœ€æ±‚æ€»ä¼šæ”¹å˜ã€‚ä¸¾ä¸ªæ —å­ï¼Œå‡è®¾è¦åšä¸€ä¸ªå¸®åŠ©å†œåœºä¸»ç†è§£åº“å­˜çš„åº”ç”¨ã€‚ä¸€å¼€å§‹ï¼Œå†œåœºä¸»å¯èƒ½æƒ³æœ‰ä¸€ä¸ªåœ¨æ‰€æœ‰åº“å­˜ä¸­æ‰¾å‡ºæ‰€æœ‰ç»¿è‰²è‹¹æœçš„åŠŸèƒ½ã€‚ä½†æ˜¯ç¬¬äºŒå¤©ä»–å¯èƒ½ä¼šå‘Šè¯‰ä½ ä»–è¿˜æƒ³è¦æ‰¾åˆ°æ‰€æœ‰é‡é‡å¤§äº150gçš„è‹¹æœã€‚ä¸¤å¤©åï¼Œä»–å¯èƒ½åˆæå‡ºæ‰¾åˆ°æ‰€æœ‰ç»¿è‰²çš„å¹¶ä¸”é‡é‡å¤§äº150gçš„è‹¹æœã€‚åœ¨é¢å¯¹è¿™äº›ç›¸ä¼¼çš„æ–°åŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬éƒ½æƒ³å°½å¯èƒ½çš„å‡å°‘å¼€å‘é‡ã€‚behavior parameterizationæ˜¯ç”¨æ¥å¤„ç†é¢‘ç¹æ›´æ”¹çš„éœ€æ±‚çš„ä¸€ç§è½¯ä»¶å¼€å‘æ¨¡å¼ï¼Œå¯ä»¥å°†ä¸€æ®µä»£ç å—å½“åšå‚æ•°ä¼ ç»™å¦ä¸€ä¸ªæ–¹æ³•ï¼Œä¹‹åæ‰§è¡Œã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œæ–¹æ³•çš„è¡Œä¸ºå¯ä»¥ç”±ä¼ å…¥çš„ä»£ç å—æ§åˆ¶ã€‚ ä¾‹å­ä¸‹é¢é€šè¿‡å†œåœºåº”ç”¨æ¥çœ‹çœ‹é¢å¯¹ä¸æ–­æ”¹å˜çš„éœ€æ±‚å¦‚ä½•å°†ä»£ç å†™çš„æ›´çµæ´»ã€‚å…ˆå®ç°ç¬¬ä¸€ä¸ªåŠŸèƒ½:ä»ä¸€ä¸ªlistä¸­è¿‡æ»¤å‡ºæ‰€æœ‰çš„ç»¿è‰²è‹¹æœ,å¬èµ·æ¥æ˜¯ä¸æ˜¯å¾ˆç®€å•ã€‚ ç‰ˆæœ¬1 ï¼š è¿‡æ»¤å‡ºç»¿è‰²è‹¹æœæœ€å¼€å§‹æƒ³åˆ°çš„è§£å†³åŠæ³•å¯èƒ½é•¿ä¸‹é¢çš„æ ·å­ï¼š 12345678910public static List&lt;Apple&gt; filterGreenApples(List&lt;Apple&gt; inventory) &#123; List&lt;Apple&gt; result = new ArrayList&lt;&gt;(); // An accumulator list for apples for (Apple apple : inventory) &#123; if ( \"green\".equals(apple.getColor())) &#123; // Select only green apples result.add(apple); &#125; &#125; return result; &#125; ä¸Šé¢çš„æ–¹æ³•å¯ä»¥è¿‡æ»¤å‡ºç»¿è‰²çš„è‹¹æœï¼Œä½†æ˜¯å¦‚æœå†œåœºä¸»è¿˜æƒ³çŸ¥é“çº¢è‰²çš„è‹¹æœå‘¢ï¼Ÿä¸€ä¸ªå¾ˆå¹¼ç¨šçš„åšæ³•æ˜¯å°†ä¸Šé¢çš„æ–¹æ³•å¤åˆ¶ä¸€éï¼Œå‘½åä¸ºfilterRedApplesï¼Œæ›´æ”¹ä¸€ä¸‹ifè¯­å¥ã€‚ä½†å¦‚æœè¿˜æƒ³çŸ¥é“é»„è‰²çš„å‘¢ï¼Ÿä¸€ä¸ªå¥½çš„åšæ³•æ˜¯ï¼šè¯•ç€æŠ½è±¡ã€‚ ç‰ˆæœ¬2 ï¼š å°†é¢œè‰²ä½œä¸ºå‚æ•°å¯ä»¥åœ¨æ–¹æ³•ä¸­åŠ å…¥é¢œè‰²ä½œä¸ºå‚æ•°ï¼Œä½¿ä»£ç æ›´çµæ´»ã€‚ 123456789public static List&lt;Apple&gt; filterApplesByColor(List&lt;Apple&gt; inventory, String color) &#123; List&lt;Apple&gt; result = new ArrayList&lt;&gt;(); for (Apple apple: inventory) &#123; if (apple.getColor().equals(color)) &#123; result.add(apple); &#125; &#125; return result;&#125; è¿™æ ·å°±å¯ä»¥çµæ´»çš„æ ¹æ®é¢œè‰²æ¥ç­›é€‰ã€‚è¿™æ—¶å†œåœºä¸»åˆæå‡ºäº†æ ¹æ®é‡é‡ç­›é€‰ï¼Œäºæ˜¯å‚ç…§ä¸Šé¢æ ¹æ®é¢œè‰²ç­›é€‰çš„æ–¹æ³•åˆæ–°å¢äº†ä¸€ä¸ªæ ¹æ®é‡é‡ç­›é€‰çš„æ–¹æ³•ï¼Œå¦‚ä¸‹ï¼š 123456789public static List&lt;Apple&gt; filterApplesByWeight(List&lt;Apple&gt; inventory, int weight) &#123; List&lt;Apple&gt; result = new ArrayList&lt;&gt;(); for (Apple apple: inventory) &#123; if (apple.getWeight()&gt;weight) &#123; result.add(apple); &#125; &#125; return result;&#125; è¿™æ˜¯ä¸€ä¸ªè§£å†³åŠæ³•ï¼Œä½†è€ƒè™‘åˆ°è‹¹æœæœ‰è®¸å¤šå…¶å®ƒç‰¹æ€§ï¼Œå¦‚æœé’ˆå¯¹æ¯ä¸€ç‰¹æ€§çš„ç­›é€‰éƒ½å¤åˆ¶ä¸€ä¸ªæ–¹æ³•ï¼Œè¿èƒŒäº†DRY(donâ€™t repeat yourself)åŸåˆ™.æˆ‘ä»¬å¯ä»¥å°†é¢œè‰²å’Œé‡é‡ç»“åˆåˆ°ä¸€ä¸ªæ–¹æ³•ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªæ ‡è®°æ¥æŒ‡æ˜æƒ³è¦è¿›è¡Œè¿‡æ»¤çš„æ˜¯é¢œè‰²è¿˜æ˜¯é‡é‡(è¿™æ ·åšå…¶å®å¾ˆä¸å¥½ï¼Œä¹‹åä¼šè§£é‡Š)ã€‚ ç‰ˆæœ¬3 ï¼š åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­è¿‡æ»¤æƒ³è¦è¿‡æ»¤çš„å±æ€§ä¸‹é¢åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­æ ¹æ®flagå€¼çš„ä¸åŒè¿‡æ»¤ä¸åŒçš„å±æ€§(è¿™æ ·åšæ³•å¾ˆä¸å¥½)ã€‚ 12345678910public static List&lt;Apple&gt; filterApples(List&lt;Apple&gt; inventory,String color, int weight, boolean flag) &#123; List&lt;Apple&gt; result = new ArrayList&lt;&gt;(); for (Apple apple : inventory) &#123; if ((flag&amp;&amp;apple.getColor().equals(color)) || (!flag &amp;&amp; apple.getWeight() &gt; weight)) &#123; result.add(apple); &#125; &#125; return result; &#125; ä¸Šé¢çš„ä»£ç å¾ˆä¸‘é™‹è€Œä¸”ä¹Ÿæ²¡æœ‰è§£å†³éœ€æ±‚å˜åŒ–çš„é—®é¢˜ï¼Œæ¯”å¦‚å¦‚æœå†œåœºä¸»è¿˜æƒ³è¦æ ¹æ®å¤§å°ï¼Œäº§åœ°ï¼Œå½¢çŠ¶æ¥ç­›é€‰å°±ä¸é€‚ç”¨äº†ã€‚ ç‰ˆæœ¬4 ï¼š æ ¹æ®æŠ½è±¡çº¦æŸè¿‡æ»¤ä¸€ä¸ªæ›´å¥½çš„è§£å†³åŠæ³•æ˜¯å°†è¿‡æ»¤çš„æ ‡å‡†æŠ½è±¡å‡ºæ¥ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰ä¸€ä¸ªæ¥å£ä½œä¸ºæŠ½è±¡çš„é€‰æ‹©æ ‡å‡†.123public interface ApplePredicate &#123; boolean test(Apple apple);&#125; æ¥ä¸‹æ¥å°±å¯ä»¥å®šä¹‰å¤šä¸ªApplePredicateæ¥å£çš„å®ç°ç±»æ¥ä»£è¡¨ä¸åŒçš„è¿‡æ»¤æ ‡å‡†ã€‚å¦‚ä¸‹å›¾: 12345678910111213//select only heavy applepublic class AppleHeavyWeightPredicate implements ApplePredicate &#123; public boolean test(Apple apple) &#123; return apple.getWeight() &gt; 150; &#125;&#125;//select only green applepublic class AppleGreenColorPredicate implements ApplePredicate &#123; public boolean test(Apple apple) &#123; return \"green\".equals(apple.getColor); &#125;&#125; ä¸Šé¢æ¯ä¸€ä¸ªå®ç°äº†ApplePredicateæ¥å£çš„ç±»éƒ½ä»£è¡¨äº†ä¸€ç§ç­›é€‰ç­–ç•¥ã€‚åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥å°†ç­›é€‰æ–¹æ³•ä¿®æ”¹æˆä¸‹é¢çš„æ ·å­,å°†ApplePredicateä½œä¸ºå‚æ•°ä¼ å…¥ã€‚ 123456789public static List&lt;Apple&gt; filterApples(List&lt;Apple&gt; inventory, ApplePredicate p) &#123; List&lt;Apple&gt; result = new ArrayList&lt;&gt;(); for (Apple apple : inventory) &#123; if (p.test(apple)) &#123; result.add(apple); &#125; &#125; return result;&#125; ç°åœ¨çš„ç­›é€‰æ–¹æ³•æ¯”ç¬¬ä¸€ä¸ªç‰ˆæœ¬çµæ´»å¤šäº†ï¼Œå¦‚æœæƒ³æ”¹å˜ç­›é€‰æ ‡å‡†ï¼Œåªéœ€åˆ›å»ºä¸åŒçš„ApplePredicateå¯¹è±¡ï¼Œå¹¶ä¼ å…¥filterApplesæ–¹æ³•å³å¯ã€‚ä¾‹å¦‚æ–°å¢äº†é€‰å‡ºçº¢è‰²å¹¶ä¸”é‡é‡å¤§äº150gçš„è‹¹æœçš„éœ€æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå®ç°ApplePredicateæ¥å£çš„ç±»å³å¯ï¼Œä»£ç å¦‚ä¸‹:1234567public class AppleRedAndHeavyPredicate implements ApplePredicate &#123; public boolean test(Apple apple) &#123; return \"red\".equals(apple.getColor()) &amp;&amp; apple.getWeight() &gt; 150; &#125;&#125;List&lt;Apple&gt; redAndHeavyApples = filter(inventory, new AppleRedAndHeavyPredicate()); ä½†æ˜¯ä¸Šé¢çš„å®ç°æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œå°±æ˜¯å¤ªå•°å—¦äº†ï¼Œæ¯æ–°å¢ä¸€ä¸ªç­›é€‰æ ‡å‡†éƒ½è¦æ–°å¢ä¸€ä¸ªç±»ã€‚ä¸‹é¢æ¥ç»§ç»­ä¼˜åŒ–ä¸€ä¸‹ã€‚ ç‰ˆæœ¬5 ï¼š ä½¿ç”¨åŒ¿åç±»åŒ¿åç±»æ˜¯æ²¡æœ‰åå­—çš„ç±»ï¼Œä½¿ç”¨åŒ¿åç±»å¯ä»¥åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„å®ç°ã€‚ä¸‹é¢çš„ä»£ç å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨åŒ¿åç±»åˆ›å»ºå®ç°äº†ApplePredicateçš„å¯¹è±¡ã€‚12345List&lt;Apple&gt; redApples = filterApples(inventory, new ApplePredicate(ï¼‰ &#123; public boolean test(Apple apple) &#123; return \"red\".equals(apple.getColor()); &#125;&#125;); ä½†æ˜¯å°½ç®¡åŒ¿åç±»è§£å†³äº†ä¸ºä¸€ä¸ªæ¥å£å£°æ˜å¤šä¸ªå®ç°ç±»çš„é—®é¢˜ï¼Œä½¿ç”¨åŒ¿åç±»è¿˜ä¸è¶³å¤Ÿå¥½ã€‚ä½¿ç”¨åŒ¿åç±»ä»£ç çœ‹èµ·æ¥æœ‰äº›ç¬¨é‡ï¼Œå¯è¯»æ€§å·®ï¼Œè€Œä¸”æœ‰ä¸€äº›å¼€å‘è€…å¯¹åŒ¿åç±»æ„Ÿåˆ°å›°æƒ‘ã€‚ä¸‹é¢æˆ‘ä»¬ä½¿ç”¨Java 8å¼•å…¥çš„lambdaè¡¨è¾¾å¼ä½¿ä»£ç çœ‹èµ·æ¥æ›´åŠ ç®€æ´ä¸€ç‚¹ã€‚ ç‰ˆæœ¬6 ï¼š ä½¿ç”¨lambdaè¡¨è¾¾å¼æˆ‘ä»¬å¯ä»¥ä½¿ç”¨lambdaè¡¨è¾¾å¼ç®€åŒ–ä»£ç . 1List&lt;Apple&gt; result = filterApples(inventory, (Apple apple) -&gt; \"red\".equals(apple.getColor())); æœ€ç»ˆç‰ˆ ï¼š ä½¿ç”¨æ³›å‹ï¼ŒæŠ½è±¡åˆ—è¡¨çš„ç±»å‹æˆ‘ä»¬å¯ä»¥ç»§ç»­åšä¸€äº›æŠ½è±¡ã€‚ç›®å‰ï¼ŒfilterApplesæ–¹æ³•åªå¯ä»¥è¿‡æ»¤å…ƒç´ ç±»å‹ä¸ºAppleçš„Listã€‚æˆ‘ä»¬å¯ä»¥å°†åˆ—è¡¨çš„ç±»å‹æŠ½è±¡å‡ºæ¥ï¼Œä½¿å¾—æˆ‘ä»¬çš„è¿‡æ»¤æ–¹æ³•å˜å¾—æ›´åŠ é€šç”¨ï¼Œä»£ç å¦‚ä¸‹ï¼š12345678910111213public interface Predicate&lt;T&gt; &#123; boolean test(T t);&#125;public static &lt;T&gt; List&lt;T&gt; filter(List&lt;T&gt; list, Predicate&lt;T&gt; p) &#123; List&lt;T&gt; result = new ArrayList&lt;&gt;(); for (T e: list) &#123; if (p.test(e)) &#123; result.add(e); &#125; &#125; return result;&#125; ç»è¯„è®ºåŒºæé†’ï¼Œåœ¨åŠ ä¸ªstreamç‰ˆæœ¬çš„(æœç„¶æ¸…çˆ½ä¸å°‘â†–(^Ï‰^)â†—)ï¼š 123456public static &lt;T&gt; List&lt;T&gt; filterWithStream(List&lt;T&gt; list, Predicate&lt;T&gt; p) &#123; List&lt;T&gt; result; result = list.stream().filter( t -&gt; p.test(t)).collect(Collectors.toList()); return result;&#125; è¿™æ ·å°±å¯ä»¥å¯¹å¤šç§ç±»å‹çš„listè¿›è¡Œè¿‡æ»¤äº†ï¼š 123List&lt;Apple&gt; redApples = filter(inventory, (Apple apple) -&gt; \"red\".equals(apple.getColor()));List&lt;Integer&gt; evenNumber = filter(numbers, (Integer i) -&gt; i%2 == 0); ç»ˆäºoveräº†ï¼Œæ‹–å»¶ç™ŒæœçœŸå·²ç»åˆ°äº†æ™šæœŸã€‚ã€‚ã€‚ã€‚ã€‚","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"}]},{"title":"[è¯‘]Java 8ä¸­HashMapå’ŒLinkedHashMapå¦‚ä½•è§£å†³å†²çª","slug":"è¯‘-Javaä¸­HashMapå’ŒLinkedHashMapå¦‚ä½•è§£å†³å†²çª","date":"2016-02-03T08:23:39.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/02/03/è¯‘-Javaä¸­HashMapå’ŒLinkedHashMapå¦‚ä½•è§£å†³å†²çª/","link":"","permalink":"http://yemengying.com/2016/02/03/è¯‘-Javaä¸­HashMapå’ŒLinkedHashMapå¦‚ä½•è§£å†³å†²çª/","excerpt":"åŸæ–‡æ¥è‡ªä¸€ä¸ªjavaå¤§ç‰›çš„åšå®¢ åŸæ–‡åœ°å€http://javarevisited.blogspot.jp/2016/01/how-does-java-hashmap-or-linkedhahsmap-handles.html åšå®¢è®²è§£äº†Java 8ä¸­HashMapå’ŒLinkedHashMapæ˜¯å¦‚ä½•è§£å†³å†²çªçš„ã€‚","keywords":null,"text":"åŸæ–‡æ¥è‡ªä¸€ä¸ªjavaå¤§ç‰›çš„åšå®¢ åŸæ–‡åœ°å€http://javarevisited.blogspot.jp/2016/01/how-does-java-hashmap-or-linkedhahsmap-handles.html åšå®¢è®²è§£äº†Java 8ä¸­HashMapå’ŒLinkedHashMapæ˜¯å¦‚ä½•è§£å†³å†²çªçš„ã€‚ åœ¨Java 8 ä¹‹å‰ï¼ŒHashMapå’Œå…¶ä»–åŸºäºmapçš„ç±»éƒ½æ˜¯é€šè¿‡é“¾åœ°å€æ³•è§£å†³å†²çªï¼Œå®ƒä»¬ä½¿ç”¨å•å‘é“¾è¡¨æ¥å­˜å‚¨ç›¸åŒç´¢å¼•å€¼çš„å…ƒç´ ã€‚åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œè¿™ç§æ–¹å¼ä¼šå°†HashMapçš„getæ–¹æ³•çš„æ€§èƒ½ä»O(1)é™ä½åˆ°O(n)ã€‚ä¸ºäº†è§£å†³åœ¨é¢‘ç¹å†²çªæ—¶hashmapæ€§èƒ½é™ä½çš„é—®é¢˜ï¼ŒJava 8ä¸­ä½¿ç”¨å¹³è¡¡æ ‘æ¥æ›¿ä»£é“¾è¡¨å­˜å‚¨å†²çªçš„å…ƒç´ ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å°†æœ€åæƒ…å†µä¸‹çš„æ€§èƒ½ä»O(n)æé«˜åˆ°O(logn)ã€‚åœ¨Java 8ä¸­ä½¿ç”¨å¸¸é‡TREEIFY_THRESHOLDæ¥æ§åˆ¶æ˜¯å¦åˆ‡æ¢åˆ°å¹³è¡¡æ ‘æ¥å­˜å‚¨ã€‚ç›®å‰ï¼Œè¿™ä¸ªå¸¸é‡å€¼æ˜¯8ï¼Œè¿™æ„å‘³ç€å½“æœ‰è¶…è¿‡8ä¸ªå…ƒç´ çš„ç´¢å¼•ä¸€æ ·æ—¶ï¼ŒHashMapä¼šä½¿ç”¨æ ‘æ¥å­˜å‚¨å®ƒä»¬ã€‚è¿™ä¸€æ”¹å˜æ˜¯ä¸ºäº†ç»§ç»­ä¼˜åŒ–å¸¸ç”¨ç±»ã€‚å¤§å®¶å¯èƒ½è¿˜è®°å¾—åœ¨Java 7ä¸­ä¸ºäº†ä¼˜åŒ–å¸¸ç”¨ç±»å¯¹ArrayListå’ŒHashMapé‡‡ç”¨äº†å»¶è¿ŸåŠ è½½çš„æœºåˆ¶ï¼Œåœ¨æœ‰å…ƒç´ åŠ å…¥ä¹‹å‰ä¸ä¼šåˆ†é…å†…å­˜ï¼Œè¿™ä¼šå‡å°‘ç©ºçš„é“¾è¡¨å’ŒHashMapå ç”¨çš„å†…å­˜ã€‚è¿™ä¸€åŠ¨æ€çš„ç‰¹æ€§ä½¿å¾—HashMapä¸€å¼€å§‹ä½¿ç”¨é“¾è¡¨ï¼Œå¹¶åœ¨å†²çªçš„å…ƒç´ æ•°é‡è¶…è¿‡æŒ‡å®šå€¼æ—¶ç”¨å¹³è¡¡äºŒå‰æ ‘æ›¿æ¢é“¾è¡¨ã€‚ä¸è¿‡è¿™ä¸€ç‰¹æ€§åœ¨æ‰€æœ‰åŸºäºhash tableçš„ç±»ä¸­å¹¶æ²¡æœ‰ï¼Œä¾‹å¦‚Hashtableå’ŒWeakHashMapã€‚ç›®å‰ï¼Œåªæœ‰ConcurrentHashMap,LinkedHashMapå’ŒHashMapä¼šåœ¨é¢‘ç¹å†²çªçš„æƒ…å†µä¸‹ä½¿ç”¨å¹³è¡¡æ ‘ã€‚ ä»€ä¹ˆæ—¶å€™ä¼šäº§ç”Ÿå†²çªHashMapä¸­è°ƒç”¨hashCode()æ–¹æ³•æ¥è®¡ç®—hashCodeã€‚ç”±äºåœ¨Javaä¸­ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡å¯èƒ½æœ‰ä¸€æ ·çš„hashCode,æ‰€ä»¥ä¸åŒçš„é”®å¯èƒ½æœ‰ä¸€æ ·hashCodeï¼Œä»è€Œå¯¼è‡´å†²çªçš„äº§ç”Ÿã€‚ æ€»ç»“ HashMapåœ¨å¤„ç†å†²çªæ—¶ä½¿ç”¨é“¾è¡¨å­˜å‚¨ç›¸åŒç´¢å¼•çš„å…ƒç´ ã€‚ ä»Java 8å¼€å§‹ï¼ŒHashMapï¼ŒConcurrentHashMapå’ŒLinkedHashMapåœ¨å¤„ç†é¢‘ç¹å†²çªæ—¶å°†ä½¿ç”¨å¹³è¡¡æ ‘æ¥ä»£æ›¿é“¾è¡¨ï¼Œå½“åŒä¸€hashæ¡¶ä¸­çš„å…ƒç´ æ•°é‡è¶…è¿‡ç‰¹å®šçš„å€¼ä¾¿ä¼šç”±é“¾è¡¨åˆ‡æ¢åˆ°å¹³è¡¡æ ‘ï¼Œè¿™ä¼šå°†get()æ–¹æ³•çš„æ€§èƒ½ä»O(n)æé«˜åˆ°O(logn)ã€‚ å½“ä»é“¾è¡¨åˆ‡æ¢åˆ°å¹³è¡¡æ ‘æ—¶ï¼ŒHashMapè¿­ä»£çš„é¡ºåºå°†ä¼šæ”¹å˜ã€‚ä¸è¿‡è¿™å¹¶ä¸ä¼šé€ æˆä»€ä¹ˆé—®é¢˜ï¼Œå› ä¸ºHashMapå¹¶æ²¡æœ‰å¯¹è¿­ä»£çš„é¡ºåºæä¾›ä»»ä½•ä¿è¯ã€‚ ä»Java 1ä¸­å°±å­˜åœ¨çš„Hashtableç±»ä¸ºäº†ä¿è¯è¿­ä»£é¡ºåºä¸å˜ï¼Œå³ä¾¿åœ¨é¢‘ç¹å†²çªçš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä½¿ç”¨å¹³è¡¡æ ‘ã€‚è¿™ä¸€å†³å®šæ˜¯ä¸ºäº†ä¸ç ´åæŸäº›è¾ƒè€çš„éœ€è¦ä¾èµ–äºHashtableè¿­ä»£é¡ºåºçš„Javaåº”ç”¨ã€‚ é™¤äº†Hashtableä¹‹å¤–ï¼ŒWeakHashMapå’ŒIdentityHashMapä¹Ÿä¸ä¼šåœ¨é¢‘ç¹å†²çªçš„æƒ…å†µä¸‹ä½¿ç”¨å¹³è¡¡æ ‘ã€‚ ä½¿ç”¨HashMapä¹‹æ‰€ä»¥ä¼šäº§ç”Ÿå†²çªæ˜¯å› ä¸ºä½¿ç”¨äº†é”®å¯¹è±¡çš„hashCode()æ–¹æ³•ï¼Œè€Œequals()å’ŒhashCode()æ–¹æ³•ä¸ä¿è¯ä¸åŒå¯¹è±¡çš„hashCodeæ˜¯ä¸åŒçš„ã€‚éœ€è¦è®°ä½çš„æ˜¯ï¼Œç›¸åŒå¯¹è±¡çš„hashCodeä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œä½†ç›¸åŒçš„hashCodeä¸ä¸€å®šæ˜¯ç›¸åŒçš„å¯¹è±¡ã€‚ åœ¨HashTableå’ŒHashMapä¸­ï¼Œå†²çªçš„äº§ç”Ÿæ˜¯ç”±äºä¸åŒå¯¹è±¡çš„hashCode()æ–¹æ³•è¿”å›äº†ä¸€æ ·çš„å€¼ã€‚ ä»¥ä¸Šå°±æ˜¯Javaä¸­HashMapå¦‚ä½•å¤„ç†å†²çªã€‚è¿™ç§æ–¹æ³•è¢«ç§°ä¸ºé“¾åœ°å€æ³•ï¼Œå› ä¸ºä½¿ç”¨é“¾è¡¨å­˜å‚¨åŒä¸€æ¡¶å†…çš„å…ƒç´ ã€‚é€šå¸¸æƒ…å†µHashMapï¼ŒHashSetï¼ŒLinkedHashSetï¼ŒLinkedHashMapï¼ŒConcurrentHashMapï¼ŒHashTableï¼ŒIdentityHashMapå’ŒWeakHashMapå‡é‡‡ç”¨è¿™ç§æ–¹æ³•å¤„ç†å†²çªã€‚ ä»JDK 8å¼€å§‹ï¼ŒHashMapï¼ŒLinkedHashMapå’ŒConcurrentHashMapä¸ºäº†æå‡æ€§èƒ½ï¼Œåœ¨é¢‘ç¹å†²çªçš„æ—¶å€™ä½¿ç”¨å¹³è¡¡æ ‘æ¥æ›¿ä»£é“¾è¡¨ã€‚å› ä¸ºHashSetå†…éƒ¨ä½¿ç”¨äº†HashMapï¼ŒLinkedHashSetå†…éƒ¨ä½¿ç”¨äº†LinkedHashMapï¼Œæ‰€ä»¥ä»–ä»¬çš„æ€§èƒ½ä¹Ÿä¼šå¾—åˆ°æå‡ã€‚ ç›¸å…³é˜…è¯»Data Structure and Algorithm in JavaJava Performance The Definitive Guide","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"},{"name":"hashmap","slug":"java/hashmap","permalink":"http://yemengying.com/categories/java/hashmap/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"ç¿»è¯‘","slug":"ç¿»è¯‘","permalink":"http://yemengying.com/tags/ç¿»è¯‘/"}]},{"title":"æœ€è¿‘çœ‹çš„ä¹¦","slug":"æœ€è¿‘çœ‹çš„ä¹¦","date":"2016-01-19T06:34:13.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/01/19/æœ€è¿‘çœ‹çš„ä¹¦/","link":"","permalink":"http://yemengying.com/2016/01/19/æœ€è¿‘çœ‹çš„ä¹¦/","excerpt":"è‡ªä»å»å¹´8æœˆä»½ä¹‹åçœŸæ˜¯å˜æˆäº†ä¸ªçˆ±çœ‹ä¹¦ã®girlï¼Œç®—æ˜¯*%^&amp;#$å¸¦æ¥çš„å”¯ä¸€å¥½å¤„å§ï¼Œæ˜¯æ—¶å€™æ•´ç†ä¸€å‘å•¦ã€‚ä¸è¿‡ï¼Œè¦æŒ‰ä»€ä¹ˆåˆ†ç±»å‘¢ï¼ŒæŠ€æœ¯å’ŒéæŠ€æœ¯ï¼Œçœ‹å®Œå’Œæ²¡çœ‹å®Œï¼Œå¥½çœ‹å’Œä¸å¥½çœ‹è¿˜æ˜¯å¤–æ–‡å’Œä¸­æ–‡ï¼Ÿå¥½ä¹±ã€‚ã€‚ã€‚ã€‚ ç®—äº† è¿˜æ˜¯ä¸åˆ†äº†éšä¾¿åˆ—å§ã€‚ã€‚ã€‚ã€‚","keywords":null,"text":"è‡ªä»å»å¹´8æœˆä»½ä¹‹åçœŸæ˜¯å˜æˆäº†ä¸ªçˆ±çœ‹ä¹¦ã®girlï¼Œç®—æ˜¯*%^&amp;#$å¸¦æ¥çš„å”¯ä¸€å¥½å¤„å§ï¼Œæ˜¯æ—¶å€™æ•´ç†ä¸€å‘å•¦ã€‚ä¸è¿‡ï¼Œè¦æŒ‰ä»€ä¹ˆåˆ†ç±»å‘¢ï¼ŒæŠ€æœ¯å’ŒéæŠ€æœ¯ï¼Œçœ‹å®Œå’Œæ²¡çœ‹å®Œï¼Œå¥½çœ‹å’Œä¸å¥½çœ‹è¿˜æ˜¯å¤–æ–‡å’Œä¸­æ–‡ï¼Ÿå¥½ä¹±ã€‚ã€‚ã€‚ã€‚ ç®—äº† è¿˜æ˜¯ä¸åˆ†äº†éšä¾¿åˆ—å§ã€‚ã€‚ã€‚ã€‚ Flipped(æ€¦ç„¶å¿ƒåŠ¨)ä¸€æœ¬è®²ä¸¤ä¸ªå°å­¦ç”Ÿåˆæ‹çš„è‹±æ–‡å°è¯´ï¼Œé€‚åˆæ”¾æ¾çš„æ—¶å€™çœ‹çœ‹ã€‚è™½ç„¶å·²ç»çœ‹è¿‡äº†ç”µå½±ï¼Œå†çœ‹å°è¯´è¿˜æ˜¯è§‰å¾—å¾ˆç¾å¥½ï¼ŒæˆåŠŸå”¤é†’äº†æˆ‘é‚£é¢—æ²‰ç¡å·²ä¹…çš„å°‘å¥³å¿ƒã€‚å¥³ä¸»æ€§æ ¼è¶…çº§å¯çˆ±ï¼Œç”·ä¸»è™½ç„¶ä¸€å¼€å§‹æŒºçƒ¦äººçš„ï¼Œä¸è¿‡åæœŸçš„è½¬å˜è¿˜æ˜¯ä¸é”™çš„ï¼Œæ’©å¦¹æŠ€èƒ½æ»¡åˆ†ï¼Œè¿˜æœ‰å¥³çš„çˆ¸çˆ¸å’Œç”·ä¸»çš„çˆ·çˆ·ä¹Ÿéƒ½æ˜¯å¾ˆæœ‰å“²ç†çš„äººã€‚é‡Œé¢çš„å¥å­éƒ½æŒºç®€å•çš„ï¼Œç”¨æ¥å­¦è‹±è¯­ä¹Ÿä¸é”™ã€‚ æ·˜å®æŠ€æœ¯è¿™åå¹´å¾ˆå¤šåœ°æ–¹éƒ½æœ‰æ¨èè¿™æœ¬ä¹¦ï¼Œå°±ä¹°äº†ï¼Œä¸è¿‡çœ‹å®Œå€’ä¹Ÿæ²¡è§‰å¾—å¤šå¥½çœ‹ï¼Œé‡Œé¢å…³äºæŠ€æœ¯çš„åœ°æ–¹è®²çš„å¾ˆæµ…ï¼Œæ‰€ä»¥æŒ‡æœ›ç€å­¦åˆ°ä»€ä¹ˆæŠ€æœ¯è¿˜æ˜¯åˆ«çœ‹äº†,å½“æ•…äº‹ä¹¦çœ‹è¿˜æ˜¯ä¸é”™çš„ã€‚ç°åœ¨ä¹¦çš„å†…å®¹å·²ç»è®°ä¸å¤ªæ¸…äº†ï¼Œå°±è®°å¾—ä¸¤å¥è¯ï¼Œå¥½çš„æ¶æ„éƒ½æ˜¯ä¸€æ­¥æ­¥æ¼”åŒ–æ¥çš„å’Œå†ç‰›Bçš„äººä¹Ÿéƒ½æœ‰ä¸€æ®µè‹¦Bçš„ç»å†ã€‚ æ¸…é†’æ€è€ƒçš„è‰ºæœ¯å·¦è€³æœµè€—å­æ¥åšæŠ€æœ¯åˆ†äº«æ—¶æ¨èçš„ï¼Œé‡Œé¢æ˜¯ä¸€ä¸ªä¸ªçš„å°æ•…äº‹ï¼Œé€šè¿‡è®²æ•…äº‹çš„æ–¹å¼æ¥å‘Šè¯‰è¯»è€…æ€è€ƒæ—¶å®¹æ˜“çŠ¯çš„é”™ã€‚è¯»èµ·æ¥æŒºè½»æ¾çš„ï¼Œå¯ä»¥ç¡å‰çœ‹ä¸€ä¸ªå°æ•…äº‹ã€‚ä¸è¿‡å§ã€‚ã€‚ã€‚ã€‚é“ç†éƒ½æ‡‚ï¼Œæƒ³åšåˆ°æ¸…é†’æ€è€ƒè¿˜æ˜¯æŒºéš¾çš„ã€‚ ç¿çƒ‚åƒé˜³(A THOUSAND SPLENDID SUNS)æ˜¯ã€Šè¿½é£ç­çš„äººã€‹ä½œè€…çš„å¦ä¸€æœ¬å°è¯´ï¼Œæ²¡çœ‹è¿‡è¿½é£ç­çš„äººï¼Œä¸è¿‡åæ°”å¥½åƒæŒºå¤§çš„ã€‚ç¿çƒ‚åƒé˜³ä¸»è¦è®²äº†ä¸¤ä¸ªé˜¿å¯Œæ±—å°‘å¥³æ‚²æƒ¨çš„ä¸€ç”Ÿï¼Œè™½ç„¶è±æ‹‰ç»“å±€è¿˜ç®—ä¸é”™ï¼Œä¸è¿‡æ•´ä½“çœ‹è¿˜æ˜¯æŒºæƒ¨çš„ï¼Œéƒ½æ˜¯æˆ˜äº‰å®³çš„ã€‚è§‰å¾—æ•´æœ¬ä¹¦æœ€æ„Ÿäººçš„åœ°æ–¹ä¸æ˜¯è±æ‹‰å’Œç›åˆ©äºšå§†äº’ç›¸å¸®åŠ©å’Œè±æ‹‰å’Œå¡”é‡Œå…‹çš„çˆ±æƒ…ï¼Œè€Œæ˜¯ä¹¦çš„ç»“å°¾è±æ‹‰å‘ç°äº†ç›åˆ©äºšå§†çˆ¶äº²ç•™ç»™å¥¹çš„ä¸œè¥¿ï¼Œæˆ³ä¸­æ³ªç‚¹å•Šã€‚ã€‚ã€‚ã€‚ã€‚çœ‹å®Œäº†ä¹‹åè§‰å¾—ç°åœ¨ç”Ÿæ´»çœŸå¿ƒå¾ˆå¹¸ç¦çš„å•Šã€‚ æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºè¿™æœ¬ã€‚ã€‚ã€‚ã€‚å¤§æ¦‚çœ‹äº†ä¸¤ä¸‰ç« ï¼Œå®åœ¨çœ‹ä¸ä¸‹å»ã€‚ã€‚ã€‚ä¸æ˜¯ä¹¦å†™çš„ä¸å¥½ï¼Œæ˜¯æˆ‘æŠ€æœ¯æ¸£çœ‹ä¸å¤ªæ‡‚ã€‚ã€‚ã€‚è¿˜æ˜¯å…ˆæ”¾æ”¾å§ ä»0åˆ°1 åˆ©ç”¨å‘¨æœ«çœ‹å®Œäº†ï¼Œæ„Ÿè§‰ä½œè€…è¯´çš„éƒ½å¯¹ï¼Œä½†å¯¹ç°åœ¨çš„æˆ‘å¸®åŠ©ä¸å¤§ï¼Œå¯èƒ½ç»å†è¿˜ä¸å¤Ÿå§ã€‚ä¸è¿‡å–œæ¬¢åšå¼€å‘ä¹Ÿæ­£æ˜¯å› ä¸ºä»0åˆ°1çš„åˆ›é€ ä¸€ä¸ªäº§å“çš„è¿‡ç¨‹å¾ˆinterestingã€‚ Linux Bible 9th Editionè¶…å®ç”¨çš„æŠ€æœ¯ä¹¦ï¼Œä¸è¿‡ç”±äºæ˜¯è‹±æ–‡çš„è¿˜æ˜¯æŠ€æœ¯ä¹¦ï¼Œçœ‹çš„æ¯”è¾ƒæ…¢ï¼Œæ‰çœ‹åˆ°ç¬¬å…­ç« ï¼ŒåŸºæœ¬ä¸€ç« ä¸€ä¸ªä¸»é¢˜å·²ç»ä»ä½¿ç”¨shellçœ‹åˆ°ç®¡ç†è¿›ç¨‹äº†ã€‚çœŸæ˜¯æ¯ä¸€ç« éƒ½æœ‰å¾ˆå¤§æ”¶è·ï¼Œæ¯”å¦‚ä»¥å‰æŸ¥çœ‹è¿›ç¨‹å°±çŸ¥é“ç”¨ps auxï¼Œå¹¶ä¸çŸ¥é“æ¯ä¸ªå‘½ä»¤é€‰é¡¹çš„å…·ä½“æ„æ€ã€‚èµ°è¿‡è·¯è¿‡ä¸è¦é”™è¿‡ï¼Œlinuxå­¦çš„å¥½çš„ä¹Ÿå¯ä»¥çœ‹çœ‹ï¼ŒæŸ¥æ¼è¡¥ç¼ºå•Šã€‚äº‰å–ä»¥ä¸€å‘¨ä¸€ç« çš„é€Ÿåº¦æŠŠå®ƒçœ‹å®Œã€‚æœ‰è¦ç”µå­ä¹¦çš„å¯ä»¥ç•™é‚®ç®± å“ˆå“ˆã€‚ Spring in Action 4th editionè™½ç„¶ä¸€ç›´åœ¨ç”¨springï¼Œä½†æ˜¯è²Œä¼¼ä¸€ç›´æ²¡æœ‰ç³»ç»Ÿå®Œæ•´çš„çœ‹è¿‡ä¸€æœ¬å…³äºspringçš„ä¹¦ï¼Œæ­£å¥½ä»geekbookä¸Šçˆ¬ä¸‹äº†è¿™æœ¬å°±çœ‹çœ‹å§ï¼ŒæŸ¥æ¼è¡¥ç¼ºï¼Œä»¥å‰æ³¨å…¥beanï¼Œä¸€ç›´ç”¨xmlå’Œåˆ©ç”¨æ³¨è§£è‡ªåŠ¨æ³¨å…¥çš„æ–¹å¼ï¼Œå€Ÿè¿™ä¸ªæœºä¼šäº†è§£ä¸‹åˆ©ç”¨JavaConfigæ˜¯å¦‚ä½•å®ç°ä¾èµ–æ³¨å…¥çš„ã€‚ä»¤æˆ‘åƒæƒŠçš„æ˜¯ï¼Œä½œè€…ç¬¬äºŒæ¨èçš„å±…ç„¶æ˜¯JavaConfigï¼Œä¸€ç›´ä»¥ä¸ºXmlçš„æ–¹å¼åº”è¯¥æ’ç¬¬äºŒå‘¢ã€‚ã€‚ã€‚åˆšçœ‹åˆ°ç¬¬ä¸‰ç« ï¼Œæ…¢æ…¢çœ‹å§ã€‚ã€‚ã€‚æœ‰è¦ç”µå­ä¹¦çš„å¯ä»¥ç•™é‚®ç®±ã€‚ The Martian(ç«æ˜Ÿæ•‘æ´)çœ‹å®Œç”µå½±å†æ¥çœ‹ä¹¦ï¼Œè§‰å¾—ä¹¦æ¯”ç”µå½±å¥½ä¸€ç‚¹ï¼Œå½“ç„¶ç”µå½±ä¹Ÿä¸å·®ã€‚ç”·ä¸»å®åœ¨ä»¤äººæŠ˜æœï¼Œå°¤å…¶æ˜¯ä»–é‡åˆ°å›°éš¾åªæƒ³ç€æ€ä¹ˆè§£å†³å›°éš¾çš„ç²¾ç¥ã€‚å¦‚æœæŠŠæˆ‘ç•™åœ¨ç«æ˜Ÿä¸Šï¼Œä¼°è®¡å¾—æ­»å¥½å‡ ç™¾å›ã€‚ã€‚ã€‚ã€‚ å·å½±å­çš„äººä¸€æœ¬æ²»æ„ˆç³»çš„æ³•å›½å°è¯´ï¼Œå–œæ¬¢å°é¢çš„è®¾è®¡ï¼Œå†…å®¹æŒºå¹³æ·¡çš„ï¼Œæ„Ÿè§‰å‰åŠéƒ¨åˆ†æ¯”åé¢è¦å¥½çœ‹ã€‚","raw":null,"content":null,"categories":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/categories/éšç¬”/"}],"tags":[{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yemengying.com/tags/éšç¬”/"},{"name":"ä¹¦å•","slug":"ä¹¦å•","permalink":"http://yemengying.com/tags/ä¹¦å•/"}]},{"title":"æ‹¥æœ‰è‡ªå·±çš„å›¾ä¹¦å°é‡‘åº“","slug":"æ‹¥æœ‰è‡ªå·±çš„å›¾ä¹¦å°é‡‘åº“","date":"2016-01-09T06:15:46.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2016/01/09/æ‹¥æœ‰è‡ªå·±çš„å›¾ä¹¦å°é‡‘åº“/","link":"","permalink":"http://yemengying.com/2016/01/09/æ‹¥æœ‰è‡ªå·±çš„å›¾ä¹¦å°é‡‘åº“/","excerpt":"åœ¨æ‰¾matering elasticsearch second editionè¿™æœ¬ä¹¦çš„æ—¶å€™ï¼Œåœ¨è®¸å¤šå¯ä»¥å…è´¹ä¸‹ç”µå­ä¹¦çš„ç½‘ç«™éƒ½æ²¡æœ‰æ‰¾åˆ°ï¼Œæ‰€ä»¥å°±ä¹°äº†Geekbookä¸€ä¸ªæœˆçš„ä¼šå‘˜ï¼Œä¸ºäº†ä¸æµªè´¹å……ä¼šå‘˜çš„é’±ï¼Œå†³å®šæ’¸ä¸ªè„šæœ¬æŠŠå…¨ç«™çš„ä¹¦éƒ½ä¸‹ä¸‹æ¥,å¹¶ç”¨djangoæ­ä¸ªç®¡ç†åå°ã€‚å’Œæ´ªèŠï¼Œå¢ç¥åˆ©ç”¨ç©ºé—²æ—¶é—´å¿™æ´»äº†å¿«ä¸¤å‘¨ï¼Œç»ˆäºæœ‰äº†è‡ªå·±çš„å›¾ä¹¦å°é‡‘åº“ï¼Œ5000+çš„ä¼˜è´¨è‹±æ–‡åŸç‰ˆç”µå­ä¹¦ï¼Œå“‡å’”å’”å’”å’”ï¼Œè¿™è¾ˆå­çš„ä¹¦éƒ½æœ‰äº†ï¼Œæ”¾äº†ä¸€éƒ¨åˆ†åˆ°githubä¸Šã€‚geekbookåƒä¸‡ä¸è¦æ€ªæˆ‘ä»¬å•Šï¼Œè°è®©ä½ ä¸å°æˆ‘ä»¬çš„~~ã€‚é¡¹ç›®åœ°å€ï¼š loadStyle(\"/hexo-github/style.css\"); loadStyle(\"/hexo-github/octicons/octicons.css\"); new Badge(\"#badge-container-giraffe0813-GeekBook-3d83e8f\", \"giraffe0813\", \"GeekBook\", \"3d83e8f\", false); éƒ¨åˆ†ç”µå­ä¹¦åœ°å€: loadStyle(\"/hexo-github/style.css\"); loadStyle(\"/hexo-github/octicons/octicons.css\"); new Badge(\"#badge-container-Geek-Organization-geek-programming-books-643e0bd\", \"Geek-Organization\", \"geek-programming-books\", \"643e0bd\", false);","keywords":null,"text":"åœ¨æ‰¾matering elasticsearch second editionè¿™æœ¬ä¹¦çš„æ—¶å€™ï¼Œåœ¨è®¸å¤šå¯ä»¥å…è´¹ä¸‹ç”µå­ä¹¦çš„ç½‘ç«™éƒ½æ²¡æœ‰æ‰¾åˆ°ï¼Œæ‰€ä»¥å°±ä¹°äº†Geekbookä¸€ä¸ªæœˆçš„ä¼šå‘˜ï¼Œä¸ºäº†ä¸æµªè´¹å……ä¼šå‘˜çš„é’±ï¼Œå†³å®šæ’¸ä¸ªè„šæœ¬æŠŠå…¨ç«™çš„ä¹¦éƒ½ä¸‹ä¸‹æ¥,å¹¶ç”¨djangoæ­ä¸ªç®¡ç†åå°ã€‚å’Œæ´ªèŠï¼Œå¢ç¥åˆ©ç”¨ç©ºé—²æ—¶é—´å¿™æ´»äº†å¿«ä¸¤å‘¨ï¼Œç»ˆäºæœ‰äº†è‡ªå·±çš„å›¾ä¹¦å°é‡‘åº“ï¼Œ5000+çš„ä¼˜è´¨è‹±æ–‡åŸç‰ˆç”µå­ä¹¦ï¼Œå“‡å’”å’”å’”å’”ï¼Œè¿™è¾ˆå­çš„ä¹¦éƒ½æœ‰äº†ï¼Œæ”¾äº†ä¸€éƒ¨åˆ†åˆ°githubä¸Šã€‚geekbookåƒä¸‡ä¸è¦æ€ªæˆ‘ä»¬å•Šï¼Œè°è®©ä½ ä¸å°æˆ‘ä»¬çš„~~ã€‚é¡¹ç›®åœ°å€ï¼š loadStyle(\"/hexo-github/style.css\"); loadStyle(\"/hexo-github/octicons/octicons.css\"); new Badge(\"#badge-container-giraffe0813-GeekBook-3d83e8f\", \"giraffe0813\", \"GeekBook\", \"3d83e8f\", false); éƒ¨åˆ†ç”µå­ä¹¦åœ°å€: loadStyle(\"/hexo-github/style.css\"); loadStyle(\"/hexo-github/octicons/octicons.css\"); new Badge(\"#badge-container-Geek-Organization-geek-programming-books-643e0bd\", \"Geek-Organization\", \"geek-programming-books\", \"643e0bd\", false); é‡åˆ°çš„å‘è®°å½•ä¸‹é‡åˆ°çš„å‘ ä¸ç„¶å°±å¿˜äº†ğŸ˜‚ åªå¸¦cookie æ— æ³•ä¸‹è½½æœ¬æ¥ä»¥ä¸ºåªè¦å¸¦ç€ç™»å½•ä¹‹åçš„cookieè¯·æ±‚ä¸‹è½½çš„åœ°å€(eg:https://www.geekbooks.me/books/56/48/c1955c13518f994167b11f7b7279/amazon_ec2_cookbook.pdf) å°±å¯ä»¥ä¸‹è½½äº†ï¼Œä¸è¿‡å‘ç°ä¸‹ä¸‹æ¥çš„å¹¶ä¸æ˜¯ä¹¦ï¼Œè€Œæ˜¯ç½‘ç«™ä¸Šä¹¦çš„è¯¦æƒ…é¡µçš„htmlã€‚å—åˆ°åšå®¢CourseæŠ“ç«™å°ç»“ çš„å¯å‘ï¼Œåˆç ”ç©¶äº†ä¸€ä¸‹è¯·æ±‚çš„headerã€‚å‘ç°é™¤äº†è¦å¸¦cookieä¹‹å¤–ï¼Œè¿˜è¦å¸¦æœ‰user_agentå’ŒRefererï¼Œreferæ˜¯è¡¨ç¤ºä»å“ªä¸ªé¡µé¢è®¿é—®å½“å‰é“¾æ¥ã€‚æ‰€ä»¥ä¿®æ”¹äº†ä¸‹ä»£ç ï¼Œåœ¨è¯·æ±‚å¤´ä¸­åŠ å…¥user-agentå’Œrefererä¹‹åï¼Œé—®é¢˜å°±è§£å†³äº†,éƒ¨åˆ†ä»£ç å¦‚ä¸‹1234567cookie = cookielib.MozillaCookieJar()# get cookie from filecookie.load('../data/cookie4geek.data', ignore_discard=True, ignore_expires=True)handler = urllib2.HTTPCookieProcessor(cookie)opener = urllib2.build_opener(handler)# add headeropener.addheaders = [('User-agent', 'Mozilla/5.0'), (\"Referer\", url)] ä¸‹è½½æ–‡ä»¶çš„æ—¶å€™ä¸æ˜¾ç¤ºè¿›åº¦å¯ä»¥ä¸‹è½½æ–‡ä»¶ä¹‹åï¼Œå¸Œæœ›å¯ä»¥åœ¨ä¸‹è½½æ–‡ä»¶çš„æ—¶å€™æ˜¾ç¤ºä¸‹è½½è¿›åº¦ï¼Œè®©æˆ‘ä»¬çŸ¥é“ä»–åœ¨å·¥ä½œã€‚ã€‚ã€‚ã€‚ç›´æ¥åœ¨stackoverflowä¸ŠæŠ„äº†æ®µä»£ç ï¼Œè¿™ä¸ªé—®é¢˜ä¹Ÿæ„‰å¿«çš„è§£å†³äº†ã€‚12345678910111213141516171819202122u = opener.open(\"https://www.geekbooks.me\" + url)print \"Preparing to download...\"# f with directoryif os.path.exists(conf_books_dir + category + \"/\" + file_name) and detect_book( (conf_books_dir + category + \"/\" + file_name)): continuef = open(conf_books_dir + category + \"/\" + file_name, 'wb')meta = u.info()file_size = int(meta.getheaders(\"Content-Length\")[0])print \"Downloading: %s Bytes: %s\" % (file_name, file_size)file_size_dl = 0block_sz = 8192while True: buffer = u.read(block_sz) if not buffer: break file_size_dl += len(buffer) f.write(buffer) status = r\"%10d [%3.2f%%]\" % (file_size_dl, file_size_dl * 100. / file_size) status = status + chr(8) * (len(status) + 1) print status,f.close() ä¸€æœ¬ä¸€æœ¬ä¸‹è½½é€Ÿåº¦å¤ªæ…¢è¿™ä¸ªåªèƒ½æœæ–­ä¸Šå¤šçº¿ç¨‹äº†ã€‚ã€‚ã€‚123456789101112131415161718def download_work(): f = open(\"../data/detailurl.txt\", \"r\") books = [] destDir = \"\" tmp = \"\" for line in f: if not (line.strip()).startswith(\"/\"): tmp += \"/\" + line.strip() destDir = tmp else: # desDir book = Book(destDir, line.strip()) books.append(book) tmp = \"\" pool = threadpool.ThreadPool(conf_thread_count) reqs = threadpool.makeRequests(lambda book: book.download(), books) [pool.putRequest(req) for req in reqs] pool.wait() æ— æ³•å±•ç¤ºä¸‹è½½ä¹¦çš„å…·ä½“ä¿¡æ¯é™¤äº†å°†ä¹¦ä¸‹è½½ä¸‹æ¥ï¼Œè¿˜æƒ³å°†ä¹¦çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ä¿å­˜ä¸‹æ¥ï¼Œæ¯”å¦‚:ä½œè€…ï¼Œç®€æ´ï¼Œå‡ºç‰ˆå¹´ä»½ï¼Œå°é¢ï¼Œæ ‡ç­¾ç­‰ç­‰ã€‚ã€‚æœ€å¥½å¯ä»¥æ ¹æ®ä½œè€…ï¼Œé¢˜ç›®è¿›è¡Œæœç´¢ã€‚æœ¬æ¥æƒ³è‡ªå·±å†™ä¸ªç½‘ç«™å‡ºæ¥ï¼Œä½†æ˜¯åˆæ²¡æœ‰æ—¶é—´ã€‚è¿˜å¥½ä¹‹å‰å­¦å”æ¨èè¿‡djangoï¼Œç”¨djangoæ­ä¸ªç®¡ç†åå°ç®€ç›´ä¸è¦å¤ªæ–¹ä¾¿å¥½ä¹ˆï¼Œé…ç½®nginxï¼Œsupervisorçš„æ—¶é—´éƒ½æ¯”å†™ä»£ç çš„æ—¶é—´é•¿ğŸ‘…ï¼Œè¿˜å¯ä»¥å¾ˆæ–¹ä¾¿å®šä¹‰æƒ³æœç´¢çš„å­—æ®µå’Œæƒ³å±•ç¤ºçš„å­—æ®µã€‚æ ·å¼æ˜¯ä¸‘äº†ä¸€ä¸¢ä¸¢ï¼Œä½†è‡ªå·±ç”¨ä¹Ÿæ— æ‰€è°“ã€‚ æˆå“ Summaryä¾é ç©ºé—²æ—¶é—´å¯ä»¥åšç‚¹æƒ³åšçš„äº‹ï¼Œä¹Ÿæ˜¯è›®å¥½çš„~~ã€‚ç”¨pythonå†™è„šæœ¬çœŸçš„å¾ˆæ–¹ä¾¿ï¼ŒåŸºæœ¬ä¸ç”¨è‡ªå·±é€ è½®å­ï¼Œç”¨å®ƒè‡ªå¸¦çš„æ¨¡å—å°±å¯ä»¥å®Œæˆäº†ã€‚ç”¨djangoæ­ç®¡ç†åå°ä¹Ÿæ˜¯å¿«çš„ä¸è¦ä¸è¦çš„ã€‚ä¸€å‘¨å¤šçš„æ—¶é—´æ¢4000+çš„ä¹¦å¾ˆå€¼å•Šï¼Œä½†æ˜¯ã€‚ã€‚ã€‚ã€‚æœåŠ¡å™¨+å­˜å‚¨å¹³å‡ä¸€å¤©çš„æˆæœ¬å°±è¦10å—ã€‚ã€‚ã€‚æ˜¯ä¸æ˜¯å¾—æƒ³ä¸ªæ³•å­ï¼Œçœ‹èƒ½ä¸èƒ½ç”¨è¿™äº›ç”µå­ä¹¦æŒ£ç‚¹é’±å•Šã€‚ã€‚ã€‚ã€‚æƒ³åˆ°è¿™ã€‚ã€‚ã€‚çªç„¶æ²¡é‚£ä¹ˆå¼€å¿ƒäº†ã€‚ã€‚ã€‚","raw":null,"content":null,"categories":[{"name":"python","slug":"python","permalink":"http://yemengying.com/categories/python/"}],"tags":[{"name":"python","slug":"python","permalink":"http://yemengying.com/tags/python/"},{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"http://yemengying.com/tags/çˆ¬è™«/"},{"name":"django","slug":"django","permalink":"http://yemengying.com/tags/django/"}]},{"title":"è¯»ä¹¦ç¬”è®°-Linux Bible 9th Editionä¹‹è¿›ç¨‹å¤§æ³•å¥½","slug":"è¯»ä¹¦ç¬”è®°-Linux-Bible-9th-Editionä¹‹è¿›ç¨‹å¤§æ³•å¥½","date":"2015-12-24T09:56:03.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/12/24/è¯»ä¹¦ç¬”è®°-Linux-Bible-9th-Editionä¹‹è¿›ç¨‹å¤§æ³•å¥½/","link":"","permalink":"http://yemengying.com/2015/12/24/è¯»ä¹¦ç¬”è®°-Linux-Bible-9th-Editionä¹‹è¿›ç¨‹å¤§æ³•å¥½/","excerpt":"æ ¹æ®Linux Bibleç¬¬ä¹ç‰ˆç¬¬å…­ç« æ•´ç†çš„è¯»ä¹¦ç¬”è®°ï¼Œè®°å½•linuxç³»ç»Ÿä¸‹å¦‚ä½•ç®¡ç†è¿›ç¨‹ Linuxæ˜¯ä¸€ä¸ªæ”¯æŒå¤šç”¨æˆ·å’Œå¤šä»»åŠ¡çš„æ“ä½œç³»ç»Ÿï¼Œå¤šä»»åŠ¡æ˜¯æŒ‡å¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªç¨‹åºï¼Œè€Œæ¯ä¸ªè¿è¡Œç¨‹åºçš„ä¸€ä¸ªå®ä¾‹è¢«ç§°ä½œä¸€ä¸ªè¿›ç¨‹ã€‚Linuxç³»ç»Ÿæä¾›äº†å¯ä»¥è®©æˆ‘ä»¬åˆ—å‡ºæ­£è¿è¡Œè¿›ç¨‹ï¼Œæ€æ­»è¿›ç¨‹ï¼Œç›‘å¬ç³»ç»Ÿä½¿ç”¨æƒ…å†µçš„å·¥å…·ã€‚ ç›¸å…³åšå®¢:Linux Bible 9th Editionä¹‹ä½¿ç”¨shellLinux Bible 9th Editionä¹‹ç©è½¬æ–‡æœ¬æ–‡ä»¶Linux Bible 9th Editionä¹‹æ–‡ä»¶ç³»ç»Ÿ","keywords":null,"text":"æ ¹æ®Linux Bibleç¬¬ä¹ç‰ˆç¬¬å…­ç« æ•´ç†çš„è¯»ä¹¦ç¬”è®°ï¼Œè®°å½•linuxç³»ç»Ÿä¸‹å¦‚ä½•ç®¡ç†è¿›ç¨‹ Linuxæ˜¯ä¸€ä¸ªæ”¯æŒå¤šç”¨æˆ·å’Œå¤šä»»åŠ¡çš„æ“ä½œç³»ç»Ÿï¼Œå¤šä»»åŠ¡æ˜¯æŒ‡å¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªç¨‹åºï¼Œè€Œæ¯ä¸ªè¿è¡Œç¨‹åºçš„ä¸€ä¸ªå®ä¾‹è¢«ç§°ä½œä¸€ä¸ªè¿›ç¨‹ã€‚Linuxç³»ç»Ÿæä¾›äº†å¯ä»¥è®©æˆ‘ä»¬åˆ—å‡ºæ­£è¿è¡Œè¿›ç¨‹ï¼Œæ€æ­»è¿›ç¨‹ï¼Œç›‘å¬ç³»ç»Ÿä½¿ç”¨æƒ…å†µçš„å·¥å…·ã€‚ ç›¸å…³åšå®¢:Linux Bible 9th Editionä¹‹ä½¿ç”¨shellLinux Bible 9th Editionä¹‹ç©è½¬æ–‡æœ¬æ–‡ä»¶Linux Bible 9th Editionä¹‹æ–‡ä»¶ç³»ç»Ÿ ç†è§£è¿›ç¨‹ä¸€ä¸ªè¿›ç¨‹æ˜¯ä¸€ä¸ªå‘½ä»¤æ­£åœ¨è¿è¡Œçš„å®ä¾‹ã€‚æ¯”å¦‚ï¼Œç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªviå‘½ä»¤ï¼Œå¦‚æœviå‘½ä»¤æ­£åœ¨è¢«15ä¸ªä¸åŒçš„ç”¨æˆ·è¿è¡Œï¼Œé‚£ä¹ˆå°±å¯¹åº”äº†15ä¸ªä¸åŒçš„è¿è¡Œè¿›ç¨‹ã€‚ä¸€ä¸ªè¿›ç¨‹åœ¨ç³»ç»Ÿä¸­é€šè¿‡è¿›ç¨‹Id(process ID)æ¥æ ‡è¯†ï¼Œåœ¨å½“å‰ç³»ç»Ÿä¸­è¿›ç¨‹Idæ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹æ­£åœ¨è¿è¡Œï¼Œé‚£ä¹ˆå…¶ä»–è¿›ç¨‹éƒ½ä¸èƒ½ä½¿ç”¨å®ƒçš„è¿›ç¨‹Idçš„æ•°å­—ä½œä¸ºè‡ªå·±çš„è¿›ç¨‹Idã€‚ä½†å¦‚æœè¿™ä¸ªè¿›ç¨‹å·²ç»ç»“æŸï¼Œé‚£ä¹ˆä»–çš„è¿›ç¨‹Idå¯ä»¥è¢«é‡æ–°ä½¿ç”¨å½“åšå…¶ä»–è¿›ç¨‹çš„è¿›ç¨‹Idã€‚é™¤äº†è¿›ç¨‹Idï¼Œè¿›ç¨‹è¿˜æœ‰ä¸€äº›å…¶ä»–å±æ€§ã€‚æ¯ä¸ªè¿è¡Œçš„è¿›ç¨‹éƒ½ä¼šå…³è”ä¸€ä¸ªæŒ‡å®šçš„ç”¨æˆ·è´¦å·å’Œç”¨æˆ·ç»„ï¼Œè¿™ä¸ªè´¦å·å†³å®šäº†è¿›ç¨‹å¯ä»¥è®¿é—®å“ªäº›ç³»ç»Ÿèµ„æºã€‚æ‰€ä»¥rootç”¨æˆ·è¿è¡Œçš„è¿›ç¨‹èƒ½æ¯”æ™®é€šç”¨æˆ·çš„è¿›ç¨‹è®¿é—®æ›´å¤šçš„æ–‡ä»¶ã€‚å¯¹äºä¸€ä¸ªLinuxçš„ç®¡ç†å‘˜æ¥è¯´ï¼Œç®¡ç†è¿›ç¨‹çš„èƒ½åŠ›è‡³å…³é‡è¦ã€‚å› ä¸ºæœ‰æ—¶ï¼Œä¸€äº›è¿è¡Œçš„è¿›ç¨‹ä¼šä¸¥é‡å½±å“ç³»ç»Ÿçš„æ€§èƒ½ï¼Œè¿™ä¸€ç« ä¼šè®²è¿°å¦‚æœæ ¹æ®å†…å­˜å’ŒCPUçš„ä½¿ç”¨æƒ…å†µï¼Œå®šä½å’Œå¤„ç†è¿™äº›è¿›ç¨‹ã€‚ åˆ—å‡ºè¿›ç¨‹å¦‚æœä½¿ç”¨å‘½ä»¤è¡Œåˆ—å‡ºå½“å‰ç³»ç»Ÿè¿è¡Œçš„è¿›ç¨‹ï¼Œpså‘½ä»¤æ˜¯æœ€è€ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„å‘½ä»¤ï¼Œè€Œtopå‘½ä»¤ä¸ä»…å¯ä»¥åˆ—å‡ºè¿›ç¨‹è¿˜å¯ä»¥æ›´æ”¹è¿›ç¨‹çš„çŠ¶æ€ã€‚å¦‚æœä½¿ç”¨çš„æ˜¯GNOMEï¼Œå¯ä»¥ä½¿ç”¨gnome-system-monitoræ¥é€šè¿‡å›¾å½¢ç•Œé¢ç®¡ç†è¿›ç¨‹ã€‚ é€šè¿‡pså‘½ä»¤åˆ—å‡ºè¿›ç¨‹æœ€å¸¸ç”¨çš„æŸ¥çœ‹æ­£åœ¨è¿è¡Œè¿›ç¨‹çš„å·¥å…·å°±æ˜¯pså‘½ä»¤ï¼Œé€šè¿‡pså‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œå®ƒä»¬ä½¿ç”¨çš„èµ„æºä»¥åŠè¿è¡Œå®ƒä»¬çš„ç”¨æˆ·ã€‚ä¸‹é¢æ˜¯pså‘½ä»¤çš„ä¸€ä¸ªä¾‹å­: 1234$ ps uUSER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND jake 2147 0.0 0.7 1836 1020 tty1 S+ 14:50 0:00 -bash jake 2310 0.0 0.7 2592 912 tty1 R+ 18:22 0:00 ps u åœ¨ä¸Šé¢çš„å‘½ä»¤ä¸­ï¼Œä½¿ç”¨ué€‰é¡¹ä¼šæ˜¾ç¤ºç”¨æˆ·åå’Œä¸€äº›å…¶ä»–ä¿¡æ¯ï¼Œæ¯”å¦‚è¿›ç¨‹æ˜¯ä»€ä¹ˆæ—¶å€™å¼€å§‹è¿è¡Œçš„ï¼Œè¿›ç¨‹å ç”¨çš„å†…å­˜å’ŒCpuï¼Œå‘½ä»¤è¿è¡Œçš„ä½ç½®(TTY)ç­‰ã€‚ä¸Šé¢çš„ç¬¬ä¸€ä¸ªè¿›ç¨‹è¯´æ˜äº†jakeç”¨æˆ·åœ¨ç™»å½•ä¹‹åæ‰“å¼€äº†ä¸€ä¸ªbash shellã€‚ç¬¬äºŒè¿›ç¨‹æ˜¾ç¤ºäº†jakeç”¨æˆ·æ­£åœ¨è¿è¡Œps uå‘½ä»¤ã€‚ç»ˆç«¯è®¾å¤‡tty1æ­£åœ¨è¢«ç™»å½•ä¼šè¯ä½¿ç”¨ç€ã€‚STATè¿™ä¸€åˆ—ä»£è¡¨äº†è¿›ç¨‹çš„çŠ¶æ€ï¼ŒRä»£è¡¨è¿›ç¨‹æ­£åœ¨è¿è¡Œï¼ŒSä»£è¡¨è¿›ç¨‹å¤„äºä¼‘çœ çŠ¶æ€ã€‚ STATé™¤äº†Rå’ŒSä¹‹å¤–è¿˜å¯ä»¥æœ‰åˆ«çš„å€¼ï¼ŒDä»£è¡¨ä¸å¯ä¸­æ–­ï¼ŒRè¿è¡Œï¼ŒSä¸­æ–­/ä¼‘çœ ï¼ŒTåœæ­¢ï¼ŒZåƒµæ­»ã€‚å¦‚æœåé¢æœ‰+å·ï¼Œä»£è¡¨åœ¨å‰å°è¿è¡Œçš„è¿›ç¨‹ã€‚ USERåˆ—æ˜¾ç¤ºäº†è¿è¡Œè¿™ä¸ªè¿›ç¨‹çš„ç”¨æˆ·ã€‚PIDåˆ—æ˜¯è¿›ç¨‹çš„è¿›ç¨‹Idï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„è¿›ç¨‹Idï¼Œåœ¨éœ€è¦æ€æ­»ä¸€ä¸ªè¿›ç¨‹æˆ–è€…ä¸ºè¿›ç¨‹å‘é€ä¿¡å·æ—¶ä½¿ç”¨ã€‚%CPUå’Œ%MENä¸¤åˆ—æ˜¾ç¤ºäº†è¿›ç¨‹å ç”¨çš„CPUç™¾åˆ†æ¯”å’Œå†…å­˜ç™¾åˆ†æ¯”ã€‚VSZ(virtual set size)å±•ç¤ºäº†è™šæ‹Ÿå†…å­˜å ç”¨å¤§å°(å•ä½ï¼škb/kilobytes),RSS(reside set size)å±•ç¤ºäº†å®é™…å†…å­˜å ç”¨å¤§å°(å•ä½ï¼škb/kilobytes)ã€‚VSZå’ŒRSSçš„å€¼å¯èƒ½ä¸ä¸€æ ·ï¼Œå› ä¸ºVSZæ˜¯åˆ†é…ç»™è¿›ç¨‹çš„å†…å­˜å¤§å°ï¼Œè€ŒRSSæ˜¯è¿›ç¨‹å®é™…ä½¿ç”¨çš„å†…å­˜å¤§å°ï¼Œä»£è¡¨äº†ä¸å¯äº¤æ¢çš„ç‰©ç†å†…å­˜ã€‚STARTä»£è¡¨äº†è¿›ç¨‹å¯åŠ¨çš„æ—¶é—´ï¼ŒTIMEæ‰§è¡Œç´¯è®¡æ—¶é—´(å¦‚æœå ç”¨cpuæ—¶é—´éå¸¸çŸ­ä¸åˆ°ä¸€ç§’ï¼Œä¼šæ˜¾ç¤º 0:00)ã€‚åœ¨Linuxä¸­ï¼Œæœ‰äº›è¿è¡Œçš„è¿›ç¨‹æ˜¯ä¸ç»ˆç«¯æ— å…³çš„ï¼Œè¿™äº›è¿›ç¨‹é€šå¸¸åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶å¼€å§‹è¿è¡Œï¼Œå¹¶ä¸”ä¼šæŒç»­è¿è¡Œï¼Œç›´åˆ°ç³»ç»Ÿå…³é—­ã€‚å¯ä»¥ä½¿ç”¨xé€‰é¡¹æŸ¥çœ‹ä¸ç»ˆç«¯æ— å…³çš„è¿›ç¨‹ã€‚ åˆ†é¡µæŸ¥çœ‹ä¸å½“å‰ç”¨æˆ·æœ‰å…³çš„æ‰€æœ‰è¿è¡Œè¿›ç¨‹ 1$ ps ux | less åˆ†é¡µæŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·çš„è¿è¡Œçš„è¿›ç¨‹ 1$ ps aux | less ç®¡é“ç¬¦(â€œ|â€)ä¼šå°†ç¬¬ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºå½“åšç¬¬äºŒä¸ªå‘½ä»¤çš„è¾“å…¥ï¼Œä¸Šé¢çš„ä¾‹å­ä¸­pså‘½ä»¤çš„è¾“å‡ºä¼šå½“åšlesså‘½ä»¤çš„è¾“å…¥ï¼Œè¿™æ ·å°±å¯ä»¥åˆ†é¡µæŸ¥çœ‹ä¿¡æ¯äº†ã€‚æŒ‰ç©ºæ ¼é”®æ¢é¡µï¼ŒæŒ‰qé€€å‡ºã€‚æˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰pså‘½ä»¤å±•ç¤ºçš„ä¿¡æ¯ï¼Œå¹¶æŒ‰å…¶ä¸­ä¸€åˆ—æ’åºã€‚ä½¿ç”¨-oé€‰é¡¹ï¼Œå¯ä»¥é€šè¿‡å…³é”®å­—æŒ‡å®šæƒ³è¦å±•ç¤ºçš„åˆ—ã€‚ä¸‹é¢çš„ä¾‹å­å°±æ˜¯æŒ‡å®špså±•ç¤ºè¿›ç¨‹Id(pid),ç”¨æˆ·å(username),ç”¨æˆ·Id(uid),ç”¨æˆ·ç»„(group),ç»„Id(gid),åˆ†é…çš„è™šæ‹Ÿå†…å­˜(vsz),å®é™…ä½¿ç”¨å†…å­˜(rss),è¿è¡Œçš„å‘½ä»¤(comm),é»˜è®¤æƒ…å†µä¸‹æŒ‰è¿›ç¨‹Idæ’åºã€‚123$ ps -eo pid,user,uid,group,gid,vsz,rss,comm | less PID USER GROUP GID VSZ RSS COMMAND 1 root root 0 19324 1320 init 2 root root 0 0 0 kthreadd å¦‚æœæƒ³è¦æŒ‰å…¶ä»–åˆ—æ’åºå¯ä»¥ä½¿ç”¨sort=é€‰é¡¹ã€‚ä¾‹å¦‚ï¼Œæƒ³æŸ¥çœ‹é‚£ä¸ªè¿›ç¨‹å ç”¨äº†æœ€å¤šçš„å†…å­˜ï¼Œå¯ä»¥æŒ‰rssæ’åˆ—ï¼Œä¼šæŒ‰rssä»ä½åˆ°é«˜å±•ç¤ºè¿›ç¨‹ï¼Œå¦‚æœæƒ³ä»é«˜åˆ°åº•å¯ä»¥åœ¨å‰é¢åŠ è¿å­—ç¬¦ã€‚ä¸‹é¢æ˜¯ä¾‹å­ï¼š12345$ ps -eo pid,user,group,gid,vsz,rss,comm --sort=-rss | lessPID USER GROUP GID VSZ RSS COMMAND12005 cnegus cnegus 13597 1271008 522192 firefox5412 cnegus cnegus 13597 949584 157268 thunderbird-bin25870 cnegus cnegus 13597 1332492 112952 swriter.bin é€šè¿‡topå‘½ä»¤åˆ—å‡ºè¿›ç¨‹,ä¿®æ”¹è¿›ç¨‹ä½¿ç”¨topå‘½ä»¤ï¼Œä¼šé»˜è®¤æŒ‰å ç”¨CPUçš„æ—¶é—´å±•ç¤ºè¿›ç¨‹ï¼Œä¹Ÿå¯ä»¥æŒ‰å…¶ä»–æŒ‡æ ‡æ’åºã€‚å¦‚æœå®šä½åˆ°äº†ä¸€ä¸ªå¼‚å¸¸çš„è¿›ç¨‹ï¼Œå¯ä»¥ä½¿ç”¨topç»ˆæ­¢(kill)è¿›ç¨‹æˆ–ä¿®æ”¹å…¶ä¼˜å…ˆçº§(reprioritize)ã€‚å¦‚æœæƒ³è¦èƒ½å¤Ÿç»ˆæ­¢æ‰€æœ‰çš„è¿›ç¨‹æˆ–æ›´æ”¹æ‰€æœ‰è¿›ç¨‹ä¼˜å…ˆçº§éœ€è¦ä½¿ç”¨root useræ¥è¿è¡Œtopå‘½ä»¤ã€‚å¦‚æœåªæ˜¯æƒ³è¦å±•ç¤ºè¿›ç¨‹ï¼Œæˆ–è€…æ›´æ”¹è‡ªå·±çš„è¿›ç¨‹ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨æ™®é€šç”¨æˆ·çš„èº«ä»½ã€‚ä¸‹å›¾æ˜¯ä½¿ç”¨topçš„ä¾‹å­ï¼Œæœ€ä¸Šé¢åˆ—å‡ºäº†ç³»ç»Ÿçš„åŸºæœ¬ä¿¡æ¯ï¼Œä¸‹é¢æ˜¯æ¯ä¸ªè¿è¡Œè¿›ç¨‹çš„ä¿¡æ¯ã€‚ä»æœ€ä¸Šé¢çš„è¾“å‡ºä¿¡æ¯ä½ å¯ä»¥çŸ¥é“ç³»ç»Ÿå¯åŠ¨äº†å¤šé•¿æ—¶é—´ï¼Œç›®å‰ç”¨å¤šå°‘ç”¨æˆ·ç™»å…¥ï¼Œåœ¨è¿‡å»çš„1,5,10åˆ†é’Ÿå†…åˆ†åˆ«è¿è¡Œäº†å¤šå°‘æ¡å‘½ä»¤ã€‚é™¤æ­¤ä¹‹å¤–è¿˜åŒ…æ‹¬äº†å½“å‰æœ‰å¤šå°‘è¿›ç¨‹åœ¨è¿è¡Œï¼ŒCPUå ç”¨å¤šå°‘ï¼Œç”¨å¤šå°‘å¯ç”¨çš„Swapå’ŒRAMã€‚ç´§æ¥ç€åˆ—å‡ºäº†æ¯ä¸ªè¿›ç¨‹çš„åŸºæœ¬ä¿¡æ¯ï¼ŒæŒ‰è¿›ç¨‹å ç”¨cpuç™¾åˆ†æ¯”æ’åˆ—ï¼Œé»˜è®¤æƒ…å†µä¸‹æ‰€æœ‰ä¿¡æ¯5ç§’é’Ÿåˆ·æ–°ä¸€æ¬¡ã€‚ ä¸‹é¢åˆ—å‡ºäº†åœ¨ç”¨topå±•ç¤ºã€ä¿®æ”¹è¿›ç¨‹æ—¶å¯ç”¨çš„ä¸€äº›æ“ä½œï¼š æŒ‰hçœ‹å¸®åŠ©é€‰é¡¹ï¼ŒæŒ‰ä»»æ„é”®è¿”å› æŒ‰MæŒ‰å ç”¨å†…å­˜æ’åˆ—ï¼ŒæŒ‰Pè¿”å›æŒ‰CPUæ’åˆ— æŒ‰æ•°å­—1å¯ä»¥åœ¨æ‰€æœ‰cpuä¸­åˆ‡æ¢ï¼Œå‰ææ˜¯ä½ çš„ç³»ç»Ÿä¸­æœ‰å¤šäºä¸€ä¸ªcpu æŒ‰Rå°†è¾“å‡ºå€’åºæ’åˆ— æŒ‰uå¹¶è¾“å…¥ä¸€ä¸ªç”¨æˆ·åï¼Œå±•ç¤ºæŒ‡å®šç”¨æˆ·çš„è¿›ç¨‹ ä¸‹é¢æ˜¯è¿è¡Œtopå‘½ä»¤æ—¶ï¼Œå¦‚ä½•ç»ˆæ­¢è¿›ç¨‹æˆ–ä¿®æ”¹å…¶ä¼˜å…ˆçº§: ä¿®æ”¹ä¼˜å…ˆçº§ï¼šè®°ä¸‹æƒ³è¦ä¿®æ”¹çš„è¿›ç¨‹çš„PIDï¼Œä¹‹åæŒ‰rè¾“å…¥çº¿ç¨‹å¯¹åº”çš„PID,å†è¾“å…¥æƒ³è¦è°ƒæ•´çš„å€¼(-19 åˆ° 20)ã€‚ ç»ˆæ­¢è¿›ç¨‹ï¼š è®°ä¸‹æƒ³è¦ä¿®æ”¹çš„è¿›ç¨‹çš„PIDï¼Œä¹‹åæŒ‰kè¾“å…¥çº¿ç¨‹å¯¹åº”çš„PIDï¼Œä¹‹åè¾“å…¥15(ç»ˆæ­¢)æˆ–9(å¼ºè¿«ç»ˆæ­¢)ã€‚ é¢˜å¤–è¯æœ€è¿‘è´Ÿèƒ½é‡å¤ªå¤šäº† èµ¶ç´§å¬é¦–æˆ‘å¤§å°‘æ—¶çš„æ­Œå‹å‹ã€‚","raw":null,"content":null,"categories":[{"name":"linux","slug":"linux","permalink":"http://yemengying.com/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://yemengying.com/tags/linux/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"http://yemengying.com/tags/è¯»ä¹¦ç¬”è®°/"}]},{"title":"è¯»ä¹¦ç¬”è®°-Linux Bible 9th Editionä¹‹ç©è½¬æ–‡æœ¬æ–‡ä»¶","slug":"è¯»ä¹¦ç¬”è®°-Linux-Bible-9th-Editionä¹‹ç©è½¬æ–‡æœ¬æ–‡ä»¶","date":"2015-11-30T07:04:46.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/11/30/è¯»ä¹¦ç¬”è®°-Linux-Bible-9th-Editionä¹‹ç©è½¬æ–‡æœ¬æ–‡ä»¶/","link":"","permalink":"http://yemengying.com/2015/11/30/è¯»ä¹¦ç¬”è®°-Linux-Bible-9th-Editionä¹‹ç©è½¬æ–‡æœ¬æ–‡ä»¶/","excerpt":"æ ¹æ®ä¹¦çš„ç¬¬5ç« æ•´ç†ä¸€ä¸‹å…³äºæ“ä½œæ–‡æœ¬æ–‡ä»¶çš„å¸¸ç”¨å‘½ä»¤ã€‚åœ¨Linuxç³»ç»Ÿä¸­è®¸å¤šä¿¡æ¯éƒ½æ˜¯åœ¨æ–‡æœ¬æ–‡ä»¶ä¸­ç®¡ç†çš„,æ‰€ä»¥ç†Ÿç»ƒæŒæ¡å¯¹æ–‡æœ¬æ–‡ä»¶çš„æ›´æ”¹ï¼ŒæŸ¥æ‰¾æ˜¯å¾ˆé‡è¦çš„ã€‚è¿™ä¸€ç‚¹ï¼Œåœ¨å‡ºbugæŸ¥æ‰¾æœåŠ¡å™¨æ—¥å¿—æ—¶çœŸæ˜¯æ·±æœ‰ä½“ä¼šå•Šï¼ğŸ˜¼ğŸ˜¼ ç›¸å…³åšå®¢: Linux Bible 9th Editionä¹‹ä½¿ç”¨shell Linux Bible 9th Editionä¹‹æ–‡ä»¶ç³»ç»Ÿ Linux Bible 9th Editionä¹‹è¿›ç¨‹å¤§æ³•å¥½","keywords":null,"text":"æ ¹æ®ä¹¦çš„ç¬¬5ç« æ•´ç†ä¸€ä¸‹å…³äºæ“ä½œæ–‡æœ¬æ–‡ä»¶çš„å¸¸ç”¨å‘½ä»¤ã€‚åœ¨Linuxç³»ç»Ÿä¸­è®¸å¤šä¿¡æ¯éƒ½æ˜¯åœ¨æ–‡æœ¬æ–‡ä»¶ä¸­ç®¡ç†çš„,æ‰€ä»¥ç†Ÿç»ƒæŒæ¡å¯¹æ–‡æœ¬æ–‡ä»¶çš„æ›´æ”¹ï¼ŒæŸ¥æ‰¾æ˜¯å¾ˆé‡è¦çš„ã€‚è¿™ä¸€ç‚¹ï¼Œåœ¨å‡ºbugæŸ¥æ‰¾æœåŠ¡å™¨æ—¥å¿—æ—¶çœŸæ˜¯æ·±æœ‰ä½“ä¼šå•Šï¼ğŸ˜¼ğŸ˜¼ ç›¸å…³åšå®¢: Linux Bible 9th Editionä¹‹ä½¿ç”¨shell Linux Bible 9th Editionä¹‹æ–‡ä»¶ç³»ç»Ÿ Linux Bible 9th Editionä¹‹è¿›ç¨‹å¤§æ³•å¥½ ä½¿ç”¨vimå’Œviç¼–è¾‘æ–‡ä»¶ åˆšæ¥è§¦viç¼–è¾‘å™¨å¯èƒ½ä¼šè§‰å¾—æœ‰ç‚¹éš¾ï¼Œä¸è¿‡å½“ä½ ç†Ÿæ‚‰äº†ä¹‹åå¯ä»¥åªç”¨é”®ç›˜å°±èƒ½å¿«é€Ÿé«˜æ•ˆçš„ç¼–è¾‘æ–‡ä»¶ï¼Œæ— éœ€ä½¿ç”¨é¼ æ ‡æˆ–åŠŸèƒ½é”®ã€‚(å¦‚æœè§‰å¾—viä¸é€‚åˆä½ ï¼Œå¯ä»¥é€‰æ‹©å…¶å®ƒçš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæ¯”å¦‚:nano,gedit,jed,kate,kedit,mcedit,neditâ€¦ç­‰ç­‰) ä»æœ€å¸¸è§çš„æ‰“å¼€æ–‡ä»¶çš„å¼€å§‹äº†è§£viæ‰“å¼€æ–‡ä»¶: 1$ vi test å¦‚æœè¿™æ˜¯ä¸€ä¸ªç©ºçš„æ–‡ä»¶ï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹å›¾çš„ä¸œä¸œã€‚æœ€ä¸Šé¢é—ªçƒçš„ä¸œä¸œä»£è¡¨äº†å…‰æ ‡çš„å½“å‰ä½ç½®ï¼Œæœ€ä¸‹é¢çš„ä¸€è¡Œæ˜¾ç¤ºäº†å…³äºæ–‡ä»¶çš„ä¸€äº›ä¿¡æ¯,ä¸­é—´çš„â€~â€ç¬¦å·ä»£è¡¨æ²¡æœ‰å†…å®¹ã€‚å½“ä½ çœ‹åˆ°è¿™ä¸ªç•Œé¢å¯èƒ½ä¼šæ„Ÿè§‰ä¸çŸ¥æ‰€æªï¼Œå› ä¸ºæ²¡æœ‰ä»»ä½•èœå•ï¼Œæç¤ºå’Œå›¾æ ‡æ¥å‘Šè¯‰ä½ è¯¥åšä»€ä¹ˆã€‚æ›´ææ€–çš„æ˜¯ï¼Œä½ ä¸èƒ½ç›´æ¥è¾“å…¥ï¼Œå¦åˆ™ä¼šå¬è§â€å˜Ÿå˜Ÿâ€çš„å£°éŸ³ã€‚ æ·»åŠ æ–‡ä»¶å†…å®¹ä¸è¦æ€•,é¦–å…ˆ,éœ€è¦äº†è§£ä¸¤ç§ä¸»è¦çš„æ¨¡å¼:å‘½ä»¤æ¨¡å¼(command)å’Œç¼–è¾‘æ¨¡å¼(input)ã€‚viç¼–è¾‘å™¨ä»¥å‘½ä»¤æ¨¡å¼å¯åŠ¨ï¼Œåœ¨æ·»åŠ æˆ–æ”¹å˜æ–‡æœ¬å†…å®¹ä¹‹å‰éœ€è¾“å…¥å‘½ä»¤æ¥å‘Šè¯‰viä½ æƒ³è¦åšä»€ä¹ˆ(å¤§å°å†™æ•æ„Ÿ)ã€‚è¾“å…¥ä¸‹é¢çš„å‘½ä»¤å°±å¯ä»¥è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œå½“ç¼–è¾‘ç»“æŸåï¼ŒæŒ‰Escé”®å°±å¯ä»¥å›åˆ°å‘½ä»¤æ¨¡å¼ã€‚ å‘½ä»¤ ä½œç”¨ a å¯ä»¥åœ¨å…‰æ ‡å³ä¾§å¼€å§‹æ’å…¥æ–‡æœ¬ A å¯ä»¥åœ¨å½“å‰è¡Œçš„æœ€åå¼€å§‹æ’å…¥æ–‡æœ¬ i å¯ä»¥åœ¨å…‰æ ‡å·¦ä¾§å¼€å§‹æ’å…¥æ–‡æœ¬ I å¯ä»¥åœ¨å½“å‰è¡Œçš„æœ€å‰é¢å¼€å§‹æ’å…¥æ–‡æœ¬ o åœ¨å½“å‰è¡Œä¸‹é¢ æ’å…¥æ–°çš„ä¸€è¡Œ O åœ¨å½“å‰è¡Œä¸Šé¢ æ’å…¥æ–°çš„ä¸€è¡Œ å½“è¿›å…¥ç¼–è¾‘æ¨¡å¼æ—¶ï¼Œå±å¹•ä¸‹æ–¹ä¼šå‡ºç°â€“ INSERT â€“ï¼›ç¼–è¾‘ç»“æŸåï¼ŒæŒ‰Escé”®å°±å¯ä»¥å›åˆ°å‘½ä»¤æ¨¡å¼ã€‚ä¸è¿‡å¦‚æœè¾“å…¥äº†â€:â€ç¬¦å·ï¼Œéœ€è¦æŒ‰ä¸¤ä¸‹Escé”® åœ¨æ–‡æœ¬ä¸­ç§»åŠ¨å¯ä»¥ä½¿ç”¨æ–¹å‘é”®å¯ä»¥åœ¨æ–‡æœ¬ä¸­ç§»åŠ¨å…‰æ ‡ï¼Œä½†è¿˜æœ‰ä¸€äº›å°æŠ€å·§å¯ä»¥è®©æˆ‘ä»¬æ›´æ–¹ä¾¿çš„åœ¨æ–‡æœ¬ä¸­ç§»åŠ¨ å‘½ä»¤ ä½œç”¨ w å…‰æ ‡ç§»åˆ°ä¸‹ä¸€ä¸ªå•è¯çš„å¼€å¤´(å•è¯ä»¥spaces,tabs,æ ‡ç‚¹ç•Œå®š) W å…‰æ ‡ç§»åˆ°ä¸‹ä¸€ä¸ªå•è¯çš„å¼€å¤´(å•è¯ä»¥spaces,tabsç•Œå®š) b å…‰æ ‡ç§»åˆ°å‰ä¸€ä¸ªå•è¯çš„å¼€å¤´(å•è¯ä»¥spaces,tabs,æ ‡ç‚¹ç•Œå®š) B å…‰æ ‡ç§»åˆ°å‰ä¸€ä¸ªå•è¯çš„å¼€å¤´(å•è¯ä»¥spaces,tabsç•Œå®š) 0(zero) å…‰æ ‡ç§»åˆ°å½“å‰è¡Œçš„æœ€å‰é¢ $ å…‰æ ‡ç§»åˆ°å½“å‰è¡Œçš„æœ€å H å…‰æ ‡ç§»åˆ°å±å¹•çš„å·¦ä¸Šè§’ M ç§»åˆ°ä¸­é—´è¡Œç¬¬ä¸€ä¸ªå­—ç¬¦ L å…‰æ ‡ç§»åˆ°å±å¹•çš„å·¦ä¸‹è§’ åˆ é™¤ï¼Œå¤åˆ¶ï¼Œæ›´æ”¹æ–‡æœ¬äº†è§£äº†å¦‚ä½•æ·»åŠ æ–‡æœ¬å’Œç§»åŠ¨å…‰æ ‡æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼Œè¿˜éœ€è¦çŸ¥é“å¦‚ä½•åˆ é™¤ï¼Œå¤åˆ¶å’Œæ›´æ”¹æ–‡æœ¬ã€‚å‘½ä»¤x,d,y,cç­‰å¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ é™¤å’Œä¿®æ”¹æ–‡æœ¬ï¼Œè¿™äº›å‘½ä»¤ä¹Ÿå¯ä»¥å’Œç§»åŠ¨å…‰æ ‡çš„å‘½ä»¤(ä¸Šä¸€ä¸ªè¡¨æ ¼ä¸­æåˆ°çš„)æˆ–è€…æ•°å­—é…åˆä½¿ç”¨æ¥å‘Šè¯‰ç¼–è¾‘å™¨ç¡®åˆ‡çš„æ“ä½œæ˜¯ä»€ä¹ˆã€‚ å‘½ä»¤ ä½œç”¨ x åˆ é™¤å…‰æ ‡æ‰€åœ¨ä½ç½®çš„å­—ç¬¦ X åˆ é™¤å…‰æ ‡æ‰€åœ¨ä½ç½®çš„å‰ä¸€ä¸ªå­—ç¬¦ d? åˆ é™¤ä¸€äº›æ–‡æœ¬ c? æ›´æ”¹ä¸€äº›æ–‡æœ¬ y? å¤åˆ¶ä¸€äº›æ–‡æœ¬ ?ä»£è¡¨è¿™äº›å‘½ä»¤è¦å’Œç§»åŠ¨å…‰æ ‡çš„å‘½ä»¤é…åˆç€ä½¿ç”¨ï¼Œä¸‹é¢æ˜¯ä¸€äº›ä¾‹å­ å‘½ä»¤ ä½œç”¨ dw åˆ é™¤å½“å‰å…‰æ ‡ä½ç½®çš„åä¸€ä¸ªå•è¯ db åˆ é™¤å½“å‰å…‰æ ‡ä½ç½®çš„å‰ä¸€ä¸ªå•è¯ dd åˆ é™¤å½“å‰ä¸€æ•´è¡Œ c$ æ›´æ”¹(å®é™…ä¸Šæ˜¯æ“¦é™¤)ä»å½“å‰ä½ç½®åˆ°å½“å‰è¡Œæœ€åçš„å†…å®¹ï¼Œå¹¶è¿›å…¥ç¼–è¾‘æ¨¡å¼ c0 æ›´æ”¹(å®é™…ä¸Šæ˜¯æ“¦é™¤)ä»å½“å‰ä½ç½®åˆ°å½“å‰è¡Œæœ€å‰é¢çš„å†…å®¹ï¼Œå¹¶è¿›å…¥ç¼–è¾‘æ¨¡å¼ yy å°†å½“å‰è¡Œå¤åˆ¶åˆ°bufferä¸­ ä¸Šé¢è¿™äº›å‘½ä»¤ä¹Ÿå¯ä»¥å’Œæ•°å­—é…åˆä½¿ç”¨,ä¸‹é¢æ˜¯æ —å­ğŸŒ° å‘½ä»¤ ä½œç”¨ 3dd åˆ é™¤å½“å‰è¡Œå¾€ä¸‹çš„ä¸‰è¡Œ 3dw åˆ é™¤æ¥ä¸‹æ¥çš„ä¸‰ä¸ªå•è¯ 5cl åˆ é™¤æ¥ä¸‹æ¥çš„5ä¸ªå­—ç¬¦ï¼Œå¹¶è¿›å…¥ç¼–è¾‘æ¨¡å¼ ç²˜è´´å¯ä»¥ä½¿ç”¨å‘½ä»¤på’ŒPï¼Œå°†å¤åˆ¶åˆ°bufferä¸­çš„å†…å®¹ç²˜è´´åˆ°æ–‡æœ¬ä¸­ã€‚pæ˜¯å°†ç¼“å­˜åŒºçš„å†…å®¹ç²˜è´´åˆ°å½“å‰å…‰æ ‡æ‰€åœ¨ä½ç½®çš„ä¸‹æ–¹ï¼ŒPæ˜¯å°†ç¼“å­˜åŒºçš„å†…å®¹ç²˜è´´åˆ°å½“å‰å…‰æ ‡æ‰€åœ¨ä½ç½®çš„ä¸Šæ–¹ åœ¨æ–‡ä»¶ä¸­è·³è·ƒ å‘½ä»¤ ä½œç”¨ ctrl+f å‘ä¸‹ä¸€é¡µ ctrl+b å‘ä¸Šä¸€é¡µ ctrl+d å‘ä¸‹ä¸€é¡µåŠ ctrl+u å‘ä¸Šä¸€é¡µåŠ G è·³åˆ°æœ€åä¸€è¡Œ 1G è·³åˆ°ç¬¬ä¸€è¡Œ 35G è·³åˆ°ç¬¬35è¡Œ æŸ¥æ‰¾æ–‡æœ¬æŸ¥æ‰¾æ–‡æœ¬æ—¶,â€/â€œå’Œâ€?â€åˆ†åˆ«å¯¹åº”å‘å‰å’Œå‘åæŸ¥æ‰¾,ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€äº›é€šé…ç¬¦ï¼Œæ¯”å¦‚/The.*foot,?[pP]rint,æŸ¥æ‰¾ä¹‹åå¯ä»¥æŒ‰nå’ŒNæ¥é‡å¤æŸ¥æ‰¾å’ŒæŒ‰ç›¸åæ–¹å‘æŸ¥æ‰¾ å‘½ä»¤ ä½œç”¨ /hello å‘å‰æŸ¥æ‰¾å•è¯â€helloâ€ ?goodbye å‘åæŸ¥æ‰¾å•è¯â€goodbyeâ€ ä½¿ç”¨exæ¨¡å¼å½“è¾“å…¥å†’å·,å¹¶ä¸”å…‰æ ‡åœ¨æœ€ä¸‹æ–¹æ—¶å°±è¿›å…¥äº†exæ¨¡å¼ï¼Œä¸‹é¢æ˜¯ä¸€äº›åœ¨exæ¨¡å¼ä¸‹æŸ¥æ‰¾ï¼Œä¿®æ”¹æ–‡æœ¬çš„æ —å­ğŸŒ° å‘½ä»¤ ä½œç”¨ :g/local æŸ¥æ‰¾local å¹¶æ‰“å° :s/local/r å°†localç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®æ›¿æ¢ä¸ºr é€€å‡ºviä»¥ä¸‹çš„å‘½ä»¤ç”¨æ¥ä¿å­˜å’Œé€€å‡ºæ–‡ä»¶ å‘½ä»¤ ä½œç”¨ ZZ ä¿å­˜ä¿®æ”¹ å¹¶é€€å‡ºvi :w ä¿å­˜ä¿®æ”¹ ä½†ä¸é€€å‡ºvi :wq ä¸ZZå‘½ä»¤ä¸€æ · :q é€€å‡ºæ–‡ä»¶ï¼Œè¯¥å‘½ä»¤åªæœ‰åœ¨æ²¡æœ‰æœªä¿å­˜çš„ä¿®æ”¹ä¸‹æ‰èµ·æ•ˆ :q! é€€å‡ºæ–‡ä»¶ ä¸ä¿å­˜å¯¹æ–‡ä»¶çš„ä¿®æ”¹ æŸ¥æ‰¾æ–‡ä»¶ ä¸ºäº†å¸®åŠ©ç”¨æˆ·æ›´æœ‰æ•ˆçš„æŸ¥æ‰¾ä»–ä»¬çš„æ–‡ä»¶ï¼Œlinuxç³»ç»Ÿæä¾›äº†locate,find,grepä¸‰ä¸ªå‘½ä»¤ï¼Œä¾æ¬¡æ¥çœ‹çœ‹ä»–ä»¬çš„ä½œç”¨ã€‚ ä½¿ç”¨localteå‘½ä»¤æŸ¥æ‰¾æ–‡ä»¶ å¤§å¤šæ•°linuxç³»ç»Ÿä¸­ï¼Œupdatedbå‘½ä»¤ä¼šæ¯å¤©æ‰§è¡Œä¸€æ¬¡ï¼Œå°†ç³»ç»Ÿä¸­æ–‡ä»¶çš„åå­—å­˜åˆ°æ•°æ®åº“ä¸­ã€‚é€šè¿‡locateå‘½ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥æ‰¾å­˜åœ¨åœ¨æ•°æ®åº“ä¸­çš„æ–‡ä»¶çš„ä½ç½®ã€‚ç›¸è¾ƒäºfindå‘½ä»¤ï¼Œlocateå‘½ä»¤æ•ˆç‡æ›´é«˜ï¼Œå› ä¸ºå®ƒæœç´¢æ•°æ®åº“è€Œä¸æ˜¯æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿã€‚ä¸è¿‡locateå‘½ä»¤ä¹Ÿæœ‰å®ƒçš„ç¼ºç‚¹ï¼Œå®ƒå¹¶ä¸èƒ½æ‰¾åˆ°æ‰€æœ‰å­˜æ”¾åœ¨ç³»ç»Ÿçš„æ–‡ä»¶ï¼Œå› ä¸ºå¹¶ä¸æ˜¯æ‰€æœ‰çš„æ–‡ä»¶éƒ½ä¼šå­˜å‚¨äºæ•°æ®åº“ä¸­ï¼Œ/etc/updatedb.confæ–‡ä»¶å†³å®šäº†å“ªäº›æ–‡ä»¶å°†å­˜åœ¨äºæ•°æ®åº“ä¸­ã€‚å¦å¤–ï¼Œæ™®é€šç”¨æˆ·æ— æ³•é€šè¿‡æ•°æ®åº“æŸ¥æ‰¾é‚£äº›ä»–ä»¬åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æ²¡æœ‰æƒåˆ©æŸ¥çœ‹çš„æ–‡ä»¶ï¼Œæ¯”å¦‚ï¼Œæ™®é€šç”¨æˆ·æ— æ³•åœ¨/rootç›®å½•ä¸‹æ‰§è¡Œlså‘½ä»¤ï¼Œé‚£ä¹ˆä»–ä»¬ä¹Ÿæ— æ³•é€šè¿‡locateæŸ¥æ‰¾è¿™ä¸ªç›®å½•ä¸‹çš„æ–‡ä»¶ã€‚å¦‚æœç”¨locateå‘½ä»¤æŸ¥æ‰¾ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆè¿™ä¸ªå­—ç¬¦ä¸²å¯èƒ½å‡ºç°åœ¨è¿”å›æ–‡ä»¶çš„è·¯å¾„çš„ä»»æ„ä½ç½®ã€‚ä¸¾ä¸ªæ —å­ï¼ŒæŸ¥æ‰¾passwdï¼Œç»“æœå¯èƒ½ä¸º/etc/passwd,/usr/bin/passwdå’Œå…¶å®ƒè·¯å¾„åŒ…å«passwdçš„æ–‡ä»¶ã€‚è¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ä¹‹åï¼Œå¸Œæœ›ç«‹åˆ»é€šè¿‡locateæŸ¥æ‰¾å®ƒï¼Œæœ€å¥½æ‰§è¡Œå‘½ä»¤updatedbæ›´æ–°ä¸‹æ•°æ®åº“ã€‚ 123456789101112$ locate .bashrc/etc/skel/.bashrc /home/cnegus/.bashrc# locate ./bashrc (èº«ä»½ä¸åŒ æŸ¥æ‰¾ç»“æœä¸åŒ)/etc/skel/.bashrc /home/bill/.bashrc /home/joe/.bashrc /root/.bashrc$ locate -i muttrcï¼ˆ-i å¿½ç•¥å¤§å°å†™ï¼‰ /etc/Muttrc /etc/Muttrc.local /usr/share/doc/mutt-1.5.20/sample.muttrc $ locate services (æŸ¥æ‰¾çš„å­—ç¬¦ä¸²å¯èƒ½å‡ºç°åœ¨æ–‡ä»¶è·¯å¾„ä¸­) /etc/services /usr/share/services/bmp.kmgio /usr/share/services/data.kmgio ä¸­åœºä¼‘æ¯ï¼Œçœ‹çœ‹æˆ‘å®¶å…‰æ´™ ä½¿ç”¨findå‘½ä»¤æŸ¥æ‰¾æ–‡ä»¶ ç”±äºæœ‰è®¸å¤šä¸åŒçš„å±æ€§ï¼Œfindå‘½ä»¤æ˜¯æŸ¥æ‰¾æ–‡ä»¶çš„åˆ©å™¨ã€‚å½“æ‰§è¡Œfindå‘½ä»¤æ—¶ï¼Œå®ƒä¼šæœç´¢æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œè¿™ä¼šé€ æˆfindå‘½ä»¤æ¯”locateå‘½ä»¤è€—æ—¶é•¿ï¼Œä½†åŒæ—¶ä¹Ÿèƒ½è®©ç”¨æˆ·æŸ¥æ‰¾åˆ°ç³»ç»Ÿä¸­æœ€æ–°çš„æ–‡ä»¶ã€‚findå‘½ä»¤æœ€å¤§çš„ä¼˜ç‚¹åœ¨äºæ‰€æœ‰ä½ èƒ½æƒ³åˆ°çš„æ–‡ä»¶çš„å±æ€§ï¼Œéƒ½å¯ä»¥é€šè¿‡å®ƒæŸ¥æ‰¾ï¼Œä¾‹å¦‚åå­—ï¼Œæ‹¥æœ‰è€…ï¼Œæƒé™ï¼Œå¤§å°ï¼Œä¿®æ”¹æ—¶é—´ç­‰ç­‰ï¼Œä¹Ÿå¯ä»¥è¿›è¡Œç»„åˆæŸ¥æ‰¾ã€‚ 123456789101112$ find (åˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶å’Œç›®å½•)$ find /etc (åˆ—å‡º/etcç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶å’Œç›®å½•ï¼Œæƒé™ä¸è¶³æ—¶ä¼šæŠ¥é”™)$ find -ls (åˆ—å‡ºæ–‡ä»¶çš„æ‹¥æœ‰è€…ï¼Œæƒé™ï¼Œå¤§å°ç­‰ä¿¡æ¯)$ find /etc -name passwdï¼ˆæ ¹æ®åå­—æŸ¥æ‰¾ï¼‰$ find /etc -iname '*passwd*' ï¼ˆå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼‰$ find /bigdata -size +10G ï¼ˆæŸ¥æ‰¾å¤§å°å¤§äº10Gçš„æ–‡ä»¶ï¼‰$ find /smalldata -size -5M (æŸ¥æ‰¾å¤§å°å°äº5Mçš„æ–‡ä»¶)$ find /home -user chris -ls (è¾“å‡º/homeç›®å½•ä¸‹æ‹¥æœ‰è€…æ˜¯chrisçš„æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯)$ find /home -user chris -or -user joe -ls (è¾“å‡º/homeç›®å½•ä¸‹æ‹¥æœ‰è€…æ˜¯chrisæˆ–joeçš„æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯)$ find /home -not -user root -ls (è¾“å‡º/homeç›®å½•ä¸‹æ‹¥æœ‰è€…ä¸æ˜¯rootçš„æ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯)$ find /bin -perm 755 -lsï¼ˆé€šè¿‡æƒé™æŸ¥æ‰¾ï¼‰$ find . -perm -002 -type f -ls ï¼ˆé€šè¿‡ç±»å‹æŸ¥æ‰¾ï¼‰ findå‘½ä»¤è¿˜æœ‰ä¸€ä¸ªå¾ˆæ£’çš„ç‰¹æ€§ï¼Œå¯ä»¥ä½¿ç”¨-excuteå’Œ-oké€‰é¡¹å¯ä»¥åœ¨æŸ¥æ‰¾åˆ°çš„ä»»ä½•æ–‡ä»¶ä¸Šæ‰§è¡Œå‘½ä»¤ã€‚excuteé€‰é¡¹ä¼šç›´æ¥åœ¨æ¯ä¸ªæ‰¾åˆ°çš„æ–‡ä»¶ä¸Šæ‰§è¡Œå‘½ä»¤ï¼Œä¸ä¼šè¯¢é—®æ˜¯å¦æ‰§è¡Œã€‚è€Œoké€‰é¡¹ä¼šåœ¨æ¯ä¸ªæ–‡ä»¶æ‰§è¡Œå‘½ä»¤å‰è¯¢é—®æ˜¯å¦æ‰§è¡Œã€‚ 1234$ find /etc -iname iptables -exec echo \"I found &#123;&#125;\" \\; I found /etc/bash_completion.d/iptables I found /etc/sysconfig/iptables # find /var/allusers/ -user joe -ok mv &#123;&#125; /tmp/joe/ \\;mv ... /var/allusers/dict.dat &gt; ? y mv ... /var/allusers/five &gt; ? y æƒ³äº†è§£æ›´å¤šå…³äºfindå‘½ä»¤çš„ä¿¡æ¯ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤ man find ä½¿ç”¨grepå‘½ä»¤åœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾ å¦‚æœå¸Œæœ›æŸ¥æ‰¾åŒ…å«ç‰¹å®šå†…å®¹çš„æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨grepå‘½ä»¤ã€‚é€šè¿‡grepå‘½ä»¤ï¼Œå¯ä»¥æœç´¢å•ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥é€’å½’æœç´¢æ•´ä¸ªç›®å½•ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œgrepå‘½ä»¤æ˜¯å¤§å°å†™æ•æ„Ÿçš„ 12345$ grep desktop /etc/services desktop-dna 2763/tcp # Desktop DNA desktop-dna 2763/udp # Desktop DNA $ grep -i desktop /etc/services sco-dtmgr 617/tcp # SCO Desktop Administration Serversco-dtmgr 617/udp # SCO Desktop Administration Serverairsync 2175/tcp # Microsoft Desktop AirSync Protocol ç¬¬ä¸€ä¸ªä¾‹å­ï¼Œæ˜¯åœ¨/etc/servicesæ–‡ä»¶ä¸­æŸ¥æ‰¾å­—ç¬¦ä¸²desktop.ç¬¬äºŒä¸ªä¾‹å­é€šè¿‡é€‰é¡¹-i,åœ¨æŸ¥æ‰¾æ—¶å¤§å°å†™ä¸æ•æ„Ÿ-v æ˜¯æŸ¥æ‰¾ä¸åŒ…å«æŒ‡å®šå†…å®¹çš„è¡Œï¼Œ-ræ˜¯åœ¨ç›®å½•ä¸­é€’å½’æŸ¥æ‰¾ï¼Œ-læ˜¯åˆ—å‡ºæ–‡ä»¶å è€Œä¸æ˜¯åŒ…å«å†…å®¹çš„å…·ä½“è¡Œ 1234$ grep -v desktop /etc/services$ grep -rli peerdns /usr/share/doc/ /usr/share/doc/dnsmasq-2.66/setup.html /usr/share/doc/initscripts-9.49.17/sysconfig.txt ä»¥æˆ‘å¤§è°¢è€³æœµç»“å°¾å§ï¼Œä¸»è¦çœ‹æ°”è´¨ï¼Œå“ˆå“ˆ~~","raw":null,"content":null,"categories":[{"name":"linux","slug":"linux","permalink":"http://yemengying.com/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://yemengying.com/tags/linux/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"http://yemengying.com/tags/è¯»ä¹¦ç¬”è®°/"}]},{"title":"è¯»ä¹¦ç¬”è®°-Linux Bible 9th Editionä¹‹æ–‡ä»¶ç³»ç»Ÿ","slug":"è¯»ä¹¦ç¬”è®°-Linux-Bible-9th-Editionä¹‹æ–‡ä»¶ç³»ç»Ÿ","date":"2015-11-26T08:28:15.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/11/26/è¯»ä¹¦ç¬”è®°-Linux-Bible-9th-Editionä¹‹æ–‡ä»¶ç³»ç»Ÿ/","link":"","permalink":"http://yemengying.com/2015/11/26/è¯»ä¹¦ç¬”è®°-Linux-Bible-9th-Editionä¹‹æ–‡ä»¶ç³»ç»Ÿ/","excerpt":"è·Ÿç€ä¹¦ï¼Œé‡æ–°æ¢³ç†ä¸€ä¸‹linuxæ–‡ä»¶ç³»ç»Ÿçš„æœ‰å…³çŸ¥è¯†, æœ€è¿‘ä¸€å¤©ä¸€ä¸ªæ¥å£çš„èŠ‚å¥çœŸçœŸæ˜¯æå¥½çš„,æœ‰æ—¶é—´çœ‹çœ‹ä¹¦äº†ã€‚ğŸ˜»ğŸ˜»ğŸ˜» ç›¸å…³åšå®¢: Linux Bible 9th Editionä¹‹ä½¿ç”¨shell Linux Bible 9th Editionä¹‹ç©è½¬æ–‡æœ¬æ–‡ä»¶ Linux Bible 9th Editionä¹‹è¿›ç¨‹å¤§æ³•å¥½","keywords":null,"text":"è·Ÿç€ä¹¦ï¼Œé‡æ–°æ¢³ç†ä¸€ä¸‹linuxæ–‡ä»¶ç³»ç»Ÿçš„æœ‰å…³çŸ¥è¯†, æœ€è¿‘ä¸€å¤©ä¸€ä¸ªæ¥å£çš„èŠ‚å¥çœŸçœŸæ˜¯æå¥½çš„,æœ‰æ—¶é—´çœ‹çœ‹ä¹¦äº†ã€‚ğŸ˜»ğŸ˜»ğŸ˜» ç›¸å…³åšå®¢: Linux Bible 9th Editionä¹‹ä½¿ç”¨shell Linux Bible 9th Editionä¹‹ç©è½¬æ–‡æœ¬æ–‡ä»¶ Linux Bible 9th Editionä¹‹è¿›ç¨‹å¤§æ³•å¥½ Linuxæ–‡ä»¶ç³»ç»Ÿç»“æ„ åœ¨linuxä¸­æ–‡ä»¶ç»„ç»‡åœ¨ä¸€ä¸ªå±‚çº§çš„ç›®å½•ç»“æ„ä¸­ï¼Œæ¯ä¸ªç›®å½•å¯ä»¥åŒ…å«æ–‡ä»¶å’Œç›®å½•ï¼Œæ•´ä½“çœ‹èµ·æ¥å°±åƒä¸€ä¸ªå€’è¿‡æ¥çš„æ ‘ã€‚æœ€ä¸Šé¢å°±æ˜¯æ ¹ç›®å½•ï¼Œç”¨â€/â€œç¬¦å·è¡¨ç¤ºã€‚æ ¹ç›®å½•ä¸‹é¢æ˜¯linuxç³»ç»Ÿä¸­ä¸€äº›å¸¸è§çš„ç›®å½•,æ¯”å¦‚bin,dev,home,libç­‰ç­‰ã€‚ä¸‹é¢çš„å›¾(ä¹¦ä¸Šçš„æˆªå›¾)å±•ç¤ºäº†linuxæ–‡ä»¶ç³»ç»Ÿçš„å±‚çº§ç»“æ„ã€‚ åŸºæœ¬çš„ä¸€äº›æ–‡ä»¶ç³»ç»Ÿå‘½ä»¤ å‘½ä»¤ ä½œç”¨ cd è¿›å…¥å¦ä¸€ä¸ªç›®å½• pwd æ‰“å°å½“å‰å·¥ä½œç›®å½•çš„è·¯å¾„ mkdir åˆ›å»ºä¸€ä¸ªç›®å½• chmod æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ ls åˆ—å‡ºç›®å½•çš„å†…å®¹ cdå‘½ä»¤cdå‘½ä»¤æ˜¯å…¶ä¸­æœ€å¸¸ç”¨çš„egï¼š 12345678# è¿›å…¥æ ¹ç›®å½•ä¸‹çš„usrç›®å½•ä¸‹çš„shareç›®å½• ä»¥\"/\"å¼€å¤´ï¼Œä»£è¡¨åœ¨æ ¹ç›®å½•ä¸‹$ cd /usr/share# åªè¾“å…¥cd å›åˆ°homeç›®å½•$ cd # è¿›å…¥homeç›®å½•ä¸‹çš„æŸä¸€ç›®å½• \"~\"ä»£è¡¨homeç›®å½•$ cd ~/coffee# å›åˆ°ä¸Šä¸€çº§ç›®å½• \"..\"ä»£è¡¨ä¸Šä¸€çº§ç›®å½•$ cd .. åˆ›å»ºç›®å½•å¹¶æŸ¥çœ‹æƒé™ 1234# åˆ›å»ºç›®å½•test$ mkdir test# æŸ¥çœ‹ç›®å½•æƒé™$ ls -ld test ä½¿ç”¨Metacharacters(å…ƒå­—ç¬¦)å’ŒOperators(æ“ä½œç¬¦) ä½¿ç”¨metacharactersè¿›è¡Œæ–‡ä»¶åŒ¹é… â€œ*â€ä»£è¡¨ä»»æ„æ•°é‡çš„å­—ç¬¦ â€œ?â€ä»£è¡¨ä»»æ„ä¸€ä¸ªå­—ç¬¦ â€œ[â€¦]â€åŒ¹é…ä»»æ„ä¸€ä¸ªåŒ…å«åœ¨æ‹¬å·ä¸­çš„å­—ç¬¦,ä¹Ÿå¯ä»¥ç”¨è¿å­—ç¬¦è¡¨ç¤ºä¸€ä¸ªèŒƒå›´ egï¼š 123456789101112# åˆ›å»º5ä¸ªç©ºæ–‡ä»¶$ touch apple banana grape grapefruit watermelon$ ls a*apple$ ls g*grape $ ls g???egrape$ ls [abw]*apple banana watermelon$ ls [a-g]*apple banana grape grapefruit ä½¿ç”¨metacharactersè¿›è¡Œæ–‡ä»¶é‡å®šå‘ ä½¿ç”¨ç®¡é“ç¬¦å·â€|â€å¯ä»¥å°†ä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å‡º(standard output)ä½œä¸ºå¦ä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å…¥(standard input)ã€‚å¯¹äºæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨â€&lt;â€å’Œâ€&gt;â€æ¥å°†æ•°æ®ä»æ–‡ä»¶ä¸­è¾“å…¥æˆ–è¾“å‡ºã€‚ ç¬¦å· ä½œç”¨ &lt; æ–‡ä»¶çš„å†…å®¹è¾“å…¥åˆ°å‘½ä»¤ &gt; å°†ä¸€ä¸ªå‘½ä»¤çš„æ ‡å‡†è¾“å‡ºè¾“å‡ºåˆ°æ–‡ä»¶ï¼Œå¦‚æœæ–‡ä»¶å·²å­˜åœ¨,æ–‡ä»¶çš„å†…å®¹ä¼šè¢«è¦†ç›– 2&gt; å°†é”™è¯¯è¾“å‡ºè¾“å‡ºåˆ°æ–‡ä»¶ &amp;&gt; å°†æ ‡å‡†è¾“å‡ºå’Œé”™è¯¯è¾“å‡ºéƒ½è¾“å‡ºåˆ°æ–‡ä»¶ &gt;&gt; å°†å‘½ä»¤çš„è¾“å‡ºåˆ°æ–‡ä»¶ä¸­ï¼Œä¸è¦†ç›–æ–‡ä»¶åŸæœ‰å†…å®¹ï¼Œå°†è¾“å‡ºæ·»åŠ åˆ°æ–‡ä»¶æœ€å &lt;&lt; åé¢è¦è·Ÿç€ä¸€ä¸ªå•è¯ï¼Œä¹‹åæ‰€æœ‰çš„è¾“å…¥éƒ½ä¼šå½“åšç”¨æˆ·è¾“å…¥ï¼Œç›´åˆ°é‡å¤è¾“å…¥ç¬¦å·åçš„å•è¯ ä½¿ç”¨å¤§æ‹¬å· é€šè¿‡ä½¿ç”¨å¤§æ‹¬å·â€{}â€,å¯ä»¥åœ¨æ–‡ä»¶ååæ‰©å±•ä¸€ç»„å…ƒç´ ã€‚ eg: 123$ touch &#123;a,b,c&#125;-&#123;1,2,3&#125;$ lsa-1 a-2 a-3 b-1 b-2 b-3 c-1 c-2 c-3 åˆ—å‡ºæ–‡ä»¶å’Œç›®å½•åœ¨linuxç³»ç»Ÿä¸­,lså‘½ä»¤ç”¨æ¥åˆ—å‡ºæ–‡ä»¶å’Œç›®å½•çš„æœ‰å…³ä¿¡æ¯ï¼Œlså‘½ä»¤æœ‰è®¸å¤šoptionã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œè¾“å…¥lsï¼Œä¼šè¾“å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„ééšè—çš„æ–‡ä»¶å’Œç›®å½•ã€‚å¦‚æœåœ¨å‘½ä»¤ååœ¨ä¸Šé€‰é¡¹â€-lâ€ä¼šè¾“å‡ºè¯¦ç»†çš„ä¿¡æ¯(å¦‚ä¸‹)ï¼Œå…¶ä¸­totalä»£è¡¨äº†ç›®å½•ä¸­çš„å†…å®¹å ç”¨äº†å¤šå°‘ç£ç›˜ç©ºé—´;ç¬¬ä¸€åˆ—ç¬¬ä¸€ä¸ªå­—ç¬¦ä»£è¡¨äº†æ–‡ä»¶çš„ç±»å‹ï¼Œâ€-â€œä»£è¡¨æ™®é€šæ–‡ä»¶ï¼Œâ€dâ€ä»£è¡¨æ˜¯ç›®å½•ï¼Œâ€lâ€ä»£è¡¨æ˜¯ä¸€ä¸ªç¬¦å·é“¾æ¥,å‰©ä¸‹çš„9ä¸ªå­—ç¬¦ä»£è¡¨äº†æ–‡ä»¶çš„æƒé™(ä¸‹é¢ä¼šè®²);ç¬¬äºŒåˆ—å±•ç¤ºäº†æ–‡ä»¶ç¡¬é“¾æ¥æ•°æˆ–ç›®å½•å­ç›®å½•æ•°;ç¬¬ä¸‰åˆ—æ˜¾ç¤ºäº†æ–‡ä»¶æˆ–ç›®å½•çš„æ‹¥æœ‰è€…;ç¬¬å››åˆ—ä»£è¡¨æ–‡ä»¶æ‹¥æœ‰è€…æ‰€åœ¨çš„ç»„;ç¬¬äº”åˆ—æ˜¯æ–‡ä»¶çš„å¤§å°;ç¬¬å…­åˆ—æ˜¯æ–‡ä»¶æœ€åçš„ä¿®æ”¹æ—¶é—´;æœ€åä¸€åˆ—å±•ç¤ºäº†æ–‡ä»¶æˆ–ç›®å½•çš„åå­—;egï¼š 12$ ls -ltotal 4 -rw-rw-r--. 1 joe joe 0 Dec 18 13:38 apple lrwxrwxrwx. 1 joe joe 5 Dec 18 13:46 pointer_to_apple -&gt; apple -rwxr-xr-x. 1 joe joe 0 Dec 18 13:37 scriptx.sh drwxrwxr-x. 2 joe joe 4096 Dec 18 13:38 Stuff lså‘½ä»¤çš„å…¶å®ƒé€‰é¡¹ï¼š é€‰é¡¹ ä½œç”¨ -a å±•ç¤ºåŒ…å«éšè—æ–‡ä»¶(ä»¥.å¼€å¤´)åœ¨å†…çš„æ‰€æœ‰æ–‡ä»¶ -t æŒ‰ç…§æœ€è¿‘ä¿®æ”¹æ—¶é—´å±•ç¤º -F åœ¨å±•ç¤ºæ—¶ï¼Œåœ¨ç›®å½•åååŠ â€/â€œ,åœ¨å¯æ‰§è¡Œæ–‡ä»¶ååŠ â€*â€,åœ¨ç¬¦å·é“¾æ¥ååŠ â€@â€ -S å±•ç¤ºæ—¶æŒ‰å¤§å°æ’åº -d åªå±•ç¤ºåŒ…å«çš„ç›®å½• -R é€’å½’çš„åˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶å’Œç›®å½• â€“hide= ä¸å±•ç¤ºæŒ‡å®šç›®å½•æˆ–æ–‡ä»¶ ç†è§£æ–‡ä»¶æƒé™ åœ¨ä½¿ç”¨Linuxç³»ç»Ÿæ—¶ï¼Œç»å¸¸ä¼šçœ‹åˆ°â€Permission Deniedâ€(æƒé™ä¸è¶³)çš„æç¤ºã€‚æƒé™æ§åˆ¶æ˜¯ä¸ºäº†é¿å…ç”¨æˆ·è®¿é—®å…¶ä»–ç”¨æˆ·çš„ç§æœ‰æ–‡ä»¶å’Œä¿æŠ¤é‡è¦çš„ç³»ç»Ÿæ–‡ä»¶ã€‚åœ¨Linuxä¸­ï¼Œæ¯ä¸ªæ–‡ä»¶å¯¹åº”ä¸€ä¸ª9bitçš„æƒé™ä¿¡æ¯(eg:rwxrwxrwx)ã€‚å…¶ä¸­å‰ä¸‰ä½ä»£è¡¨äº†æ–‡ä»¶æ‹¥æœ‰è€…çš„æƒé™ï¼Œä¸­é—´ä¸‰ä½ä»£è¡¨äº†æ‹¥æœ‰è€…æ‰€åœ¨ç»„çš„æƒé™ï¼Œæœ€åä¸‰ä½ä»£è¡¨äº†å…¶ä»–ç”¨æˆ·çš„æƒé™ã€‚æƒé™ç”±å­—æ¯ä»£è¡¨ï¼Œâ€râ€ä»£è¡¨è¯»æƒé™ï¼Œâ€wâ€ä»£è¡¨å†™æƒé™ï¼Œâ€xâ€ä»£è¡¨æ‰§è¡Œæƒé™ï¼Œå¦‚æœæŸä¸€ä½ä¸æ˜¯å­—æ¯ï¼Œè€Œæ˜¯â€-â€œï¼Œåˆ™ä»£è¡¨æ²¡æœ‰è¯¥ä½æ‰€ä»£è¡¨çš„æƒé™ã€‚ä¸¾ä¸ªä¸¤ä¸ªæ —å­ğŸŒ°ğŸŒ°ï¼Œâ€rw-â€œä»£è¡¨æœ‰è¯»å†™æƒé™ï¼Œæ²¡æœ‰æ‰§è¡Œæƒé™ï¼›â€râ€“â€ä»£è¡¨åªæœ‰è¯»æƒé™ ä½¿ç”¨chmodå‘½ä»¤æ›´æ”¹æƒé™ ä½¿ç”¨æ•°å­— æ–‡ä»¶çš„æ‹¥æœ‰è€…å¯ä»¥æ”¹å˜æ–‡ä»¶çš„æƒé™ï¼Œæ¯ç§æƒé™éƒ½å¯¹åº”äº†ä¸€ä¸ªæ•°å­—ï¼Œè¯»æƒé™rå¯¹åº”4ï¼Œå†™æƒé™wå¯¹åº”2ï¼Œæ‰§è¡Œæƒé™xå¯¹åº”1ã€‚å¯ä»¥é€šè¿‡è®¾ç½®æ•°å€¼æ¥å»ºç«‹æƒé™ã€‚eg: 12345678# è®¾ç½®æƒé™ rwxrwxrwx# chmod 777 filename# è®¾ç½®æƒé™ rwxr-xr-x# chomd 755 filename# è®¾ç½®æƒé™ rw-r--r--# chomd 644 filename# è®¾ç½®æƒé™ ---------# chmod 000 filename ä½¿ç”¨å­—æ¯ åœ¨linuxä¸­ï¼Œè¿˜æœ‰å¦ä¸€ç§æ”¹å˜æƒé™çš„æ–¹å¼ã€‚åœ¨è¿™ç§æ–¹å¼ä¸­ï¼Œâ€+â€å’Œâ€-â€œåˆ†åˆ«ä»£è¡¨æƒé™çš„å¼€å’Œå…³ã€‚å­—æ¯â€uâ€,â€gâ€,â€oâ€å’Œâ€aâ€åˆ†åˆ«ä»£è¡¨æ‹¥æœ‰è€…,ç»„ï¼Œå…¶ä»–ç”¨æˆ·å’Œå…¨éƒ¨ç”¨æˆ·ã€‚å’Œä¸Šä¸€ç§æ–¹å¼ä¸€æ ·â€râ€,â€wâ€,â€xâ€åˆ†åˆ«ä»£è¡¨è¯»ã€å†™å’Œæ‰§è¡Œæƒé™ã€‚egï¼š 12345678910# è®¾ç½®æƒé™ å°†æƒé™rwxrwxrwxæ”¹ä¸ºr-xr-xr-x# chmod a-w filename# è®¾ç½®æƒé™ å°†æƒé™rwxrwxrwxæ”¹ä¸ºrwxrwxrw-# chomd o-x filename# è®¾ç½®æƒé™ å°†æƒé™rwxrwxrwxæ”¹ä¸ºrwx------# chmod go-rwx filename# è®¾ç½®æƒé™ å°†æƒé™---------æ”¹ä¸ºrw-------# chmod u+rw filename# æ›´æ”¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•çš„æƒé™# chmod -R o-w myapps ä½¿ç”¨umaskè®¾ç½®é»˜è®¤æƒé™ æ™®é€šç”¨æˆ·åˆ›å»ºæ–‡ä»¶ é»˜è®¤æƒé™æ˜¯rw-rw-râ€“ï¼Œåˆ›å»ºç›®å½• é»˜è®¤æƒé™æ˜¯rwxrwxr-xã€‚rootç”¨æˆ·åˆ›å»ºæ–‡ä»¶å’Œç›®å½•æƒé™åˆ†åˆ«æ˜¯rw-râ€“râ€“å’Œrwxr-xr-xã€‚è¿™äº›é»˜è®¤å€¼ç”±umaskçš„å€¼å†³å®šï¼Œå¯é€šè¿‡å‘½ä»¤umaskæŸ¥çœ‹å®ƒçš„å€¼ã€‚ä¸chmodæ•ˆæœåˆšå¥½ç›¸åï¼Œumaskè®¾ç½®çš„æ˜¯æƒé™çš„è¡¥ç ï¼Œumaskçš„å€¼æœ‰ä¸‰ä½åˆ†åˆ«å¯¹åº”æ‹¥æœ‰è€…ï¼ŒåŒç»„ç”¨æˆ·å’Œå…¶ä»–ç”¨æˆ·çš„æƒé™ã€‚å¯¹äºæ–‡ä»¶æ¥è¯´ï¼Œæ¯ä¸€ä½çš„æœ€å¤§å€¼æ˜¯6ï¼Œå› ä¸ºç³»ç»Ÿä¸å…è®¸åœ¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶æ—¶å°±èµ‹äºˆæ‰§è¡Œæƒé™ï¼Œéœ€é€šè¿‡chmodè®¾ç½®ï¼›å¯¹äºç›®å½•æ¥è¯´æ¯ä¸€ä½çš„æœ€å¤§å€¼æ˜¯7ã€‚ä¾‹å¦‚umaskå€¼002æ‰€å¯¹åº”çš„æ–‡ä»¶å’Œç›®å½•çš„åˆ›å»ºæƒé™æ˜¯664å’Œ775ã€‚å¯é€šè¿‡umaskå‘½ä»¤æ”¹å˜é»˜è®¤å€¼ã€‚egï¼š 1234# æŸ¥çœ‹é»˜è®¤å€¼$ umask# æ”¹å˜é»˜è®¤å€¼$ umask 022 æ”¹å˜æ–‡ä»¶çš„æ‹¥æœ‰è€… ä½œä¸ºæ™®é€šç”¨æˆ·ï¼Œæ˜¯ä¸èƒ½æ›´æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æ‹¥æœ‰è€…çš„ï¼Œåªæœ‰root user(ç®¡ç†å‘˜æ‰å¯ä»¥)ã€‚eg: 123456# ä¿®æ”¹æ–‡ä»¶çš„æ‹¥æœ‰è€…# chown giraffe filename.text# åŒæ—¶ä¿®æ”¹æ‹¥æœ‰è€…å’Œç»„# chown giraffe:coffee filename.txt# ä¿®æ”¹ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶çš„æ‹¥æœ‰è€…# chown -R giraffe:coffee /mydic ç§»åŠ¨ å¤åˆ¶ åˆ é™¤æ–‡ä»¶ ç§»åŠ¨ã€å¤åˆ¶å’Œåˆ é™¤æ–‡ä»¶çš„å‘½ä»¤å¾ˆç®€å•ã€‚å¦‚æœæƒ³è¦æ”¹å˜æ–‡ä»¶çš„ä½ç½®ï¼Œä½¿ç”¨mvå‘½ä»¤ã€‚å¦‚æœæƒ³è¦å¤åˆ¶æ–‡ä»¶ï¼Œä½¿ç”¨cpå‘½ä»¤ã€‚å¦‚æœæƒ³è¦åˆ é™¤æ–‡ä»¶ï¼Œä½¿ç”¨rmå‘½ä»¤ã€‚è¿™äº›å‘½ä»¤å¯ä»¥ä½¿ç”¨åœ¨å•ä¸€çš„æ–‡ä»¶å’Œç›®å½•ä¸Šï¼Œä¹Ÿå¯ä»¥é€’å½’çš„ä½¿ç”¨åœ¨è®¸å¤šæ–‡ä»¶å’Œç›®å½•ä¸Šã€‚ ç§»åŠ¨æ–‡ä»¶egï¼š 1234# å°†æ–‡ä»¶abcç§»åˆ°homeç›®å½•$ mv abc ~# å°†ç›®å½•mydemoçš„å…¨éƒ¨å†…å®¹ç§»åˆ°ç›®å½•documentä¸­$ mv /home/giraffe/mydemo /home/giraffe/document å¤åˆ¶æ–‡ä»¶egï¼š 123456# å°†æ–‡ä»¶abcå¤åˆ¶åˆ°homeç›®å½•ä¸‹$ cp abc ~# å°†ç›®å½•bash-completion*ä¸‹çš„å†…å®¹å¤åˆ¶åˆ°tmp/aä¸‹$ cp -r /usr/share/bash-completion* /tmp/a# å°†ç›®å½•bash-completion*ä¸‹çš„å†…å®¹å¤åˆ¶åˆ°tmp/aä¸‹ å¹¶ä¸”ä¿ç•™æƒé™$ cp -ra /usr/share/bash-completion* /tmp/a åˆ é™¤æ–‡ä»¶egï¼š 12345678910# åˆ é™¤æ–‡ä»¶abc$ rm abc# åˆ é™¤å½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶$ rm *# åˆ é™¤ä¸€ä¸ªç©ºçš„ç›®å½•$ rmdir /home/giraffe/empty# åˆ é™¤ç›®å½•å’Œä»–åŒ…å«çš„æ‰€æœ‰å†…å®¹$ rm -r /home/giraffe/bigdir# ä¸æç¤ºçš„åˆ é™¤ç›®å½•å’Œå®ƒåŒ…å«çš„æ‰€æœ‰å†…å®¹$ rm -rf /home/giraffe/bigdir","raw":null,"content":null,"categories":[{"name":"linux","slug":"linux","permalink":"http://yemengying.com/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://yemengying.com/tags/linux/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"http://yemengying.com/tags/è¯»ä¹¦ç¬”è®°/"}]},{"title":"è¯»ä¹¦ç¬”è®°-Linux Bible 9th Editionä¹‹ä½¿ç”¨shell","slug":"è¯»ä¹¦ç¬”è®°-Linux-Bible-9th-Edition","date":"2015-11-23T08:23:32.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/11/23/è¯»ä¹¦ç¬”è®°-Linux-Bible-9th-Edition/","link":"","permalink":"http://yemengying.com/2015/11/23/è¯»ä¹¦ç¬”è®°-Linux-Bible-9th-Edition/","excerpt":"å…¶å®ä¹Ÿä¸ç®—è¯»ä¹¦ç¬”è®° ä¸»è¦æ˜¯æƒ³æ•´ç†ä¸€ä¸‹å¸¸ç”¨çš„ä¸€äº›linuxå‘½ä»¤ ç›¸å…³åšå®¢: Linux Bible 9th Editionä¹‹ç©è½¬æ–‡æœ¬æ–‡ä»¶ Linux Bible 9th Editionä¹‹æ–‡ä»¶ç³»ç»Ÿ Linux Bible 9th Editionä¹‹è¿›ç¨‹å¤§æ³•å¥½","keywords":null,"text":"å…¶å®ä¹Ÿä¸ç®—è¯»ä¹¦ç¬”è®° ä¸»è¦æ˜¯æƒ³æ•´ç†ä¸€ä¸‹å¸¸ç”¨çš„ä¸€äº›linuxå‘½ä»¤ ç›¸å…³åšå®¢: Linux Bible 9th Editionä¹‹ç©è½¬æ–‡æœ¬æ–‡ä»¶ Linux Bible 9th Editionä¹‹æ–‡ä»¶ç³»ç»Ÿ Linux Bible 9th Editionä¹‹è¿›ç¨‹å¤§æ³•å¥½ linuxå‘½ä»¤çš„ä¸€äº›è¯­æ³• $æç¤ºç¬¦ä»£è¡¨æ™®é€šç”¨æˆ· #æç¤ºç¬¦ä»£è¡¨rootç”¨æˆ·ã€‚ å¤§å¤šæ•°å‘½ä»¤éƒ½æœ‰è®¸å¤šé€‰é¡¹ é€‰é¡¹é€šå¸¸ç”±å•ä¸€å­—ç¬¦å’Œè¿å­—ç¬¦ç»„æˆ(eg:ls -a),è¿˜æœ‰é€‰é¡¹æ˜¯ç”±ä¸€ä¸ªå•è¯ä»£è¡¨,éœ€åœ¨å•è¯å‰åŠ åŒè¿å­—ç¬¦(eg:date - -help) è·å¾—å½“å‰ç™»å½•ä¼šè¯çš„ä¸€äº›ä¿¡æ¯123$ who $ who am i $ who -uH æŸ¥çœ‹æœåŠ¡å™¨ä¸Šçš„æ—¶é—´12$ date$ date +'%d/%m/%y'(ä»¥10/12/14çš„æ ¼å¼è¾“å‡º) å½“å‰çš„ç›®å½•1$ pwd è·å¾—hostname1$ hostname åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œç›®å½•12$ ls$ ls -l(åˆ—å‡ºè¯¦ç»†ä¿¡æ¯) -a(åˆ—å‡ºåŒ…æ‹¬.å¼€å¤´çš„éšå«æ–‡ä»¶åœ¨å†…çš„æ‰€æœ‰æ–‡ä»¶) -t(æŒ‰æ—¶é—´æ’åº) æŸ¥çœ‹uid gid1$ id LINUXå¦‚ä½•å®šä½å‘½ä»¤ å¯é€šè¿‡echo $PATHå‘½ä»¤æŸ¥çœ‹PATHç¯å¢ƒå˜é‡çš„å€¼ï¼Œå¦‚æœå‘½ä»¤å­˜æ”¾çš„ç›®å½•åŒ…å«åœ¨PATHä¸­ï¼Œå¯ç›´æ¥è¾“å…¥å‘½ä»¤è¿è¡Œã€‚å¦‚æœä¸åŒ…å«åˆ™éœ€ç»™å‡ºå‘½ä»¤çš„ä½ç½®(eg:ç»å¯¹ä½ç½®:/home/chris/scriptx.sh,ç›¸å¯¹ä½ç½®:./scriptx.sh) shellæ£€æŸ¥è¾“å…¥å‘½ä»¤çš„é¡ºåºï¼š1.Aliases(åˆ«å) 2.Reserved word(ä¿ç•™çš„å…³é”®å­—) 3.Function 4.Build-in command(eg:cd/echo/exit/type..) 5.Filesystem 1234#æŸ¥çœ‹ä¸€ä¸ªå‘½ä»¤çš„ä½ç½®$ type bash#æ‰“å°PATHç¯å¢ƒå˜é‡çš„å€¼$ echo $PATH åœ¨æ–‡ä»¶ç³»ç»Ÿä¸­æŸ¥æ‰¾1$ locate ymy æŸ¥çœ‹å†å²è¾“å…¥çš„å‘½ä»¤,ä¿®æ”¹å‘½ä»¤ å¯ä»¥ç”¨historyå‘½ä»¤æŸ¥çœ‹ä¹‹å‰è¾“å…¥è¿‡çš„æ‰€æœ‰å‘½ä»¤,ä¹‹åå¯ä»¥é€šè¿‡!+è¡Œå· è¿è¡ŒæŒ‡å®šä¸€è¡Œçš„å‘½ä»¤ã€‚å‘ä¸Šç®­å¤´(â†‘)å¯æŸ¥çœ‹æœ€è¿‘ä¸€æ¡å‘½ä»¤,ä¸‹é¢æ˜¯ä¿®æ”¹å‘½ä»¤çš„ä¸€äº›å¿«æ·æŒ‰é”®ã€‚ å¿«æ·é”® ä½œç”¨ ctrl+A å°†å…‰æ ‡å®šä½åˆ°å‘½ä»¤çš„æœ€å‰é¢ ctrl+E å°†å…‰æ ‡å®šä½åˆ°å‘½ä»¤çš„æœ€åé¢ ctrl+L æ¸…ç©ºå±å¹•ï¼Œå°†å‘½ä»¤ç½®ä¸ºæœ€ä¸Šé¢ ctrl+Fæˆ– â†’ å°†å…‰æ ‡åç§» ctrl+Bæˆ– â† å°†å…‰æ ‡å‰ç§» alt+F å°†å…‰æ ‡åç§»ä¸€ä¸ªå•è¯ alt+B å°†å…‰æ ‡å‰ç§»ä¸€ä¸ªå•è¯ ctrl+D åˆ é™¤å½“å‰å­—ç¬¦ backspace åˆ é™¤å‰ä¸€ä¸ªå­—ç¬¦ ctrl+T å°†å½“å‰å­—ç¬¦å’Œå‰ä¸€ä¸ªå­—ç¬¦å¯¹æ¢ alt+T å°†å½“å‰å•è¯å’Œå‰ä¸€ä¸ªå•è¯å¯¹æ¢ alt+U å°†å½“å‰å•è¯å˜æˆå¤§å†™ alt+L å°†å½“å‰å•è¯å˜æˆå°å†™ ctrl+K å‰ªåˆ‡ä»å…‰æ ‡ä½ç½®åˆ°æœ€å ctrl+U å‰ªåˆ‡ä»å…‰æ ‡ä½ç½®åˆ°æœ€å‰ ctrl+W å‰ªåˆ‡å‰ä¸€ä¸ªå•è¯ alt+D å‰ªåˆ‡åä¸€ä¸ªå•è¯ ctrl+Y ç²˜è´´æœ€è¿‘å¤åˆ¶çš„å†…å®¹ alt+Y ç²˜è´´æœ€å‰å¤åˆ¶çš„å†…å®¹ tab è¡¥å…¨å‘½ä»¤ è¿æ¥å’Œæ‰©å±•å‘½ä»¤ ç®¡é“ç¬¦å· â€œ|â€å°†å‰ä¸€ä¸ªå‘½ä»¤çš„è¾“å‡ºä½œä¸ºä¸‹ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥eg: 1$ cat /etc/passwd | sort |less å‘½ä»¤åˆ†éš”ç¬¦ â€œ;â€åœ¨ä¸€è¡Œè¯­å¥ä¸­ é¡ºæ¬¡æ‰§è¡Œå„ä¸ªå‘½ä»¤eg: 12#å¯è·å¾—troffå‘½ä»¤çš„æ‰§è¡Œæ—¶é—´$ date; troff -me verylargedocument|lpr ; date åå°è¿›ç¨‹ç¬¦ â€œ&amp;â€å¦‚æœä¸å¸Œæœ›shellä¸€ç›´è¢«ä¸€ä¸ªå‘½ä»¤å ç”¨ç€ï¼Œå¯ä»¥ä½¿ç”¨â€&amp;â€è®©å‘½ä»¤åœ¨åå°è¿è¡Œeg: 1$ troff -me verylargedocument | lpr &amp; ä½¿ç”¨æ•°å­¦è¡¨è¾¾å¼/å‘½ä»¤çš„ç»“æœ â€œ$[]â€/â€œ$()â€å¯ä»¥åœ¨ä¸€ä¸ªå‘½ä»¤ä¸­ä½¿ç”¨æ•°å­¦è¡¨è¾¾å¼æˆ–å¦ä¸€ä¸ªå‘½ä»¤çš„ç»“æœeg: 12$ echo \"I am $[2015 - 1993] years old\"$ echo \"there are $(ls | wc -w) files in this directory\" å˜é‡è°ƒç”¨ç¬¦å· â€œ$â€eg: 1$ echo $USER åˆ›å»ºå’Œä½¿ç”¨åˆ«åä½¿ç”¨aliaså‘½ä»¤ï¼Œå¯ä»¥ç»™ä»»ä½•çš„å‘½ä»¤åŠé€‰é¡¹å–ä¸€ä¸ªåˆ«åeg:123456#ä¸ºå‘½ä»¤pwdå–åˆ«åymy$ alias ymy='pwd'#æŸ¥çœ‹æ‰€æœ‰çš„åˆ«å$ alias#åˆ é™¤åˆ«å$ unalias ymy é€€å‡ºshell1$ exit","raw":null,"content":null,"categories":[{"name":"linux","slug":"linux","permalink":"http://yemengying.com/categories/linux/"}],"tags":[{"name":"linux","slug":"linux","permalink":"http://yemengying.com/tags/linux/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"http://yemengying.com/tags/è¯»ä¹¦ç¬”è®°/"}]},{"title":"EsGiraffe-åˆ©ç”¨æ³¨è§£å’Œåå°„æ‹¼æ¥ElasticsearchæŸ¥è¯¢è¯­å¥","slug":"EsGiraffe-åˆ©ç”¨æ³¨è§£å’Œåå°„æ‹¼æ¥ElasticsearchæŸ¥è¯¢è¯­å¥","date":"2015-11-19T05:56:50.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/11/19/EsGiraffe-åˆ©ç”¨æ³¨è§£å’Œåå°„æ‹¼æ¥ElasticsearchæŸ¥è¯¢è¯­å¥/","link":"","permalink":"http://yemengying.com/2015/11/19/EsGiraffe-åˆ©ç”¨æ³¨è§£å’Œåå°„æ‹¼æ¥ElasticsearchæŸ¥è¯¢è¯­å¥/","excerpt":"EsGiraffe å°é—­å¼€å‘ç»“æŸï¼Œç»ˆäºæœ‰æ—¶é—´å¯ä»¥æ•´ç†ä¸€ä¸‹äº†ã€‚EsGiraffeæ˜¯ä¸€ä¸ªåˆ©ç”¨æ³¨è§£å’Œåå°„å¼€å‘ä¸€å¥—å·¥å…·ç±»ï¼Œç”¨æ¥ç”Ÿæˆelastisearchçš„æŸ¥è¯¢è¯­å¥ã€‚ä¸ºä»€ä¹ˆè¦å«Giraffeå‘¢ï¼Ÿä¸€æ˜¯å› ä¸ºæˆ‘å–œæ¬¢é•¿é¢ˆé¹¿ï¼ŒäºŒæ˜¯å¸Œæœ›å¯ä»¥é€šè¿‡å·¥å…·ç±»æŠŠåƒé•¿é¢ˆé¹¿è„–å­ä¸€æ ·é•¿çš„ä»£ç ç®€åŒ–ä¸€ä¸‹ï¼Œä¸‰æ˜¯å¸Œæœ›è¿™ä¸ªå·¥å…·ç±»å¯ä»¥åƒæ¡¥æ¢ä¸€æ ·è¿æ¥javaå’Œelaticsearchã€‚å®åœ¨ç¼–ä¸ä¸‹å»äº†ï¼Œå…¶å®å°±æ˜¯å› ä¸ºå–œæ¬¢é•¿é¢ˆé¹¿ã€‚ç›®å‰åªé€‚ç”¨äºç®€å•çš„æŸ¥è¯¢ï¼Œä¸è¿‡ä¼šåœ¨å·¥ä½œå­¦ä¹ ä¸­æ…¢æ…¢å®Œå–„çš„ã€‚ç”±äºç›®å‰åœ¨å·¥ä½œä¸­ç”¨åˆ°æœ€å¤šçš„å°±æ˜¯BoolæŸ¥è¯¢ï¼Œæ‰€ä»¥ç›®å‰ç”Ÿæˆçš„æŸ¥è¯¢è¯­å¥æœ€å¤–å±‚å°±æ˜¯boolæŸ¥è¯¢ï¼Œç”Ÿæˆçš„å¤§è‡´çš„æ ·å­å¦‚ä¸‹: &quot;query&quot;: { &quot;bool&quot;: { &quot;must&quot;: [ ... ], &quot;must_not&quot;: [ ... ], &quot;should&quot;: [ ... ] } } gitåœ°å€ï¼š loadStyle(\"/hexo-github/style.css\"); loadStyle(\"/hexo-github/octicons/octicons.css\"); new Badge(\"#badge-container-giraffe0813-EsGiraffe-6afdc51\", \"giraffe0813\", \"EsGiraffe\", \"6afdc51\", false);","keywords":null,"text":"EsGiraffe å°é—­å¼€å‘ç»“æŸï¼Œç»ˆäºæœ‰æ—¶é—´å¯ä»¥æ•´ç†ä¸€ä¸‹äº†ã€‚EsGiraffeæ˜¯ä¸€ä¸ªåˆ©ç”¨æ³¨è§£å’Œåå°„å¼€å‘ä¸€å¥—å·¥å…·ç±»ï¼Œç”¨æ¥ç”Ÿæˆelastisearchçš„æŸ¥è¯¢è¯­å¥ã€‚ä¸ºä»€ä¹ˆè¦å«Giraffeå‘¢ï¼Ÿä¸€æ˜¯å› ä¸ºæˆ‘å–œæ¬¢é•¿é¢ˆé¹¿ï¼ŒäºŒæ˜¯å¸Œæœ›å¯ä»¥é€šè¿‡å·¥å…·ç±»æŠŠåƒé•¿é¢ˆé¹¿è„–å­ä¸€æ ·é•¿çš„ä»£ç ç®€åŒ–ä¸€ä¸‹ï¼Œä¸‰æ˜¯å¸Œæœ›è¿™ä¸ªå·¥å…·ç±»å¯ä»¥åƒæ¡¥æ¢ä¸€æ ·è¿æ¥javaå’Œelaticsearchã€‚å®åœ¨ç¼–ä¸ä¸‹å»äº†ï¼Œå…¶å®å°±æ˜¯å› ä¸ºå–œæ¬¢é•¿é¢ˆé¹¿ã€‚ç›®å‰åªé€‚ç”¨äºç®€å•çš„æŸ¥è¯¢ï¼Œä¸è¿‡ä¼šåœ¨å·¥ä½œå­¦ä¹ ä¸­æ…¢æ…¢å®Œå–„çš„ã€‚ç”±äºç›®å‰åœ¨å·¥ä½œä¸­ç”¨åˆ°æœ€å¤šçš„å°±æ˜¯BoolæŸ¥è¯¢ï¼Œæ‰€ä»¥ç›®å‰ç”Ÿæˆçš„æŸ¥è¯¢è¯­å¥æœ€å¤–å±‚å°±æ˜¯boolæŸ¥è¯¢ï¼Œç”Ÿæˆçš„å¤§è‡´çš„æ ·å­å¦‚ä¸‹: &quot;query&quot;: { &quot;bool&quot;: { &quot;must&quot;: [ ... ], &quot;must_not&quot;: [ ... ], &quot;should&quot;: [ ... ] } } gitåœ°å€ï¼š loadStyle(\"/hexo-github/style.css\"); loadStyle(\"/hexo-github/octicons/octicons.css\"); new Badge(\"#badge-container-giraffe0813-EsGiraffe-6afdc51\", \"giraffe0813\", \"EsGiraffe\", \"6afdc51\", false); å¸¸è§çš„å·¥ä½œéœ€æ±‚åœ¨æˆ‘å·¥ä½œæ¯”è¾ƒå¸¸è§çš„æœç´¢éœ€æ±‚å°±æ˜¯å¯¹å¤–æä¾›æœç´¢çš„æ¥å£ã€‚ä¼šæŒ‰ç…§æœç´¢å¼•æ“ä¸­çš„å­—æ®µå®šä¹‰ä¸€ä¸ªå¯¹åº”çš„modelï¼Œç„¶åè¿™äº›å­—æ®µçš„å€¼å¦‚æœä¸ºNullï¼Œå°±ä»£è¡¨è°ƒç”¨æ–¹ä¸æƒ³å¯¹è¿™ä¸ªå­—æ®µè¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœä¸ä¸ºNullä»£è¡¨éœ€è¦å¯¹è¿™ä¸ªå­—æ®µè¿›è¡ŒæŸ¥è¯¢ã€‚è€Œä¸”è¿˜ä¼šæå‰åœ¨APIæ–‡æ¡£ä¸­å®šä¹‰å¥½æŸ¥è¯¢çš„ç±»å‹æ˜¯mustã€must_notè¿˜æ˜¯should æœªä½¿ç”¨å·¥å…·ç±»çš„ä»£ç Demoå‡è®¾æœ‰ä¸€ä¸ªå’Œè®¢å•æœ‰å…³çš„ç´¢å¼•ï¼Œéœ€è¦å¯¹è®¢å•çš„ä¸€ç³»åˆ—å±æ€§è¿›è¡ŒæŸ¥è¯¢ å…¶ä¸­userNameå’ŒorderModeæ˜¯shouldæŸ¥è¯¢ å…¶ä½™éƒ½æ˜¯mustæŸ¥è¯¢modelï¼š 1234567891011121314151617181920212223public class OrderModel &#123; private String userName; private Integer restaurantId; private Integer orderMode; private String userPhone; private Integer comeFrom; private String restaurantName; private String createdAtBegin; private String createdAtEnd; private Integer offset = 0; private Integer limit = 10; //çœç•¥getterå’Œsetter &#125; æŸ¥è¯¢æ–¹æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142public SearchService implements ISearchService&#123; public String searchOrder(SearchOrderModel search) throws IllegalAccessException&#123; BoolQueryBuilder baseQuery = QueryBuilders.boolQuery(); if(search.getUserName() != null)&#123; baseQuery.should(QueryBuilders.termQuery(\"user_name\", search.getUserName())); &#125; if(search.getRestaurantId() != null)&#123; baseQuery.must(QueryBuilders.termQuery(\"restaurant_id\", search.getRestaurantId())); &#125; if(search.getOrderMode() != null)&#123; baseQuery.should(QueryBuilders.termQuery(\"order_mode\", search.getOrderMode())); &#125; if(search.getUserPhone() != null)&#123; baseQuery.must(QueryBuilders.termQuery(\"user_phone\", search.getUserPhone())); &#125; if(search.getComeFrom() != null)&#123; baseQuery.must(QueryBuilders.termQuery(\"come_from\", search.getComeFrom())); &#125; if(search.getRestaurantName() != null)&#123; baseQuery.must(QueryBuilders.queryStringQuery(search.getRestaurantName()).defaultField(\"restaurant_name\")); &#125; if(search.getCreatedAtBegin() != null)&#123; baseQuery.must(QueryBuilders.rangeQuery(\"created_at\").gte(search.getCreatedAtBegin())); &#125; if(search.getCreatedAtEnd() != null)&#123; baseQuery.must(QueryBuilders.rangeQuery(\"created_at\").lte(search.getCreatedAtBegin())); &#125; log.info(\"æŸ¥è¯¢è¯­å¥:&#123;&#125;\",baseQuery.toString()); SearchResponse response = client.prepareSearch(\"index1\") .setTypes(\"type1\") .setSearchType(SearchType.DFS_QUERY_THEN_FETCH) .setQuery(baseQuery) .setFrom(search.getOffset()).setSize(search.getLimit()).setExplain(true) .execute() .actionGet(); return response.toString(); &#125;&#125; ä¸‹é¢æ˜¯é’ˆå¯¹é¤å…åç§°ï¼Œç”¨æˆ·åå’Œæ¥æºåŒæ—¶æŸ¥è¯¢æ—¶ï¼Œæ‰“å°å‡ºæ¥çš„æ‹¼æ¥çš„æŸ¥è¯¢è¯­å¥: 123456789101112131415161718&#123; \"bool\" : &#123; \"must\" : [ &#123; \"term\" : &#123; \"come_from\" : 1 &#125; &#125;, &#123; \"query_string\" : &#123; \"query\" : \"æµ‹è¯•é¤å…\", \"default_field\" : \"restaurant_name\" &#125; &#125; ], \"should\" : &#123; \"term\" : &#123; \"user_name\" : \"123123123\" &#125; &#125; &#125; &#125; å¯æ˜¯ä¸Šé¢åªæ˜¯ç¼©å‡ç‰ˆçš„è®¢å•modelï¼Œä¸€ä¸ªè®¢å•çš„å±æ€§æœ‰20å¤šä¸ª æ‰€ä»¥æ¯ä¸ªå±æ€§éƒ½åˆ¤æ–­æ˜¯å¦ä¸ºnullï¼Œä»£ç å°±å¤ªä¸æ¼‚äº®äº†,è€Œä¸”å¯è¯»æ€§å·®ï¼Œä¸æ˜“ç»´æŠ¤ï¼Œæ‰€ä»¥å°±æƒ³é€šè¿‡æ³¨è§£å’Œåå°„æ¥ç²¾ç®€ä»£ç ã€‚ EsGiraffeçš„ä¸»è¦å†…å®¹EsGiraffeä¸»è¦æ˜¯è‡ªå®šä¹‰äº†ä¸€äº›æ³¨è§£ï¼Œå°†ä¸€äº›è¯¸å¦‚modelå±æ€§å¯¹åº”çš„æœç´¢å¼•æ“çš„å­—æ®µï¼ŒæŸ¥è¯¢çš„ç±»å‹ï¼Œè¦æŸ¥è¯¢çš„indexåï¼Œè¦æŸ¥è¯¢çš„documentåç”¨æ³¨è§£æ ‡æ³¨åœ¨modelç±»ä¸Šï¼Œç„¶ååœ¨å·¥å…·ç±»ä¸­åˆ©ç”¨åå°„è·å–æ³¨è§£çš„å€¼ æ‹¼æ¥æŸ¥è¯¢è¯­å¥ã€‚ä¸‹é¢æ˜¯å‡ ä¸ªæ¯”è¾ƒé‡è¦çš„æ³¨è§£: Indexæ³¨è§£ DocumentTypeæ³¨è§£ åªèƒ½åœ¨ç±»ä¸Šä½¿ç”¨ Indexä»£è¡¨è¦åœ¨å“ªä¸ªç´¢å¼•ä¸­æŸ¥è¯¢ï¼Œ Documentä»£è¡¨è¦æŸ¥è¯¢çš„æ–‡æ¡£ å¯ä»¥æŒ‡å®šå¤šä¸ªç´¢å¼•æˆ–æ–‡æ¡£ç”¨â€,â€åˆ†å‰² ä¾‹å­: 1234@Index(\"index\")@DocumentType(\"document1\")public class model&#123;&#125; EsFieldæ³¨è§£ åœ¨ç±»çš„å±æ€§ä¸Šä½¿ç”¨ å€¼ä¸ºè¯¥å±æ€§å¯¹åº”çš„ç´¢å¼•å­—æ®µå å¦‚æœvalueä¸ºç©ºï¼Œé‚£ä¹ˆå¯¹åº”çš„ç´¢å¼•åå°±æ˜¯è¯¥å±æ€§åã€‚è¿™ä¸ªæ³¨è§£ä¸»è¦æ˜¯è€ƒè™‘åˆ°åœ¨Javaä¹ æƒ¯é©¼å³°å¼çš„å‘½åï¼Œè€Œæœç´¢å¼•æ“ä¸­å¾€å¾€æ˜¯ä¸‹åˆ’çº¿ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªæ³¨è§£å°†ä»–ä»¬å¯¹åº”èµ·æ¥ã€‚ ä¾‹å­: 1234567@Index(\"index\")@DocumentType(\"document1\")public class model&#123; @EsField(\"come_from\") private Integer comeFrom;&#125; ä¸è¿‡ï¼Œè¿™ä¸¤ä¸ªæ³¨è§£åªé€‚ç”¨äºåœ¨æŸ¥è¯¢å‰å°±ç¡®å®šè¦æŸ¥è¯¢çš„ç´¢å¼•å’Œæ–‡æ¡£æ—¶ä½¿ç”¨ã€‚å¦‚æœè¦æ ¹æ®æŸ¥è¯¢çš„å†…å®¹æ‰èƒ½ç¡®å®šè¦æŸ¥è¯¢çš„æ–‡æ¡£ï¼Œç›®å‰æ²¡æœ‰æƒ³åˆ°ä»€ä¹ˆå¥½çš„è§£å†³åŠæ³•ï¼Œè¿™ç§æƒ…å†µåªèƒ½ä¸ç”¨Indexå’ŒDocumentTypeæ³¨è§£äº†ã€‚æ¯”å¦‚åšæ´»åŠ¨æŸ¥è¯¢æ—¶ï¼Œæ´»åŠ¨ç´¢å¼•åˆ°æœç´¢å¼•æ“ä¸­æ˜¯æŒ‰ç…§æ´»åŠ¨æ‰€å±çš„åŸå¸‚å­˜å‚¨åˆ°ä¸åŒçš„æ–‡æ¡£ï¼Œä¸¾ä¸ªæ —å­ğŸŒ°ï¼Œå¦‚æœæ´»åŠ¨1çš„åŸå¸‚idæ˜¯1,é‚£ä¹ˆæ´»åŠ¨1å°±å­˜åœ¨åœ¨æ–‡æ¡£activity_1,å¦‚æœæ´»åŠ¨2çš„åŸå¸‚idæ˜¯3ï¼Œé‚£ä¹ˆæ´»åŠ¨2å°±å­˜åœ¨åœ¨æ–‡æ¡£activity_3ä¸­ï¼Œè¿™ç§æƒ…å†µå°±ä¸èƒ½é é€šè¿‡æ³¨è§£çš„æ–¹å¼è·å¾—æŸ¥è¯¢çš„æ–‡æ¡£äº†ã€‚ Boolæ³¨è§£ æœ€é‡è¦çš„æ³¨è§£ï¼Œé‡Œé¢åŒ…å«5ä¸ªå…ƒç´ value,type,escape,fuzziness,prefixã€‚å…¶ä¸­valueæ˜¯MatchType(æšä¸¾ç±»)ç±»å‹ï¼Œä»£è¡¨äº†è¯¥BoolæŸ¥è¯¢æ˜¯MUSTï¼ŒMUST_NOTè¿˜æ˜¯SHOULDï¼Œé»˜è®¤æ˜¯MUSTã€‚typeçš„å€¼æ˜¯EsSearchType(æšä¸¾ç±»)ç±»å‹ï¼Œä»£è¡¨å¯¹è¯¥å­—æ®µé‡‡ç”¨ä»€ä¹ˆç±»å‹çš„æŸ¥è¯¢ã€‚é»˜è®¤å€¼æ˜¯TERMSï¼Œæ”¯æŒçš„å…¶ä»–ç±»å‹è¿˜æœ‰TERM,RANGE_FROM, RANGE_TO, RANGE_GT,RANGE_LT, RANGE_GTE, RANGE_LTE, FUZZY, SHOULD_TERM, QUERY_STRING, MATCHã€‚escapeæ˜¯å¸ƒå°”ç±»å‹çš„ï¼Œä»£è¡¨æ˜¯å¦éœ€è¦è¿›è¡Œç‰¹æ®Šå­—ç¬¦(eg: !$()ç­‰)çš„è½¬æ¢ï¼Œé»˜è®¤å€¼æ˜¯falseã€‚fuzzinesså’Œprefixæ˜¯åœ¨æ–°ç‰ˆæœ¬ä¸­é’ˆå¯¹type=EsSearchType.FUZZYåšçš„æ‰©å±•è€Œæ–°å¢çš„å…ƒç´ ã€‚åˆ†åˆ«ä»£è¡¨Fuzzy Queryä¸­çš„fuzzinesså’Œprefix_length,è¿™ä¸¤ä¸ªå‚æ•°çš„æ„æ€å¯ä»¥åˆ°å®˜æ–¹æ–‡æ¡£ä¸Šçœ‹ï¼Œfuzzinessçš„å€¼åªèƒ½ä¸º[0,1,2],å¦åˆ™ä¼šæŠ¥é”™â€œorg.elasticsearch.ElasticsearchIllegalArgumentException: Valid edit distances are [0, 1, 2]â€ï¼Œä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆçŸ¥é“ã€‚è¦æ³¨æ„çš„æ˜¯è¿™ä¸¤ä¸ªå…ƒç´ åªæœ‰åœ¨type=EsSearchType.FUZZYæ—¶æ‰æœ‰æ•ˆ ä¾‹å­ï¼š 123456789101112@Index(\"index\")@DocumentType(\"document1\")public class model&#123; @EsField(\"come_from\") @Bool(type = EsSearchType.TERM) private Integer comeFrom; @EsField(\"created_at\") @Bool(type = EsSearchType.RANGE_GTE) private String createdAtBegin;&#125; ä¸Šé¢çš„æ³¨è§£ä»£è¡¨çš„æŸ¥è¯¢è¯­å¥æ˜¯ 1234567891011121314151617&#123; \"bool\" : &#123; \"must\" : [ &#123; \"term\" : &#123; \"come_from\" : 1 &#125; &#125;, &#123; \"range\" : &#123; \"created_at\" : &#123; \"from\" : \"2015-02-03\", \"to\" : null, \"include_lower\" : true, \"include_upper\" : true &#125; &#125; &#125; ] &#125; &#125; From,Size,Sortæ³¨è§£ è¿™ä¸‰ä¸ªæ³¨è§£ä¹Ÿæ˜¯ç”¨åˆ°ç±»çš„å±æ€§ä¸Šçš„ï¼Œå¦‚æœä¸€ä¸ªå±æ€§ä¸Šæ ‡æœ‰Fromæ³¨è§£ï¼Œä»£è¡¨è¿™ä¸ªå­—æ®µçš„å€¼æ˜¯æŸ¥è¯¢åˆ†é¡µçš„èµ·å§‹ä½ç½®ï¼›å¦‚æœä¸€ä¸ªå±æ€§ä¸Šæ ‡æœ‰Sizeæ³¨è§£ï¼Œä»£è¡¨è¿™ä¸ªå­—æ®µçš„å€¼æ˜¯åˆ†é¡µçš„é•¿åº¦ï¼›å¦‚æœä¸€ä¸ªå±æ€§ä¸Šæ ‡æœ‰Sortæ³¨è§£ï¼Œä»£è¡¨æŸ¥è¯¢ç»“æœæŒ‰è¯¥å­—æ®µæ’åºï¼ŒSortçš„å€¼æœ‰SortType.ASCå’ŒSortType.DESCä¸¤ç§ã€‚ ElasticBaseSearchä¸­ä¸¤ä¸ªå·¥å…·æ–¹æ³• getIndexAndTypeå’ŒgetQueryBuilder å·²ç»åœ¨ç±»å’Œå±æ€§æ·»åŠ äº†æ³¨è§£ï¼Œé‚£ä¹ˆå°±éœ€è¦å†™ä¸¤ä¸ªæ–¹æ³•åˆ†åˆ«é€šè¿‡åå°„è·å–ç±»å’Œå±æ€§ä¸Šçš„å€¼ æ¥æ‹¼æ¥å¯¹åº”çš„æŸ¥è¯¢è¯­å¥ã€‚å…¶ä¸­getQueryBuilderæ˜¯æ ¹æ®å±æ€§ä¸Šçš„æ³¨è§£æ‹¼è£…æŸ¥è¯¢è¯­å¥å¹¶è¿”å›ä¸€ä¸ªQueryBuilderå¯¹è±¡ï¼ŒgetIndexAndTypeæ˜¯æ ¹æ®æ³¨è§£è·å¾—è¦æŸ¥è¯¢çš„ç´¢å¼•ï¼Œæ–‡æ¡£ç­‰ä¿¡æ¯ï¼Œå¹¶è¿”å›ä¸€ä¸ªSearchRequestBuilderå¯¹è±¡ã€‚ ä½¿ç”¨EsGiraffeç®€åŒ–ä»£ç  ä¸‹é¢æ˜¯ä½¿ç”¨EsGiraffeç®€åŒ–åçš„ä»£ç  æŸ¥è¯¢modelç±» 12345678910111213141516171819202122232425262728293031323334353637383940414243@Index(\"index1\")@DocumentType(\"type1\")public class OrderModel &#123; @EsField(\"user_name\") @Bool(type = EsSearchType.QUERY_STRING, value = MatchType.SHOULD, escape=true) private String userName; @EsField(\"restaurant_id\") @Bool(type = EsSearchType.TERM) private Integer restaurantId; @EsField(\"order_mode\") @Bool(type = EsSearchType.TERM) private Integer orderMode; @EsField(\"usr_phone\") @Bool(type = EsSearchType.TERM) private String userPhone; @EsField(\"come_from\") @Bool(type = EsSearchType.TERM) private Integer comeFrom; @EsField(\"restaurant_name\") @Bool(type = EsSearchType.QUERY_STRING,escape=true) private String restaurantName; @EsField(\"created_at\") @Bool(type = EsSearchType.RANGE_GTE) private String createdAtBegin; @EsField(\"created_at\") @Bool(type = EsSearchType.RANGE_LTE) private String createdAtEnd; @From private Integer offset = 0; @Size private Integer limit = 10; //çœç•¥getterå’Œsetter &#125; æ¥å£ç±»ï¼Œä¹Ÿæ— éœ€å†™å¤§é‡çš„ä¸šåŠ¡é€»è¾‘ï¼Œåªéœ€è¦è°ƒç”¨ä¸¤ä¸ªå·¥å…·æ–¹æ³•å³å¯ 12345678910111213141516public String searchOrder(SearchOrderModel search) throws IllegalAccessException &#123; log.info(\"æŸ¥è¯¢å‚æ•°:&#123;&#125;\", search.toString()); QueryBuilder baseQuery = ElasticBaseSearch.getInstance().getQueryBuilder(search); if(baseQuery != null)&#123; log.info(baseQuery.toString()); SearchResponse response = ElasticBaseSearch.getInstance().getIndexAndType(client, search).setQuery(baseQuery).execute().actionGet(); log.info(response.toString()); return response.toString(); &#125; return \"\";&#125; ä½¿ç”¨äº†EsGiraffeä¹‹åï¼Œå¤§å¤§ç®€åŒ–äº†æŸ¥è¯¢æ¥å£çš„ä»£ç ï¼Œæ— éœ€æŒ¨ä¸ªå±æ€§åˆ¤æ–­æ˜¯å¦ä¸ºnullã€‚è€Œä¸”åœ¨modelç±»ä¸Šä½¿ç”¨æ³¨è§£ï¼Œä½¿å¾—ç¨‹åºå˜å¾—æ›´åŠ å¯è¯»ï¼Œæ¯ä¸ªå±æ€§å¯¹åº”æœç´¢å¼•æ“ä¸­å“ªä¸ªå­—æ®µï¼Œé‡‡ç”¨å“ªç§æŸ¥è¯¢æ–¹å¼ä¸€ç›®äº†ç„¶ã€‚ä¸‹é¢æ˜¯ä½¿ç”¨EsGiraffeä¹‹åï¼Œå¯¹é¤å…åç§°ï¼Œç”¨æˆ·åå’Œæ¥æºæŸ¥è¯¢æ—¶æ‰“å°çš„æŸ¥è¯¢è¯­å¥ï¼Œå’Œä¸ç”¨æ³¨è§£ç”Ÿæˆçš„æ˜¯ä¸€æ ·çš„ã€‚ 123456789101112131415161718&#123; \"bool\" : &#123; \"must\" : [ &#123; \"term\" : &#123; \"come_from\" : 1 &#125; &#125;, &#123; \"query_string\" : &#123; \"query\" : \"æµ‹è¯•é¤å…\", \"default_field\" : \"restaurant_name\" &#125; &#125; ], \"should\" : &#123; \"term\" : &#123; \"user_name\" : \"123123123\" &#125; &#125; &#125; &#125;","raw":null,"content":null,"categories":[{"name":"elasticsearch","slug":"elasticsearch","permalink":"http://yemengying.com/categories/elasticsearch/"}],"tags":[{"name":"elasticsearch","slug":"elasticsearch","permalink":"http://yemengying.com/tags/elasticsearch/"},{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"annotation","slug":"annotation","permalink":"http://yemengying.com/tags/annotation/"},{"name":"reflect","slug":"reflect","permalink":"http://yemengying.com/tags/reflect/"}]},{"title":"è¯»ä¹¦ç¬”è®°---æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº1","slug":"è¯»ä¹¦ç¬”è®°-æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº1","date":"2015-11-12T09:23:23.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/11/12/è¯»ä¹¦ç¬”è®°-æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº1/","link":"","permalink":"http://yemengying.com/2015/11/12/è¯»ä¹¦ç¬”è®°-æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœº1/","excerpt":"","keywords":null,"text":"æœ€è¿‘çœ‹ä¹¦æ€»æ˜¯çœ‹ä¸è¿›å»ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚å†³å®šè¾¹çœ‹è¾¹ç”»ç”»å›¾ï¼Œåšä¸ªæ€»ç»“ã€‚ä¸‹é¢æ˜¯æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºè¿™æœ¬ä¹¦çš„ç¬¬äºŒï¼Œä¸‰ç« çš„æ€»ç»“ã€‚","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"è¯»ä¹¦ç¬”è®°","slug":"è¯»ä¹¦ç¬”è®°","permalink":"http://yemengying.com/tags/è¯»ä¹¦ç¬”è®°/"}]},{"title":"ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap","slug":"ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap","date":"2015-11-06T05:20:37.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/11/06/ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap/","link":"","permalink":"http://yemengying.com/2015/11/06/ã€è¯‘ã€‘å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMap/","excerpt":"åŸæ–‡æ¥è‡ªä¸€ä¸ªjavaå¤§ç‰›çš„æŠ€æœ¯åšå®¢ åœ°å€http://javarevisited.blogspot.com/2013/02/concurrenthashmap-in-java-example-tutorial-working.html åšå®¢è®²è§£äº†å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMapã€‚é©¬ä¸Šè¦å°é—­å¼€å‘10å¤©ï¼Œè¿ä¸Š15å¤©ç­ï¼ŒçœŸé…¸çˆ½ã€‚ä¸‹é¢æ˜¯åŸæ–‡çš„ç¿»è¯‘ï¼š","keywords":null,"text":"åŸæ–‡æ¥è‡ªä¸€ä¸ªjavaå¤§ç‰›çš„æŠ€æœ¯åšå®¢ åœ°å€http://javarevisited.blogspot.com/2013/02/concurrenthashmap-in-java-example-tutorial-working.html åšå®¢è®²è§£äº†å¦‚ä½•åœ¨javaä¸­ä½¿ç”¨ConcurrentHashMapã€‚é©¬ä¸Šè¦å°é—­å¼€å‘10å¤©ï¼Œè¿ä¸Š15å¤©ç­ï¼ŒçœŸé…¸çˆ½ã€‚ä¸‹é¢æ˜¯åŸæ–‡çš„ç¿»è¯‘ï¼š ConcurrentHashMap(ç®€ç§°CHM)æ˜¯åœ¨Java 1.5ä½œä¸ºHashtableçš„æ›¿ä»£é€‰æ‹©æ–°å¼•å…¥çš„ï¼Œæ˜¯concurrentåŒ…çš„é‡è¦æˆå‘˜ã€‚åœ¨Java 1.5ä¹‹å‰ï¼Œå¦‚æœæƒ³è¦å®ç°ä¸€ä¸ªå¯ä»¥åœ¨å¤šçº¿ç¨‹å’Œå¹¶å‘çš„ç¨‹åºä¸­å®‰å…¨ä½¿ç”¨çš„Map,åªèƒ½åœ¨HashTableå’Œsynchronized Mapä¸­é€‰æ‹©ï¼Œå› ä¸ºHashMapå¹¶ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†å†å¼•å…¥äº†CHMä¹‹åï¼Œæˆ‘ä»¬æœ‰äº†æ›´å¥½çš„é€‰æ‹©ã€‚CHMä¸ä½†æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œä¸”æ¯”HashTableå’ŒsynchronizedMapçš„æ€§èƒ½è¦å¥½ã€‚ç›¸å¯¹äºHashTableå’ŒsynchronizedMapé”ä½äº†æ•´ä¸ªMapï¼ŒCHMåªé”ä½éƒ¨åˆ†Mapã€‚CHMå…è®¸å¹¶å‘çš„è¯»æ“ä½œï¼ŒåŒæ—¶é€šè¿‡åŒæ­¥é”åœ¨å†™æ“ä½œæ—¶ä¿æŒæ•°æ®å®Œæ•´æ€§ã€‚æˆ‘ä»¬å·²ç»åœ¨Top 5 Java Concurrent Collections from JDK 5 and 6ä¸­å­¦ä¹ äº†CHMçš„åŸºç¡€çŸ¥è¯†ï¼Œåœ¨è¿™ç¯‡åšå®¢ä¸­æˆ‘å°†ä»‹ç»ä»¥ä¸‹å‡ ç‚¹ï¼š CHMåœ¨Javaä¸­å¦‚ä½•å®ç°çš„ ä»€ä¹ˆæƒ…å†µä¸‹åº”è¯¥ä½¿ç”¨CHM åœ¨Javaä¸­ä½¿ç”¨CHMçš„ä¾‹å­ CHMçš„ä¸€äº›é‡è¦ç‰¹æ€§ Javaä¸­ConcurrentHashMapçš„å®ç°CHMå¼•å…¥äº†åˆ†å‰²ï¼Œå¹¶æä¾›äº†HashTableæ”¯æŒçš„æ‰€æœ‰çš„åŠŸèƒ½ã€‚åœ¨CHMä¸­ï¼Œæ”¯æŒå¤šçº¿ç¨‹å¯¹Mapåšè¯»æ“ä½œï¼Œå¹¶ä¸”ä¸éœ€è¦ä»»ä½•çš„blockingã€‚è¿™å¾—ç›ŠäºCHMå°†Mapåˆ†å‰²æˆäº†ä¸åŒçš„éƒ¨åˆ†ï¼Œåœ¨æ‰§è¡Œæ›´æ–°æ“ä½œæ—¶åªé”ä½ä¸€éƒ¨åˆ†ã€‚æ ¹æ®é»˜è®¤çš„å¹¶å‘çº§åˆ«(concurrency level)ï¼ŒMapè¢«åˆ†å‰²æˆ16ä¸ªéƒ¨åˆ†ï¼Œå¹¶ä¸”ç”±ä¸åŒçš„é”æ§åˆ¶ã€‚è¿™æ„å‘³ç€ï¼ŒåŒæ—¶æœ€å¤šå¯ä»¥æœ‰16ä¸ªå†™çº¿ç¨‹æ“ä½œMapã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œç”±åªèƒ½ä¸€ä¸ªçº¿ç¨‹è¿›å…¥å˜æˆåŒæ—¶å¯ç”±16ä¸ªå†™çº¿ç¨‹åŒæ—¶è¿›å…¥(è¯»çº¿ç¨‹å‡ ä¹ä¸å—é™åˆ¶)ï¼Œæ€§èƒ½çš„æå‡æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚ä½†ç”±äºä¸€äº›æ›´æ–°æ“ä½œï¼Œå¦‚put(),remove(),putAll(),clear()åªé”ä½æ“ä½œçš„éƒ¨åˆ†ï¼Œæ‰€ä»¥åœ¨æ£€ç´¢æ“ä½œä¸èƒ½ä¿è¯è¿”å›çš„æ˜¯æœ€æ–°çš„ç»“æœã€‚ å¦ä¸€ä¸ªé‡è¦ç‚¹æ˜¯åœ¨è¿­ä»£éå†CHMæ—¶ï¼ŒkeySetè¿”å›çš„iteratoræ˜¯å¼±ä¸€è‡´å’Œfail-safeçš„ï¼Œå¯èƒ½ä¸ä¼šè¿”å›æŸäº›æœ€è¿‘çš„æ”¹å˜ï¼Œå¹¶ä¸”åœ¨éå†è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå·²ç»éå†çš„æ•°ç»„ä¸Šçš„å†…å®¹å˜åŒ–äº†ï¼Œä¸ä¼šæŠ›å‡ºConcurrentModificationExceptoinçš„å¼‚å¸¸ã€‚ CHMé»˜è®¤çš„å¹¶å‘çº§åˆ«æ˜¯16ï¼Œä½†å¯ä»¥åœ¨åˆ›å»ºCHMæ—¶é€šè¿‡æ„é€ å‡½æ•°æ”¹å˜ã€‚æ¯«æ— ç–‘é—®ï¼Œå¹¶å‘çº§åˆ«ä»£è¡¨ç€å¹¶å‘æ‰§è¡Œæ›´æ–°æ“ä½œçš„æ•°ç›®ï¼Œæ‰€ä»¥å¦‚æœåªæœ‰å¾ˆå°‘çš„çº¿ç¨‹ä¼šæ›´æ–°Mapï¼Œé‚£ä¹ˆå»ºè®®è®¾ç½®ä¸€ä¸ªä½çš„å¹¶å‘çº§åˆ«ã€‚å¦å¤–ï¼ŒCHMè¿˜ä½¿ç”¨äº†ReentrantLockæ¥å¯¹segmentsåŠ é”ã€‚ Javaä¸­ConcurrentHashMap putifAbsentæ–¹æ³•çš„ä¾‹å­å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¸Œæœ›åœ¨å…ƒç´ ä¸å­˜åœ¨æ—¶æ’å…¥å…ƒç´ ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¼šåƒä¸‹é¢é‚£æ ·å†™ä»£ç  1234567synchronized(map)&#123; if (map.get(key) == null)&#123; return map.put(key, value); &#125; else&#123; return map.get(key); &#125;&#125; ä¸Šé¢è¿™æ®µä»£ç åœ¨HashMapå’ŒHashTableä¸­æ˜¯å¥½ç”¨çš„ï¼Œä½†åœ¨CHMä¸­æ˜¯æœ‰å‡ºé”™çš„é£é™©çš„ã€‚è¿™æ˜¯å› ä¸ºCHMåœ¨putæ“ä½œæ—¶å¹¶æ²¡æœ‰å¯¹æ•´ä¸ªMapåŠ é”ï¼Œæ‰€ä»¥ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨put(k,v)çš„æ—¶å€™ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨get(k)ä¼šå¾—åˆ°nullï¼Œè¿™å°±ä¼šé€ æˆä¸€ä¸ªçº¿ç¨‹putçš„å€¼ä¼šè¢«å¦ä¸€ä¸ªçº¿ç¨‹putçš„å€¼æ‰€è¦†ç›–ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥å°†ä»£ç å°è£…åˆ°synchronizedä»£ç å—ä¸­ï¼Œè¿™æ ·è™½ç„¶çº¿ç¨‹å®‰å…¨äº†ï¼Œä½†ä¼šä½¿ä½ çš„ä»£ç å˜æˆäº†å•çº¿ç¨‹ã€‚CHMæä¾›çš„putIfAbsent(key,value)æ–¹æ³•åŸå­æ€§çš„å®ç°äº†åŒæ ·çš„åŠŸèƒ½ï¼ŒåŒæ—¶é¿å…äº†ä¸Šé¢çš„çº¿ç¨‹ç«äº‰çš„é£é™©ã€‚ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ConcurrentHashMapCHMé€‚ç”¨äºè¯»è€…æ•°é‡è¶…è¿‡å†™è€…æ—¶ï¼Œå½“å†™è€…æ•°é‡å¤§äºç­‰äºè¯»è€…æ—¶ï¼ŒCHMçš„æ€§èƒ½æ˜¯ä½äºHashtableå’Œsynchronized Mapçš„ã€‚è¿™æ˜¯å› ä¸ºå½“é”ä½äº†æ•´ä¸ªMapæ—¶ï¼Œè¯»æ“ä½œè¦ç­‰å¾…å¯¹åŒä¸€éƒ¨åˆ†æ‰§è¡Œå†™æ“ä½œçš„çº¿ç¨‹ç»“æŸã€‚CHMé€‚ç”¨äºåšcache,åœ¨ç¨‹åºå¯åŠ¨æ—¶åˆå§‹åŒ–ï¼Œä¹‹åå¯ä»¥è¢«å¤šä¸ªè¯·æ±‚çº¿ç¨‹è®¿é—®ã€‚æ­£å¦‚Javadocè¯´æ˜çš„é‚£æ ·ï¼ŒCHMæ˜¯HashTableä¸€ä¸ªå¾ˆå¥½çš„æ›¿ä»£ï¼Œä½†è¦è®°ä½ï¼ŒCHMçš„æ¯”HashTableçš„åŒæ­¥æ€§ç¨å¼±ã€‚ æ€»ç»“ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ä»€ä¹ˆæ˜¯ConcurrentHashMapå’Œä»€ä¹ˆæ—¶å€™è¯¥ç”¨ConcurrentHashMapï¼Œä¸‹é¢æˆ‘ä»¬æ¥å¤ä¹ ä¸€ä¸‹CHMçš„ä¸€äº›å…³é”®ç‚¹ã€‚ CHMå…è®¸å¹¶å‘çš„è¯»å’Œçº¿ç¨‹å®‰å…¨çš„æ›´æ–°æ“ä½œ åœ¨æ‰§è¡Œå†™æ“ä½œæ—¶ï¼ŒCHMåªé”ä½éƒ¨åˆ†çš„Map å¹¶å‘çš„æ›´æ–°æ˜¯é€šè¿‡å†…éƒ¨æ ¹æ®å¹¶å‘çº§åˆ«å°†Mapåˆ†å‰²æˆå°éƒ¨åˆ†å®ç°çš„ é«˜çš„å¹¶å‘çº§åˆ«ä¼šé€ æˆæ—¶é—´å’Œç©ºé—´çš„æµªè´¹ï¼Œä½çš„å¹¶å‘çº§åˆ«åœ¨å†™çº¿ç¨‹å¤šæ—¶ä¼šå¼•èµ·çº¿ç¨‹é—´çš„ç«äº‰ CHMçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨ CHMè¿”å›çš„è¿­ä»£å™¨æ˜¯å¼±ä¸€è‡´æ€§ï¼Œfail-safeå¹¶ä¸”ä¸ä¼šæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ CHMä¸å…è®¸nullçš„é”®å€¼ å¯ä»¥ä½¿ç”¨CHMä»£æ›¿HashTableï¼Œä½†è¦è®°ä½CHMä¸ä¼šé”ä½æ•´ä¸ªMap ä»¥ä¸Šå°±æ˜¯Javaä¸­CHMçš„å®ç°å’Œä½¿ç”¨åœºæ™¯","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"},{"name":"hashmap","slug":"java/hashmap","permalink":"http://yemengying.com/categories/java/hashmap/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"ç¿»è¯‘","slug":"ç¿»è¯‘","permalink":"http://yemengying.com/tags/ç¿»è¯‘/"}]},{"title":"ã€è¯‘ã€‘Java8ä¸­çš„æ‰©å±•(default/extension)æ–¹æ³•","slug":"Java-8ä¸­çš„æ‰©å±•-Default-Defender-Extension-æ–¹æ³•","date":"2015-11-01T14:11:06.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/11/01/Java-8ä¸­çš„æ‰©å±•-Default-Defender-Extension-æ–¹æ³•/","link":"","permalink":"http://yemengying.com/2015/11/01/Java-8ä¸­çš„æ‰©å±•-Default-Defender-Extension-æ–¹æ³•/","excerpt":"åŸæ–‡æ¥è‡ªä¸€ä¸ªjavaå¤§ç‰›çš„æŠ€æœ¯åšå®¢ åœ°å€http://javarevisited.blogspot.hk/2014/07/default-defender-or-extension-method-of-Java8-example-tutorial.html#uds-search-results åšå®¢è®²è§£äº†Java 8ä¸­æ–°å¼•å…¥çš„å¯ä»¥åœ¨æ¥å£ä¸­å®šä¹‰æ‰©å±•æ–¹æ³•ã€‚ä¸‹é¢æ˜¯åŸæ–‡çš„ç¿»è¯‘ã€‚ Java 8å…è®¸å¼€å‘è€…ä½¿ç”¨defaultå’Œstaticä¸¤ä¸ªå…³é”®å­—åœ¨æ¥å£ä¸­åŠ å…¥éæŠ½è±¡çš„æ–¹æ³•ã€‚å¸¦æœ‰defaultå…³é”®å­—çš„æ–¹æ³•åœ¨Javaä¸­ä¹Ÿè¢«ç§°ä½œdefenderæ–¹æ³•æˆ–defaulæ–¹æ³•ã€‚åœ¨Java 8ä¹‹å‰ï¼Œæƒ³è¦æ”¹å˜ä¸€ä¸ªå·²ç»å‘å¸ƒçš„æ¥å£å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œä»»ä½•æ”¹åŠ¨(ä¾‹å¦‚å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•)éƒ½ä¼šå½±å“è¯¥æ¥å£ç°æœ‰çš„å®ç°ç±»ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨Java 8æƒ³è¦æ”¹å˜å†…éƒ¨iteratorçš„å®ç°ï¼Œä½¿ç”¨forEach()æ–¹æ³•æ—¶é¢ä¸´äº†ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ï¼Œå› ä¸ºè¿™ä¼šç ´åäº†ç°æœ‰çš„Iterableæ¥å£çš„å®ç°ç±»ã€‚æ¯«æ— ç–‘é—®ï¼Œå‘åå…¼å®¹æ˜¯Javaå·¥ç¨‹å¸ˆæœ€ä¼˜å…ˆè€ƒè™‘çš„äº‹ï¼Œæ‰€ä»¥è¦ç ´åç°æœ‰çš„å®ç°ç±»æ˜¯ä¸å¯è¡Œçš„ã€‚å› æ­¤ï¼Œä»–ä»¬æå‡ºäº†ä¸€ä¸ªè§£å†³åŠæ³•ï¼Œå¼•å…¥defaultæ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªç»å¦™çš„æƒ³æ³•ï¼Œå› ä¸ºç°åœ¨ä½ å¯ä»¥ç”¨æ‰©å±•ç°æœ‰çš„æ¥å£ã€‚JDKæœ¬èº«ä¹Ÿä½¿ç”¨äº†è®¸å¤šdefaultæ–¹æ³•,java.util.Mapæ¥å£æ‰©å±•äº†è®¸å¤šdefaultæ–¹æ³•ï¼Œä¾‹å¦‚replaceAll(),putIfAbsent(Key k,Value v)â€¦.ã€‚å¦å¤–ï¼Œç”±äºdefaultæ–¹æ³•å¯ä»¥æ‰©å±•ç°æœ‰çš„æ¥å£ä¹Ÿè¢«ç§°ä½œextensionæ–¹æ³•ã€‚ä¸€ä¸ªæ¥å£ä¸­çš„defaultæ–¹æ³•æ˜¯æ•°é‡ä¸å—é™åˆ¶çš„ã€‚æˆ‘ç›¸ä¿¡ï¼Œåœ¨è¿™æ¬¡æ”¹å˜ä¹‹åï¼Œå°†ä¸å†éœ€è¦æŠ½è±¡ç±»æ¥æä¾›éª¨æ¶å®ç°(skeletal implementation),ä¾‹å¦‚Listæ¥å£æœ‰AbstractListï¼ŒCollectionæ¥å£æœ‰AbstractCollectionï¼ŒSetæ¥å£æœ‰AbstractSetï¼ŒMapæ¥å£æœ‰AbstractMapã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ¥å£ä¸­å®šä¹‰defaultæ–¹æ³•æ¥æ›¿ä»£åˆ›å»ºä¸€ä¸ªæ–°çš„æŠ½è±¡ç±»ã€‚ç›¸ä¼¼çš„ï¼Œstaticæ–¹æ³•çš„å¼•å…¥ä¹Ÿä½¿å¾—æ¥å£çš„å·¥å…·ç±»å˜å¾—å†—ä½™ã€‚ä¾‹å¦‚ï¼ŒCollectionæ¥å£çš„Collectionsç±»ï¼ŒPathæ¥å£çš„Pathsç±»ï¼Œå› ä¸ºä½ å¯ä»¥ç›´æ¥åœ¨æ¥å£ä¸­å®šä¹‰é™æ€å·¥å…·æ–¹æ³•ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºJava 8çš„æ–°ç‰¹æ€§ï¼Œæˆ‘å»ºè®®é˜…è¯»Cay S. Horstmannå†™çš„Java SE 8 Really Impatientã€‚è¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„å…³äºJava 8çš„ä¹¦ä¹‹ä¸€ï¼Œå®ƒè¯¦ç»†çš„ä»‹ç»äº†Java7ä¸Java 8ä¸åŒçš„ç‰¹æ€§ã€‚","keywords":null,"text":"åŸæ–‡æ¥è‡ªä¸€ä¸ªjavaå¤§ç‰›çš„æŠ€æœ¯åšå®¢ åœ°å€http://javarevisited.blogspot.hk/2014/07/default-defender-or-extension-method-of-Java8-example-tutorial.html#uds-search-results åšå®¢è®²è§£äº†Java 8ä¸­æ–°å¼•å…¥çš„å¯ä»¥åœ¨æ¥å£ä¸­å®šä¹‰æ‰©å±•æ–¹æ³•ã€‚ä¸‹é¢æ˜¯åŸæ–‡çš„ç¿»è¯‘ã€‚ Java 8å…è®¸å¼€å‘è€…ä½¿ç”¨defaultå’Œstaticä¸¤ä¸ªå…³é”®å­—åœ¨æ¥å£ä¸­åŠ å…¥éæŠ½è±¡çš„æ–¹æ³•ã€‚å¸¦æœ‰defaultå…³é”®å­—çš„æ–¹æ³•åœ¨Javaä¸­ä¹Ÿè¢«ç§°ä½œdefenderæ–¹æ³•æˆ–defaulæ–¹æ³•ã€‚åœ¨Java 8ä¹‹å‰ï¼Œæƒ³è¦æ”¹å˜ä¸€ä¸ªå·²ç»å‘å¸ƒçš„æ¥å£å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ï¼Œä»»ä½•æ”¹åŠ¨(ä¾‹å¦‚å¢åŠ ä¸€ä¸ªæ–°çš„æ–¹æ³•)éƒ½ä¼šå½±å“è¯¥æ¥å£ç°æœ‰çš„å®ç°ç±»ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨Java 8æƒ³è¦æ”¹å˜å†…éƒ¨iteratorçš„å®ç°ï¼Œä½¿ç”¨forEach()æ–¹æ³•æ—¶é¢ä¸´äº†ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ï¼Œå› ä¸ºè¿™ä¼šç ´åäº†ç°æœ‰çš„Iterableæ¥å£çš„å®ç°ç±»ã€‚æ¯«æ— ç–‘é—®ï¼Œå‘åå…¼å®¹æ˜¯Javaå·¥ç¨‹å¸ˆæœ€ä¼˜å…ˆè€ƒè™‘çš„äº‹ï¼Œæ‰€ä»¥è¦ç ´åç°æœ‰çš„å®ç°ç±»æ˜¯ä¸å¯è¡Œçš„ã€‚å› æ­¤ï¼Œä»–ä»¬æå‡ºäº†ä¸€ä¸ªè§£å†³åŠæ³•ï¼Œå¼•å…¥defaultæ–¹æ³•ã€‚è¿™æ˜¯ä¸€ä¸ªç»å¦™çš„æƒ³æ³•ï¼Œå› ä¸ºç°åœ¨ä½ å¯ä»¥ç”¨æ‰©å±•ç°æœ‰çš„æ¥å£ã€‚JDKæœ¬èº«ä¹Ÿä½¿ç”¨äº†è®¸å¤šdefaultæ–¹æ³•,java.util.Mapæ¥å£æ‰©å±•äº†è®¸å¤šdefaultæ–¹æ³•ï¼Œä¾‹å¦‚replaceAll(),putIfAbsent(Key k,Value v)â€¦.ã€‚å¦å¤–ï¼Œç”±äºdefaultæ–¹æ³•å¯ä»¥æ‰©å±•ç°æœ‰çš„æ¥å£ä¹Ÿè¢«ç§°ä½œextensionæ–¹æ³•ã€‚ä¸€ä¸ªæ¥å£ä¸­çš„defaultæ–¹æ³•æ˜¯æ•°é‡ä¸å—é™åˆ¶çš„ã€‚æˆ‘ç›¸ä¿¡ï¼Œåœ¨è¿™æ¬¡æ”¹å˜ä¹‹åï¼Œå°†ä¸å†éœ€è¦æŠ½è±¡ç±»æ¥æä¾›éª¨æ¶å®ç°(skeletal implementation),ä¾‹å¦‚Listæ¥å£æœ‰AbstractListï¼ŒCollectionæ¥å£æœ‰AbstractCollectionï¼ŒSetæ¥å£æœ‰AbstractSetï¼ŒMapæ¥å£æœ‰AbstractMapã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨æ¥å£ä¸­å®šä¹‰defaultæ–¹æ³•æ¥æ›¿ä»£åˆ›å»ºä¸€ä¸ªæ–°çš„æŠ½è±¡ç±»ã€‚ç›¸ä¼¼çš„ï¼Œstaticæ–¹æ³•çš„å¼•å…¥ä¹Ÿä½¿å¾—æ¥å£çš„å·¥å…·ç±»å˜å¾—å†—ä½™ã€‚ä¾‹å¦‚ï¼ŒCollectionæ¥å£çš„Collectionsç±»ï¼ŒPathæ¥å£çš„Pathsç±»ï¼Œå› ä¸ºä½ å¯ä»¥ç›´æ¥åœ¨æ¥å£ä¸­å®šä¹‰é™æ€å·¥å…·æ–¹æ³•ã€‚å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äºJava 8çš„æ–°ç‰¹æ€§ï¼Œæˆ‘å»ºè®®é˜…è¯»Cay S. Horstmannå†™çš„Java SE 8 Really Impatientã€‚è¿™æ˜¯æˆ‘æœ€å–œæ¬¢çš„å…³äºJava 8çš„ä¹¦ä¹‹ä¸€ï¼Œå®ƒè¯¦ç»†çš„ä»‹ç»äº†Java7ä¸Java 8ä¸åŒçš„ç‰¹æ€§ã€‚ Defaultæ–¹æ³•çš„ä¾‹å­Java 8è®©æˆ‘ä»¬å¯ä»¥é€šè¿‡defaultå…³é”®å­—ä¸ºæ¥å£æ·»åŠ éæŠ½è±¡çš„æ–¹æ³•ã€‚è¿™ä¸€ç‰¹æ€§ä¹Ÿè¢«ç§°ä½œExtension(æ‰©å±•)æ–¹æ³•ã€‚ä¸‹é¢æ˜¯ç¬¬ä¸€ä¸ªä¾‹å­ï¼š 12345678interface Multiplication&#123; int multiply(int a, int b); default int square(int a)&#123; return multiply(a, a); &#125; &#125; é™¤äº†æŠ½è±¡æ–¹æ³•multiply()ä¹‹å¤–ï¼Œæ¥å£Multiplicationè¿˜åŒ…å«ä¸€ä¸ªdefaultæ–¹æ³•square()ã€‚ä»»ä½•å®ç°Multiplicationæ¥å£çš„ç±»åªéœ€å®ç°æŠ½è±¡æ–¹æ³•multiplyï¼Œdefaultæ–¹æ³•square()å¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚ 12345678910Multiplication product = new Multiplication()&#123; @Override public int multiply(int x, int y)&#123; return x*y; &#125;&#125;; int square = product.square(2); int multiplication = product.multiply(2, 3); productæ˜¯ä¸ªåŒ¿åç±»ã€‚è¿™æ®µä»£ç æœ‰ç‚¹å•°å—¦äº†ï¼Œç”¨äº†6è¡Œå®ç°ä¸€ä¸ªç®€å•åœ°ä¹˜æ³•çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨lambdaè¡¨è¾¾å¼æ¥ç®€åŒ–ä¸€ä¸‹ä»£ç ï¼Œlambdaè¡¨è¾¾å¼ä¹Ÿæ˜¯Java 8ä¸­æ–°å¼•å…¥çš„ã€‚å› ä¸ºæˆ‘ä»¬çš„æ¥å£åªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œè€Œä¸”lambdaè¡¨è¾¾å¼ä¹Ÿæ˜¯SAM(Single Abstract methodå•ä¸€æŠ½è±¡æ–¹æ³•)ç±»å‹çš„ã€‚æˆ‘ä»¬å¯ä»¥ç”¨lambdaè¡¨è¾¾å¼æ¥æ›¿ä»£åŒ¿åç±»å°†ä»£ç ç®€åŒ–æˆä¸‹é¢çš„æ ·å­ã€‚ 123Multiplication lambda = (x, y) -&gt; x*y; int product = lambda.multiply(3, 4); int square = lambda.square(4); ä»¥ä¸Šå°±æ˜¯åœ¨æ¥å£ä¸­ä½¿ç”¨defaultæ–¹æ³•çš„ä¾‹å­ã€‚ç°åœ¨ï¼Œä½ å¯ä»¥æ¯«æ— é¡¾è™‘çš„åœ¨æ—§çš„æ¥å£ä¸­æ‰©å±•æ–°çš„æ–¹æ³•ï¼Œåªè¦è¿™äº›æ–¹æ³•æ˜¯defaultæˆ–staticçš„å°±ä¸ç”¨æ‹…å¿ƒä¼šç ´åæ¥å£çš„å®ç°ç±»ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142/**Java Program to demonstrate use of default method in Java 8. * You can define non-abstract method by using default keyword, and more * than one default method is permitted, which allows you to ship default skeletal * implementation on interface itself. * @author Javin Paul */ public class Java8DefaultMethodDemo&#123; public static void main(String args[]) &#123; // Implementing interface using Anonymous class Multiplication product = new Multiplication()&#123; @Override public int multiply(int x, int y)&#123; return x*y; &#125; &#125;; int squareOfTwo = product.square(2); int cubeOfTwo = product.cube(2); System.out.println(\"Square of Two : \" + squareOfTwo); System.out.println(\"Cube of Two : \" + cubeOfTwo); // Since Multiplication has only one abstract method, it can // also be implemented using lambda expression in Java 8 Multiplication lambda = (x, y) -&gt; x*y; int squareOfThree = lambda.square(3); int cubeOfThree = lambda.cube(3); System.out.println(\"Square of Three : \" + squareOfThree); System.out.println(\"Cube of Three : \" + cubeOfThree); &#125; &#125; interface Multiplication&#123; int multiply(int a, int b); default int square(int a)&#123; return multiply(a, a); &#125; default int cube(int a)&#123; return multiply(multiply(a, a), a); &#125; &#125; Output : Square of Two : 4 Cube of Two : 8 Square of Three : 9 Cube of Three : 27 è¿™æ˜¯ä¸ªå¾ˆå¥½çš„å…³äºå¦‚ä½•ä½¿ç”¨defaultæ–¹æ³•åœ¨æ¥å£ä¸­æ–¹ä¾¿çš„æ·»åŠ æ–¹æ³•çš„ä¾‹å­ã€‚ä¹Ÿå±•ç¤ºäº†å¦‚ä½•é¿å…ä¸€ä¸ªé¢å¤–çš„å¸®åŠ©ç±»ï¼Œæ¯”å¦‚Collectionsç±»ã€‚å®ƒä»…ä»…æä¾›äº†ä¸€äº›ç”¨äºCollectionçš„å·¥å…·æ–¹æ³•ï¼Œè€Œç°åœ¨æˆ‘ä»¬å¯ä»¥ç›´æ¥åœ¨Collectionä¸­å®šä¹‰è¿™äº›æ–¹æ³•ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•multiply(a,b)çš„æ¥å£Multiplicationï¼Œæ¥å£è¿˜åŒ…æ‹¬ä¸¤ä¸ªä¾èµ–äºmultiply(a,b)æ–¹æ³•çš„éæŠ½è±¡æ–¹æ³•square(a)å’Œcube(b)ã€‚æ¥å£çš„å®ç°ç±»åªéœ€è¦å®ç°multiply(a,b)æ–¹æ³•ï¼Œå°±å¯ä»¥ç›´æ¥ä½¿ç”¨square(a)å’Œcube(b)æ–¹æ³•äº†ã€‚ defaultæ–¹æ³•çš„å…³é”®ç‚¹ç°åœ¨è®©æˆ‘ä»¬æ¥å¤ä¹ æˆ‘ä»¬åˆšåˆšå­¦åˆ°äº†ä»€ä¹ˆï¼Œè®°ä¸€ä¸‹å…³äºdefaultæ–¹æ³•çš„å…³é”®ç‚¹ã€‚ åœ¨Java8ä¸­ä½ å¯ä»¥åœ¨æ¥å£ä¸­æ·»åŠ defaultæ–¹æ³• defaultæ–¹æ³•çš„å‡ºç°ä½¿å¾—æ¥å£å’ŒæŠ½è±¡ç±»çš„ä¸åŒå˜å¾—æ¨¡ç³Šã€‚æ‰€ä»¥ï¼Œå½“åœ¨é¢è¯•ä¸­è¢«é—®åˆ°è¿™ä¸ªé—®é¢˜ï¼Œåˆ«å¿˜äº†æä¸€ä¸‹ï¼Œä»¥å‰åªèƒ½é€šè¿‡æŠ½è±¡ç±»å®ç°çš„äº‹æƒ…ï¼Œç°åœ¨ä¹Ÿå¯ä»¥é€šè¿‡defaultæ–¹æ³•å®ç°äº†ã€‚ defaultå¹¶ä¸æ˜¯ä¸€ä¸ªæ–°çš„å…³é”®å­—ï¼Œåœ¨JDK1.1ä¸­å°±æ˜¯ä¿ç•™å…³é”®å­— æ¥å£ä¸­defaultæ–¹æ³•çš„æ•°é‡æ²¡æœ‰é™åˆ¶ å¦‚æœæ¥å£Cç»§æ‰¿äº†æ¥å£Aå’ŒBï¼Œå¦‚æœAå’ŒBä¸­æ‹¥æœ‰ä¸€æ ·çš„defaultæ–¹æ³•ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ä¼šæŠ¥é”™ã€‚ä¸ºäº†é¿å…æ­§ä¹‰ï¼Œè¿™åœ¨Java 8ä¸­æ˜¯ä¸å…è®¸çš„ã€‚æ‰€ä»¥å½“defaultæ–¹æ³•æœ‰å†²çªæ—¶ï¼Œæ˜¯ä¸å¯ä»¥å¤šç»§æ‰¿çš„ åœ¨JDK1.8ä¸­æœ‰è®¸å¤šå…³äºdefaultæ–¹æ³•çš„ä¾‹å­ï¼Œæ¯”å¦‚forEachæ–¹æ³•ã€‚ä¹Ÿå¯ä»¥æŸ¥çœ‹java.util.Mapä¸­æ–°æ·»çš„putIfAbsentæ–¹æ³•ï¼Œåœ¨JDK1.8ä¹‹å‰ï¼Œæˆ‘ä»¬åªèƒ½ConcurrentMapæ¥ä½¿ç”¨å®ƒã€‚ ä»¥ä¸Šå°±æ˜¯defaultæ–¹æ³•ã€‚ä¸å¾—ä¸è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå·¨å¤§çš„çªç ´ï¼Œä½¿æˆ‘ä»¬å¯ä»¥æ›´å¥½æ›´æ–¹ä¾¿çš„ä½¿ç”¨æ¥å£ã€‚äº†è§£CurrentMapçš„putIfAbsentæ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½çš„è®°ä½defaultæ–¹æ³•ã€‚åœ¨JDK1.7ä¸­ï¼ŒputIfAbsentæ–¹æ³•å¹¶ä¸å­˜åœ¨äºMapæ¥å£ä¸­ï¼Œæ‰€ä»¥ä¸ºäº†ä½¿ç”¨putIfAbsentæ–¹æ³•ï¼Œå¿…é¡»å°†Mapæ¥å£æŒ‡å‘çš„ConcurrentMapå¯¹è±¡å¼ºåˆ¶è½¬æ¢æˆConcurrentMapã€‚ä½†Java 8å¼•å…¥æ‰©å±•æ–¹æ³•ä¹‹åï¼ŒMapæ¥å£ä¸­ä¹Ÿæœ‰äº†putIfAbsentæ–¹æ³•ã€‚æƒ³äº†è§£æ›´å¤šçš„å…³äºJava8çš„æ–°ç‰¹æ€§ï¼Œå¯ä»¥é˜…è¯»Manning&#39;s Java 8 in Action","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"interface","slug":"interface","permalink":"http://yemengying.com/tags/interface/"},{"name":"ç¿»è¯‘","slug":"ç¿»è¯‘","permalink":"http://yemengying.com/tags/ç¿»è¯‘/"}]},{"title":"ã€è¯‘ã€‘ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll","slug":"è¯‘-ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll","date":"2015-10-29T06:34:55.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/10/29/è¯‘-ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll/","link":"","permalink":"http://yemengying.com/2015/10/29/è¯‘-ä»¥ç”Ÿäº§è€…æ¶ˆè´¹è€…ä¸ºä¾‹é˜è¿°å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAll/","excerpt":"åŸæ–‡æ¥è‡ªä¸€ä¸ªjavaå¤§ç‰›çš„æŠ€æœ¯åšå®¢ åœ°å€http://javarevisited.blogspot.com/2015/07/how-to-use-wait-notify-and-notifyall-in.html åšå®¢ä»¥ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¸ºä¾‹ è®²è§£äº†å¦‚ä½•ä½¿ç”¨wait,notify,notifyAllè¿›è¡Œå¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ä¸‹é¢æ˜¯åŸæ–‡çš„ç¿»è¯‘ã€‚ åœ¨Javaä¸­å¯ä»¥åˆ©ç”¨use,notify,notifyAllæ¥å®Œæˆçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ çš„ç¨‹åºä¸­æœ‰ä¸¤ä¸ªçº¿ç¨‹(eg:Producer(ç”Ÿäº§è€…)å’ŒConsumer(æ¶ˆè´¹è€…))ï¼ŒProducerè¦å’ŒConsumeré€šä¿¡ï¼Œé€šçŸ¥Consumeré˜Ÿåˆ—ä¸­æœ‰å…ƒç´ äº†å¯ä»¥å¼€å§‹æ¶ˆè´¹ã€‚ç›¸ä¼¼çš„ï¼ŒConsumerä¹Ÿéœ€è¦é€šçŸ¥Produceré˜Ÿåˆ—ä¸­æœ‰ç©ºé—²å¯ä»¥æ’å…¥å…ƒç´ äº†ã€‚ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯ä»¥åœ¨ä¸€å®šæ¡ä»¶ä¸‹è°ƒç”¨waitæ–¹æ³•æš‚åœä»€ä¹ˆéƒ½ä¸åšã€‚æ¯”å¦‚ï¼Œåœ¨Producerå’Œconsumerçš„é—®é¢˜ä¸­ï¼Œå½“é˜Ÿåˆ—æ»¡äº†æ—¶Produceréœ€è¦è°ƒç”¨waitï¼Œå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶Consumeréœ€è¦è°ƒç”¨waitæ–¹æ³•ã€‚å¦‚æœä¸€äº›çº¿ç¨‹åœ¨ç­‰å¾…æŸäº›æ¡ä»¶å˜ä¸ºçœŸï¼Œå¯ä»¥åœ¨æ¡ä»¶æ”¹å˜æ—¶ä½¿ç”¨notifyå’ŒnotifyAllé€šçŸ¥ä»–ä»¬å¹¶å”¤é†’ä»–ä»¬ã€‚Notifyæ–¹æ³•å’ŒNotifyAllæ–¹æ³•éƒ½å¯ä»¥å‘é€é€šçŸ¥ï¼Œä¸åŒçš„æ˜¯ï¼Œnotifyåªèƒ½å‘ç­‰å¾…çš„çº¿ç¨‹ä¸­çš„ä¸€ä¸ªå‘é€é€šçŸ¥ï¼Œä¸ä¿è¯æ¥å—åˆ°é€šçŸ¥çš„æ˜¯å“ªä¸ªçº¿ç¨‹ï¼Œè€ŒNotifyAllä¼šå‘æ‰€æœ‰çº¿ç¨‹å‘é€é€šçŸ¥ã€‚æ‰€ä»¥å¦‚æœåªæœ‰ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¯¹è±¡é”ï¼Œnotifyå’ŒnotifyAlléƒ½ä¼šé€šçŸ¥åˆ°å®ƒã€‚åœ¨è¿™ä¸ªjavaå¤šçº¿ç¨‹çš„æ•™ç¨‹ä¸­ï¼Œå°†åˆ©ç”¨ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…çš„ä¾‹å­è®²è¿°åœ¨Javaä¸­å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAllå®ç°çº¿ç¨‹å†…éƒ¨é€šä¿¡ã€‚å¦å¤–ï¼Œå¦‚æœå¤§å®¶å¯¹æŒæ¡å¤šçº¿ç¨‹å’Œå¹¶å‘å¾ˆæ„Ÿå…´è¶£ï¼Œå¼ºçƒˆå»ºè®®å¤§å®¶é˜…è¯»Brian Goetzå†™çš„Java Concurrency in Practiceã€‚å¦‚æœæ²¡çœ‹è¿‡è¿™æœ¬ä¹¦ï¼Œä½ çš„Javaå¤šçº¿ç¨‹ä¹‹æ—…æ˜¯ä¸å®Œæ•´çš„ğŸ™€ã€‚","keywords":null,"text":"åŸæ–‡æ¥è‡ªä¸€ä¸ªjavaå¤§ç‰›çš„æŠ€æœ¯åšå®¢ åœ°å€http://javarevisited.blogspot.com/2015/07/how-to-use-wait-notify-and-notifyall-in.html åšå®¢ä»¥ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä¸ºä¾‹ è®²è§£äº†å¦‚ä½•ä½¿ç”¨wait,notify,notifyAllè¿›è¡Œå¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ä¸‹é¢æ˜¯åŸæ–‡çš„ç¿»è¯‘ã€‚ åœ¨Javaä¸­å¯ä»¥åˆ©ç”¨use,notify,notifyAllæ¥å®Œæˆçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ä½ çš„ç¨‹åºä¸­æœ‰ä¸¤ä¸ªçº¿ç¨‹(eg:Producer(ç”Ÿäº§è€…)å’ŒConsumer(æ¶ˆè´¹è€…))ï¼ŒProducerè¦å’ŒConsumeré€šä¿¡ï¼Œé€šçŸ¥Consumeré˜Ÿåˆ—ä¸­æœ‰å…ƒç´ äº†å¯ä»¥å¼€å§‹æ¶ˆè´¹ã€‚ç›¸ä¼¼çš„ï¼ŒConsumerä¹Ÿéœ€è¦é€šçŸ¥Produceré˜Ÿåˆ—ä¸­æœ‰ç©ºé—²å¯ä»¥æ’å…¥å…ƒç´ äº†ã€‚ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¯ä»¥åœ¨ä¸€å®šæ¡ä»¶ä¸‹è°ƒç”¨waitæ–¹æ³•æš‚åœä»€ä¹ˆéƒ½ä¸åšã€‚æ¯”å¦‚ï¼Œåœ¨Producerå’Œconsumerçš„é—®é¢˜ä¸­ï¼Œå½“é˜Ÿåˆ—æ»¡äº†æ—¶Produceréœ€è¦è°ƒç”¨waitï¼Œå½“é˜Ÿåˆ—ä¸ºç©ºæ—¶Consumeréœ€è¦è°ƒç”¨waitæ–¹æ³•ã€‚å¦‚æœä¸€äº›çº¿ç¨‹åœ¨ç­‰å¾…æŸäº›æ¡ä»¶å˜ä¸ºçœŸï¼Œå¯ä»¥åœ¨æ¡ä»¶æ”¹å˜æ—¶ä½¿ç”¨notifyå’ŒnotifyAllé€šçŸ¥ä»–ä»¬å¹¶å”¤é†’ä»–ä»¬ã€‚Notifyæ–¹æ³•å’ŒNotifyAllæ–¹æ³•éƒ½å¯ä»¥å‘é€é€šçŸ¥ï¼Œä¸åŒçš„æ˜¯ï¼Œnotifyåªèƒ½å‘ç­‰å¾…çš„çº¿ç¨‹ä¸­çš„ä¸€ä¸ªå‘é€é€šçŸ¥ï¼Œä¸ä¿è¯æ¥å—åˆ°é€šçŸ¥çš„æ˜¯å“ªä¸ªçº¿ç¨‹ï¼Œè€ŒNotifyAllä¼šå‘æ‰€æœ‰çº¿ç¨‹å‘é€é€šçŸ¥ã€‚æ‰€ä»¥å¦‚æœåªæœ‰ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…å¯¹è±¡é”ï¼Œnotifyå’ŒnotifyAlléƒ½ä¼šé€šçŸ¥åˆ°å®ƒã€‚åœ¨è¿™ä¸ªjavaå¤šçº¿ç¨‹çš„æ•™ç¨‹ä¸­ï¼Œå°†åˆ©ç”¨ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…çš„ä¾‹å­è®²è¿°åœ¨Javaä¸­å¦‚ä½•ä½¿ç”¨waitï¼Œnotifyå’ŒnotifyAllå®ç°çº¿ç¨‹å†…éƒ¨é€šä¿¡ã€‚å¦å¤–ï¼Œå¦‚æœå¤§å®¶å¯¹æŒæ¡å¤šçº¿ç¨‹å’Œå¹¶å‘å¾ˆæ„Ÿå…´è¶£ï¼Œå¼ºçƒˆå»ºè®®å¤§å®¶é˜…è¯»Brian Goetzå†™çš„Java Concurrency in Practiceã€‚å¦‚æœæ²¡çœ‹è¿‡è¿™æœ¬ä¹¦ï¼Œä½ çš„Javaå¤šçº¿ç¨‹ä¹‹æ—…æ˜¯ä¸å®Œæ•´çš„ğŸ™€ã€‚ åœ¨ä»£ç ä¸­å±•ç¤ºå¦‚ä½•ä½¿ç”¨waitå’Œnotifyå°½ç®¡waitå’Œnotifyæ˜¯ç›¸å½“åŸºç¡€çš„æ¦‚å¿µï¼Œå¹¶ä¸”ä»–ä»¬å®šä¹‰åœ¨Objectç±»ä¸­ï¼Œä½†è¦æƒ³åœ¨ä»£ç ä¸­ä½¿ç”¨ä»–ä»¬å¹¶éæ˜“äº‹ã€‚ä½ å¯ä»¥åœ¨é¢è¯•ä¸­è®©é¢è¯•è€…é€šè¿‡æ‰‹å†™ä»£ç è§£å†³Producerè€…å’ŒConsumerè€…é—®é¢˜æ¥éªŒè¯ï¼Œæˆ‘ç›¸ä¿¡å¤§å¤šæ•°äººéƒ½ä¼šçŠ¯åœ¨é”™è¯¯çš„åœ°æ–¹åŒæ­¥ï¼Œæ²¡æœ‰åœ¨æ­£ç¡®çš„å¯¹è±¡ä¸Šè°ƒç”¨waitä¹‹ç±»çš„é”™ã€‚è®²çœŸï¼Œè¿™äº›å¸¸å¸¸ä¼šå›°æƒ‘è®¸å¤šç¨‹åºå‘˜ã€‚ç¬¬ä¸€ä¸ªå›°æƒ‘ç‚¹æ¥è‡ªæ€æ ·è°ƒç”¨waitæ–¹æ³•ï¼Œå› ä¸ºwaitæ–¹æ³•å¹¶ä¸æ˜¯å®šä¹‰åœ¨Threadç±»ä¸­ï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•çš„Thread.wait()ã€‚è€Œè®¸å¤šJavaå¼€å‘è€…ä¹ æƒ¯äºThread.sleep(),æ‰€ä»¥å¸¸å¸¸é”™è¯¯çš„æƒ³ç”¨åŒæ ·çš„æ–¹å¼è°ƒç”¨waitã€‚å®é™…ä¸Šï¼Œwait()æ–¹æ³•éœ€è¦åœ¨ä¸€ä¸ªè¢«ä¸¤ä¸ªçº¿ç¨‹å…±äº«çš„å¯¹è±¡ä¸Šè°ƒç”¨ï¼Œä¾‹å¦‚åœ¨Producerè€…å’Œæ¶ˆè´¹Consumerçš„é—®é¢˜ä¸­ï¼Œä¸¤ä¸ªçº¿ç¨‹å…±äº«å¯¹è±¡æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ã€‚ç¬¬äºŒä¸ªå›°æƒ‘ç‚¹æ¥è‡ªwaitæ–¹æ³•åº”è¯¥åœ¨åŒæ­¥å—è¿˜æ˜¯åŒæ­¥æ–¹æ³•ä¸­è°ƒç”¨ï¼Ÿå¦‚æœä½¿ç”¨åŒæ­¥å—ï¼Œé‚£ä¹ˆå“ªä¸ªå¯¹è±¡åº”è¯¥æ”¾åˆ°åŒæ­¥å—ä¸­ï¼Ÿè¿™ä¸ªå¯¹è±¡å’Œä½ æƒ³è¦è·å¾—é”çš„å¯¹è±¡åº”è¯¥æ˜¯åŒä¸€ä¸ªã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œè¿™ä¸ªå¯¹è±¡å°±æ˜¯ä¸¤ä¸ªçº¿ç¨‹å…±äº«çš„é˜Ÿåˆ—ã€‚ åœ¨å¾ªç¯ä¸­ä½¿ç”¨waitå’Œnotifyï¼Œè€Œä¸æ˜¯Ifä»£ç å—ä¸­åœ¨ä½ å·²ç»äº†è§£éœ€è¦åœ¨ä¸€ä¸ªå…±äº«çš„å¯¹è±¡ä¸Šè°ƒç”¨waitæ–¹æ³•åï¼Œæ¥ä¸‹æ¥å°±æ˜¯å­¦ä¼šé¿å…è®¸å¤šjavaå¼€å‘è€…çŠ¯çš„é”™â€”åœ¨Ifä»£ç å—ä¸­è°ƒç”¨waitè€Œä¸æ˜¯whileå¾ªç¯ä¸­ã€‚å› ä¸ºéœ€è¦åœ¨ä¸€å®šçš„æ¡ä»¶ä¸‹è°ƒç”¨waitï¼Œæ¯”å¦‚Producerçº¿ç¨‹è¦åœ¨é˜Ÿåˆ—æ»¡äº†çš„æƒ…å†µä¸‹è°ƒç”¨waitï¼Œæ‰€ä»¥ç¬¬ä¸€ååº”éƒ½æ˜¯ä½¿ç”¨Ifè¯­å¥ã€‚ä½†æ˜¯ï¼Œåœ¨Ifä»£ç å—ä¸­è°ƒç”¨waitä¼šäº§ç”Ÿbugï¼Œå› ä¸ºçº¿ç¨‹å­˜åœ¨ä¸€å®šçš„å¯èƒ½åœ¨ç­‰å¾…æ¡ä»¶æ²¡æœ‰æ”¹å˜çš„æƒ…å†µä¸‹å‡å”¤é†’(spurious wake up)ã€‚æ‰€ä»¥å¦‚æœæ²¡æœ‰ä½¿ç”¨å¾ªç¯åœ¨çº¿ç¨‹å”¤é†’åæ£€æŸ¥ç­‰å¾…æ¡ä»¶ï¼Œå¯èƒ½ä¼šé€ æˆå°è¯•åœ¨å·²ç»æ»¡äº†çš„é˜Ÿåˆ—ä¸­æ’å…¥å…ƒç´ æˆ–è€…åœ¨ç©ºäº†çš„é˜Ÿåˆ—ä¸­å–å…ƒç´ ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦åœ¨whileå¾ªç¯ä¸­è°ƒç”¨waitè€Œä¸æ˜¯ifã€‚ 12345678 // The standard idiom for calling the wait method in Java synchronized (sharedObject) &#123; while (condition) &#123; sharedObject.wait();// (Releases lock, and reacquires on wakeup) &#125; ...// do action based upon condition e.g. take or put into queue&#125; æ­£å¦‚æˆ‘å»ºè®®çš„ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨ä¸€ä¸ªå¾ªç¯ä¸­è°ƒç”¨waitã€‚è¿™ä¸ªå¾ªç¯ç”¨äºåœ¨çº¿ç¨‹ä¼‘çœ ä¹‹å‰å’Œä¹‹åæ£€æŸ¥conditionã€‚ Javaä¸­ä½¿ç”¨wait(),notify(),notifyAll()çš„ä¾‹å­ä¸‹é¢æ˜¯åœ¨Javaä¸­ä½¿ç”¨wait(),notify(),notifyAll()çš„ä¾‹å­ã€‚åœ¨è¿™ä¸ªç¨‹åºä¸­ï¼Œæœ‰ä¸¤ä¸ªçº¿ç¨‹(PRODUCTORå’ŒCONSUMER)ï¼Œç”¨ç»§æ‰¿äº†Threadç±»çš„Producerå’ŒConsumerç±»å®ç°ã€‚Prodcuerå’ŒConsumerçš„ä¸šåŠ¡é€»è¾‘å†™åœ¨ä»–ä»¬å„è‡ªçš„run()æ–¹æ³•ä¸­ã€‚å¹¶ä¸”å®ç°ä¸€ä¸ªLinkedListï¼Œå½“åšå…±äº«é˜Ÿåˆ—ã€‚Produceråœ¨ä¸€ä¸ªæ­»å¾ªç¯ä¸­ä¸æ–­åœ¨é˜Ÿåˆ—ä¸­æ’å…¥éšæœºæ•°ï¼Œç›´åˆ°é˜Ÿåˆ—æ»¡äº†ã€‚æˆ‘ä»¬ä¼šæ£€æŸ¥while(queue.size == maxSize),éœ€è¦æ³¨æ„çš„æ˜¯åœ¨æ£€æŸ¥ä¹‹å‰éœ€è¦ç»™é˜Ÿåˆ—åŠ ä¸ŠåŒæ­¥é”ä»¥ä¿è¯åœ¨æ£€æŸ¥æ—¶æ²¡æœ‰å¦ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹é˜Ÿåˆ—ã€‚å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼ŒPRODUCERçº¿ç¨‹å°±ä¼šä¼‘çœ ï¼Œç›´åˆ°CONSUMERæ¶ˆè´¹äº†é˜Ÿåˆ—ä¸­çš„å…ƒç´ å¹¶ä¸”è°ƒç”¨notify()æ–¹æ³•é€šçŸ¥PRODUCERçº¿ç¨‹ã€‚waitå’Œnotifyéƒ½æ˜¯åœ¨å…±äº«çš„å¯¹è±¡(æˆ‘ä»¬çš„ä¾‹å­ä¸­æ˜¯é˜Ÿåˆ—)ä¸Šè°ƒç”¨çš„ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113import java.util.LinkedList;import java.util.Queue;import java.util.Random;/** * Simple Java program to demonstrate How to use wait, notify and notifyAll() * method in Java by solving producer consumer problem. * * @author Javin Paul */public class MultipleThread &#123; public static void main(String args[]) &#123; System.out.println(\"How to use wait and notify method in Java\"); System.out.println(\"Solving Producer Consumper Problem\"); Queue&lt;Integer&gt; buffer = new LinkedList&lt;&gt;(); int maxSize = 10; Thread producer = new Producer(buffer, maxSize, \"PRODUCER\"); Thread consumer = new Consumer(buffer, maxSize, \"CONSUMER\"); producer.start(); consumer.start(); &#125;&#125;/** * Producer Thread will keep producing values for Consumer * to consumer. It will use wait() method when Queue is full * and use notify() method to send notification to Consumer * Thread. * @author WINDOWS 8 * */class Producer extends Thread &#123; private Queue&lt;Integer&gt; queue; private int maxSize; public Producer(Queue&lt;Integer&gt; queue, int maxSize, String name) &#123; super(name); this.queue = queue; this.maxSize = maxSize; &#125; @Override public void run() &#123; while (true) &#123; synchronized (queue) &#123; while (queue.size() == maxSize) &#123; try &#123; System.out .println(\"Queue is full, \" + \"Producer thread waiting for \" + \"consumer to take something from queue\"); queue.wait(); &#125; catch (Exception ex) &#123; ex.printStackTrace(); &#125; &#125; Random random = new Random(); int i = random.nextInt(); System.out.println(\"Producing value : \" + i); queue.add(i); queue.notifyAll(); &#125; &#125; &#125;&#125;/** * Consumer Thread will consumer values form shared queue. * It will also use wait() method to wait if queue is * empty. It will also use notify method to send * notification to producer thread after consuming values * from queue. * @author WINDOWS 8 **/class Consumer extends Thread &#123; private Queue&lt;Integer&gt; queue; private int maxSize; public Consumer(Queue&lt;Integer&gt; queue, int maxSize, String name)&#123; super(name); this.queue = queue; this.maxSize = maxSize; &#125; @Override public void run() &#123; while (true) &#123; synchronized (queue) &#123; while (queue.isEmpty()) &#123; System.out.println(\"Queue is empty,\" + \"Consumer thread is waiting\" + \" for producer thread to put something in queue\"); try &#123; queue.wait(); &#125; catch (Exception ex) &#123; ex.printStackTrace(); &#125; &#125; System.out.println(\"Consuming value : \" + queue.remove()); queue.notifyAll(); &#125; &#125; &#125;&#125;Output How to use wait and notify method in Java Solving Producer Consumper Problem Queue is empty,Consumer thread is waiting for producer thread to put something in queue Producing value : -1692411980 Producing value : 285310787 Producing value : -1045894970 Producing value : 2140997307 Producing value : 1379699468 Producing value : 912077154 Producing value : -1635438928 Producing value : -500696499 Producing value : -1985700664 Producing value : 961945684 Queue is full, Producer thread waiting for consumer to take something from queue Consuming value : -1692411980 Consuming value : 285310787 Consuming value : -1045894970 Consuming value : 2140997307 Consuming value : 1379699468 Consuming value : 912077154 Consuming value : -1635438928 Consuming value : -500696499 Consuming value : -1985700664 Consuming value : 961945684 Queue is empty,Consumer thread is waiting for producer thread to put something in queue ä¸ºäº†æ›´å¥½çš„ç†è§£è¿™ä¸ªç¨‹åºï¼Œæˆ‘å»ºè®®å¤§å®¶ä½¿ç”¨debugæ¨¡å¼è¿è¡Œã€‚ ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAlléœ€è¦æ³¨æ„çš„ åœ¨Javaä¸­å¯ä»¥ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAllå®Œæˆå¤šçº¿ç¨‹(ä¸ä»…ä»…æ˜¯ä¸¤ä¸ªçº¿ç¨‹)çš„å†…éƒ¨é€šä¿¡ã€‚ åœ¨åŒæ­¥æ–¹æ³•æˆ–åŒæ­¥å—ä¸­ä½¿ç”¨waitï¼Œnotifyï¼ŒnotifyAllï¼Œå¦åˆ™JVMä¼šæŠ›å‡ºIllegalMonitorStateException åœ¨å¾ªç¯ä¸­è°ƒç”¨waitï¼Œnotifyã€‚ åœ¨çº¿ç¨‹å…±äº«çš„å¯¹è±¡ä¸Šè°ƒç”¨wait åå‘é€‰æ‹©notifyAllï¼Œè€Œä¸æ˜¯notifyï¼ŒåŸå› åœ¨è¿™ç¯‡æ–‡ç« é‡Œ","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"},{"name":"thread","slug":"java/thread","permalink":"http://yemengying.com/categories/java/thread/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"ç¿»è¯‘","slug":"ç¿»è¯‘","permalink":"http://yemengying.com/tags/ç¿»è¯‘/"}]},{"title":"ä½¿ç”¨åŸºäºæ³¨è§£çš„mybatisæ—¶,åˆ©ç”¨åå°„å’Œæ³¨è§£ç”Ÿæˆsqlè¯­å¥","slug":"åŸºäºæ³¨è§£çš„mybatisæ’å…¥å¯¹è±¡æ—¶åˆ©ç”¨åå°„ç”Ÿæˆsqlè¯­å¥","date":"2015-10-28T05:21:29.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/10/28/åŸºäºæ³¨è§£çš„mybatisæ’å…¥å¯¹è±¡æ—¶åˆ©ç”¨åå°„ç”Ÿæˆsqlè¯­å¥/","link":"","permalink":"http://yemengying.com/2015/10/28/åŸºäºæ³¨è§£çš„mybatisæ’å…¥å¯¹è±¡æ—¶åˆ©ç”¨åå°„ç”Ÿæˆsqlè¯­å¥/","excerpt":"åœ¨å¼€å‘æ—¶é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨ä½¿ç”¨åŸºäºæ³¨è§£çš„mybatisæ’å…¥ä¸€ä¸ªå¯¹è±¡åˆ°mysqlæ—¶ï¼Œåœ¨å†™sqlè¯­å¥æ—¶éœ€è¦åˆ—å‡ºå¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œæ‰€ä»¥åœ¨æ’å…¥ä¸€ä¸ªæ‹¥æœ‰10ä¸ªä»¥ä¸Šå±æ€§çš„å¯¹è±¡æ—¶sqlè¯­å¥å°±ä¼šå˜å¾—å¾ˆé•¿ï¼Œå†™èµ·æ¥ä¹Ÿå¾ˆä¸æ–¹ä¾¿,ä¹Ÿå¾ˆå®¹æ˜“æ‹¼é”™ã€‚googleäº†ä¸€ä¸‹ä¹Ÿæ²¡æœ‰æ‰¾åˆ°ä»€ä¹ˆè§£å†³æ–¹å¼(å¯èƒ½æ˜¯å§¿åŠ¿ä¸å¯¹ğŸ˜œ)ï¼Œåœ¨stackoverflowä¸Šæçš„é—®é¢˜æˆªæ­¢ç›®å‰è¿˜æ²¡æœ‰äººå›ç­”ã€‚æ‰€ä»¥è‡ªå·±æƒ³äº†ä¸€ä¸ªåŸºäºåå°„å’Œæ³¨è§£çš„è§£å†³åŠæ³•gitåœ°å€ï¼š loadStyle(\"/hexo-github/style.css\"); loadStyle(\"/hexo-github/octicons/octicons.css\"); new Badge(\"#badge-container-giraffe0813-spring-mybatis-utils-a555c91\", \"giraffe0813\", \"spring-mybatis-utils\", \"a555c91\", false);","keywords":null,"text":"åœ¨å¼€å‘æ—¶é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨ä½¿ç”¨åŸºäºæ³¨è§£çš„mybatisæ’å…¥ä¸€ä¸ªå¯¹è±¡åˆ°mysqlæ—¶ï¼Œåœ¨å†™sqlè¯­å¥æ—¶éœ€è¦åˆ—å‡ºå¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œæ‰€ä»¥åœ¨æ’å…¥ä¸€ä¸ªæ‹¥æœ‰10ä¸ªä»¥ä¸Šå±æ€§çš„å¯¹è±¡æ—¶sqlè¯­å¥å°±ä¼šå˜å¾—å¾ˆé•¿ï¼Œå†™èµ·æ¥ä¹Ÿå¾ˆä¸æ–¹ä¾¿,ä¹Ÿå¾ˆå®¹æ˜“æ‹¼é”™ã€‚googleäº†ä¸€ä¸‹ä¹Ÿæ²¡æœ‰æ‰¾åˆ°ä»€ä¹ˆè§£å†³æ–¹å¼(å¯èƒ½æ˜¯å§¿åŠ¿ä¸å¯¹ğŸ˜œ)ï¼Œåœ¨stackoverflowä¸Šæçš„é—®é¢˜æˆªæ­¢ç›®å‰è¿˜æ²¡æœ‰äººå›ç­”ã€‚æ‰€ä»¥è‡ªå·±æƒ³äº†ä¸€ä¸ªåŸºäºåå°„å’Œæ³¨è§£çš„è§£å†³åŠæ³•gitåœ°å€ï¼š loadStyle(\"/hexo-github/style.css\"); loadStyle(\"/hexo-github/octicons/octicons.css\"); new Badge(\"#badge-container-giraffe0813-spring-mybatis-utils-a555c91\", \"giraffe0813\", \"spring-mybatis-utils\", \"a555c91\", false); ä¸‹é¢æ˜¯ä¹‹å‰çš„ä»£ç ç‰‡æ®µ: 123@Insert(\"insert into poi_shop(name,brand,tags,status,phone,mobile,business_time,address,city,lng,lat,business_type,attribute_json) values(#&#123;name&#125;,#&#123;brand&#125;,#&#123;tags&#125;,#&#123;status&#125;,#&#123;phone&#125;,#&#123;mobile&#125;,#&#123;business_time&#125;,#&#123;address&#125;,#&#123;city&#125;,#&#123;lng&#125;,#&#123;lat&#125;,#&#123;business_type&#125;,#&#123;attribute_json&#125;)\")@Options(useGeneratedKeys = true, keyProperty = \"id\", keyColumn = \"id\")public Long insertPoiInfo(PoiBo poiBo); æ˜¯ä¸æ˜¯too looooooooooooongï¼š ç¬¬ä¸€ç‰ˆ(åˆ©ç”¨åå°„)é¦–å…ˆæƒ³åˆ°çš„æ˜¯å¯ä»¥åˆ©ç”¨åå°„è·å¾—å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œç„¶åæ‹¼æ¥æˆsqlè¯­å¥ã€‚æ‰€ä»¥å†™äº†ä¸€ä¸ªåŸºäºåå°„æ‹¼è£…sqlè¯­å¥çš„æ–¹æ³•ï¼Œç„¶ååŸºäºmybatisåŠ¨æ€è·å¾—sqlè¯­å¥çš„æ–¹å¼ è·å¾—å®Œæ•´çš„sql å…·ä½“çš„ä»£ç å¦‚ä¸‹:æ¥å£å±‚æ”¹ä¸ºä¸‹é¢çš„æ ·å­ï¼Œsqlè¯­å¥çš„ç”Ÿæˆæ”¾åˆ°PoiSqlProviderçš„insertPoiBoæ–¹æ³•ä¸­ 12@InsertProvider(type = PoiSqlProvider.class, method = \"insertPoiBo\")public Long insertPoiInfo(@Param(\"poiBo\")PoiBo poiBo); PoiSqlProvider.class 1234567891011121314151617181920212223242526272829303132333435363738 public String insertPoiBo(Map&lt;String,Object&gt; map)&#123; PoiBo poiBo = (PoiBo)map.get(\"poiBo\"); StringBuilder sql = new StringBuilder(\"insert into poi_shop \"); //get sql via reflection Map&lt;String,String&gt; sqlMap = getAllPropertiesForSql(poiBo, \"poiBo\"); // sql.append(sqlMap.get(\"field\")).append(sqlMap.get(\"value\")); System.out.println(sql.toString()); return sql.toString(); &#125;//æ ¹æ®ä¼ å…¥çš„å¯¹è±¡ åŸºäºåå°„ç”Ÿæˆä¸¤éƒ¨åˆ†sqlè¯­å¥ private Map&lt;String,String&gt; getAllPropertiesForSql(Object obj, String objName)&#123; Map&lt;String,String&gt; map = new HashMap&lt;String,String&gt;(); if(null == obj) return map; StringBuilder filedSql = new StringBuilder(\"(\"); StringBuilder valueSql = new StringBuilder(\"value (\"); Field[] fields = obj.getClass().getDeclaredFields(); for (int i = 0; i &lt; fields.length; i++) &#123; filedSql.append(fields[i].getName() + \",\"); valueSql.append(\"#&#123;\" + objName + \".\" + fields[i].getName() + \"&#125;,\"); &#125; //remove last ',' valueSql.deleteCharAt(valueSql.length() - 1); filedSql.deleteCharAt(filedSql.length() - 1); valueSql.append(\") \"); filedSql.append(\") \"); map.put(\"field\",filedSql.toString()); map.put(\"value\", valueSql.toString()); System.out.println(\"database filed sql: \" + filedSql.toString()); System.out.println(\"value sql:\" + valueSql.toString()); return map; &#125; ä¸‹é¢æ˜¯åŸºäºåå°„ç”Ÿæˆçš„ä¸¤éƒ¨åˆ†sqè¯­å¥å’Œæœ€åæ‹¼æ¥çš„è¯­å¥ 123456789database filed sql: (id,name,brand,tags,status,phone,mobile,business_time,address,city,lng,lat,business_type,attribute_json,updated_at,created_at) value sql:value(#&#123;poiBo.id&#125;,#&#123;poiBo.name&#125;,#&#123;poiBo.brand&#125;,#&#123;poiBo.tags&#125;,#&#123;poiBo.status&#125;,#&#123;poiBo.phone&#125;,#&#123;poiBo.mobile&#125;,#&#123;poiBo.business_time&#125;,#&#123;poiBo.address&#125;,#&#123;poiBo.city&#125;,#&#123;poiBo.lng&#125;,#&#123;poiBo.lat&#125;,#&#123;poiBo.business_type&#125;,#&#123;poiBo.attribute_json&#125;,#&#123;poiBo.updated_at&#125;,#&#123;poiBo.created_at&#125;) insert into poi_shop (id,name,brand,tags,status,phone,mobile,business_time,address,city,lng,lat,business_type,attribute_json,updated_at,created_at) value (#&#123;poiBo.id&#125;,#&#123;poiBo.name&#125;,#&#123;poiBo.brand&#125;,#&#123;poiBo.tags&#125;,#&#123;poiBo.status&#125;,#&#123;poiBo.phone&#125;,#&#123;poiBo.mobile&#125;,#&#123;poiBo.business_time&#125;,#&#123;poiBo.address&#125;,#&#123;poiBo.city&#125;,#&#123;poiBo.lng&#125;,#&#123;poiBo.lat&#125;,#&#123;poiBo.business_type&#125;,#&#123;poiBo.attribute_json&#125;,#&#123;poiBo.updated_at&#125;,#&#123;poiBo.created_at&#125;) è¦æ³¨æ„çš„æ˜¯å¦‚æœæ•°æ®åº“çš„å­—æ®µåå’Œæ’å…¥å¯¹è±¡çš„å±æ€§åä¸ä¸€è‡´ï¼Œé‚£ä¹ˆä¸èƒ½ä½¿ç”¨ç”Ÿæˆçš„database filed sqlã€‚ æœ€ç»ˆç‰ˆ(åŠ å…¥æ³¨è§£)ä¸Šé¢çš„getAllPropertiesForSqlæ–¹æ³•æœ‰ä¸ªç¼ºç‚¹ï¼Œå¦‚æœæ•°æ®åº“çš„å­—æ®µåå’Œç±»çš„å±æ€§åä¸ä¸€è‡´ï¼Œå°±ä¸èƒ½ä¾é åå°„è·å¾—sqläº†ã€‚æ‰€ä»¥å€Ÿé‰´è€å¤§çš„ORMæ¡†æ¶ä¹Ÿå†™äº†ä¸€ä¸ªæ³¨è§£Columnï¼Œç”¨äºmodelç±»çš„å±æ€§ä¸Šï¼Œè¡¨æ˜å±æ€§æ‰€å¯¹åº”æ•°æ®åº“å­—æ®µã€‚ä¸‹é¢æ˜¯Columnæ³¨è§£çš„snippetã€‚ 123456789101112131415161718import java.lang.annotation.ElementType;import java.lang.annotation.Retention;import java.lang.annotation.RetentionPolicy;import java.lang.annotation.Target;/* å®šä¹‰å­—æ®µçš„æ³¨è§£*/@Retention(RetentionPolicy.RUNTIME)/*è¯¥æ³¨è§£åªèƒ½ç”¨åœ¨æˆå‘˜å˜é‡ä¸Š*/@Target(ElementType.FIELD)public @interface Column &#123; /** * ç”¨æ¥å­˜æ”¾å­—æ®µçš„åå­— å¦‚æœæœªæŒ‡å®šåˆ—åï¼Œé»˜è®¤åˆ—åä½¿ç”¨æˆå‘˜å˜é‡å * * @return */ String name() default \"\"; &#125; ä¹‹ååœ¨modelç±»å±æ€§ä¸ŠåŠ å…¥å¯¹åº”çš„æ³¨è§£,çœç•¥getterå’Œsetterã€‚Columnçš„nameä¸ºç©ºæ—¶ï¼Œä»£è¡¨å±æ€§åå’Œå­—æ®µåä¸€è‡´ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738public class PoiBo &#123; @Column private Long id; @Column(name = \"poi_name\") private String name;//è¡¨ç¤ºnameå±æ€§å¯¹åº”æ•°æ®åº“poi_nameå­—æ®µ @Column(name = \"poi_brand\") private String brand;//è¡¨ç¤ºbrandå±æ€§å¯¹åº”æ•°æ®åº“poi_brandå­—æ®µ @Column private String tags; @Column private Integer status; @Column private String phone; @Column private String mobile; @Column private String business_time; @Column private Float average_price; @Column private String address; @Column private String city; @Column private Double lng; @Column private Double lat; @Column private String business_type; @Column private String attribute_json; @Column private Timestamp updated_at; @Column private Timestamp created_at; &#125; ä¿®æ”¹getAllPropertiesForSqlæ–¹æ³•ï¼Œé€šè¿‡è·å–ç±»å±æ€§ä¸Šçš„æ³¨è§£è·å¾—æ•°æ®åº“å­—æ®µåã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940private Map&lt;String,String&gt; getAllPropertiesForSql(Object obj, String objName)&#123; Map&lt;String,String&gt; map = new HashMap&lt;String,String&gt;(); if(null == obj) return map; StringBuilder filedSql = new StringBuilder(\"(\"); StringBuilder valueSql = new StringBuilder(\"value (\"); Field[] fields = obj.getClass().getDeclaredFields(); for (Field field : fields) &#123; // åˆ¤æ–­è¯¥æˆå‘˜å˜é‡ä¸Šæ˜¯ä¸æ˜¯å­˜åœ¨Columnç±»å‹çš„æ³¨è§£ if (!field.isAnnotationPresent(Column.class)) &#123; continue; &#125; Column c = field.getAnnotation(Column.class);// è·å–å®ä¾‹ // è·å–å…ƒç´ å€¼ String columnName = c.name(); // å¦‚æœæœªæŒ‡å®šåˆ—åï¼Œé»˜è®¤åˆ—åä½¿ç”¨æˆå‘˜å˜é‡å if (\"\".equals(columnName.trim())) &#123; columnName = field.getName(); &#125; filedSql.append(columnName + \",\"); valueSql.append(\"#&#123;\" + objName + \".\" + field.getName() + \"&#125;,\"); &#125; //remove last ',' valueSql.deleteCharAt(valueSql.length() - 1); filedSql.deleteCharAt(filedSql.length() - 1); valueSql.append(\") \"); filedSql.append(\") \"); map.put(\"field\",filedSql.toString()); map.put(\"value\", valueSql.toString()); System.out.println(\"database filed sql: \" + filedSql.toString()); System.out.println(\"value sql:\" + valueSql.toString()); return map; &#125;` åˆ©ç”¨åå°„+æ³¨è§£ä¹‹åçš„è¾“å‡ºç»“æœï¼Œå¯ä»¥çœ‹åˆ°sqlè¯­å¥æ­£ç¡®æŒ‰ç…§nameçš„Columnæ³¨è§£çš„è¾“å‡ºäº†nameå±æ€§å¯¹åº”çš„æ•°æ®åº“å­—æ®µæ˜¯poi_name. 123456789database filed sql: (id,poi_name,poi_brand,tags,status,phone,mobile,business_time,average_price,address,city,lng,lat,business_type,attribute_json,updated_at,created_at) value sql:value(#&#123;poiBo.id&#125;,#&#123;poiBo.name&#125;,#&#123;poiBo.brand&#125;,#&#123;poiBo.tags&#125;,#&#123;poiBo.status&#125;,#&#123;poiBo.phone&#125;,#&#123;poiBo.mobile&#125;,#&#123;poiBo.business_time&#125;,#&#123;poiBo.average_price&#125;,#&#123;poiBo.address&#125;,#&#123;poiBo.city&#125;,#&#123;poiBo.lng&#125;,#&#123;poiBo.lat&#125;,#&#123;poiBo.business_type&#125;,#&#123;poiBo.attribute_json&#125;,#&#123;poiBo.updated_at&#125;,#&#123;poiBo.created_at&#125;) insert into poi_shop (id,poi_name,poi_brand,tags,status,phone,mobile,business_time,average_price,address,city,lng,lat,business_type,attribute_json,updated_at,created_at) value (#&#123;poiBo.id&#125;,#&#123;poiBo.name&#125;,#&#123;poiBo.brand&#125;,#&#123;poiBo.tags&#125;,#&#123;poiBo.status&#125;,#&#123;poiBo.phone&#125;,#&#123;poiBo.mobile&#125;,#&#123;poiBo.business_time&#125;,#&#123;poiBo.average_price&#125;,#&#123;poiBo.address&#125;,#&#123;poiBo.city&#125;,#&#123;poiBo.lng&#125;,#&#123;poiBo.lat&#125;,#&#123;poiBo.business_type&#125;,#&#123;poiBo.attribute_json&#125;,#&#123;poiBo.updated_at&#125;,#&#123;poiBo.created_at&#125;) å†™çš„å¥½ç´¯æ”¾å¼ èŒå›¾å§","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"annotation","slug":"annotation","permalink":"http://yemengying.com/tags/annotation/"},{"name":"mybatis","slug":"mybatis","permalink":"http://yemengying.com/tags/mybatis/"},{"name":"reflection","slug":"reflection","permalink":"http://yemengying.com/tags/reflection/"}]},{"title":"ã€è¯‘ã€‘å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList--clear vs removeAll","slug":"è¯‘-å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList-clear-vs-removeAll","date":"2015-10-26T15:20:04.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/10/26/è¯‘-å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList-clear-vs-removeAll/","link":"","permalink":"http://yemengying.com/2015/10/26/è¯‘-å¦‚ä½•é‡ç½®ä¸€ä¸ªArrayList-clear-vs-removeAll/","excerpt":"å®‰åˆ©ä¸€ä¸ªAPPâ€“å¼€å‘è€…å¤´æ¡ï¼Œåœ¨ä¸Šé¢å‘ç°ä¸€ä¸ªä¸é”™çš„è‹±æ–‡æŠ€æœ¯ç±»åšå®¢ï¼Œåœ°å€http://javarevisited.blogspot.com/ï¼Œ ä¼šä¸å®šæœŸçš„ç¿»è¯‘ä¸€äº› ç¿»è¯‘ä¸å¥½è§è°…å•ŠğŸ˜¼ åŸæ–‡åœ°å€ï¼šhttp://javarevisited.blogspot.co.uk/2015/09/how-to-reset-arraylist-in-java-clear-vs-removeAll-example.html å¾ˆå¤šæ—¶å€™ä¸ºäº†é‡ç”¨æˆ‘ä»¬ä¼šæƒ³è¦é‡ç½®ä¸€ä¸ªArrayListï¼Œè¿™é‡Œçš„é‡ç½®æ˜¯æŒ‡æ¸…ç©ºåˆ—è¡¨æˆ–ç§»é™¤åˆ—è¡¨æ‰€æœ‰çš„å…ƒç´ ã€‚åœ¨Javaä¸­ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°é‡ç½®clearæˆ–removeAllã€‚åœ¨åˆ—è¡¨é•¿åº¦å¾ˆå°çš„æƒ…å†µä¸‹(eg:10æˆ–100ä¸ªå…ƒç´ )ï¼Œå¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•ã€‚ä½†å¦‚æœåˆ—è¡¨å¾ˆå¤§(eg:10Mä¸ªå…ƒç´ )ï¼Œé‚£ä¹ˆé€‰æ‹©clearè¿˜æ˜¯removeAllä¼šå¯¹ä½ javaåº”ç”¨çš„æ€§èƒ½é€ æˆå·¨å¤§çš„å½±å“ã€‚ç”šè‡³æœ‰æ—¶ï¼Œåœ¨åˆ—è¡¨è¿‡å¤§çš„æƒ…å†µä¸‹ï¼Œé‡ç½®ä¼šè€—è´¹è®¸å¤šæ—¶é—´ï¼Œé‚£ä¹ˆé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨æ¯”å°†è€çš„åˆ—è¡¨é‡ç½®è¦å¥½ã€‚ä½†éœ€è¦æé†’çš„æ˜¯ï¼Œå¿…é¡»è¦ç¡®ä¿è€çš„åˆ—è¡¨å¯ä»¥è¢«åƒåœ¾å›æ”¶ï¼Œå¦åˆ™ï¼Œæœ‰å¾ˆå¤§çš„é£é™©ä¼šå‡ºç°java.lang.OutOfMemoryError: Java Heap Spaceã€‚è¨€å½’æ­£ä¼ ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹clear()å’ŒremoveAll()ä¸¤ä¸ªæ–¹æ³•ã€‚å¤§å®¶åº”è¯¥å¸¸å¸¸ä¼šé€‰æ‹©ç”¨clear(),å› ä¸ºä»–çš„å¤æ‚åº¦æ˜¯O(n),è€Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒremoveAll(Collection C)çš„æ€§èƒ½è¦å·®ä¸€äº›ï¼Œå®ƒçš„å¤æ‚åº¦æ˜¯O(n^2)ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨é‡ç½®å¤§çš„åˆ—è¡¨çš„æ—¶å€™ä¸¤ä¸ªæ–¹æ³•ä¼šæœ‰å·¨å¤§çš„å·®å¼‚ã€‚å¦‚æœé˜…è¯»ä»–ä»¬çš„æºç å¹¶è¿è¡Œä¸‹é¢çš„ä¾‹å­ç¨‹åºï¼Œå·®å¼‚ä¼šæ›´æ˜æ˜¾ã€‚","keywords":null,"text":"å®‰åˆ©ä¸€ä¸ªAPPâ€“å¼€å‘è€…å¤´æ¡ï¼Œåœ¨ä¸Šé¢å‘ç°ä¸€ä¸ªä¸é”™çš„è‹±æ–‡æŠ€æœ¯ç±»åšå®¢ï¼Œåœ°å€http://javarevisited.blogspot.com/ï¼Œ ä¼šä¸å®šæœŸçš„ç¿»è¯‘ä¸€äº› ç¿»è¯‘ä¸å¥½è§è°…å•ŠğŸ˜¼ åŸæ–‡åœ°å€ï¼šhttp://javarevisited.blogspot.co.uk/2015/09/how-to-reset-arraylist-in-java-clear-vs-removeAll-example.html å¾ˆå¤šæ—¶å€™ä¸ºäº†é‡ç”¨æˆ‘ä»¬ä¼šæƒ³è¦é‡ç½®ä¸€ä¸ªArrayListï¼Œè¿™é‡Œçš„é‡ç½®æ˜¯æŒ‡æ¸…ç©ºåˆ—è¡¨æˆ–ç§»é™¤åˆ—è¡¨æ‰€æœ‰çš„å…ƒç´ ã€‚åœ¨Javaä¸­ï¼Œæœ‰ä¸¤ä¸ªæ–¹æ³•å¯ä»¥å¸®åŠ©æˆ‘ä»¬å®ç°é‡ç½®clearæˆ–removeAllã€‚åœ¨åˆ—è¡¨é•¿åº¦å¾ˆå°çš„æƒ…å†µä¸‹(eg:10æˆ–100ä¸ªå…ƒç´ )ï¼Œå¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨è¿™ä¸¤ç§æ–¹æ³•ã€‚ä½†å¦‚æœåˆ—è¡¨å¾ˆå¤§(eg:10Mä¸ªå…ƒç´ )ï¼Œé‚£ä¹ˆé€‰æ‹©clearè¿˜æ˜¯removeAllä¼šå¯¹ä½ javaåº”ç”¨çš„æ€§èƒ½é€ æˆå·¨å¤§çš„å½±å“ã€‚ç”šè‡³æœ‰æ—¶ï¼Œåœ¨åˆ—è¡¨è¿‡å¤§çš„æƒ…å†µä¸‹ï¼Œé‡ç½®ä¼šè€—è´¹è®¸å¤šæ—¶é—´ï¼Œé‚£ä¹ˆé‡æ–°åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨æ¯”å°†è€çš„åˆ—è¡¨é‡ç½®è¦å¥½ã€‚ä½†éœ€è¦æé†’çš„æ˜¯ï¼Œå¿…é¡»è¦ç¡®ä¿è€çš„åˆ—è¡¨å¯ä»¥è¢«åƒåœ¾å›æ”¶ï¼Œå¦åˆ™ï¼Œæœ‰å¾ˆå¤§çš„é£é™©ä¼šå‡ºç°java.lang.OutOfMemoryError: Java Heap Spaceã€‚è¨€å½’æ­£ä¼ ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹clear()å’ŒremoveAll()ä¸¤ä¸ªæ–¹æ³•ã€‚å¤§å®¶åº”è¯¥å¸¸å¸¸ä¼šé€‰æ‹©ç”¨clear(),å› ä¸ºä»–çš„å¤æ‚åº¦æ˜¯O(n),è€Œç›¸æ¯”ä¹‹ä¸‹ï¼ŒremoveAll(Collection C)çš„æ€§èƒ½è¦å·®ä¸€äº›ï¼Œå®ƒçš„å¤æ‚åº¦æ˜¯O(n^2)ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨é‡ç½®å¤§çš„åˆ—è¡¨çš„æ—¶å€™ä¸¤ä¸ªæ–¹æ³•ä¼šæœ‰å·¨å¤§çš„å·®å¼‚ã€‚å¦‚æœé˜…è¯»ä»–ä»¬çš„æºç å¹¶è¿è¡Œä¸‹é¢çš„ä¾‹å­ç¨‹åºï¼Œå·®å¼‚ä¼šæ›´æ˜æ˜¾ã€‚ Clear() vs RemoveAll(Collection c)ä¸ºäº†æ›´å¥½çš„æ¯”è¾ƒè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œé˜…è¯»ä»–ä»¬æºç æ˜¯å¾ˆé‡è¦çš„ã€‚å¯ä»¥åœ¨java.utils.ArrayListç±»ä¸­æ‰¾åˆ°clear()æ–¹æ³•ï¼Œä¸è¿‡ä¸ºäº†æ–¹ä¾¿æˆ‘å°†å®ƒå¼•å…¥åˆ°äº†è¿™é‡Œã€‚ä¸‹é¢çš„ä»£ç æ¥è‡ªJDK 1.7.0_40ç‰ˆæœ¬ã€‚å¦‚æœä½ æƒ³è¦å­¦ä¹ æ›´å¤šçš„æœ‰å…³æ€§èƒ½ç›‘æ§å’Œè°ƒä¼˜çš„çŸ¥è¯†ï¼Œæˆ‘å¼ºçƒˆå»ºè®®é˜…è¯»Scott Oakså†™çš„Java Performance the Definitive Guide,å®ƒåŒ…å«äº†java 7å’Œä¸€ç‚¹java 8ã€‚ä¸‹é¢æ˜¯clear()çš„ä»£ç ç‰‡æ®µ: 12345678910/** * Removes all of the elements from this list.The list will * be empty after this call returns. */ public void clear() &#123; modCount++; // clear to let GC do its work for (int i = 0; i &lt; size; i++) elementData[i] = null; size = 0; &#125; å¤§å®¶å¯ä»¥çœ‹å‡ºï¼Œclear()åœ¨å¾ªç¯éå†ArrayListï¼Œå¹¶ä¸”å°†æ¯ä¸€ä¸ªå…ƒç´ éƒ½ç½®ä¸ºnullï¼Œä½¿å®ƒä»¬åœ¨æ²¡æœ‰è¢«å¤–éƒ¨å¼•ç”¨çš„æƒ…å†µä¸‹å¯ä»¥è¢«åƒåœ¾å›æ”¶ã€‚ç›¸ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨java.util.AbstractCollectionç±»ä¸­æŸ¥çœ‹removeAll(Collention c)çš„ä»£ç ï¼Œä¸‹é¢æ˜¯ä»£ç ç‰‡æ®µ: 12345678910111213public boolean removeAll(Collection&lt;?&gt; c) &#123; //åˆ¤æ–­å¯¹è±¡æ˜¯å¦ä¸ºnull Objects.requireNonNull(c); boolean modified = false; Iterator&lt;?&gt; it = iterator(); while (it.hasNext()) &#123; if (c.contains(it.next())) &#123; it.remove(); modified = true; &#125; &#125; return modified; &#125; è¿™ä¸ªæ–¹æ³•ä¼šæ£€æŸ¥è¿­ä»£å™¨é¡ºåºè¿”å›çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦åŒ…å«åœ¨ç‰¹å®šçš„é›†åˆä¸­ã€‚å¦‚æœå­˜åœ¨ï¼Œè°ƒç”¨è¿­ä»£å™¨çš„removeæ–¹æ³•å°†å®ƒä»é›†åˆä¸­ç§»é™¤ã€‚å› ä¸ºä¼šç”¨åˆ°containsæ–¹æ³•ï¼ŒremoveAllçš„å¤æ‚åº¦æ˜¯O(n^2)ã€‚æ‰€ä»¥åœ¨æƒ³è¦é‡ç½®ä¸€ä¸ªå¤§çš„ArrayListæ—¶ï¼Œè¿™ç§æ–¹æ³•æ˜¯ç»å¯¹ä¸å¯å–çš„ã€‚ä¸‹é¢æˆ‘ä»¬æ¯”è¾ƒä¸€ä¸‹ä¸¤è€…åœ¨é‡ç½®ä¸€ä¸ªåŒ…å«100Kä¸ªå…ƒç´ æ—¶çš„æ€§èƒ½å·®å¼‚ã€‚ åˆ é™¤ä¸€ä¸ªåŒ…å«100kä¸ªå…ƒç´ çš„åˆ—è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ æˆ‘æœ¬æ¥æƒ³åœ¨ä¾‹å­ä¸­å°è¯•é‡ç½®ä¸€ä¸ªåŒ…å«10Mä¸ªå…ƒç´ çš„åˆ—è¡¨ï¼Œä¸è¿‡åœ¨è¶…è¿‡åŠä¸ªå°æ—¶ç­‰å¾…removeAll()ç»“æŸåï¼Œæˆ‘å†³å®šå°†å…ƒç´ çš„æ•°é‡é™ä¸º100Kã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸¤ä¸ªæ–¹æ³•çš„å·®è·ä¹Ÿæ˜¯å¾ˆæ˜æ˜¾çš„ã€‚removeAll()æ¯”clear()å¤šèŠ±è´¹äº†10000å€çš„æ—¶é—´ã€‚äº‹å®ä¸Šï¼Œåœ¨APIä¸­clear()å’ŒremoveAll(Collection c)è¿™ä¸¤ä¸ªæ–¹æ³•çš„ç›®çš„æ˜¯ä¸åŒçš„ã€‚clear()æ–¹æ³•æ˜¯ä¸ºäº†é€šè¿‡åˆ é™¤æ‰€æœ‰å…ƒç´ è€Œé‡ç½®åˆ—è¡¨ï¼Œè€ŒremoveAll(Collection c)æ˜¯ä¸ºäº†ä»é›†åˆä¸­åˆ é™¤æŸäº›å­˜åœ¨äºå¦ä¸€ä¸ªæä¾›çš„é›†åˆä¸­çš„å…ƒç´ ï¼Œå¹¶ä¸æ˜¯ä¸ºäº†ä»é›†åˆä¸­ç§»é™¤æ‰€æœ‰å…ƒç´ ã€‚æ‰€ä»¥å¦‚æœä½ çš„ç›®çš„æ˜¯åˆ é™¤æ‰€æœ‰å…ƒç´ ï¼Œç”¨clear(),å¦‚æœä½ çš„ç›®çš„æ˜¯åˆ é™¤æŸäº›å­˜åœ¨äºå¦ä¸€é›†åˆçš„å…ƒç´ ï¼Œé‚£ä¹ˆé€‰æ‹©removeAll(Collection c)æ–¹æ³•ã€‚ 1234567891011121314151617181920212223242526272829303132333435import java.util.ArrayList; /** * Java Program to remove all elements from list in Java and comparing * performance of clearn() and removeAll() method. * * @author Javin Paul */ public class ArrayListResetTest &#123; private static final int SIZE = 100_000; public static void main(String args[]) &#123; // Two ArrayList for clear and removeAll ArrayList numbers = new ArrayList(SIZE); ArrayList integers = new ArrayList(SIZE); // Initialize ArrayList with 10M integers for (int i = 0; i &amp;lt; SIZE; i++) &#123; numbers.add(new Integer(i)); integers.add(new Integer(i)); &#125; // Empty ArrayList using clear method long startTime = System.nanoTime(); numbers.clear(); long elapsed = System.nanoTime() - startTime; System.out.println(\"Time taken by clear to empty ArrayList of 1M elements (ns): \" + elapsed); // Reset ArrayList using removeAll method startTime = System.nanoTime(); integers.removeAll(integers); long time = System.nanoTime() - startTime; System.out.println(\"Time taken by removeAll to reset ArrayList of 1M elements (ns): \" + time); &#125; &#125; Output: Time taken by clear to empty ArrayList of 100000 elements (ns): 889619 Time taken by removeAll to reset ArrayList of 100000 elements (ns): 36633112126 ç”±äºç¨‹åºä½¿ç”¨äº†ä¸¤ä¸ªarrayListå­˜å‚¨Integersï¼Œæ‰€ä»¥åœ¨è¿è¡Œæ—¶è¦ç¡®ä¿æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œå°¤å…¶æ˜¯ä½ æƒ³æ¯”è¾ƒåœ¨åˆ—è¡¨å­˜æœ‰1Mä¸ªå…ƒç´ æ—¶ï¼Œä¸¤ç§æ–¹æ³•çš„æ€§èƒ½å·®å¼‚ã€‚å¦å¤–ï¼Œç”±äºä½¿ç”¨äº†åœ¨æ•°å­—ä¸­åŠ å…¥ä¸‹åˆ’çº¿çš„ç‰¹æ€§ï¼Œæ‰€ä»¥éœ€è¦java7æ¥è¿è¡Œã€‚å¦‚æœæ²¡æœ‰JDK7ï¼Œä¹Ÿå¯ä»¥ç§»é™¤SIZEå¸¸é‡ä¸­çš„ä¸‹åˆ’çº¿ã€‚ ä»¥ä¸Šå°±æ˜¯å…³äºå¦‚ä½•é‡ç½®ä¸€ä¸ªArrayListçš„å†…å®¹ã€‚æˆ‘ä»¬ä¸ä»…ä»…å­¦åˆ°äº†ä¸¤ç§ä»åˆ—è¡¨ä¸­åˆ é™¤å…ƒç´ çš„æ–¹æ³•ï¼Œä¹Ÿå­¦åˆ°äº†clear()å’ŒremoveAll()æ–¹æ³•çš„åŒºåˆ«ã€‚æˆ‘ä»¬æ˜ç™½äº†ä¸ºä»€ä¹ˆåœ¨åˆ—è¡¨è¿‡å¤§æ—¶ï¼ŒremoveAll()æ€§èƒ½å¾ˆå·®ã€‚ PSï¼šå½“ä½¿ç”¨clear()æ–¹æ³•ä¹Ÿæ¶ˆè€—å¾ˆé•¿çš„æ—¶é—´æ—¶ï¼Œè€ƒè™‘åˆ›å»ºä¸€ä¸ªæ–°çš„åˆ—è¡¨ï¼Œå› ä¸ºjavaå¯ä»¥å¾ˆå¿«çš„åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚ æ‰©å±•é˜…è¯»ï¼š ArrayList and HashMap Performance Improvement in JDK 7 How to convert ArrayList to Set? How to sort an ArrayList in reverse order in Java? How to remove duplicate elements from ArrayList in Java? How to clone an ArrayList in Java? How do you convert a Map to List in Java? Performance comparison of contains() vs binarySearch() How to initialize an ArrayList with values in Java? The ArrayList Guide The difference between an ArrayList and a Vector in Java? How to make an ArrayList unmodifiable in Java?","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"},{"name":"list","slug":"java/list","permalink":"http://yemengying.com/categories/java/list/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"ç¿»è¯‘","slug":"ç¿»è¯‘","permalink":"http://yemengying.com/tags/ç¿»è¯‘/"}]},{"title":"Macç³»ç»Ÿä¸‹Ideaå’ŒSTSçš„å¿«æ·é”®å¯¹æ¯”","slug":"idea-sts","date":"2015-10-23T08:15:42.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/10/23/idea-sts/","link":"","permalink":"http://yemengying.com/2015/10/23/idea-sts/","excerpt":"","keywords":null,"text":"åˆè¢«æœ‹å‹å®‰åˆ©äº†ä¸€éIdea æ‰€ä»¥å†³å®šå°è¯•ç€æŠŠIDEç”±STSåˆ‡æ¢æˆIdeaã€‚ä¸è¿‡å‘ç°å¥½å¤šå¿«æ·é”®éƒ½ä¸ä¸€è‡´ï¼Œæ‰€ä»¥åœ¨ç†Ÿæ‚‰Ideaçš„è¿‡ç¨‹ä¸­é¡ºä¾¿è®°å½•ä¸€ä¸‹ä¸¤è€…çš„å¸¸ç”¨å¿«æ·é”®å¯¹æ¯” STS(Spring Tool Suite) Idea Run shift+command+F11 shift + control + r Debug command + F11 shift + control + d å¤åˆ¶å½“å‰è¡Œ alt + command + å‘ä¸‹æ–¹å‘é”® command + d å‰ªè´´å½“å‰è¡Œ command + x command + x åˆ é™¤å½“å‰è¡Œ command + d command + x æœç´¢ command + f command + f æœç´¢æ›¿æ¢ command + f command + r Preferences command + , command + , å…‰æ ‡ç§»åˆ°ä»£ç å—æœ€å option+command+] å…‰æ ‡ç§»åˆ°ä»£ç å—æœ€å‰ option+command+[ Rename alt+command+r shift+F6 æ‰€é€‰è¯­å¥ä¸Šç§» option+å‘ä¸Šæ–¹å‘é”® shift+command+å‘ä¸Šæ–¹å‘é”® æ‰€é€‰è¯­å¥ä¸‹ç§» option+å‘ä¸‹æ–¹å‘é”® shift+command+å‘ä¸‹æ–¹å‘é”® é€‰æ‹©å®ç°çˆ¶ç±»çš„æ–¹æ³• control+o generate(setter/constructor/toString) option+command+s command+n step over F6 F8 step into F5 F7 step out F7 shift+F8 stop option+command+s command+F2","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"IDE","slug":"IDE","permalink":"http://yemengying.com/tags/IDE/"}]},{"title":"ä½¿ä»£ç æ›´ç®€æ´(ä¸‰)---åˆ©ç”¨Builder Patternä¸ºå¯¹è±¡å±æ€§èµ‹å€¼","slug":"cleancode-builder","date":"2015-09-26T07:18:12.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/09/26/cleancode-builder/","link":"","permalink":"http://yemengying.com/2015/09/26/cleancode-builder/","excerpt":"ä»¥å‰å†™åœ¨segmentFaultä¸Šçš„ä¸€ç¯‡æ–‡ç« ï¼Œæ¬ç§»åˆ°è¿™é‡Œ æœ‰ä¸€ä¸ªæœ‰å¾ˆå¤šå±æ€§çš„ç±»ï¼Œåœ¨ä¸ºå®ƒçš„å±æ€§èµ‹å€¼æ—¶ï¼Œé€šå¸¸æœ‰ä¸¤ç§æ–¹å¼ï¼Œä½¿ç”¨æ„é€ å‡½æ•°å’Œä½¿ç”¨setæ–¹æ³•ã€‚å¯æ˜¯ä½¿ç”¨æ„é€ å‡½æ•°æœ‰æ—¶ä¼šå¿˜äº†å„ä¸ªå­—æ®µçš„é¡ºåº ï¼Œç›´æ¥ä½¿ç”¨setæ–¹æ³•ï¼Œåˆæ¯”è¾ƒéº»çƒ¦ã€‚æ‰€ä»¥åŒäº‹æå‡ºå¯ä»¥ä½¿ç”¨æ–¹æ³•é“¾ã€‚","keywords":null,"text":"ä»¥å‰å†™åœ¨segmentFaultä¸Šçš„ä¸€ç¯‡æ–‡ç« ï¼Œæ¬ç§»åˆ°è¿™é‡Œ æœ‰ä¸€ä¸ªæœ‰å¾ˆå¤šå±æ€§çš„ç±»ï¼Œåœ¨ä¸ºå®ƒçš„å±æ€§èµ‹å€¼æ—¶ï¼Œé€šå¸¸æœ‰ä¸¤ç§æ–¹å¼ï¼Œä½¿ç”¨æ„é€ å‡½æ•°å’Œä½¿ç”¨setæ–¹æ³•ã€‚å¯æ˜¯ä½¿ç”¨æ„é€ å‡½æ•°æœ‰æ—¶ä¼šå¿˜äº†å„ä¸ªå­—æ®µçš„é¡ºåº ï¼Œç›´æ¥ä½¿ç”¨setæ–¹æ³•ï¼Œåˆæ¯”è¾ƒéº»çƒ¦ã€‚æ‰€ä»¥åŒäº‹æå‡ºå¯ä»¥ä½¿ç”¨æ–¹æ³•é“¾ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273public class User &#123; private int id; private String name; private int age; private int sex; private int cityId; private int buId; private int roleId; private String pinyinName; public String getPinyinName() &#123; return pinyinName; &#125; public void setPinyinName(String pinyinName) &#123; this.pinyinName = pinyinName; &#125; public int getAge() &#123; return age; &#125; public void setAge(int age) &#123; this.age = age; &#125; public int getSex() &#123; return sex; &#125; public void setSex(int sex) &#123; this.sex = sex; &#125; public int getCityId() &#123; return cityId; &#125; public void setCityId(int cityId) &#123; this.cityId = cityId; &#125; public int getBuId() &#123; return buId; &#125; public void setBuId(int buId) &#123; this.buId = buId; &#125; public int getRoleId() &#123; return roleId; &#125; public void setRoleId(int roleId) &#123; this.roleId = roleId; &#125; public int getId() &#123; return id; &#125; public void setId(int id) &#123; this.id = id; &#125; public String getName() &#123; return name; &#125; public void setName(String name) &#123; this.name = name; &#125; public User(int id, String name, int age, int sex, int cityId, int buId, int roleId, String pinyinName) &#123; super(); this.id = id; this.name = name; this.age = age; this.sex = sex; this.cityId = cityId; this.buId = buId; this.roleId = roleId; this.pinyinName = pinyinName; &#125; &#125; ç±»ä¼¼äºStringBuilderçš„appendæ–¹æ³• 12String s = new StringBuilder().append(\"0\").append(1) .append(\" 2 \").append(3).toString(); è®©beançš„æ¯ä¸ªå±æ€§çš„setæ–¹æ³•éƒ½è¿”å›ä¸€ä¸ªå¯¹è±¡æœ¬èº«çš„å¼•ç”¨ï¼Œå°†Userç±»çš„setæ–¹æ³•æ”¹å†™æˆä¸‹é¢çš„æ ·å­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839public User setId(int id) &#123; this.id = id; return this; &#125; public User setName(String name) &#123; this.name = name; return this; &#125; public User setAge(int age) &#123; this.age = age; return this; &#125; public User setSex(int sex) &#123; this.sex = sex; return this; &#125; public User setCityId(int cityId) &#123; this.cityId = cityId; return this; &#125; public User setBuId(int buId) &#123; this.buId = buId; return this; &#125; public User setRoleId(int roleId) &#123; this.roleId = roleId; return this; &#125; public User setPinyinName(String pinyinName) &#123; this.pinyinName = pinyinName; return this; &#125; è¿™æ ·åœ¨å¯¹Userçš„å±æ€§èµ‹å€¼æ—¶å°±ç®€æ´äº†è®¸å¤šã€‚ 1234567User user = new User().setId(1).setAge(18) .setBuId(127) .setRoleId(12) .setName(\"giraffe\") .setCityId(12) .setSex(1) .setPinyinName(\"gif\"); å¤§éƒ¨åˆ†IDEé»˜è®¤ç”Ÿæˆæ— è¿”å›å€¼çš„setterï¼Œä¸è¿‡Ideaä¹Ÿæ”¯æŒç”Ÿæˆè¿”å›thiså¯¹è±¡çš„æ–¹å¼ã€‚åœ¨ç”Ÿæˆsetteræ—¶æŠŠtemplateç”±defaultæ”¹ä¸ºbuilderã€‚å¦‚ä¸‹å›¾: ä¸è¿‡ä¸çŸ¥é“è¿™æ ·å†™ä¼šä¸ä¼šæœ‰ä»€ä¹ˆä¸å¥½çš„åœ°æ–¹~~","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"}]},{"title":"springç»“åˆrabbitmq---ç®€å•çš„demo","slug":"spring-rabbitmq-demo","date":"2015-09-19T06:55:43.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/09/19/spring-rabbitmq-demo/","link":"","permalink":"http://yemengying.com/2015/09/19/spring-rabbitmq-demo/","excerpt":"åœ¨åšæœç´¢æœåŠ¡æ—¶ï¼Œå½“ä¸šåŠ¡æ–¹æ•°æ®æºæ”¹å˜æ—¶ï¼Œéœ€è¦æ”¹å˜æœç´¢å¼•æ“ä¸­ç´¢å¼•çš„æ•°æ®ã€‚å¯ä»¥å®šæ—¶æ‹‰å–ä¹Ÿå¯ä»¥å®æ—¶æ¨é€ã€‚ä¸ºäº†å®ç°åŒæ­¥æ›´æ–°ï¼Œé€‰æ‹©äº†å®æ—¶æ¨é€ã€‚å®æ—¶æ¨é€ä¹Ÿæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯æä¾›ç´¢å¼•æ›´æ–°æ¥å£ä¾›ä¸šåŠ¡æ–¹è°ƒç”¨ï¼Œåœ¨æ¥å£ä¸­å°†å˜åŒ–çš„æ•°æ®æ›´æ–°åˆ°æœç´¢å¼•æ“ä¸­ï¼›å¦ä¸€ç§æ˜¯ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸šåŠ¡æ–¹åœ¨æ•°æ®æ”¹å˜æ—¶ï¼Œå°†æ”¹å˜çš„æ•°æ®æ’å…¥é˜Ÿåˆ—ï¼ŒæœåŠ¡ç«¯çš„æ¶ˆè´¹è€…å®æ—¶ç›‘å¬é˜Ÿåˆ—ï¼Œå¹¶è¿›è¡Œç´¢å¼•æ›´æ–°ã€‚è€ƒè™‘åˆ°ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—æœ‰ä¸‰ç‚¹å¥½å¤„ï¼Œé€‰æ‹©äº†ç¬¬äºŒç§æ–¹å¼ã€‚ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„å¥½å¤„: ä¸€ï¼Œä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥å¼‚æ­¥å¤„ç†æ›´æ–°æ“ä½œé™ä½æ¥å£å“åº”æ—¶é—´ï¼›äºŒï¼Œå¯¹äºæ¶ˆè´¹ç«¯ç”±äºä¸å¯é¢„æµ‹åŸå› å¯¼è‡´æ¶ˆæ¯æ— æ³•å¤„ç†æ—¶ï¼Œæ•°æ®å¯ä»¥æš‚å­˜åœ¨é˜Ÿåˆ—ä¸­ï¼Œç­‰æ¶ˆè´¹è€…æœåŠ¡æ¢å¤åå¯ä»¥ç»§ç»­å¤„ç†å†å²æ•°æ®,æé«˜å¯ç”¨æ€§ï¼›ä¸‰ï¼Œå°†ä¸šåŠ¡æ–¹çš„æœåŠ¡å’Œç´¢å¼•æ›´æ–°æœåŠ¡è§£è€¦ã€‚ä¸‹é¢ç®€å•è®°å½•ä¸€ä¸‹ä¸€ä¸ªç®€å•çš„spring+rabbitmqçš„demoå®ç°ï¼Œåªå®ç°äº†ç®€å•çš„æ¶ˆæ¯ç”Ÿäº§å’Œæ¶ˆè´¹ã€‚ å‚è€ƒäº†ä¸‹é¢å‡ ç¯‡åšå®¢ï¼šhttp://syntx.io/getting-started-with-rabbitmq-using-the-spring-framework/https://blog.codecentric.de/en/2011/04/amqp-messaging-with-rabbitmq/http://wb284551926.iteye.com/blog/2212869","keywords":null,"text":"åœ¨åšæœç´¢æœåŠ¡æ—¶ï¼Œå½“ä¸šåŠ¡æ–¹æ•°æ®æºæ”¹å˜æ—¶ï¼Œéœ€è¦æ”¹å˜æœç´¢å¼•æ“ä¸­ç´¢å¼•çš„æ•°æ®ã€‚å¯ä»¥å®šæ—¶æ‹‰å–ä¹Ÿå¯ä»¥å®æ—¶æ¨é€ã€‚ä¸ºäº†å®ç°åŒæ­¥æ›´æ–°ï¼Œé€‰æ‹©äº†å®æ—¶æ¨é€ã€‚å®æ—¶æ¨é€ä¹Ÿæœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯æä¾›ç´¢å¼•æ›´æ–°æ¥å£ä¾›ä¸šåŠ¡æ–¹è°ƒç”¨ï¼Œåœ¨æ¥å£ä¸­å°†å˜åŒ–çš„æ•°æ®æ›´æ–°åˆ°æœç´¢å¼•æ“ä¸­ï¼›å¦ä¸€ç§æ˜¯ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¸šåŠ¡æ–¹åœ¨æ•°æ®æ”¹å˜æ—¶ï¼Œå°†æ”¹å˜çš„æ•°æ®æ’å…¥é˜Ÿåˆ—ï¼ŒæœåŠ¡ç«¯çš„æ¶ˆè´¹è€…å®æ—¶ç›‘å¬é˜Ÿåˆ—ï¼Œå¹¶è¿›è¡Œç´¢å¼•æ›´æ–°ã€‚è€ƒè™‘åˆ°ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—æœ‰ä¸‰ç‚¹å¥½å¤„ï¼Œé€‰æ‹©äº†ç¬¬äºŒç§æ–¹å¼ã€‚ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—çš„å¥½å¤„: ä¸€ï¼Œä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—å¯ä»¥å¼‚æ­¥å¤„ç†æ›´æ–°æ“ä½œé™ä½æ¥å£å“åº”æ—¶é—´ï¼›äºŒï¼Œå¯¹äºæ¶ˆè´¹ç«¯ç”±äºä¸å¯é¢„æµ‹åŸå› å¯¼è‡´æ¶ˆæ¯æ— æ³•å¤„ç†æ—¶ï¼Œæ•°æ®å¯ä»¥æš‚å­˜åœ¨é˜Ÿåˆ—ä¸­ï¼Œç­‰æ¶ˆè´¹è€…æœåŠ¡æ¢å¤åå¯ä»¥ç»§ç»­å¤„ç†å†å²æ•°æ®,æé«˜å¯ç”¨æ€§ï¼›ä¸‰ï¼Œå°†ä¸šåŠ¡æ–¹çš„æœåŠ¡å’Œç´¢å¼•æ›´æ–°æœåŠ¡è§£è€¦ã€‚ä¸‹é¢ç®€å•è®°å½•ä¸€ä¸‹ä¸€ä¸ªç®€å•çš„spring+rabbitmqçš„demoå®ç°ï¼Œåªå®ç°äº†ç®€å•çš„æ¶ˆæ¯ç”Ÿäº§å’Œæ¶ˆè´¹ã€‚ å‚è€ƒäº†ä¸‹é¢å‡ ç¯‡åšå®¢ï¼šhttp://syntx.io/getting-started-with-rabbitmq-using-the-spring-framework/https://blog.codecentric.de/en/2011/04/amqp-messaging-with-rabbitmq/http://wb284551926.iteye.com/blog/2212869 æœ¬åœ°å®‰è£…rabbitmqåªä»‹ç»macç³»ç»Ÿä¸‹å¦‚ä½•å®‰è£… å®‰è£…brew1ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot; åˆ©ç”¨brewå®‰è£…rabbitmq1.è¾“å…¥å‘½ä»¤ 1brew install rabbitmq 2.æ·»åŠ é…ç½® 1export PATH=$PATH:$(brew --prefix)/sbin 3.å¯ä»¥ç¦ç”¨ç”¨ä¸ç€çš„æ’ä»¶ 12rabbitmq-plugins disable --offline rabbitmq_stomprabbitmq-plugins disable --offline rabbitmq_mqtt 4.å¯åŠ¨rabbitmq server ç›´æ¥è¾“å…¥ä¸‹é¢çš„å‘½ä»¤ 1rabbitmq-server 5.å¦‚æœæ‰“å°å‡ºä¸‹é¢çš„ä¸œä¸œå°±æ˜¯å¯åŠ¨æˆåŠŸäº†ï¼Œé»˜è®¤ç«¯å£æ˜¯5672 å®ç°demoé¦–å…ˆè¦æœ‰ä¸ªå¯ä»¥è¿è¡Œçš„spring + mavençš„é¡¹ç›® æ·»åŠ mavenä¾èµ–åœ¨pomæ–‡ä»¶ä¸­æ·»åŠ rabbitmqç›¸å…³çš„ä¾èµ– 12345678910&lt;dependency&gt; &lt;groupId&gt;com.rabbitmq&lt;/groupId&gt; &lt;artifactId&gt;amqp-client&lt;/artifactId&gt; &lt;version&gt;3.5.4&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework.amqp&lt;/groupId&gt; &lt;artifactId&gt;spring-rabbit&lt;/artifactId&gt; &lt;version&gt;1.5.0.RELEASE&lt;/version&gt;&lt;/dependency&gt; æ·»åŠ é…ç½®æ–‡ä»¶12345678910111213141516171819202122232425262728293031323334&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;beans xmlns=\"http://www.springframework.org/schema/beans\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:context=\"http://www.springframework.org/schema/context\" xmlns:rabbit=\"http://www.springframework.org/schema/rabbit\" xmlns:p=\"http://www.springframework.org/schema/p\" xsi:schemaLocation=\"http://www.springframework.org/schema/beanshttp://www.springframework.org/schema/beans/spring-beans-4.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd http://www.springframework.org/schema/rabbit http://www.springframework.org/schema/rabbit/spring-rabbit.xsd\"&gt; &lt;!-- æ‰«æåŒ… --&gt; &lt;context:component-scan base-package=\"ymy.com.rabbitmq.demo.service.impl.*\" /&gt; &lt;context:annotation-config /&gt; &lt;!-- è¿æ¥æœ¬åœ°rabbitmq --&gt; &lt;rabbit:connection-factory id=\"connectionFactory\" host=\"localhost\" port=\"5672\" /&gt; &lt;rabbit:admin connection-factory=\"connectionFactory\" id=\"amqpAdmin\" /&gt; &lt;!-- queue é˜Ÿåˆ—å£°æ˜ --&gt; &lt;rabbit:queue id=\"rabbit_queue_one\" durable=\"true\" auto-delete=\"false\" exclusive=\"false\" name=\"rabbit_queue_one\" /&gt; &lt;!-- exchange queue binging key ç»‘å®š --&gt; &lt;rabbit:direct-exchange name=\"mq-exchange\" durable=\"true\" auto-delete=\"false\" id=\"mq-exchange\"&gt; &lt;rabbit:bindings&gt; &lt;rabbit:binding queue=\"rabbit_queue_one\" key=\"rabbit_queue_one\" /&gt; &lt;/rabbit:bindings&gt; &lt;/rabbit:direct-exchange&gt; &lt;!-- spring templateå£°æ˜ --&gt; &lt;rabbit:template exchange=\"mq-exchange\" id=\"amqpTemplate\" connection-factory=\"connectionFactory\" /&gt;&lt;/beans&gt; ç”Ÿäº§è€…å¼€å‘ï¼ˆæ’å…¥æ¶ˆæ¯ï¼‰123456789101112131415161718192021222324package ymy.com.rabbitmq.demo.service.impl;import org.springframework.amqp.core.AmqpAdmin;import org.springframework.amqp.core.AmqpTemplate;import org.springframework.amqp.core.Message;import org.springframework.amqp.rabbit.connection.ConnectionFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;@Service(\"messageProductorService\")public class MessageProductorService &#123; @Autowired private AmqpAdmin admin; @Autowired private AmqpTemplate amqpTemplate; @Autowired private ConnectionFactory connectionFactory; public void pushToMessageQueue(String routingKey, String message) &#123; amqpTemplate.convertAndSend(routingKey, message); &#125;&#125; æ¶ˆè´¹è€…å¼€å‘æœ‰ä¸¤ç§æ–¹å¼ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ï¼Œä¸€ç§æ˜¯è‡ªå·±è°ƒç”¨receiveæ–¹æ³•è·å¾—ï¼Œä¸€ç§æ˜¯ä¸ºé˜Ÿåˆ—é…ç½®ç›‘å¬ç±»ï¼Œæ¯å½“ç›‘å¬çš„é˜Ÿåˆ—ä¸­æœ‰æ¶ˆæ¯äº§ç”Ÿï¼Œå°±ä¼šè¢«ç›‘å¬çš„ç±»å»é™¤ã€‚ç¬¬ä¸€ç§æ–¹å¼ï¼š 12345678910111213141516package ymy.com.rabbitmq.demo.service.impl;import org.springframework.amqp.core.AmqpTemplate;import org.springframework.amqp.core.Message;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Service;@Service(\"messageConsumerService\")public class MessageConsumerService &#123; @Autowired private AmqpTemplate amqpTemplate; public void popMessage(String destinationQueueName) &#123; Message message = amqpTemplate.receive(destinationQueueName); System.out.println(new String(message.getBody())); &#125;&#125; junit test 12345@Testpublic void testMessageQueueManager()&#123; messageProductor.pushToMessageQueue(\"rabbit_queue_one\", \"hello giraffe\"); messageConsumer.popMessage(\"rabbit_queue_one\");&#125; ç¬¬äºŒç§æ–¹å¼é…ç½®ä¸­æ·»åŠ ç›‘å¬ 1234&lt;!-- queue litener è§‚å¯Ÿ ç›‘å¬æ¨¡å¼ å½“æœ‰æ¶ˆæ¯åˆ°è¾¾æ—¶ä¼šé€šçŸ¥ç›‘å¬åœ¨å¯¹åº”çš„é˜Ÿåˆ—ä¸Šçš„ç›‘å¬å¯¹è±¡ taskExecutorè¿™ä¸ªéœ€è¦è‡ªå·±å®ç°ä¸€ä¸ªè¿æ¥æ±  æŒ‰ç…§å®˜æ–¹è¯´æ³• é™¤éç‰¹åˆ«å¤§çš„æ•°æ®é‡ ä¸€èˆ¬ä¸éœ€è¦è¿æ¥æ± --&gt; &lt;rabbit:listener-container connection-factory=\"connectionFactory\" acknowledge=\"auto\" &gt; &lt;rabbit:listener queues=\"rabbit_queue_one\" ref=\"messageConsumerService\"/&gt; &lt;/rabbit:listener-container&gt; æ¶ˆè´¹è€…ç±»éœ€è¦å®ç°MessageListener å¹¶å®ç°onMessageæ–¹æ³•ï¼Œå½“ç›‘å¬çš„é˜Ÿåˆ—ä¸­æœ‰æ¶ˆæ¯è¿›å…¥æ—¶ï¼ŒonMessageæ–¹æ³•ä¼šè¢«è°ƒç”¨ 1234567891011121314package ymy.com.rabbitmq.demo.service.impl;import org.springframework.amqp.core.Message;import org.springframework.stereotype.Service;import org.springframework.amqp.core.MessageListener;@Service(\"messageConsumerService\")public class MessageConsumerService implements MessageListener&#123; @Override public void onMessage(Message message) &#123; System.out.println(\"æˆåŠŸå–å‡ºæ¶ˆæ¯\" + new String(message.getBody())); &#125;&#125; git åœ°å€ï¼š loadStyle(\"/hexo-github/style.css\"); loadStyle(\"/hexo-github/octicons/octicons.css\"); new Badge(\"#badge-container-giraffe0813-spring-rabbit-demo-617348a\", \"giraffe0813\", \"spring-rabbit-demo\", \"617348a\", false);","raw":null,"content":null,"categories":[{"name":"spring","slug":"spring","permalink":"http://yemengying.com/categories/spring/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"spring","slug":"spring","permalink":"http://yemengying.com/tags/spring/"},{"name":"rabbitMq","slug":"rabbitMq","permalink":"http://yemengying.com/tags/rabbitMq/"}]},{"title":"springäº‹åŠ¡ç®¡ç†æ€»ç»“","slug":"spring-transaction","date":"2015-09-12T06:44:29.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/09/12/spring-transaction/","link":"","permalink":"http://yemengying.com/2015/09/12/spring-transaction/","excerpt":"ä»¥å‰å†™åœ¨segmentFaultä¸Šçš„ä¸€ç¯‡æ–‡ç«  æ¬ç§»åˆ°è¿™é‡Œã€‚ åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä¼šä½¿ç”¨äº‹åŠ¡æ¥ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ã€‚æ ¹æ®ç½‘ä¸Šçš„èµ„æ–™æ•´ç†ä¸€ä¸‹åœ¨springä¸­é…ç½®äº‹åŠ¡çš„å‡ ç§æ–¹å¼ã€‚æ— è®ºæ˜¯å“ªç§æ–¹å¼éƒ½éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®è¿æ¥æ± å’Œäº‹åŠ¡ç®¡ç†å™¨,ä»£ç å¦‚ä¸‹ã€‚","keywords":null,"text":"ä»¥å‰å†™åœ¨segmentFaultä¸Šçš„ä¸€ç¯‡æ–‡ç«  æ¬ç§»åˆ°è¿™é‡Œã€‚ åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä¼šä½¿ç”¨äº‹åŠ¡æ¥ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ã€‚æ ¹æ®ç½‘ä¸Šçš„èµ„æ–™æ•´ç†ä¸€ä¸‹åœ¨springä¸­é…ç½®äº‹åŠ¡çš„å‡ ç§æ–¹å¼ã€‚æ— è®ºæ˜¯å“ªç§æ–¹å¼éƒ½éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®è¿æ¥æ± å’Œäº‹åŠ¡ç®¡ç†å™¨,ä»£ç å¦‚ä¸‹ã€‚ 12345678910111213141516171819202122232425 &lt;!-- è¯»å–é…ç½®æ–‡ä»¶ --&gt; &lt;bean class=\"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer\"&gt; &lt;property name=\"locations\"&gt; &lt;list&gt; &lt;value&gt;classpath:database.properties&lt;/value&gt; &lt;value&gt;classpath:service.properties&lt;/value&gt; &lt;/list&gt; &lt;/property&gt; &lt;property name=\"fileEncoding\" value=\"UTF-8\" /&gt; &lt;property name=\"ignoreResourceNotFound\" value=\"false\" /&gt;&lt;/bean&gt; &lt;!--è¿æ¥æ±  --&gt;&lt;bean id=\"dataSource\" class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\"&gt; &lt;property name=\"driverClassName\" value=\"$&#123;db.driver&#125;\" /&gt; &lt;property name=\"url\" value=\"$&#123;db.url&#125;\" /&gt; &lt;property name=\"username\" value=\"$&#123;db.username&#125;\" /&gt; &lt;property name=\"password\" value=\"$&#123;db.password&#125;\" /&gt;&lt;/bean&gt;&lt;!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨ --&gt;&lt;bean id=\"transactionManager\" class=\"org.springframework.jdbc.datasource.DataSourceTransactionManager\"&gt; &lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;&lt;/bean&gt; å£°æ˜å¼äº‹åŠ¡ç®¡ç†åŸºäºAspectJçš„XMLæ–¹å¼çš„é…ç½®è¿™æ˜¯æˆ‘è§‰å¾—æœ€å¥½çš„æ–¹å¼ï¼ŒåŸºäºaopé…ç½®ï¼Œå½“æ–°å¢çš„æ–¹æ³•è¦ä½¿ç”¨äº‹åŠ¡ç®¡ç†æ—¶ï¼Œæ— éœ€ä¿®æ”¹ä»£ç ã€‚é¦–å…ˆåœ¨é…ç½®æ–‡ä»¶xmlä¸­å¼•å…¥aopå’Œtxçš„å‘½åç©ºé—´123456xmlns:tx=\"http://www.springframework.org/schema/tx\" xmlns:aop=\"http://www.springframework.org/schema/aop\"xsi:schemaLocation=\"http://www.springframework.org/schema/txhttp://www.springframework.org/schema/tx/spring-tx-3.0.xsdhttp://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd\" ç„¶ååœ¨xmlä¸­åŠ å…¥aopçš„é…ç½®,ä¸‹é¢çš„é…ç½®å°±æ˜¯åœ¨servicesçš„åˆ‡å…¥ç‚¹ä¸Šåº”ç”¨txAdviceçš„å¢å¼ºï¼Œservicesçš„åˆ‡å…¥ç‚¹å°±æ˜¯ymy.com.service.implåŒ…ä¸‹çš„æ‰€æœ‰æ–¹æ³•åº”ç”¨txAdviceçš„å¢å¼ºã€‚ç„¶åtxAdviceæ˜¯åœ¨æ‰€æœ‰ä»¥create,add,delete,update,changeå¼€å¤´çš„æ–¹æ³•ä¸ŠåŠ ä¸Šäº‹åŠ¡ç®¡ç†ã€‚ 12345678910111213141516171819202122232425262728 &lt;!-- å®šä¹‰äº‹åŠ¡é€šçŸ¥ ï¼ˆäº‹åŠ¡çš„å¢å¼ºï¼‰--&gt;&lt;tx:advice id=\"txAdvice\" transaction-manager=\"transactionManager\"&gt; &lt;!-- å®šä¹‰æ–¹æ³•çš„è¿‡æ»¤è§„åˆ™ --&gt; &lt;tx:attributes&gt; &lt;!-- æ‰€æœ‰æ–¹æ³•éƒ½ä½¿ç”¨äº‹åŠ¡ --&gt; &lt;!-- propagation:äº‹åŠ¡ä¼ æ’­è¡Œä¸º isolationï¼šäº‹åŠ¡éš”ç¦» read-only:åªè¯» rollback-for:å‘ç”Ÿå“ªäº›å¼‚å¸¸å›æ»š no-rollback-for:å‘ç”Ÿå“ªäº›å¼‚å¸¸ä¸å›æ»š timeout:è¿‡æœŸä¿¡æ¯ --&gt; &lt;tx:method name=\"create*\" propagation=\"REQUIRED\"/&gt; &lt;tx:method name=\"add*\" propagation=\"REQUIRED\"/&gt; &lt;tx:method name=\"delete*\" propagation=\"REQUIRED\"/&gt; &lt;tx:method name=\"update*\" propagation=\"REQUIRED\"/&gt; &lt;tx:method name=\"change*\" propagation=\"REQUIRED\"/&gt; &lt;/tx:attributes&gt;&lt;/tx:advice&gt; &lt;!-- å®šä¹‰AOPé…ç½® é…ç½®åˆ‡é¢ --&gt;&lt;aop:config&gt; &lt;!-- å®šä¹‰ä¸€ä¸ªåˆ‡å…¥ç‚¹ --&gt; &lt;aop:pointcut expression=\"execution (* ymy.com.service.impl.*.*(..))\" id=\"services\"/&gt; &lt;!-- å¯¹åˆ‡å…¥ç‚¹å’Œäº‹åŠ¡çš„é€šçŸ¥ï¼Œè¿›è¡Œé€‚é… --&gt; &lt;aop:advisor advice-ref=\"txAdvice\" pointcut-ref=\"services\"/&gt;&lt;/aop:config&gt; é‡‡ç”¨è¿™ç§æ–¹å¼é…ç½®ï¼Œå½“æ–¹æ³•æ˜¯æŒ‰ç…§äº‹åŠ¡å®šä¹‰çš„è§„åˆ™å‘½åæ—¶ï¼Œéƒ½ä¼šåŠ å…¥äº‹åŠ¡ç®¡ç†ã€‚ åŸºäºæ³¨è§£è¿™ç§æ–¹å¼æ˜¯æˆ‘è§‰å¾—æœ€ç®€å•çš„ï¼Œç¬¬äºŒæ¨èã€‚è¦é‡‡ç”¨æ³¨è§£çš„æ–¹å¼ï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­å¼€å¯æ³¨è§£äº‹åŠ¡ã€‚ 12&lt;!-- å¼€å¯æ³¨è§£äº‹åŠ¡ --&gt;&lt;tx:annotation-driven transaction-manager=\"transactionManager\"/&gt; åœ¨ä½¿ç”¨æ—¶åªéœ€åœ¨å¯¹åº”çš„ç±»ä¸Šæ·»åŠ æ³¨è§£@Transactionalå³å¯ 12345@Service@Transactionalpublic class TaskService implements ITaskService &#123;&#125; ä¹Ÿå¯åœ¨ä½¿ç”¨æ³¨è§£æ—¶å®šä¹‰äº‹ç‰©çš„ä¼ æ’­çº§åˆ« éš”ç¦»è¡Œä¸ºç­‰ã€‚ã€‚ 1@Transactional(propagation=Propagation.REQUIRED) åŸºäºTransactionProxyFactoryBeanè¿™ç§æ–¹å¼é…ç½®æ¯”è¾ƒéº»çƒ¦ï¼Œéœ€è¦ä¸ºæ¯ä¸€ä¸ªéœ€è¦äº‹åŠ¡ç®¡ç†çš„ç±»é…ç½®ä¸€ä¸ªä»£ç†ç±»ï¼Œä¸æ¨èä½¿ç”¨ã€‚ä¾‹å¦‚æˆ‘è¦å¯¹taskServiceè¿›è¡Œäº‹åŠ¡ç®¡ç†ï¼Œéœ€è¦å¦‚ä¸‹é…ç½®ï¼Œç”¨ä»£ç†ç±»å¯¹ç›®æ ‡ç±»è¿›è¡Œå¢å¼ºã€‚ 12345678910111213&lt;!-- é…ç½®serviceå±‚çš„ä»£ç† --&gt;&lt;bean id = \"taskServiceProxy\" class=\"org.springframework.transaction.interceptor.TransactionProxyFactoryBean\"&gt; &lt;!-- é…ç½®ç›®æ ‡å¯¹è±¡ --&gt; &lt;property name = \"target\" ref=\"taskService\"&gt;&lt;/property&gt; &lt;!-- æ³¨å…¥äº‹åŠ¡ç®¡ç†å™¨ --&gt; &lt;property name = \"transactionManager\" ref=\"transactionManager\"&gt;&lt;/property&gt; &lt;!-- è®¾ç½®éœ€è¦äº‹åŠ¡ç®¡ç†çš„æ–¹æ³• --&gt; &lt;property name=\"transactionAttributes\"&gt; &lt;props&gt; &lt;prop key=\"update*\"&gt;PROPAGATION_REQUIRED&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt;&lt;/bean&gt; ä¹‹ååœ¨æ³¨å…¥serviceç±»æ—¶ï¼Œå°±è¦æ³¨å…¥å®ƒçš„ä»£ç†ç±»ã€‚ 12@Resource(name = \"taskServiceProxy\")private ITaskService taskSerivce; ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†è¶…çº§ä¸æ¨èï¼Œéœ€è¦ä¸ºæ¯ä¸ªç±»æ³¨å…¥äº‹åŠ¡æ¨¡æ¿ï¼Œç„¶ååœ¨éœ€è¦äº‹åŠ¡ç®¡ç†çš„æ–¹æ³•ä¸­ä½¿ç”¨äº‹åŠ¡æ¨¡æ¿ã€‚ 123456789101112private TransactionTemplate transactionTemplate;public void test()&#123; transactionTemplate.execute(new TransactionCallbackWithoutResult() &#123; @Override protected void doInTransactionWithoutResult(TransactionStatus status) &#123; //è¿›è¡Œäº‹åŠ¡ç›¸åº”çš„æ“ä½œã€‚ã€‚ã€‚ //æ–¹æ³•ä¸€... //æ–¹æ³•äºŒ... &#125; &#125;); &#125;","raw":null,"content":null,"categories":[{"name":"spring","slug":"spring","permalink":"http://yemengying.com/categories/spring/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"spring","slug":"spring","permalink":"http://yemengying.com/tags/spring/"},{"name":"transaction","slug":"transaction","permalink":"http://yemengying.com/tags/transaction/"},{"name":"spring-aop","slug":"spring-aop","permalink":"http://yemengying.com/tags/spring-aop/"}]},{"title":"ä½¿ä»£ç æ›´ç®€æ´(äºŒ)---é›†åˆè½¬æ¢ç›¸å…³","slug":"cleancode-collection","date":"2015-09-11T06:34:33.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/09/11/cleancode-collection/","link":"","permalink":"http://yemengying.com/2015/09/11/cleancode-collection/","excerpt":"ä»¥å‰åœ¨segmentFaultä¸Šçš„ä¸€ç¯‡æ–‡ç«  æ¬ç§»åˆ°è¿™é‡Œã€‚ è®°å½•ä¸€ä¸‹åœ¨å·¥ä½œå¼€å‘ä¸­å°è£…çš„ä¸€äº›å·¥å…·ç±»ï¼Œä½¿ä»£ç çœ‹èµ·æ¥æ›´åŠ çš„ç®€æ´ã€‚è¿™ç¯‡å°±è®°å½•ä¸‹å’Œé›†åˆè½¬æ¢ç›¸å…³çš„å§ã€‚ã€‚ã€‚ã€‚ã€‚ä¼šæŒç»­è®°å½•ã€‚ã€‚ã€‚ã€‚","keywords":null,"text":"ä»¥å‰åœ¨segmentFaultä¸Šçš„ä¸€ç¯‡æ–‡ç«  æ¬ç§»åˆ°è¿™é‡Œã€‚ è®°å½•ä¸€ä¸‹åœ¨å·¥ä½œå¼€å‘ä¸­å°è£…çš„ä¸€äº›å·¥å…·ç±»ï¼Œä½¿ä»£ç çœ‹èµ·æ¥æ›´åŠ çš„ç®€æ´ã€‚è¿™ç¯‡å°±è®°å½•ä¸‹å’Œé›†åˆè½¬æ¢ç›¸å…³çš„å§ã€‚ã€‚ã€‚ã€‚ã€‚ä¼šæŒç»­è®°å½•ã€‚ã€‚ã€‚ã€‚ listè½¬map å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä¼šç¢°åˆ°éœ€è¦å°†listè½¬ä¸ºmapçš„æƒ…å†µï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ªUserç±»ï¼Œæœ‰id,name,ageç­‰å±æ€§ã€‚æœ‰ä¸€ä¸ªUserçš„listï¼Œä¸ºäº†å¾ˆæ–¹ä¾¿çš„è·å–æŒ‡å®šidçš„Userï¼Œè¿™æ—¶å°±éœ€è¦å°†List&lt; User&gt;è½¬æ¢ä¸ºMapï¼Œå…¶ä¸­mapçš„keyæ˜¯Userçš„idã€‚ä¸€èˆ¬çš„åšæ³•ï¼Œæ˜¯é€šè¿‡forå¾ªç¯å°†listä¸­çš„å…ƒç´ putåˆ°mapä¸­ï¼Œä»£ç å¦‚ä¸‹ï¼š 1234Map&lt;Integer, User&gt; map = new HashMap&lt;Integer, User&gt;();for(User user : userList)&#123; map.put(user.getId(), user);&#125; è¿™æ ·åšï¼Œåœ¨æ¯ä¸ªéœ€è¦å°†listè½¬ä¸ºmapçš„åœ°æ–¹ï¼Œéƒ½è¦å†™ä¸€éforå¾ªç¯ï¼Œä»£ç ä¸å¤Ÿç®€æ´ï¼Œæ‰€ä»¥åˆ©ç”¨streamå’Œæ³›å‹å°è£…äº†ä¸€ä¸ªé€šç”¨çš„å·¥å…·æ–¹æ³• 1234567891011121314public class TransFormUtils &#123; /** * å°†listè½¬ä¸ºmap * @param list * @param predicate1 key * @param predicate2 value * @return */ public static&lt;K,V,T&gt; Map&lt;K, V&gt; transformToMap(List&lt;T&gt; list,Function&lt;T, K&gt; predicate1, Function&lt;T,V&gt; predicate2)&#123; return list.stream().collect(Collectors.toMap(predicate1, predicate2)); &#125;&#125; è¿™æ ·å¦‚æœéœ€è¦å°†List&lt; User&gt;è½¬ä¸ºMapä»£ç å¦‚ä¸‹ 12//çœç•¥listæ„é€ è¿‡ç¨‹Map&lt;Integer, User&gt; map = TransFormUtils.transformToMap(userList, p-&gt;p.getId(), p-&gt;p); å¦‚æœéœ€è¦å°†List&lt; User&gt;è½¬ä¸ºMapä»£ç å¦‚ä¸‹ 12//çœç•¥listæ„é€ è¿‡ç¨‹Map&lt;Integer, String&gt; map2 = TransFormUtils.transformToMap(userList, p-&gt;p.getId(), p-&gt;p.getName()); åº”ç”¨å°è£…å¥½çš„å·¥å…·ç±» åªéœ€è¦ä¸€è¡Œä»£ç å°±å¯ä»¥å®Œæˆliståˆ°mapçš„è½¬æ¢ï¼Œç¨‹åºç®€å•äº†è®¸å¤š~~ list&lt; T &gt;è½¬map&lt; K,List&lt; V&gt;&gt;å°†å¼€å‘ä¸­ç»å¸¸éœ€è¦æ ¹æ®listä¸­çš„æŸä¸ªå±æ€§å°†liståˆ†ç±»ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåœ¨å¼€å‘é€šçŸ¥ä¸­å¿ƒæ—¶éœ€è¦ç»™ç”¨æˆ·æ¨é€æ¶ˆæ¯ï¼Œå®‰å“å’Œiosæ˜¯è°ƒç”¨çš„ä¸åŒçš„ç¬¬ä¸‰æ–¹åº“ï¼Œæ‰€ä»¥è¦æ ¹æ®è®¾å¤‡çš„ç±»å‹è°ƒç”¨ä¸åŒçš„æ–¹æ³•ã€‚é¦–å…ˆæ ¹æ®è¦æ¨é€çš„ç”¨æˆ·Idåˆ—è¡¨è·å¾—List&lt; DeviceUser&gt;,DeviceUserç±»çš„å±æ€§åŒ…æ‹¬devicetype,deviceId,userId,userName,createAtç­‰ã€‚æ¥ç€è¦è·å¾—deviceTypeæ˜¯iosçš„deviceIdåˆ—è¡¨ï¼ŒdeviceTypeæ˜¯å®‰å“çš„deviceIdåˆ—è¡¨ã€‚å³å°†List&lt; DeviceUser&gt;è½¬ä¸ºMap&lt; Integer,List&lt; String&gt;&gt;ï¼Œå…¶ä¸­mapçš„keyæ˜¯deviceTypeï¼Œvalueæ˜¯deviceIdçš„listã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå†™äº†ä¸€ä¸ªé€šç”¨çš„å·¥å…·ç±»ã€‚ 1.åˆ©ç”¨stream12345678910111213141516public class TransFormUtils &#123; /** * å°†list&lt;T&gt;è½¬ä¸ºMap&lt;K,List&lt;V&gt;&gt; * @param list * @param predicate1 mapä¸­çš„key * @param predicate2 mapä¸­çš„listçš„å…ƒç´  * @return */ public static &lt;K,V,T&gt; Map&lt;K, List&lt;V&gt;&gt; transformToMapList(List&lt;T&gt; list, Function&lt;T, K&gt; predicate1, Function&lt;T,V&gt; predicate2)&#123; return list.stream().collect( Collectors.groupingBy(predicate1, Collectors.mapping(predicate2, Collectors.toList()))); &#125;&#125; ä½¿ç”¨å¦‚ä¸‹ï¼š 123List&lt;DeviceUser&gt; list = new ArrayList&lt;DeviceUser&gt;();//çœç•¥listçš„æ„é€ Map&lt;Integer, List&lt;String&gt;&gt; deviceMap = TransFormUtils.transformToMapList(list, p-&gt;p.getDeviceType(), p-&gt;p.getDeviceId()); 2.æ™®é€šæ–¹æ³•åŒäº‹ä¹Ÿå†™äº†ä¸€ä¸ªå¦ä¸€ä¸ªå·¥å…·ç±»,è¿™ç§æ–¹æ³•å®šä¹‰äº†ä¸€ä¸ªæ–°çš„æ•°æ®ç»“æ„ï¼Œç›´æ¥ä½¿ç”¨MapListä»£æ›¿Map 123456789101112131415161718192021222324252627282930/** * Map&amp;Listç»„åˆæ•°æ®ç»“æ„ * * @author jianming.zhou * * @param &lt;K&gt; * @param &lt;V&gt; */public class MapList&lt;K, V&gt; &#123; private Map&lt;K, List&lt;V&gt;&gt; map = new HashMap&lt;K, List&lt;V&gt;&gt;(); public List&lt;V&gt; get(K k) &#123; return map.get(k); &#125; public void put(K k, V v) &#123; if (map.containsKey(k)) &#123; map.get(k).add(v); &#125; else &#123; List&lt;V&gt; list = new ArrayList&lt;V&gt;(); list.add(v); map.put(k, list); &#125; &#125; public Set&lt;K&gt; keySet() &#123; return map.keySet(); &#125;&#125; ä½¿ç”¨å¦‚ä¸‹123456List&lt;DeviceUser&gt; list = new ArrayList&lt;DeviceUser&gt;();//çœç•¥listçš„æ„é€ MapList&lt;Integer, String&gt; deviceMap = new MapList&lt;Integer,String&gt;();for(DeviceUser device : list)&#123; deviceMap.put(device.getDeviceType(),device.getDeviceId());&#125; è¿˜æ˜¯å–œæ¬¢ç¬¬ä¸€ç§å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ~~é¢˜å¤–è¯ï¼šæ—¢ç„¶å¯¹ç°çŠ¶ä¸æ»¡æ„ å°±å°è¯•æ”¹å˜å§ è™½ç„¶æœ‰å¯èƒ½è¿›å…¥å¦ä¸€ä¸ªå‘~~","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"stream","slug":"stream","permalink":"http://yemengying.com/tags/stream/"},{"name":"list","slug":"list","permalink":"http://yemengying.com/tags/list/"},{"name":"map","slug":"map","permalink":"http://yemengying.com/tags/map/"}]},{"title":"ä½¿ä»£ç æ›´ç®€æ´(ä¸€)---Listç›¸å…³","slug":"ä½¿ä»£ç æ›´ç®€æ´-ä¸€-Listç›¸å…³","date":"2015-09-10T06:07:54.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/09/10/ä½¿ä»£ç æ›´ç®€æ´-ä¸€-Listç›¸å…³/","link":"","permalink":"http://yemengying.com/2015/09/10/ä½¿ä»£ç æ›´ç®€æ´-ä¸€-Listç›¸å…³/","excerpt":"ä»¥å‰å†™åœ¨segmentFaultä¸Šçš„ä¸€ç¯‡æ–‡ç«  æ¬ç§»åˆ°è¿™é‡Œã€‚ è®°å½•ä¸€ä¸‹åœ¨å·¥ä½œå¼€å‘ä¸­å°è£…çš„ä¸€äº›å·¥å…·ç±»ï¼Œä½¿ä»£ç çœ‹èµ·æ¥æ›´åŠ çš„ç®€æ´ã€‚è¿™ç¯‡å°±è®°å½•ä¸‹å’Œlistç›¸å…³çš„å§ã€‚ã€‚ã€‚ã€‚ã€‚ä¼šæŒç»­è®°å½•ã€‚ã€‚ã€‚ã€‚","keywords":null,"text":"ä»¥å‰å†™åœ¨segmentFaultä¸Šçš„ä¸€ç¯‡æ–‡ç«  æ¬ç§»åˆ°è¿™é‡Œã€‚ è®°å½•ä¸€ä¸‹åœ¨å·¥ä½œå¼€å‘ä¸­å°è£…çš„ä¸€äº›å·¥å…·ç±»ï¼Œä½¿ä»£ç çœ‹èµ·æ¥æ›´åŠ çš„ç®€æ´ã€‚è¿™ç¯‡å°±è®°å½•ä¸‹å’Œlistç›¸å…³çš„å§ã€‚ã€‚ã€‚ã€‚ã€‚ä¼šæŒç»­è®°å½•ã€‚ã€‚ã€‚ã€‚ åˆ©ç”¨streamä»£æ›¿forå¾ªç¯ åœ¨å¯¹listçš„æ“ä½œä¸­å¸¸å¸¸éœ€è¦forå¾ªç¯æ¥éå†æ•´ä¸ªlistï¼Œä»£ç çœ‹èµ·æ¥ä¸å¤Ÿç®€æ´ã€‚æ‰€ä»¥åˆ©ç”¨java8çš„æ–°ç‰¹æ€§Streamæ¥ä»£æ›¿forå¾ªç¯ï¼Œæé«˜ç¨‹åºçš„å¯è¯»æ€§ã€‚ä»ç½‘ä¸Šcoypäº†ä¸€äº›streamçš„ä»‹ç»ï¼šStream ä¸æ˜¯é›†åˆå…ƒç´ ï¼Œå®ƒä¸æ˜¯æ•°æ®ç»“æ„å¹¶ä¸ä¿å­˜æ•°æ®ï¼Œå®ƒæ˜¯æœ‰å…³ç®—æ³•å’Œè®¡ç®—çš„ï¼Œå®ƒæ›´åƒä¸€ä¸ªé«˜çº§ç‰ˆæœ¬çš„ Iteratorã€‚åŸå§‹ç‰ˆæœ¬çš„ Iteratorï¼Œç”¨æˆ·åªèƒ½æ˜¾å¼åœ°ä¸€ä¸ªä¸€ä¸ªéå†å…ƒç´ å¹¶å¯¹å…¶æ‰§è¡ŒæŸäº›æ“ä½œï¼›é«˜çº§ç‰ˆæœ¬çš„ Streamï¼Œç”¨æˆ·åªè¦ç»™å‡ºéœ€è¦å¯¹å…¶åŒ…å«çš„å…ƒç´ æ‰§è¡Œä»€ä¹ˆæ“ä½œï¼Œæ¯”å¦‚ â€œè¿‡æ»¤æ‰é•¿åº¦å¤§äº 10 çš„å­—ç¬¦ä¸²â€ã€â€œè·å–æ¯ä¸ªå­—ç¬¦ä¸²çš„é¦–å­—æ¯â€ç­‰ï¼ŒStream ä¼šéšå¼åœ°åœ¨å†…éƒ¨è¿›è¡Œéå†ï¼Œåšå‡ºç›¸åº”çš„æ•°æ®è½¬æ¢ã€‚Stream å°±å¦‚åŒä¸€ä¸ªè¿­ä»£å™¨ï¼ˆIteratorï¼‰ï¼Œå•å‘ï¼Œä¸å¯å¾€å¤ï¼Œæ•°æ®åªèƒ½éå†ä¸€æ¬¡ï¼Œéå†è¿‡ä¸€æ¬¡åå³ç”¨å°½äº†ï¼Œå°±å¥½æ¯”æµæ°´ä»é¢å‰æµè¿‡ï¼Œä¸€å»ä¸å¤è¿”ã€‚è€Œå’Œè¿­ä»£å™¨åˆä¸åŒçš„æ˜¯ï¼ŒStream å¯ä»¥å¹¶è¡ŒåŒ–æ“ä½œï¼Œè¿­ä»£å™¨åªèƒ½å‘½ä»¤å¼åœ°ã€ä¸²è¡ŒåŒ–æ“ä½œã€‚é¡¾åæ€ä¹‰ï¼Œå½“ä½¿ç”¨ä¸²è¡Œæ–¹å¼å»éå†æ—¶ï¼Œæ¯ä¸ª item è¯»å®Œåå†è¯»ä¸‹ä¸€ä¸ª itemã€‚è€Œä½¿ç”¨å¹¶è¡Œå»éå†æ—¶ï¼Œæ•°æ®ä¼šè¢«åˆ†æˆå¤šä¸ªæ®µï¼Œå…¶ä¸­æ¯ä¸€ä¸ªéƒ½åœ¨ä¸åŒçš„çº¿ç¨‹ä¸­å¤„ç†ï¼Œç„¶åå°†ç»“æœä¸€èµ·è¾“å‡ºã€‚Stream çš„å¹¶è¡Œæ“ä½œä¾èµ–äº Java7 ä¸­å¼•å…¥çš„ Fork/Join æ¡†æ¶ï¼ˆJSR166yï¼‰æ¥æ‹†åˆ†ä»»åŠ¡å’ŒåŠ é€Ÿå¤„ç†è¿‡ç¨‹ã€‚ä¸‹é¢æ˜¯ä¸€äº›åˆ©ç”¨streamå†™çš„å·¥å…·ç±» æ‰“å°listä¸­çš„å…ƒç´ 123456789101112131415/** * * @author yemengying * */public class ListUtils &#123; /** * æ‰“å°listä¸­çš„å…ƒç´  * @param list */ public static &lt;T&gt; void printList(List&lt;T&gt; list)&#123; if(null == list) list = new ArrayList&lt;T&gt;(); list.stream().forEach(n -&gt; System.out.println(n.toString())); &#125;&#125; ä»listä¸­åˆ é™¤æŒ‡å®šçš„å…ƒç´ 12345678910111213141516171819202122/** * * @author yemengying * */public class ListUtils &#123; /** * ä»listä¸­åˆ é™¤æŒ‡å®šçš„å…ƒç´  å…¶ä»–ç±»éœ€é‡å†™equalsæ–¹æ³• * @param list * @param arg è¦åˆ é™¤çš„å…ƒç´  * @return è¿”å›åˆ é™¤äº†æŒ‡å®šå…ƒç´ çš„list * eg:list:[1,2,3,1]---removeElementFromList(list,1)---return list:[2,3] */ public static &lt;T&gt; List&lt;T&gt; removeElementFromList(List&lt;T&gt; list, T arg)&#123; if(null == list || list.isEmpty()) return new ArrayList&lt;T&gt;(); if(arg == null) return list; return list.stream().filter(n -&gt; &#123; return !n.equals(arg); &#125;).collect(Collectors.toList()); &#125;&#125; listæ’åº12345678910111213141516171819202122232425262728/** * * @author yemengying * */public class ListUtils &#123; /** * listæ’åº * @param list * @param comparator * @return è¿”å›æŒ‰comparatoræ’å¥½åºçš„list * eg:User:id nameä¸¤ä¸ªå±æ€§ * List&lt;User&gt; userList = new ArrayList&lt;User&gt;(); * userList.add(new User(1,\"abc\")); * userList.add(new User(3, \"ccd\")); * userList.add(new User(2, \"bde\")); * 1.æŒ‰useråå­—æ’åº * userList = ListUtils.sortList(userList, (p1, p2) -&gt; p1.getName().compareTo(p2.getName())); * 2.æŒ‰user Idæ’åº * userList = ListUtils.sortList(userList, (p1, p2) -&gt; p1.getId()-p2.getId()); */ public static &lt;T&gt; List&lt;T&gt; sortList(List&lt;T&gt; list, Comparator&lt;? super T&gt; comparator)&#123; if(null == list || list.isEmpty()) return new ArrayList&lt;T&gt;(); if(null == comparator) return list; return list.stream().sorted(comparator).collect(Collectors.toList()); &#125;&#125; åˆ¤è¯»listä¸­çš„å…ƒç´ æ˜¯ä¸æ˜¯å…¨éƒ¨æ»¡è¶³ æŒ‡å®šæ¡ä»¶12345678910111213141516171819202122232425/** * * @author yemengying * */public class ListUtils &#123; /** * åˆ¤è¯»listä¸­çš„å…ƒç´ æ˜¯ä¸æ˜¯å…¨éƒ¨æ»¡è¶³ predicateçš„æ¡ä»¶ * @param list * @param predicate * @return å…¨éƒ¨æ»¡è¶³ true æœ‰ä¸æ»¡è¶³çš„ false * egï¼šåˆ¤æ–­listä¸­çš„userçš„idæ˜¯ä¸æ˜¯å‡å°äº4 * List&lt;User&gt; userList = new ArrayList&lt;User&gt;(); * userList.add(new User(1,\"abc\")); * userList.add(new User(3, \"ccd\")); * userList.add(new User(2, \"bde\")); * System.out.println(ListUtils.isAllMatch(userList, u -&gt; u.getId()&lt;4)); * è¾“å‡º true */ public static &lt;T&gt; boolean isAllMatch(List&lt;T&gt; list, Predicate&lt;? super T&gt; predicate)&#123; if(null == list || list.isEmpty()) return false; if(null == predicate) return false; return list.stream().allMatch(predicate); &#125;&#125; åˆ¤æ–­listä¸­æ˜¯ä¸æ˜¯æœ‰ä¸€ä¸ªå…ƒç´ æ»¡è¶³predicateçš„æ¡ä»¶123456789101112131415161718192021222324/** * * @author yemengying * */public class ListUtils &#123; /** * åªè¦æœ‰ä¸€ä¸ªå…ƒç´ æ»¡è¶³predicateçš„æ¡ä»¶ è¿”å›true * @param list * @param predicate * @return * egï¼šåˆ¤æ–­listä¸­çš„userçš„idæ˜¯ä¸æ˜¯æœ‰ä¸€ä¸ªå¤§äº4 * List&lt;User&gt; userList = new ArrayList&lt;User&gt;(); * userList.add(new User(1,\"abc\")); * userList.add(new User(3, \"ccd\")); * userList.add(new User(2, \"bde\")); * System.out.println(ListUtils.isAllMatch(userList, u -&gt; u.getId()&gt;4)); return false */ public static &lt;T&gt; boolean isAnyMatch(List&lt;T&gt; list, Predicate&lt;? super T&gt; predicate)&#123; if(null == list || list.isEmpty()) return false; if(null == predicate) return false; return list.stream().anyMatch(predicate); &#125;&#125; åˆ¤æ–­listä¸­æ˜¯ä¸æ˜¯æ²¡æœ‰ä¸€ä¸ªå…ƒç´ æ»¡è¶³predicateçš„æ¡ä»¶123456789101112131415161718192021222324/** * * @author yemengying * */public class ListUtils &#123; /** * æ²¡æœ‰ä¸€ä¸ªå…ƒç´ æ»¡è¶³predicateçš„æ¡ä»¶ è¿”å›true * @param list * @param predicate * @return * egï¼šåˆ¤æ–­listä¸­çš„userçš„idæ˜¯ä¸æ˜¯æœ‰ä¸€ä¸ªå¤§äº4 * List&lt;User&gt; userList = new ArrayList&lt;User&gt;(); * userList.add(new User(1,\"abc\")); * userList.add(new User(3, \"ccd\")); * userList.add(new User(2, \"bde\")); * System.out.println(ListUtils.isAllMatch(userList, u -&gt; u.getId()&gt;4)); return true */ public static &lt;T&gt; boolean isNoneMatch(List&lt;T&gt; list, Predicate&lt;? super T&gt; predicate)&#123; if(null == list || list.isEmpty()) return false; if(null == predicate) return false; return list.stream().noneMatch(predicate); &#125;&#125; listå»é‡123456789101112131415161718/** * * @author yemengying * */public class ListUtils &#123; /** * listå»é‡ * @param list * @return * eg: * list[1,2,2]---distinctList(list)---list[1,2] */ public static &lt;T&gt; List&lt;T&gt; distinctList(List&lt;T&gt; list)&#123; if(null == list || list.isEmpty()) return new ArrayList&lt;T&gt;(); return list.stream().distinct().collect(Collectors.toList()); &#125;&#125; 2åˆ©ç”¨æ³›å‹ç¼–å†™ä¸€äº›é€šç”¨çš„æ–¹æ³•æ–¹ä¾¿çš„æ„é€ ä¸€ä¸ªliståœ¨å¼€å‘æ—¶ç»å¸¸é‡åˆ°è¦è°ƒç”¨ä¸€ä¸ªæ¥å£ï¼Œæ¥å£çš„å‚æ•°æ˜¯listã€‚ä¾‹å¦‚åœ¨å¼€å‘é€šçŸ¥ä¸­å¿ƒæ—¶å‘é€æ¶ˆæ¯çš„æ¥å£å®šä¹‰å¦‚ä¸‹,å…¶ä¸­messageFormæ˜¯è¦å‘é€çš„å†…å®¹ï¼ŒuserListæ˜¯æ¥å—è€…çš„ç”¨æˆ·id 1public int pushMessage(MessageForm messageForm,List&lt;Integer&gt; userList); è¿™æ ·ï¼Œåœ¨ç»™ä¸€ä¸ªäººå‘é€æ¶ˆæ¯çš„æ—¶å€™ä¹Ÿéœ€è¦æ„é€ ä¸€ä¸ªlistä¸€èˆ¬çš„åšæ³•,å¦‚ä¸‹: 123List&lt;Integer&gt; list = new ArrayList&lt;Integer&gt;();list.add(8808);pushService.pushMessage(messageForm,list); æ¯”è¾ƒéº»çƒ¦ï¼Œæ‰€ä»¥åŒäº‹å°è£…äº†ä¸€ä¸ªå·¥å…·æ–¹æ³•ï¼š 12345678910111213141516171819public class ListUtils &#123; /** * æ„é€ list * @param args * @return * @author zhoujianming */ @SuppressWarnings(\"unchecked\") public static &lt;T&gt; List&lt;T&gt; toList(T...args) &#123; if (null == args) &#123; return new ArrayList&lt;T&gt;(); &#125; List&lt;T&gt; list = new ArrayList&lt;T&gt;(); for (T t : args) &#123; list.add(t); &#125; return list; &#125;&#125; è¿™æ ·åœ¨è°ƒç”¨æ—¶ï¼Œæ¯”è¾ƒç®€æ´: 12//ç»™id 8808å’Œ8809å‘æ¶ˆæ¯pushService.pushMessage(messageForm,ListUtils.toList(8808,8809)); åˆ©ç”¨é€’å½’è·å¾—å¤šä¸ªlistçš„ç¬›å¡å°”ç§¯è·å¾—å¤šä¸ªlistçš„ç¬›å¡å°”ç§¯ï¼Œä»£ç å‚è€ƒstackoverflow 123456789101112131415161718192021222324252627/** * é€’å½’è·å¾—å¤šä¸ªlistçš„ç¬›å¡å°”ç§¯ * eg[1],[8808],[1,2,3]--&gt;[[1,8808,1],[1,8808,2]] * å‚è€ƒï¼šhttp://stackoverflow.com/questions/714108/cartesian-product-of-arbitrary-sets-in-java * @param lists * @return */public static &lt;T&gt; List&lt;List&lt;T&gt;&gt; cartesianProduct(List&lt;List&lt;T&gt;&gt; lists) &#123; List&lt;List&lt;T&gt;&gt; resultLists = new ArrayList&lt;List&lt;T&gt;&gt;(); if (lists.size() == 0) &#123; resultLists.add(new ArrayList&lt;T&gt;()); return resultLists; &#125; else &#123; List&lt;T&gt; firstList = lists.get(0); List&lt;List&lt;T&gt;&gt; remainingLists = cartesianProduct(lists.subList(1, lists.size())); for (T condition : firstList) &#123; for (List&lt;T&gt; remainingList : remainingLists) &#123; ArrayList&lt;T&gt; resultList = new ArrayList&lt;T&gt;(); resultList.add(condition); resultList.addAll(remainingList); resultLists.add(resultList); &#125; &#125; &#125; return resultLists;&#125; ä½¿ç”¨æ—¶å°†éœ€è¦è·å¾—ç¬›å¡å°”ç§¯çš„å¤šä¸ªlistæ”¾åˆ°ä¸€ä¸ªlisté‡Œï¼Œè°ƒç”¨ä¸Šé¢çš„æ–¹æ³•å³å¯ï¼Œè°ƒç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š 12345List&lt;Integer&gt; list1 = Arrays.asList(1,2,3);List&lt;Integer&gt; list2 = Arrays.asList(8808,8809,8810);List&lt;Integer&gt; list3 = Arrays.asList(4);List&lt;List&lt;Integer&gt;&gt; lists = Arrays.asList(list1,list2,list3);List&lt;List&lt;Integer&gt;&gt; resultLists = ListUtils.cartesianProduct(lists); [1,2,3],[8808,8809,8810],[4]â€”â€”&gt;[[1, 8808, 4], [1, 8809, 4], [1, 8810, 4], [2, 8808, 4], [2, 8809, 4], [2, 8810, 4], [3, 8808, 4], [3, 8809, 4], [3, 8810, 4]]","raw":null,"content":null,"categories":[{"name":"java","slug":"java","permalink":"http://yemengying.com/categories/java/"}],"tags":[{"name":"java","slug":"java","permalink":"http://yemengying.com/tags/java/"},{"name":"stream","slug":"stream","permalink":"http://yemengying.com/tags/stream/"},{"name":"list","slug":"list","permalink":"http://yemengying.com/tags/list/"}]},{"title":"angularjs+bootstrap+ngDialogå®ç°æ¨¡å¼å¯¹è¯æ¡†","slug":"angularjs-bootstrap-ngDialog","date":"2015-09-08T06:07:54.000Z","updated":"2017-06-10T07:56:03.000Z","comments":true,"path":"2015/09/08/angularjs-bootstrap-ngDialog/","link":"","permalink":"http://yemengying.com/2015/09/08/angularjs-bootstrap-ngDialog/","excerpt":"åœ¨å®Œæˆä¸€ä¸ªåå°ç®¡ç†ç³»ç»Ÿæ—¶ï¼Œéœ€è¦ç”¨è¡¨æ ¼æ˜¾ç¤ºæ³¨å†Œç”¨æˆ·çš„ä¿¡æ¯ã€‚ä½†æ˜¯ç”¨æˆ·åœ°å€å¤ªé•¿äº†ï¼Œä¸å¥½æ˜¾ç¤ºã€‚æ‰€ä»¥æƒ³åšä¸€ä¸ªæ¨¡å¼å¯¹è¯æ¡†ï¼Œç‚¹å‡»è¯¦ç»†åœ°å€æŒ‰é’®æ—¶ï¼Œå¼¹å‡ºå¯¹è¯æ¡†ï¼Œæ˜¾ç¤ºåœ°å€ã€‚","keywords":null,"text":"åœ¨å®Œæˆä¸€ä¸ªåå°ç®¡ç†ç³»ç»Ÿæ—¶ï¼Œéœ€è¦ç”¨è¡¨æ ¼æ˜¾ç¤ºæ³¨å†Œç”¨æˆ·çš„ä¿¡æ¯ã€‚ä½†æ˜¯ç”¨æˆ·åœ°å€å¤ªé•¿äº†ï¼Œä¸å¥½æ˜¾ç¤ºã€‚æ‰€ä»¥æƒ³åšä¸€ä¸ªæ¨¡å¼å¯¹è¯æ¡†ï¼Œç‚¹å‡»è¯¦ç»†åœ°å€æŒ‰é’®æ—¶ï¼Œå¼¹å‡ºå¯¹è¯æ¡†ï¼Œæ˜¾ç¤ºåœ°å€ã€‚æ•ˆæœå¦‚ä¸‹å›¾ï¼š é€šè¿‡æŸ¥é˜…èµ„æ–™ï¼Œé€‰æ‹©ä½¿ç”¨ngDialogæ¥å®ç°ï¼ŒngDialogæ˜¯ä¸€ä¸ªç”¨äºAngular.jsåº”ç”¨çš„æ¨¡å¼å¯¹è¯æ¡†å’Œå¼¹å‡ºçª—å£ã€‚ngDialogéå¸¸å°ï¼ˆã€œ2Kï¼‰ï¼Œæ‹¥æœ‰ç®€çº¦çš„APIï¼Œé€šè¿‡ä¸»é¢˜é«˜åº¦å¯å®šåˆ¶çš„ï¼Œå…·æœ‰å”¯ä¸€çš„ä¾èµ–Angular.jsã€‚ngDialog githubåœ°å€: https://github.com/likeastore/ngDialogngDialog Demo : http://likeastore.github.io/ngDialog/é¦–å…ˆå¼•å…¥éœ€è¦çš„ngdialogçš„jså’Œcssæ–‡ä»¶ã€‚å¯é€šè¿‡CDNå¼•å…¥ 1234//cdnjs.cloudflare.com/ajax/libs/ng-dialog/0.3.7/css/ngDialog.min.css //cdnjs.cloudflare.com/ajax/libs/ng-dialog/0.3.7/css/ngDialog-theme-default.min.css //cdnjs.cloudflare.com/ajax/libs/ng-dialog/0.3.7/css/ngDialog-theme-plain.min.css //cdnjs.cloudflare.com/ajax/libs/ng-dialog/0.3.7/js/ngDialog.min.js åœ¨user.jsé‡Œçš„controllerä¸­æ³¨å…¥ä¾èµ– 1234567891011121314151617181920var userControllers = angular.module('userControllers',['ngDialog']); userControllers.controller('userController',['$scope','$http','ngDialog',function($scope,$http, ngDialog)&#123; $scope.name = 'user'; $scope.user = \"\"; $scope.address = \"\"; //è·å–ç”¨æˆ·ä¿¡æ¯ $http.get('http://localhost:3000/users').success(function(data) &#123; $scope.user = data; console.log($scope.user); &#125;); //ç‚¹å‡»è¯¦ç»†åœ°å€æŒ‰é’®æ—¶ï¼Œè·³å‡ºæ¨¡å¼å¯¹è¯æ¡† $scope.clickToAddress = function (address) &#123; $scope.address = address; ngDialog.open(&#123; template: 'views/test.html',//æ¨¡å¼å¯¹è¯æ¡†å†…å®¹ä¸ºtest.html className: 'ngdialog-theme-plain', scope:$scope //å°†scopeä¼ ç»™test.html,ä»¥ä¾¿æ˜¾ç¤ºåœ°å€è¯¦ç»†ä¿¡æ¯ &#125;); &#125;; &#125;]) test.html(è¯»å–scopeä¸­çš„addresså¹¶æ˜¾ç¤ºï¼Œè¡¨æ ¼æ ·å¼é‡‡ç”¨bootstrap) 1234567891011121314151617181920212223242526272829&lt;table class=\"table\"&gt; &lt;thead&gt; &lt;tr&gt; &lt;th&gt; æ”¶ä»¶äººå§“å &lt;/th&gt; &lt;td&gt; &#123;&#123;address.name&#125;&#125; &lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;th&gt; æ”¶ä»¶åœ°å€ &lt;/th&gt; &lt;td&gt; &#123;&#123;address.content&#125;&#125; &lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;th&gt; æ‰‹æœºå· &lt;/th&gt; &lt;td&gt; &#123;&#123;address.phone&#125;&#125; &lt;/td&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;/table&gt; user.html (æ˜¾ç¤ºç”¨æˆ·çš„ä¿¡æ¯ï¼Œå½“åœ°å€ä¸ä¸ºç©ºæ—¶ï¼Œæ˜¾ç¤ºè¯¦ç»†åœ°å€æŒ‰é’®ï¼Œå¹¶ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œè°ƒç”¨controllerä¸­çš„clickToAddresså‡½æ•°) 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;div&gt; &lt;div class=\"panel panel-warning\"&gt; &lt;div class=\"panel-heading\"&gt; ç”¨æˆ·ç®¡ç† &lt;/div&gt; &lt;div class=\"row\"&gt; &lt;div class=\"col-lg-8\"&gt;&lt;/div&gt; &lt;div class=\"col-lg-4\"&gt; &lt;div class=\"input-group\"&gt; &lt;input type=\"text\" class=\"form-control\" placeholder=\"Search for...\" ng-model='search'&gt; &lt;span class=\"input-group-btn\"&gt; &lt;button class=\"btn btn-default\" type=\"button\"&gt;Go!&lt;/button&gt; &lt;/span&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;table class=\"table\"&gt; &lt;thead&gt; &lt;th&gt;å§“å&lt;/th&gt; &lt;th&gt;ä½™é¢ &lt;span class=\"glyphicon glyphicon-flash\" aria-hidden=\"true\"&gt; &lt;/span&gt;&lt;/th&gt; &lt;th&gt;å¤´åƒ&lt;/th&gt; &lt;th&gt;é»˜è®¤åœ°å€&lt;/th&gt; &lt;th&gt;æ“ä½œ&lt;/th&gt; &lt;/thead&gt; &lt;tbody&gt; &lt;tr ng-repeat=\"user in user | filter : search\" &gt; &lt;td&gt;&#123;&#123;user.userName&#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123;user.residualPayment&#125;&#125;&lt;/td&gt; &lt;td ng-if=\"user.url != 'undefined' \"&gt;&#123;&#123;user.url&#125;&#125;&lt;/td&gt; &lt;td ng-if=\"user.url == 'undefined' \"&gt;ç³»ç»Ÿé»˜è®¤å¤´åƒ&lt;/td&gt; &lt;td ng-if=\"user.address.length == 0 \"&gt;æš‚æ— é»˜è®¤åœ°å€&lt;/td&gt; &lt;td ng-if=\"user.address.length != 0\"ng-repeat=\"address in user.address \" ng-click=\"clickToAddress(address)\"&gt; &lt;button type=\"button\" class=\"btn btn-info navbar-btn\"&gt;è¯¦ç»†åœ°å€&lt;/button&gt; &lt;/td&gt; &lt;td&gt; &lt;button type=\"button\" class=\"btn btn-warning navbar-btn\" ng-click=\"remove(user._id)\"&gt;åˆ é™¤&lt;/button&gt; &lt;/td&gt; &lt;/tr&gt; &lt;/tbody&gt; &lt;/table&gt; &lt;/div&gt; &lt;/div&gt; gitåœ°å€: loadStyle(\"/hexo-github/style.css\"); loadStyle(\"/hexo-github/octicons/octicons.css\"); new Badge(\"#badge-container-giraffe0813-hellofreshAdmin-278d259\", \"giraffe0813\", \"hellofreshAdmin\", \"278d259\", false);","raw":null,"content":null,"categories":[{"name":"angularJs","slug":"angularJs","permalink":"http://yemengying.com/categories/angularJs/"}],"tags":[{"name":"angularJs","slug":"angularJs","permalink":"http://yemengying.com/tags/angularJs/"},{"name":"ngDialog","slug":"ngDialog","permalink":"http://yemengying.com/tags/ngDialog/"},{"name":"bootstrap","slug":"bootstrap","permalink":"http://yemengying.com/tags/bootstrap/"}]}]}