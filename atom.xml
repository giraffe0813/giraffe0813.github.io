<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Giraffe&#39;s Home</title>
  <subtitle>A Stupid Giraffe</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yemengying.com/"/>
  <updated>2016-06-26T08:02:48.000Z</updated>
  <id>http://yemengying.com/</id>
  
  <author>
    <name>Mengying Ye</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>【译】如何给变量取个简短且无歧义的名字</title>
    <link href="http://yemengying.com/2016/06/25/cleanCode4naming/"/>
    <id>http://yemengying.com/2016/06/25/cleanCode4naming/</id>
    <published>2016-06-25T08:23:39.000Z</published>
    <updated>2016-06-26T08:02:48.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;湾区日报上分享的一篇文章，文章的作者在Google设计Dart语言，就变量命名方面给了4点建议，文中也列出了好变量名、坏变量名的对比。不管作者的看法与你实际中的命名习惯是否一致，看完这篇文章，相信可以在变量命名方面有一些新的思考。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;原文地址（康桑阿米达）：&lt;a href=&quot;http://journal.stuffwithstuff.com/2016/06/16/long-names-are-long/?utm_source=wanqu.co&amp;amp;utm_campaign=Wanqu+Daily&amp;amp;utm_medium=website&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://journal.stuffwithstuff.com/2016/06/16/long-names-are-long/?utm_source=wanqu.co&amp;amp;utm_campaign=Wanqu+Daily&amp;amp;utm_medium=website&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;google做的最明智的规定之一就是严格执行code review。每一个改动在上线之前，都要经过两种形式的review。首先，团队中的人会进行常规的review，以确保代码完成了它应该完成的功能。&lt;/p&gt;
&lt;p&gt;接下来还会进行可读性层面的review。顾名思义，它是为了确保代码是可读性高的：是否利于理解和维护？是否符合该编程语言的一些惯例？是否有良好的文档？&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.dartlang.org/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Dart&lt;/a&gt;已经开始google内部使用，所以我有幸参与了n次上面类型的code review。作为该语言的设计者，这是一项令人着迷的工作。我可以直接看到人们是如何使用Dart的，这对语言的进一步发展很有帮助。在reivew的同时，我也能够清晰的了解到那些比较常见的错误和使用最多的特性，我就好像是一个记录本地居民生活的人类学者。&lt;/p&gt;
&lt;p&gt;当然，上面说的与本文的主旨无关，这并不是一篇关于Dart的文章。本文主要是想讨论我看到过的一些令人抓狂的代码：&lt;strong&gt;这些代码的变量命名实在是太尼玛的长了。。。。。&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;是的，变量的名称可以很短。回到当C语言中外部标识符仅需要由前六个字符来唯一的区分; 自动补全功能还没有发明; 每次按键盘都像在雪地上坡一样艰难的时候,长的命名就会带来很多问题。不过幸运的是，我们现在生活的世界太美好了，键盘操作变得如此简单。&lt;/p&gt;
&lt;p&gt;但我们现在似乎走上了另一个极端，我们不应该做海明威，但我们也无需成为田纳西·威廉斯。代码中使用了超长的命名会影响代码的清晰性。同时，超长的变量命名会造成换行，这会影响代码的结构，不易于阅读。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;长的类名会使开发者不易声明该类型的变量。&lt;/li&gt;
&lt;li&gt;长的方法命名会使它变得晦涩难懂.&lt;/li&gt;
&lt;li&gt;长的变量命名不利于代码重用，导致过长的方法链。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;我曾见过超过60个字符的变量命名,你甚至可以写首诗。别慌，下面我们来看看如何解决这一问题。&lt;/p&gt;
&lt;h3 id=&quot;选择一个好的命名&quot;&gt;&lt;a href=&quot;#选择一个好的命名&quot; class=&quot;headerlink&quot; title=&quot;选择一个好的命名&quot;&gt;&lt;/a&gt;选择一个好的命名&lt;/h3&gt;&lt;p&gt;命名有两个目标：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;清晰：你要知道该命名与什么有关&lt;/li&gt;
&lt;li&gt;精确：你要知道该命名与什么无关&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;当一个命名完成上面两个目标之后，其余的字符就是多余的了。下面是我在开发时的一些命名原则：&lt;/p&gt;
&lt;h4 id=&quot;命名中无需含有表示变量或参数类型的单词&quot;&gt;&lt;a href=&quot;#命名中无需含有表示变量或参数类型的单词&quot; class=&quot;headerlink&quot; title=&quot;命名中无需含有表示变量或参数类型的单词&quot;&gt;&lt;/a&gt;命名中无需含有表示变量或参数类型的单词&lt;/h4&gt;&lt;p&gt;如果使用如Java之类的静态类型语言, 开发者通常知道变量的类型. 由于方法的实现一般都比较简短, 所以即便是在查看一个需要推断才知道类型的本地变量, 或者在code review等静态分析器不可用的情况下, 我们也可以通过多看很少的几行代码就能知道变量的类型.&lt;/p&gt;
&lt;p&gt;所以将类型说明加入到变量名中是多余的. 我们应该舍弃&lt;a href=&quot;https://en.wikipedia.org/wiki/Hungarian_notation&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;匈牙利命名法&lt;/a&gt;，如下：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 不好的:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;String nameString;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;DockableModelessWindow dockableModelessWindow;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 改进:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;String name;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;DockableModelessWindow window;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;特别是对于集合来说，最好使用名词的复数形式来描述其内容, 而不是使用名词的单数形式来描述. 如果开发者更在乎集合中存储的内容, 那么变量命名应当反映这一点。&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 不好的:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;List&amp;lt;DateTime&amp;gt; holidayDateList;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Map&amp;lt;Employee, Role&amp;gt; employeeRoleHashMap;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 改进:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;List&amp;lt;DateTime&amp;gt; holidays;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Map&amp;lt;Employee, Role&amp;gt; employeeRoles;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这一点也同样适用于方法的命名。方法名不需要描述它的参数及参数的类型–参数列表已经说明了这些。&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 不好的:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mergeTableCells(List&amp;lt;TableCell&amp;gt; cells)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sortEventsUsingComparator(List&amp;lt;Event&amp;gt; events,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    Comparator&amp;lt;Event&amp;gt; comparator)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 改进:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;merge(List&amp;lt;TableCell&amp;gt; cells)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sort(List&amp;lt;Event&amp;gt; events, Comparator&amp;lt;Event&amp;gt; comparator)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这样可以帮助调用者更好的阅读：&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;mergeTableCells(tableCells);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sortEventsUsingComparator(events, comparator);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;当然，这只是我个人的看法，欢迎大家一起讨论~~&lt;/p&gt;
&lt;h4 id=&quot;省略命名中不是用来消除歧义的单词&quot;&gt;&lt;a href=&quot;#省略命名中不是用来消除歧义的单词&quot; class=&quot;headerlink&quot; title=&quot;省略命名中不是用来消除歧义的单词&quot;&gt;&lt;/a&gt;省略命名中不是用来消除歧义的单词&lt;/h4&gt;&lt;p&gt;有些开发者倾向于将他们知道的有关这个变量的所有信息都塞到命名里。要记住，命名只是一个标识符：只是告诉你该变量是在哪定义的。并不是用来告诉阅读者所有他们想知道的有关这个对象的详细信息。这是定义应该做的事情的。 命名只是让你找到他的定义。&lt;/p&gt;
&lt;p&gt;当我看到一个叫&lt;code&gt;recentlyUpdatedAnnualSalesBid&lt;/code&gt;(最近更新的全年销售投标)的标识符时，我会问：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;存在不是最近更新的全年销售投标么？&lt;/li&gt;
&lt;li&gt;存在没有被更新的最近的全年销售投标么？&lt;/li&gt;
&lt;li&gt;存在最近更新的非全年的销售投标么？&lt;/li&gt;
&lt;li&gt;存在最近更新的全年非销售的投标么？&lt;/li&gt;
&lt;li&gt;存在最近更新的全年销售非投标的东东吗？&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;上面任何一个问题的回答是“不存在”，就意味着命名中引入了无用的单词。&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 不好的:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;finalBattleMostDangerousBossMonster;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;weaklingFirstEncounterMonster;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 改进:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;boss;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;firstMonster;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;当然，你可能会觉得这有一些过了。比如将第一个例子的标识符简化为&lt;code&gt;bid&lt;/code&gt;,会让人觉得有点模糊不清。但你可以放心大胆的这样做，如果在之后的开发中觉得该命名会造成冲突或不明确，可以添加些修饰词来完善它。反之，如果一开始就取了一个很长的命名，你是不可能在之后重新回来简化它的。&lt;/p&gt;
&lt;h4 id=&quot;省略命名中可以从上下文获取的单词&quot;&gt;&lt;a href=&quot;#省略命名中可以从上下文获取的单词&quot; class=&quot;headerlink&quot; title=&quot;省略命名中可以从上下文获取的单词&quot;&gt;&lt;/a&gt;省略命名中可以从上下文获取的单词&lt;/h4&gt;&lt;p&gt;我可以在文章中使用”我”，因为读者都知道这是一篇由Bob Nystrom所做的博客。我蠢萌的脸就挂在那，我无需不停的说我的名字。写代码也是一样，类中的方法/属性和方法中的变量，都是存在在上下文中的，无需重复。&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Bad:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;AnnualHolidaySale&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; _annualSaleRebate;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;promoteHolidaySale&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123; ... &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// Better:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;AnnualHolidaySale&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; _rebate;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;promote&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123; ... &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;实际上, 一个命名嵌套的层次越多, 它就有更多的相关的上下文，也就更简短。换句话说，一个变量的作用域越小，命名就越短。&lt;/p&gt;
&lt;h4 id=&quot;省略命名中无任何含义的单词&quot;&gt;&lt;a href=&quot;#省略命名中无任何含义的单词&quot; class=&quot;headerlink&quot; title=&quot;省略命名中无任何含义的单词&quot;&gt;&lt;/a&gt;省略命名中无任何含义的单词&lt;/h4&gt;&lt;p&gt;我常常在许多游戏开发中看到包含无任何含义的单词的命名，一些开发者喜欢在命名中添加一些看起来有点严肃的单词。我猜可能他们觉得这样做可以让他们的代码显得重要，或者说让他们觉得自己更重要。&lt;/p&gt;
&lt;p&gt;实际上，有一些词语并没有实际意义，只是一些套话。比如：data, state, amount, value, manager, engine, object, entity和instance。&lt;/p&gt;
&lt;p&gt;一个好的命名能够在阅读者的脑海中描画出一幅图画。而将某变量命名为”manager”并不能向读者传达任何有关该变量是做什么的信息. 它是用来做绩效评估的吗? 它是管理加薪的吗?&lt;/p&gt;
&lt;p&gt;在命名时可以问一下自己，把这个单词去掉含义是不是不变？如果是，那就果断把它剔除吧~~&lt;/p&gt;
&lt;h3 id=&quot;实际例子—华夫饼&quot;&gt;&lt;a href=&quot;#实际例子—华夫饼&quot; class=&quot;headerlink&quot; title=&quot;实际例子—华夫饼&quot;&gt;&lt;/a&gt;实际例子—华夫饼&lt;/h3&gt;&lt;p&gt;为了让大家了解以上的命名原则在实际中如何应用，这有个违法了以上所有原则的反例。这个例子和我实际上review过的一段代码一样令人心碎。。。。&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// 好吃的比利时华夫饼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;DeliciousBelgianWaffleObject&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;garnishDeliciousBelgianWaffleWithStrawberryList&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      List&amp;lt;Strawberry&amp;gt; strawberryList)&lt;/span&gt; &lt;/span&gt;&amp;#123; ... &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;首先，通过参数列表我们可以知道方法是用来处理一个strawberry的列表，所以可以在方法命名中去掉：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;DeliciousBelgianWaffleObject&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;garnishDeliciousBelgianWaffle&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        List&amp;lt;Strawberry&amp;gt; strawberries)&lt;/span&gt; &lt;/span&gt;&amp;#123; ... &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;除非程序中还包含不好吃的比利时华夫饼或者其他国家的华夫饼，不然我们可以将这些无用的形容词去掉：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;WaffleObject&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;garnishWaffle&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(List&amp;lt;Strawberry&amp;gt; strawberries)&lt;/span&gt; &lt;/span&gt;&amp;#123; ... &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;方法是包含在&lt;code&gt;WaffleObject&lt;/code&gt;类中的，所以方法名中无需Waffle的说明：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;WaffleObject&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;garnish&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(List&amp;lt;Strawberry&amp;gt; strawberries)&lt;/span&gt; &lt;/span&gt;&amp;#123; ... &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;很明显它是一个对象，任何事物都是一个对象，这也就是传说中的“面向对象”的含义，所以命名中无需带有&lt;code&gt;Object&lt;/code&gt;：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Waffle&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;garnish&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(List&amp;lt;Strawberry&amp;gt; strawberries)&lt;/span&gt; &lt;/span&gt;&amp;#123; ... &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;好了，这样看起来好多了。&lt;/p&gt;
&lt;p&gt;以上就是我总结的相当简洁的命名原则。可能有些人会觉得无需在命名上耗费太多的精力，但我认为命名是开发过程中最基本的任务之一。&lt;br&gt;————————————————–我是萌萌哒分界线—————————————————————-&lt;br&gt;感觉变量或者方法的命名，看似简单，实际很难，特别是想一个简洁明了可读性高的命名。自己也经常用什么&lt;code&gt;data&lt;/code&gt;,&lt;code&gt;xxxlist&lt;/code&gt;来命名，作者说的挺对的，前者没什么意义，后者又有点啰嗦。不过对于集合类型的变量，统一用名词复数命名容易混淆。举个例子对于Apple这个类来说，可能存在List&lt;apple&gt;和Map&lt;integer,apple&gt;两种集合类型的变量。个人觉得对List类型的变量可以采用名词复数来命名，Map类型的变量可以采用valueByKey格式来命名，比较容易区分。&lt;/integer,apple&gt;&lt;/apple&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;欢迎指正错误，欢迎一起讨论~~~&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;湾区日报上分享的一篇文章，文章的作者在Google设计Dart语言，就变量命名方面给了4点建议，文中也列出了好变量名、坏变量名的对比。不管作者的看法与你实际中的命名习惯是否一致，看完这篇文章，相信可以在变量命名方面有一些新的思考。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="Clean Code" scheme="http://yemengying.com/categories/Clean-Code/"/>
    
    
      <category term="翻译" scheme="http://yemengying.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>面试总结</title>
    <link href="http://yemengying.com/2016/06/05/interview/"/>
    <id>http://yemengying.com/2016/06/05/interview/</id>
    <published>2016-06-05T02:12:59.000Z</published>
    <updated>2016-06-11T11:07:59.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;从决定离职开始，前前后后面试了几家公司，把还能记得住的面试问题总结一下，帮小伙伴们查漏补缺吧，希望小伙伴们可以一举拿下offer。会简要写一下我觉得问题的关键点，不过有的可能并不是正确的答案，有的问题我到现在也还没明白。。。~~&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;Java相关&quot;&gt;&lt;a href=&quot;#Java相关&quot; class=&quot;headerlink&quot; title=&quot;Java相关&quot;&gt;&lt;/a&gt;Java相关&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Java GC机制(重要程度:★★★★★)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;主要从三个方面回答:GC是针对什么对象进行回收(可达性分析法)，什么时候开始GC(当新生代满了会进行Minor GC，升到老年代的对象大于老年代剩余空间时会进行Major GC)，GC做什么(新生代采用复制算法，老年代采用标记-清除或标记-整理算法)，感觉回答这些就差不多了，也可以补充一下可以调优的参数(-XX:newRatio,-Xms,-Xmx等等)。详细的可以看我另一篇博客(&lt;a href=&quot;http://yemengying.com/2016/05/13/jvm-GC/&quot;&gt;Java中的垃圾回收机制&lt;/a&gt;)。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;如何线程安全的使用HashMap(重要程度:★★★★★)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;作为Java程序员还是经常和HashMap打交道的，所以HashMap的一些原理还是搞搞清除比较好。这个问题感觉主要就是问HashMap，HashTable，ConcurrentHashMap，sychronizedMap的原理和区别。具体的可以看我另一篇博客(&lt;a href=&quot;http://yemengying.com/2016/05/07/threadsafe-hashmap/&quot;&gt;如何线程安全的使用HashMap&lt;/a&gt;)。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;HashMap是如何解决冲突的(重要程度:★★★★☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;其实就是链接法，将索引值相同的元素存放到一个单链表里。但为了解决在频繁冲突时HashMap性能降低的问题，Java 8中做了一个小优化，在冲突的元素个数超过设定的值(默认为8)时，会使用平衡树来替代链表存储冲突的元素。具体的可以看我另一篇博客(&lt;a href=&quot;http://yemengying.com/2016/02/03/%E8%AF%91-Java%E4%B8%ADHashMap%E5%92%8CLinkedHashMap%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%86%B2%E7%AA%81/&quot;&gt;Java 8中HashMap和LinkedHashMap如何解决冲突&lt;/a&gt;)。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Java创建对象有哪几种(重要程度:★★★★☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这个问题还算好回答，大概有四种—new、工厂模式、反射和克隆，不过这个问题有可能衍生出关于设计模式，反射，深克隆，浅克隆等一系列问题。。。要做好准备~&lt;br&gt;参考资料：&lt;br&gt;&lt;a href=&quot;https://www.gitbook.com/book/quanke/design-pattern-java/details&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;设计模式Java版&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.jianshu.com/p/53eb4e16d00e&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Java反射详解&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.cnblogs.com/yxnchinahlj/archive/2010/09/20/1831615.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;深克隆与浅克隆的区别&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注解(重要程度:★★★☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;如果简历中有提到过曾自定义过注解，还是了解清楚比较好。主要是了解在自定义注解时需要使用的两个主要的元注解@Retention和@Target。@Retention用来声明注解的保留策略，有CLASS，RUNTIME,SOURCE三种，分别表示注解保存在类文件，JVM运行时刻和源代码中。@Target用来声明注解可以被添加到哪些类型的元素上，如类型，方法和域等。&lt;br&gt;参考资料：&lt;br&gt;&lt;a href=&quot;http://www.infoq.com/cn/articles/cf-java-annotation&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Java注解&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;异常(重要程度:★★★☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;一道笔试题，代码如下，问返回值是什么。&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; ret = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;try&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Exception();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;catch&lt;/span&gt;(Exception e)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ret = &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; ret;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;finally&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;ret = &lt;span class=&quot;number&quot;&gt;2&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;主要的考点就是catch中的return在finally之后执行 但是会将return的值放到一个地方存起来，所以finally中的ret=2会执行，但返回值是1。&lt;br&gt;参考资料：&lt;br&gt;&lt;a href=&quot;http://blog.csdn.net/hguisu/article/details/6155636&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;深入理解Java异常处理机制&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.runoob.com/java/java-exceptions.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Java异常处理&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;悲观锁和乐观锁区别，乐观锁适用于什么情况(重要程度:★★★★☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;悲观锁，就是总觉得有刁民想害朕，每次访问数据的时候都觉得会有别人修改它，所以每次拿数据时都会上锁，确保在自己使用的过程中不会被他人访问。乐观锁就是很单纯，心态好，所以每次拿数据的时候都不会上锁，只是在更新数据的时候去判断该数据是否被别人修改过。&lt;br&gt;大多数的关系数据库写入操作都是基于悲观锁，缺点在于如果持有锁的客户端运行的很慢，那么等待解锁的客户端被阻塞的时间就越长。Redis的事务是基于乐观锁的机制，不会在执行WATCH命令时对数据进行加锁，只是会在数据已经被其他客户端抢先修改了的情况下，通知执行WATCH命令的客户端。乐观锁适用于读多写少的情况，因为在写操作比较频繁的时候，会不断地retry，从而降低性能。&lt;br&gt;参考资料：&lt;br&gt;&lt;a href=&quot;https://yq.aliyun.com/articles/1273&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;关于悲观锁和乐观锁的区别&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.cnblogs.com/guyufei/archive/2011/01/10/1931632.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;乐观锁和悲观锁&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;单例模式找错误(重要程度:★★★★☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;错误是没有将构造函数私有化，单例还是比较简单的，把它的饿汉式和懒汉式的两种实现方式看明白了就可以了。&lt;br&gt;&lt;a href=&quot;https://quanke.gitbooks.io/design-pattern-java/content/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F-Singleton%20Pattern.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;单例模式&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;__&lt;/p&gt;
&lt;h3 id=&quot;Spring相关&quot;&gt;&lt;a href=&quot;#Spring相关&quot; class=&quot;headerlink&quot; title=&quot;Spring相关&quot;&gt;&lt;/a&gt;Spring相关&lt;/h3&gt;&lt;p&gt;关于Spring的问题主要就是围绕着Ioc和AOP，它们真是Spring的核心啊。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Spring Bean的生命周期(重要程度:★★★★★)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;就不写我那么low的回答了，直接看参考资料吧。&lt;br&gt;参考资料：&lt;br&gt;&lt;a href=&quot;http://www.cnblogs.com/zrtqsk/p/3735273.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Spring Bean的生命周期&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://javarevisited.blogspot.jp/2011/09/spring-interview-questions-answers-j2ee.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Top 10 Spring Interview Questions Answers J2EE&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Spring中用到的设计模式(重要程度:★★★★★)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;工厂模式:IOC容器&lt;br&gt;代理模式:AOP&lt;br&gt;策略模式:在spring采取动态代理时，根据代理的类有无实现接口有JDK和CGLIB两种代理方式，就是采用策略模式实现的&lt;br&gt;单例模式:默认情况下spring中的bean只存在一个实例&lt;br&gt;只知道这四个。。。。&lt;br&gt;参考资料:&lt;br&gt;&lt;a href=&quot;https://premaseem.wordpress.com/2013/02/09/spring-design-patterns-used-in-java-spring-framework/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Design Patterns Used in Java Spring Framework&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;讲一讲Spring IoC和AOP(重要程度:★★★★★)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;IoC的核心是依赖反转，将创建对象和对象之间的依赖管理交给IoC容器来做，完成对象之间的解耦。&lt;br&gt;AOP主要是利用代理模式，把许多接口都要用的又和接口本身主要的业务逻辑无关的部分抽出来，写成一个切面，单独维护，比如权限验证。这样可以使接口符合“单一职责原则”，只关注主要的业务逻辑，也提高了代码的重用性。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;AOP的应用场景(重要程度:★★★★☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;权限，日志，处理异常，事务等等，个人理解就是把许多接口都要用的又和接口本身主要的业务逻辑无关的部分抽出来，写成一个切面，单独维护，比如权限验证。这样可以使接口符合“单一职责原则”，只关注主要的业务逻辑，也提高了代码的重用性。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Spring中编码统一要如何做(重要程度:★★★☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;配置一个拦截器就行了&lt;br&gt;&lt;figure class=&quot;highlight xml&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;filter&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;filter-name&lt;/span&gt;&amp;gt;&lt;/span&gt;CharacterEncodingFilter&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;filter-name&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;filter-class&lt;/span&gt;&amp;gt;&lt;/span&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;filter-class&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;init-param&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;param-name&lt;/span&gt;&amp;gt;&lt;/span&gt;encoding&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;param-name&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;param-value&lt;/span&gt;&amp;gt;&lt;/span&gt;UTF-8&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;param-value&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;init-param&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;init-param&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;param-name&lt;/span&gt;&amp;gt;&lt;/span&gt;forceEncoding&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;param-name&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;param-value&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;param-value&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;init-param&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;filter&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;filter-mapping&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;filter-name&lt;/span&gt;&amp;gt;&lt;/span&gt;CharacterEncodingFilter&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;filter-name&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;tag&quot;&gt;&amp;lt;&lt;span class=&quot;name&quot;&gt;url-pattern&lt;/span&gt;&amp;gt;&lt;/span&gt;/*&lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;url-pattern&lt;/span&gt;&amp;gt;&lt;/span&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;tag&quot;&gt;&amp;lt;/&lt;span class=&quot;name&quot;&gt;filter-mapping&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;数据库相关&quot;&gt;&lt;a href=&quot;#数据库相关&quot; class=&quot;headerlink&quot; title=&quot;数据库相关&quot;&gt;&lt;/a&gt;数据库相关&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Mysql索引的内部结构(重要程度:★★★★☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;B+树，三层，真实的数据存储在叶子节点&lt;br&gt;参考资料:&lt;br&gt;&lt;a href=&quot;http://tech.meituan.com/mysql-index.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;MySQL索引原理及慢查询优化&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;如果一个SQL执行时间比较长怎么办(重要程度:★★★★☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;可以利用pt-query-digest等工具分析慢查询日志，也可以用explain查看SQL的执行计划。具体可看我的另一篇博客&lt;a href=&quot;http://yemengying.com/2016/05/24/mysql-tuning/&quot;&gt;MySQL调优&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;如果一张表中有上千万条数据应该怎么做分页(重要程度:★★★☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;肯定不能直接limit,offset，主要就是要想办法避免在数据量大时扫描过多的记录。具体可看我的另一篇博客&lt;a href=&quot;http://yemengying.com/2016/05/28/optimized-pagiantion-mysql/&quot;&gt;【译】优化MySQL中的分页&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;什么样的列适合加索引，如果一个列的值只有1和2，那么它适合加索引么(重要程度:★★★☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在where从句，group by从句，order by从句，on从句中出现的列&lt;/li&gt;
&lt;li&gt;索引的字段越小越好&lt;/li&gt;
&lt;li&gt;在建立联合索引时，离散度大的列放大联合索引的前面&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;只有1和2不适合建索引&lt;/p&gt;
&lt;h3 id=&quot;Redis相关&quot;&gt;&lt;a href=&quot;#Redis相关&quot; class=&quot;headerlink&quot; title=&quot;Redis相关&quot;&gt;&lt;/a&gt;Redis相关&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Redis提供哪几种数据结构(重要程度:★★★★★)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;一共有5种，字符串，散列，列表，集合，有序集合。&lt;br&gt;参考资料：&lt;br&gt;&lt;a href=&quot;http://www.redis.cn/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Redis中文官网&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Redis支持集群么，从哪个版本开始支持集群的(重要程度:★★☆☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;支持集群，从3.0版本开始。当然面试时我也没记住版本。。。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Redis集群中，如何将一个对象映射到对应的缓存服务器(重要程度:★★★★☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;一般就是hash%N,就是用对象的hash值对缓存服务器的个数取余&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;接上个问题，缓存集群中如果新增一台服务器，怎么才能不影响大部分缓存数据的命中？(重要程度:★★★★☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;其实就是一致性Hash算法。以前有看过，可惜面试的时候脑袋就空了，只记得一个环，果然还是要实践啊。&lt;br&gt;参考资料：&lt;br&gt;&lt;a href=&quot;http://blog.plasmaconduit.com/consistent-hashing/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Consistent Hashing&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://blog.csdn.net/cywosp/article/details/23397179&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;五分钟理解一致性哈希算法(consistent hashing)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;项目中具体是怎样使用Redis的(重要程度:★★★★☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;根据实际情况回答吧。。。。我是主要做权限控制时用到了Redis，将用户Id和权限Code拼接在一起作为一个key，放到Redis的集合中，在验证某一用户是否有指定权限时，只需验证集合中是否有用户Id和权限Code拼接的key即可&lt;/p&gt;
&lt;h3 id=&quot;算法相关&quot;&gt;&lt;a href=&quot;#算法相关&quot; class=&quot;headerlink&quot; title=&quot;算法相关&quot;&gt;&lt;/a&gt;算法相关&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;判断一个数字是否为快乐数字(重要程度:★☆☆☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;leetcode第202题&lt;br&gt;&lt;a href=&quot;https://leetcode.com/problems/happy-number/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;链接&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;给定一个乱序数组和一个目标数字 找到和为这个数字的两个数字 时间复杂度是多少(重要程度:★☆☆☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;leetcode第一题&lt;br&gt;&lt;a href=&quot;https://leetcode.com/problems/two-sum/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;链接&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;如何判断一个链表有没有环(重要程度:★☆☆☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;用快慢指针&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;删除字符串中的空格 只留一个(重要程度:★☆☆☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这个比较简单。。。。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;二叉树层序遍历(重要程度:★★☆☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;利用队列就可以了&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;地铁票价是如何计算的(重要程度:★★☆☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;不知道正确答案，感觉是图的最短路径算法相关的。&lt;/p&gt;
&lt;h3 id=&quot;Elasticsearch相关&quot;&gt;&lt;a href=&quot;#Elasticsearch相关&quot; class=&quot;headerlink&quot; title=&quot;Elasticsearch相关&quot;&gt;&lt;/a&gt;Elasticsearch相关&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;为什么要用Elasticsearch(重要程度:★★★★☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;其实对Es的了解还是比较少的，因为没做多久就去写坑爹代理商了😖。个人觉得项目中用Es的原因一是可以做分词，二是Es中采用的是倒排索引所以性能比较好，三是Es是个分布式的搜索服务，对各个节点的配置还是很简单方便的&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Elasticsearch中的数据来源是什么，如何做同步(重要程度:★★★★☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;数据是来自其他部门的数据库，会在一开始写python脚本做全量更新，之后利用RabbitMQ做增量更新，就是数据更改之后，数据提供方将更改的数据插入到指定消息队列，由对应的消费者索引到Es中&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;接上个问题，利用消息队列是会对对方代码造成侵入的，还有没有别的方式(重要程度:★★★☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;还可以读MySQL的binlog&lt;/p&gt;
&lt;h3 id=&quot;发散思维的题&quot;&gt;&lt;a href=&quot;#发散思维的题&quot; class=&quot;headerlink&quot; title=&quot;发散思维的题&quot;&gt;&lt;/a&gt;发散思维的题&lt;/h3&gt;&lt;p&gt;以下题都是没有正确答案的，不知道是想考思维，还是压力面试，就只写题目，不写回答了。。。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;画一下心中房树人的关系(重要程度:★☆☆☆☆)&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;给你一块地建房如何规划(重要程度:★☆☆☆☆)&lt;/strong&gt;&lt;br&gt;&lt;strong&gt;估计二号线有几辆车在运行(重要程度:★☆☆☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;其他&quot;&gt;&lt;a href=&quot;#其他&quot; class=&quot;headerlink&quot; title=&quot;其他&quot;&gt;&lt;/a&gt;其他&lt;/h3&gt;&lt;p&gt;&lt;strong&gt;Thrift通信协议(重要程度:★★★☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;这个问题被问了两遍，然而现在还是不知道。。。什么东西都不能停留在只会用的阶段啊~&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;git相关(重要程度:★★★★★)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;一些git相关的问题，比如如何做分支管理(git flow)，rebase和merge的区别(&lt;a href=&quot;http://blog.isming.me/2014/09/26/git-rebase-merge/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;merge操作会生成一个新的节点&lt;/a&gt;)等等。。。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;如何学习一门新技术(重要程度:★★★☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;google+官网+stackoverflow+github&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;比较爱逛的网站和爱看的书(重要程度:★★★☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;根据实际情况回答吧。。。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;了不了解微服务(重要程度:★★☆☆☆)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;简单了解过。。。&lt;br&gt;参考资料：&lt;br&gt;&lt;a href=&quot;http://www.jianshu.com/p/546ef242b6a3&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;基于微服务的软件架构模式&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;针对简历中的项目问一些问题(重要程度:★★★★★)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;就是根据简历上的项目问一些东西，比如权限控制是怎么做的，有没有碰到过比较难解决的问题之类的，不具体列举了，只要简历上的内容是真实的基本都没啥问题&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;为什么要离职(重要程度:★★★★★)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;被问了n遍，挺不好回答的一个问题，毕竟不算实习期工作还没满一年，这个时候跳槽很容易让人觉得不安稳。。。。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;对公司还有什么问题(重要程度:★★★★★)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;基本每轮面试结束都会问的一个问题，一开始也没当回事，直到有家公司居然挂在四面的这个问题上，我也是蛮醉的😂，果然言多必失啊🌝。。。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;在***公司最大的收获是什么(重要程度:★★★★★)&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;对于我来说，觉得最大的收获就是对企业级的应用有了一个大致的了解，企业里的项目不像学校的课程作业，只要jdbc连接数据库完成功能就可以了，企业的项目要考虑很多东西，比如说为了提高可用性，要部署在多台服务器上，用nginx做负载均衡，还有就是用缓存，异步之类来提高接口性能。然后，也是第一次接触到SOA，这种面向服务的架构。也了解到一个好的应用，除了开发本身，一些自动化发布系统和监控系统也是必不可少的。当然，还认识了一群三观合的小伙伴~~~&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;未完待续。。。。暂时只想到这些。。。面试真真是件很心累的事情，每次面完都感觉被拔了层皮，希望两年内不要在面试了😂。后天就要入职了，想想还有点小紧张呢，去看学叔推荐的美剧压压惊。。。&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;从决定离职开始，前前后后面试了几家公司，把还能记得住的面试问题总结一下，帮小伙伴们查漏补缺吧，希望小伙伴们可以一举拿下offer。会简要写一下我觉得问题的关键点，不过有的可能并不是正确的答案，有的问题我到现在也还没明白。。。~~&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="随笔" scheme="http://yemengying.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="随笔" scheme="http://yemengying.com/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>【译】优化MySQL中的分页</title>
    <link href="http://yemengying.com/2016/05/28/optimized-pagiantion-mysql/"/>
    <id>http://yemengying.com/2016/05/28/optimized-pagiantion-mysql/</id>
    <published>2016-05-28T01:45:42.000Z</published>
    <updated>2016-05-29T12:34:18.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;一道面试的问题，当MySQL表中有数据量很大的时候如何做分页。。。。当时只知道在数据量很大的时候可以分表，但不知道不分表时可以怎么做。。。。唉，谁让代理商就那么几条数据，一个简单的limit，offset就完全hold住了(捂脸🙈)。。。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;翻译一篇关于优化MySQL中的分页的文章，原文地址：&lt;a href=&quot;http://www.xarg.org/2011/10/optimized-pagination-using-mysql/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Optimized Pagination using MySQL&lt;/a&gt;，谢谢，3Q，康桑阿米达~~~&lt;/p&gt;
&lt;p&gt;很多应用往往只展示最新或最热门的几条记录，但为了旧记录仍然可访问，所以就需要个分页的导航栏。然而，如何通过MySQL更好的实现分页，始终是比较令人头疼的问题。虽然没有拿来就能用的解决办法，但了解数据库的底层或多或少有助于优化分页查询。&lt;br&gt;我们先从一个常用但性能很差的查询来看一看。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; city&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;DESC&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;LIMIT&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这个查询耗时0.00sec。So，这个查询有什么问题呢？实际上，这个查询语句和参数都没有问题，因为它用到了下面表的主键，而且只读取15条记录。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt; city (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;int&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt; AUTO_INCREMENT,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  city &lt;span class=&quot;built_in&quot;&gt;varchar&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  PRIMARY &lt;span class=&quot;keyword&quot;&gt;KEY&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;) &lt;span class=&quot;keyword&quot;&gt;ENGINE&lt;/span&gt;=&lt;span class=&quot;keyword&quot;&gt;InnoDB&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;真正的问题在于offset(分页偏移量)很大的时候，像下面这样：&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; city&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;DESC&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;LIMIT&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;上面的查询在有2M行记录时需要0.22sec，通过EXPLAIN查看SQL的执行计划可以发现该SQL检索了100015行，但最后只需要15行。大的分页偏移量会增加使用的数据，MySQL会将大量最终不会使用的数据加载到内存中。就算我们假设大部分网站的用户只访问前几页数据，但少量的大的分页偏移量的请求也会对整个系统造成危害。Facebook意识到了这一点，但Facebook并没有为了每秒可以处理更多的请求而去优化数据库，而是将重心放在将&lt;a href=&quot;http://highscalability.com/blog/2010/11/4/facebook-at-13-million-queries-per-second-recommends-minimiz.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;请求响应时间的方差变小&lt;/a&gt;。&lt;br&gt;对于分页请求，还有一个信息也很重要，就是总共的记录数。我们可以通过下面的查询很容易的获取总的记录数。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;COUNT&lt;/span&gt;(*)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; city;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;然而，上面的SQL在采用InnoDB为存储引擎时需要耗费9.28sec。一个不正确的优化是采用&lt;code&gt;SQL_CALC_FOUND_ROWS&lt;/code&gt;,&lt;code&gt;SQL_CALC_FOUND_ROWS&lt;/code&gt;可以在能够在分页查询时事先准备好符合条件的记录数，随后只要执行一句&lt;code&gt;select FOUND_ROWS();&lt;/code&gt; 就能获得总记录数。但是在大多数情况下，查询语句简短并不意味着性能的提高。不幸的是，这种分页查询方式在许多主流框架中都有用到，下面看看这个语句的查询性能。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;SQL_CALC_FOUND_ROWS&lt;/span&gt; *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; city&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;DESC&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;LIMIT&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;100000&lt;/span&gt;, &lt;span class=&quot;number&quot;&gt;15&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这个语句耗时20.02sec，是上一个的两倍。事实证明使用&lt;code&gt;SQL_CALC_FOUND_ROWS&lt;/code&gt;做分页是很糟糕的想法。&lt;br&gt;下面来看看到底如何优化。文章分为两部分，第一部分是如何获取记录的总数目，第二部分是获取真正的记录。&lt;/p&gt;
&lt;h3 id=&quot;高效的计算行数&quot;&gt;&lt;a href=&quot;#高效的计算行数&quot; class=&quot;headerlink&quot; title=&quot;高效的计算行数&quot;&gt;&lt;/a&gt;高效的计算行数&lt;/h3&gt;&lt;p&gt;如果采用的引擎是MyISAM，可以直接执行COUNT(*)去获取行数即可。相似的，在堆表中也会将行数存储到表的元信息中。但如果引擎是InnoDB情况就会复杂一些，因为InnoDB不保存表的具体行数。&lt;br&gt;我们可以将行数缓存起来，然后可以通过一个守护进程定期更新或者用户的某些操作导致缓存失效时，执行下面的语句：&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;COUNT&lt;/span&gt;(*)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; city&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;USE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;INDEX&lt;/span&gt;(PRIMARY);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;获取记录&quot;&gt;&lt;a href=&quot;#获取记录&quot; class=&quot;headerlink&quot; title=&quot;获取记录&quot;&gt;&lt;/a&gt;获取记录&lt;/h3&gt;&lt;p&gt;下面进入这篇文章最重要的部分，获取分页要展示的记录。上面已经说过了，大的偏移量会影响性能，所以我们要重写查询语句。为了演示，我们创建一个新的表“news”，按照时事性排序(最新发布的在最前面)，实现一个高性能的分页。为了简单，我们就假设最新发布的新闻的Id也是最大的。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt; news(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;INT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;UNSIGNED&lt;/span&gt; PRIMARY &lt;span class=&quot;keyword&quot;&gt;KEY&lt;/span&gt; AUTO_INCREMENT,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   title &lt;span class=&quot;built_in&quot;&gt;VARCHAR&lt;/span&gt;(&lt;span class=&quot;number&quot;&gt;128&lt;/span&gt;) &lt;span class=&quot;keyword&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;literal&quot;&gt;NULL&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;) &lt;span class=&quot;keyword&quot;&gt;ENGINE&lt;/span&gt;=&lt;span class=&quot;keyword&quot;&gt;InnoDB&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;一个比较高效的方式是基于用户展示的最后一个新闻Id。查询下一页的语句如下，需要传入当前页面展示的最后一个Id。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; news &lt;span class=&quot;keyword&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &amp;lt; $last_id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;DESC&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;LIMIT&lt;/span&gt; $perpage&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;查询上一页的语句类似，只不过需要传入当前页的第一个Id，并且要逆序。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; news &lt;span class=&quot;keyword&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &amp;gt; $last_id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;ASC&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;LIMIT&lt;/span&gt; $perpage&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;上面的查询方式适合实现简易的分页，即不显示具体的页数导航，只显示“上一页”和“下一页”，例如博客中页脚显示“上一页”，“下一页”的按钮。但如果要实现真正的页面导航还是很难的,下面看看另一种方式。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;, ((@cnt:= @cnt + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) + $perpage - &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) % $perpage cnt&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; news &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;JOIN&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; @cnt:= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;)T&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &amp;lt; $last_id&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;DESC&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;LIMIT&lt;/span&gt; $perpage * $buttons&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;)C&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WHERE&lt;/span&gt; cnt = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;通过上面的语句可以为每一个分页的按钮计算出一个offset对应的id。这种方法还有一个好处。假设，网站上正在发布一片新的文章，那么所有文章的位置都会往后移一位，所以如果用户在发布文章时换页，那么他会看见一篇文章两次。如果固定了每个按钮的offset Id，这个问题就迎刃而解了。Mark Callaghan发表过一篇类似的&lt;a href=&quot;http://www.facebook.com/note.php?note_id=206034210932&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;博客&lt;/a&gt;，利用了组合索引和两个位置变量，但是基本思想是一致的。&lt;br&gt;如果表中的记录很少被删除、修改，还可以将记录对应的页码存储到表中，并在该列上创建合适的索引。采用这种方式，当新增一个记录的时候，需要执行下面的查询重新生成对应的页号。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SET&lt;/span&gt; @p:= &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;UPDATE&lt;/span&gt; news &lt;span class=&quot;keyword&quot;&gt;SET&lt;/span&gt; page=&lt;span class=&quot;keyword&quot;&gt;CEIL&lt;/span&gt;((@p:= @p + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) / $perpage) &lt;span class=&quot;keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;DESC&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;当然，也可以新增一个专用于分页的表，可以用个后台程序来维护。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;UPDATE&lt;/span&gt; pagination T&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;JOIN&lt;/span&gt; (&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;CEIL&lt;/span&gt;((@p:= @p + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;) / $perpage) page&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; news&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &lt;span class=&quot;keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;)C&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ON&lt;/span&gt; C.&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt; = T.&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SET&lt;/span&gt; T.page = C.page;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;现在想获取任意一页的元素就很简单了：&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; news A&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;JOIN&lt;/span&gt; pagination B &lt;span class=&quot;keyword&quot;&gt;ON&lt;/span&gt; A.&lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;=B.&lt;span class=&quot;keyword&quot;&gt;ID&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WHERE&lt;/span&gt; page=$&lt;span class=&quot;keyword&quot;&gt;offset&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;还有另外一种与上种方法比较相似的方法来做分页，这种方式比较试用于数据集相对小，并且没有可用的索引的情况下—比如处理搜索结果时。在一个普通的服务器上执行下面的查询，当有2M条记录时，要耗费2sec左右。这种方式比较简单，创建一个用来存储所有Id的临时表即可(这也是最耗费性能的地方)。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TEMPORARY&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt; _tmp (&lt;span class=&quot;keyword&quot;&gt;KEY&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;SORT&lt;/span&gt;(random))&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;id&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;FLOOR&lt;/span&gt;(&lt;span class=&quot;keyword&quot;&gt;RAND&lt;/span&gt;() * &lt;span class=&quot;number&quot;&gt;0x8000000&lt;/span&gt;) random&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; city;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ALTER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;TABLE&lt;/span&gt; _tmp &lt;span class=&quot;keyword&quot;&gt;ADD&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;OFFSET&lt;/span&gt; &lt;span class=&quot;built_in&quot;&gt;INT&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;UNSIGNED&lt;/span&gt; PRIMARY &lt;span class=&quot;keyword&quot;&gt;KEY&lt;/span&gt; AUTO_INCREMENT, &lt;span class=&quot;keyword&quot;&gt;DROP&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;INDEX&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;SORT&lt;/span&gt;, &lt;span class=&quot;keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;BY&lt;/span&gt; random;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;接下来就可以向下面一样执行分页查询了。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; _tmp&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;OFFSET&lt;/span&gt; &amp;gt;= $&lt;span class=&quot;keyword&quot;&gt;offset&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;OFFSET&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;LIMIT&lt;/span&gt; $perpage;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;——————————————–俺只是个分割线———————————————————-&lt;br&gt;简单来说，对于分页的优化就是。。。避免数据量大时扫描过多的记录。&lt;br&gt;博客比较长，所以翻译的有些粗糙。。。，之后会在好好检查一遍的。在自己做测试时，有些查询时间与作者有点不一致，不过作者这篇博客是写于2011年的，so~不要在意具体数据，领会精神吧~~&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;欢迎指正错误，欢迎一起讨论！！！&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;国际惯例，wuli光洙结尾~~&lt;br&gt;&lt;img src=&quot;/images/liguangzhu06.gif&quot; alt=&quot;李光洙&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;一道面试的问题，当MySQL表中有数据量很大的时候如何做分页。。。。当时只知道在数据量很大的时候可以分表，但不知道不分表时可以怎么做。。。。唉，谁让代理商就那么几条数据，一个简单的limit，offset就完全hold住了(捂脸🙈)。。。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="MySQL" scheme="http://yemengying.com/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="http://yemengying.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>MySQL调优</title>
    <link href="http://yemengying.com/2016/05/24/mysql-tuning/"/>
    <id>http://yemengying.com/2016/05/24/mysql-tuning/</id>
    <published>2016-05-24T13:16:33.000Z</published>
    <updated>2016-05-27T06:28:37.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;啦啦啦，啦啦啦，我是卖报的小行家~~&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;先分享个脑洞打开的mv，coldplay新单up&amp;amp;up，看看会飞的海龟🐢，一点也不精彩，就看了30多遍而已😂。&lt;/p&gt;
&lt;embed src=&quot;http://player.video.qiyi.com/977853bfe26ef11b25e524a983e72c30/0/0/w_19rt2btvq9.swf-albumId=5831552909-tvId=5831552909-isPurchase=0-cnId=5&quot; allowfullscreen=&quot;true&quot; quality=&quot;high&quot; width=&quot;480&quot; height=&quot;350&quot; align=&quot;middle&quot; allowscriptaccess=&quot;always&quot; type=&quot;application/x-shockwave-flash&quot;&gt;


&lt;p&gt;———————————-我是预示画风转变分割线————————————————————————-&lt;br&gt;根据视频(&lt;a href=&quot;http://www.imooc.com/learn/194&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;链接&lt;/a&gt;)整理。&lt;/p&gt;
&lt;h3 id=&quot;为什么要进行优化？&quot;&gt;&lt;a href=&quot;#为什么要进行优化？&quot; class=&quot;headerlink&quot; title=&quot;为什么要进行优化？&quot;&gt;&lt;/a&gt;为什么要进行优化？&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;避免由数据库链接timeout产生页面5xx的错误&lt;/li&gt;
&lt;li&gt;避免由于慢查询造成页面无法加载&lt;/li&gt;
&lt;li&gt;避免由于阻塞造成数据无法提交&lt;/li&gt;
&lt;li&gt;优化用户体验&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;可以从哪几个方面进行数据库优化？&quot;&gt;&lt;a href=&quot;#可以从哪几个方面进行数据库优化？&quot; class=&quot;headerlink&quot; title=&quot;可以从哪几个方面进行数据库优化？&quot;&gt;&lt;/a&gt;可以从哪几个方面进行数据库优化？&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/mysql.png&quot; alt=&quot;image&quot;&gt;&lt;br&gt;从图中可以看出，SQL及索引的优化是最重要的，成本最低效果最好。&lt;br&gt;下面分别来看看如何优化SQL和索引。&lt;/p&gt;
&lt;h3 id=&quot;SQL优化&quot;&gt;&lt;a href=&quot;#SQL优化&quot; class=&quot;headerlink&quot; title=&quot;SQL优化&quot;&gt;&lt;/a&gt;SQL优化&lt;/h3&gt;&lt;h4 id=&quot;慢查询日志配置&quot;&gt;&lt;a href=&quot;#慢查询日志配置&quot; class=&quot;headerlink&quot; title=&quot;慢查询日志配置&quot;&gt;&lt;/a&gt;慢查询日志配置&lt;/h4&gt;&lt;p&gt;可以使用慢查询日志对有效率问题的SQL进行监控。下面是关于如何开启慢查询日志和慢查询日志的一些配置。&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;show variables like &lt;span class=&quot;string&quot;&gt;&#39;slow_query_log&#39;&lt;/span&gt;; //查看是否开启了慢查询&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; global slow_query_&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;_file=&lt;span class=&quot;string&quot;&gt;&#39;/home/mysql/sql_log/mysql-slow.log&#39;&lt;/span&gt;; //设置慢查询日志的位置&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; global &lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;_queries_not_using_indexes=ON; //是否记录未使用索引的查询&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; global long_query_time=1;//设置记录超过多长时间的SQL语句&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; global slow_query_&lt;span class=&quot;built_in&quot;&gt;log&lt;/span&gt;=ON;//设置慢查询日志是否开启&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;慢查询日志的格式：&lt;br&gt;&lt;img src=&quot;/images/mysql2.png&quot; alt=&quot;慢查询日志的格式&quot;&gt;&lt;br&gt;详细看一下每一行都是什么意思。&lt;br&gt;查询的执行时间 Time:140606 12:30:17&lt;br&gt;执行SQL的主机信息 User@Host:root[root] @ localhost []&lt;br&gt;SQL的执行信息 Query_time: 0.000024 Lock_time:0.000000 Rows_sent:0 Rows_examined: 0&lt;br&gt;SQL执行时间 SET timestamp=1402389328&lt;br&gt;SQL的内容:show tables&lt;/p&gt;
&lt;h4 id=&quot;分析慢查日志的工具&quot;&gt;&lt;a href=&quot;#分析慢查日志的工具&quot; class=&quot;headerlink&quot; title=&quot;分析慢查日志的工具&quot;&gt;&lt;/a&gt;分析慢查日志的工具&lt;/h4&gt;&lt;p&gt;1.mysqldumpslow&lt;br&gt;可以使用MySQL自带的慢查询分析工具&lt;code&gt;mysqldumpslow&lt;/code&gt;，可以通过&lt;code&gt;mysqldumpslow -h&lt;/code&gt;来查看具体的使用方法。&lt;br&gt;eg:mysqldumpslow -t 3 /path/to/mysql-slow-query.log | more&lt;br&gt;上面的命令会列出查询时间top 3的SQL语句，具体格式如下图，会列出SQL执行的次数，SQL来执行的时间，锁定的时间，发送的函数，由谁在哪个服务器上执行的和具体的SQL内容。&lt;br&gt;&lt;img src=&quot;/images/mysql3.png&quot; alt=&quot;mysqldumpslow格式&quot;&gt;&lt;br&gt;mysqldumpslow是比较常用的慢查询日志分析工具，但是分析结果包含的信息比较少，对于SQL优化来说可能还不太够。下面看看另一种分析工具。&lt;/p&gt;
&lt;p&gt;2.pt-query-digest&lt;br&gt;&lt;code&gt;pt-query-digest&lt;/code&gt;支持将分析结果保存到文件或数据表中。&lt;br&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;输出到文件&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pt-query-digest slow.log &amp;gt; slow_log.report&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;输出到数据库表&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pt-query-digest slow.log -review \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;h=127.0.0.1,D=test,p=root,P=3306,u=root,t=query_review \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--creat-reviewtable \&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;--review-history t=hostname_slow&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;通过&lt;code&gt;pt-query-digest --help&lt;/code&gt;可以查看具体的使用方式。&lt;br&gt;eg: pt-query-digest /home/mysql/data/mysql-slow.log | more&lt;br&gt;通过上面的命令，会列出慢查询日志的分析结果，分为三个部分。&lt;br&gt;第一部分中包含日志中有多少个SQL，多少个不同的SQL，SQL执行的时间范围，总的执行时间，最短的执行时间，最长的执行时间，平均执行时间，总锁定时间，总发送行数，总检索行数等等。&lt;br&gt;&lt;img src=&quot;/images/pt1.png&quot; alt=&quot;pt-query-digest格式&quot;&gt;&lt;br&gt;第二部分包含关于  表和执行语句的统计，可以看到哪个表的哪个操作的实行时间是最多的，也可以看到对应的响应时间和调用次数。&lt;br&gt;&lt;img src=&quot;/images/pt2.png&quot; alt=&quot;pt-query-digest格式&quot;&gt;&lt;br&gt;第三部分就是具体的SQL的分析，包括对应语句执行时间，锁定时间，发送行数，检索行数等等。&lt;br&gt;&lt;img src=&quot;/images/pt3.png&quot; alt=&quot;pt-query-digest格式&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;定位有问题的SQL&quot;&gt;&lt;a href=&quot;#定位有问题的SQL&quot; class=&quot;headerlink&quot; title=&quot;定位有问题的SQL&quot;&gt;&lt;/a&gt;定位有问题的SQL&lt;/h4&gt;&lt;p&gt;通过上面的慢查询日志分析我们可以定位需要优化的SQL,通常有三种：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;查询次数多且每次查询占用时间长的SQL：通常为pt-query-digest分析的前几个查询。&lt;/li&gt;
&lt;li&gt;IO大的SQL：注意pt-query-digest分析中的Rows examine项&lt;/li&gt;
&lt;li&gt;未命中索引的SQL： 注意pt-query-digest分析中Rows examine和Rows Send的对比。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;通过Explain查询和分析SQL的执行计划&quot;&gt;&lt;a href=&quot;#通过Explain查询和分析SQL的执行计划&quot; class=&quot;headerlink&quot; title=&quot;通过Explain查询和分析SQL的执行计划&quot;&gt;&lt;/a&gt;通过Explain查询和分析SQL的执行计划&lt;/h4&gt;&lt;p&gt;可以通过Explain查询SQL的执行计划，例子如下：&lt;br&gt;&lt;img src=&quot;/images/explain.png&quot; alt=&quot;Explain&quot;&gt;&lt;br&gt;explain返回的各列的含义：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;列&lt;/th&gt;
&lt;th style=&quot;text-align:center&quot;&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;table&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;显示查询是关于哪个表的&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;type&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;很重要的列，显示连接使用了何种类型。从最好到最差的连接类型为const、eq_reg、ref、range、index和ALL&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;possible_keys&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;显示可能应用在这张表中的索引。如果为空，没有可能应用的索引&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;key&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;实际使用的索引。如果为NULL，则没有使用索引&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;key_len&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;使用的索引的长度。在不损失精确性的情况下，长度越短越好&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;ref&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;显示索引的哪一列被使用了&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;rows&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;MYSQL认为必须检查的用来返回请求的行数&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;extra&lt;/td&gt;
&lt;td style=&quot;text-align:center&quot;&gt;当这一列的值是Using filesort或Using temporary时，说明查询需要优化了&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&quot;索引优化&quot;&gt;&lt;a href=&quot;#索引优化&quot; class=&quot;headerlink&quot; title=&quot;索引优化&quot;&gt;&lt;/a&gt;索引优化&lt;/h3&gt;&lt;h4 id=&quot;如何选择合适的列来建立索引&quot;&gt;&lt;a href=&quot;#如何选择合适的列来建立索引&quot; class=&quot;headerlink&quot; title=&quot;如何选择合适的列来建立索引&quot;&gt;&lt;/a&gt;如何选择合适的列来建立索引&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;在where从句，group by从句，order by从句，on从句中出现的列&lt;/li&gt;
&lt;li&gt;索引的字段越小越好&lt;/li&gt;
&lt;li&gt;在建立联合索引时，离散度大的列放大联合索引的前面&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;如何维护和优化索引&quot;&gt;&lt;a href=&quot;#如何维护和优化索引&quot; class=&quot;headerlink&quot; title=&quot;如何维护和优化索引&quot;&gt;&lt;/a&gt;如何维护和优化索引&lt;/h4&gt;&lt;p&gt;要避免重复及冗余索引，重复索引是指相同的列以相同的顺序建立的同类型的索引。冗余索引是指多个索引的前缀列相同，或是在联合索引中包含了主键的索引。&lt;br&gt;可以使用&lt;code&gt;pt-duplicate-key-checker&lt;/code&gt;工具可以检查重复及冗余索引。&lt;br&gt;同时还要注意及时删除由于业务变更不再使用的索引。目前MySQL中还没有记录索引的使用情况，但在PerconMuSQL和MariaDB中可以通过INDEX_STATISTICS表来查看哪些索引未使用，在MySQL中目前只能通过慢查询日志配合pt-index-usage工具来进行索引的使用情况的分析。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;欢迎指正错误，欢迎一起讨论~~&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;啦啦啦，啦啦啦，我是卖报的小行家~~&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="MySQL" scheme="http://yemengying.com/categories/MySQL/"/>
    
    
      <category term="MySQL" scheme="http://yemengying.com/tags/MySQL/"/>
    
  </entry>
  
  <entry>
    <title>谈谈破窗理论</title>
    <link href="http://yemengying.com/2016/05/15/broken-window-theory/"/>
    <id>http://yemengying.com/2016/05/15/broken-window-theory/</id>
    <published>2016-05-15T06:02:14.000Z</published>
    <updated>2016-05-15T15:21:58.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;在湾区日报上看到篇关于破窗理论(Broken Window Theory)的&lt;a href=&quot;http://blog.codinghorror.com/the-broken-window-theory/?utm_source=wanqu.co&amp;amp;utm_campaign=Wanqu+Daily&amp;amp;utm_medium=ios&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;文章&lt;/a&gt;，真是颇有感触，所以决定写篇博客，结合这几个月开发代理商网站的心(keng)路(die)历程,谈谈为何不能忽视一点点糟糕的代码或者不好的设计。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;破窗理论&quot;&gt;&lt;a href=&quot;#破窗理论&quot; class=&quot;headerlink&quot; title=&quot;破窗理论&quot;&gt;&lt;/a&gt;破窗理论&lt;/h3&gt;&lt;p&gt;先简单解释下什么是“破窗理论”，“破窗理论”是指：如果有人打坏了一幢建筑物的窗户玻璃，而这扇窗户又得不到及时的维修，别人就可能受到某些暗示性的纵容去打烂更多的窗户。&lt;br&gt;&lt;img src=&quot;/images/broken-window.jpg&quot; alt=&quot;破窗理论&quot;&gt;&lt;br&gt;湾区日报上的文章中是这样描述破窗理论的：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Don’t leave “broken windows” (bad designs, wrong decisions, or poor code) unrepaired. Fix each one as soon as it is discovered. If there is insufficient time to fix it properly, then board it up. Perhaps you can comment out the offending code, or display a “Not Implemented” message, or substitute dummy data instead. Take some action to prevent further damage and to show that you’re on top of the situation.&lt;br&gt;We’ve seen clean, functional systems deteriorate pretty quickly once windows start breaking. There are other factors that can contribute to software rot, and we’ll touch on some of them elsewhere, but neglect accelerates the rot faster than any other factor.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;简单翻译一下就是：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;不要放任“破窗户”(不好的设计，错误的决定或糟糕的代码)不管。要尽量在发现时立刻修复。如果没有足够的时间进行适当的修复，就先把它保留起来。可以把出问题的代码放到注释中，或是显示“未实现”消息，也可用虚拟数据加以替代。总之，要采取一些措施，防止进一步的恶化。表明局势尚在掌控之中。有许多整洁良好的系统在出现“破窗”之后立马崩溃。虽然促使软件崩溃的原因还有其他因素（我们将在其他地方接触到），但对“破窗”置之不理，肯定会更快地加速系统崩溃。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;亲身感受&quot;&gt;&lt;a href=&quot;#亲身感受&quot; class=&quot;headerlink&quot; title=&quot;亲身感受&quot;&gt;&lt;/a&gt;亲身感受&lt;/h3&gt;&lt;p&gt;先说说背景，故事要从三个月前开始讲起了，当时刚刚转去搜索组做部门内部的搜索，组内总共3个人。本以为可以远离业务代码，专心技术，可万万没想到Elasticsearch的书还没焐热就被部门leader叫去开会，说要做一个代理商系统，很紧急，是公司P0级别的项目，全公司的资源都要给我们让路(事实证明只是画饼，因为现在连一个固定前端都没了)。其实这个项目一听就是个深坑，从头发到脚都是拒绝的。因为主数据（餐厅，活动，订单）全在别的部门，85%的功能都依赖于其他部门的接口(si不si很神奇)，所以做这个项目主要工作就是。。。。。通过SOA或者Thrift调别人的接口。不过即便知道是坑也没办法，只有搜索组刚刚成立比较闲，只能我们做-_-|||。当时部门leader的要求是封闭开发一周半，拿出个可用的版本就行，一定要快！！。所以我们搜索组的三个人加上从别的组借调的两个实习生再加上两个前端就搬去了小黑屋，开始了近两周的封闭开发。&lt;/p&gt;
&lt;p&gt;好了，背景聊完了，进入正题，聊聊代理商是怎么变得越来越难维护的。代理商的开发leader是个搜索大牛，但没做过Web开发，对Java Web开发并不是十分了解。因为部门leader要求快快快，所以将许多必要的步骤省略了。比如定义方法参数命名规范，定义api规范，代码review等等。。。每天就是划分下接口，每人开发几个接口，和前端定义接口文档，就开始开发提测了。讲真，其实所有人都是有责任的，可能是对这个项目一开始就很反感，有抵触心理，所以从内心就没打算好好做，一些觉得可以改进的地方也就得过且过了。后面的事实证明，当觉得设计或规范有不合理的时候，一定要及时提出来，不能忍，忍的后果就是一次一次降低自己的底线，然后亲手造就一个难维护的系统，到时候即便有心想重构也是心有余力不足了。&lt;/p&gt;
&lt;p&gt;公司项目就不贴实际代码了，简单举几个例子，看看开发前定义必要的规范是多么的重要。由于代理商没有事先规定api的定义要符合RESTFul的规范，所以项目中api的风格有两种，符合RESTFul的和不符合的。比如获取餐厅信息的api定义是&lt;code&gt;GET /restaurant/{id}&lt;/code&gt;，而创建餐厅的api定义是&lt;code&gt;POST /restaurant/create&lt;/code&gt;，so。。。如果后面的人想设计更新餐厅信息的api是&lt;code&gt;PUT /restaurant/{id}&lt;/code&gt;还是&lt;code&gt;PUT /restaurant/update&lt;/code&gt;呢，真是一脸懵逼。接口的命名就更是五花八门了，因为大家是来自不同组，而且也没有定义统一的命名的规范，比如：一个简单的获取信息，获取餐厅信息的接口是&lt;code&gt;getRestaurant&lt;/code&gt;,获取活动信息是&lt;code&gt;activityInfo&lt;/code&gt;,获取代理商信息接口是&lt;code&gt;getAgentDto&lt;/code&gt;，获取订单信息又变成了&lt;code&gt;getOrderData&lt;/code&gt;,so。。。谁能告诉我之后想添加个获取信息的接口到底该叫什么。。。估计只能看当时的心情随便取了。。。还有就是项目中存在大量重复代码，获取餐厅管理员信息基本上每个人都写了一遍，因为管理员的信息在获取餐厅，活动信息时都用的到，由于没有代码review，所以一开始大家也不知道，就各写各的，也是蛮醉的。&lt;/p&gt;
&lt;p&gt;上面的例子只是一点点，实际还有很多很多很多的槽点，都是泪啊。由于第一版本为了压缩工时(至今也不明白为啥要那么急。。。)就这样草草交工，导致后面的几个迭代开发也随之变得越来越随意，随意命名，随意定义api，缺乏junit测试，越来越不上心。听说代理商要移交给BD组，但估计情况也只会越来越糟，因为没人愿意去整理一坨坨糟糕的代码，只会在出现问题的时候，随意的打补丁。。。&lt;/p&gt;
&lt;h3 id=&quot;总结&quot;&gt;&lt;a href=&quot;#总结&quot; class=&quot;headerlink&quot; title=&quot;总结&quot;&gt;&lt;/a&gt;总结&lt;/h3&gt;&lt;p&gt;其实也没啥好总结的，一句话，以后一定要写干净，整洁的代码，注意规范，不能忽视一点点糟糕的代码或者设计对项目带来的负面影响。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;欢迎一起讨论~~&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;在湾区日报上看到篇关于破窗理论(Broken Window Theory)的&lt;a href=&quot;http://blog.codinghorror.com/the-broken-window-theory/?utm_source=wanqu.co&amp;amp;utm_campaign=Wanqu+Daily&amp;amp;utm_medium=ios&quot;&gt;文章&lt;/a&gt;，真是颇有感触，所以决定写篇博客，结合这几个月开发代理商网站的心(keng)路(die)历程,谈谈为何不能忽视一点点糟糕的代码或者不好的设计。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="随笔" scheme="http://yemengying.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="随笔" scheme="http://yemengying.com/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>【译】Java中的垃圾回收机制</title>
    <link href="http://yemengying.com/2016/05/13/jvm-GC/"/>
    <id>http://yemengying.com/2016/05/13/jvm-GC/</id>
    <published>2016-05-13T15:28:15.000Z</published>
    <updated>2016-05-14T08:07:49.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;感觉人生就是while(true){一个选择接着一个选择接着一个选择;},好怕自己一不小心就做了错误的决定啊😭。堵上全部人品,希望新公司技术氛围浓厚,有大牛带我,切拜🙊🙏。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;不扯有的没的了，翻译一篇关于垃圾回收(以下简称GC)机制的博客(&lt;a href=&quot;http://javarevisited.blogspot.com/2011/04/garbage-collection-in-java.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;原文地址&lt;/a&gt;)。博客内容包括：Java中GC是如何工作的，常见的GC算法(比如:标记清除)，Java中不同的垃圾收集器(比如:serial)。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;关键字约定&quot;&gt;&lt;a href=&quot;#关键字约定&quot; class=&quot;headerlink&quot; title=&quot;关键字约定&quot;&gt;&lt;/a&gt;关键字约定&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Young generation –&amp;gt;新生代&lt;/li&gt;
&lt;li&gt;Tenured / Old Generation –&amp;gt;老年代&lt;/li&gt;
&lt;li&gt;Perm Area –&amp;gt;永久代&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;重要的东东&quot;&gt;&lt;a href=&quot;#重要的东东&quot; class=&quot;headerlink&quot; title=&quot;重要的东东&quot;&gt;&lt;/a&gt;重要的东东&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;在Java中，对象实例都是在堆上创建。一些类信息，常量，静态变量等存储在方法区。堆和方法区都是线程共享的。&lt;/li&gt;
&lt;li&gt;GC机制是由JVM提供，用来清理需要清除的对象，回收堆内存。&lt;/li&gt;
&lt;li&gt;GC机制将Java程序员从内存管理中解放了出来，可以更关注于业务逻辑。&lt;/li&gt;
&lt;li&gt;在Java中，GC是由一个被称为垃圾回收器的守护进程执行的。&lt;/li&gt;
&lt;li&gt;在从内存回收一个对象之前会调用对象的finalize()方法。&lt;/li&gt;
&lt;li&gt;作为一个Java开发者不能强制JVM执行GC；GC的触发由JVM依据堆内存的大小来决定。&lt;/li&gt;
&lt;li&gt;System.gc()和Runtime.gc()会向JVM发送执行GC的请求，但是JVM不保证一定会执行GC。&lt;/li&gt;
&lt;li&gt;如果堆没有内存创建新的对象了，会抛出&lt;code&gt;OutOfMemoryError&lt;/code&gt;。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;GC针对什么对象？&quot;&gt;&lt;a href=&quot;#GC针对什么对象？&quot; class=&quot;headerlink&quot; title=&quot;GC针对什么对象？&quot;&gt;&lt;/a&gt;GC针对什么对象？&lt;/h3&gt;&lt;p&gt;了解GC机制的第一步就是理解什么样的对象会被回收。当一个对象通过一系列根对象(比如：静态属性引用的常量)都不可达时就会被回收。简而言之，当一个对象的所有引用都为null。循环依赖不算做引用，如果对象A有一个指向对象B的引用，对象B也有一个指向对象A的引用，除此之外，它们没有其他引用，那么对象A和对象B都、需要被回收(如下图,ObjA和ObjB需要被回收)。&lt;br&gt;&lt;img src=&quot;/images/GC-Object.png&quot; alt=&quot;GC回收对象&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;堆内存是如何划分的？&quot;&gt;&lt;a href=&quot;#堆内存是如何划分的？&quot; class=&quot;headerlink&quot; title=&quot;堆内存是如何划分的？&quot;&gt;&lt;/a&gt;堆内存是如何划分的？&lt;/h3&gt;&lt;p&gt;Java中对象都在堆上创建。为了GC，堆内存分为三个部分，也可以说三代，分别称为新生代，老年代和永久代。其中新生代又进一步分为Eden区，Survivor 1区和Survivor 2区(如下图)。新创建的对象会分配在Eden区,在经历一次Minor GC后会被移到Survivor 1区，再经历一次Minor GC后会被移到Survivor 2区，直到升至老年代,需要注意的是，一些大对象(长字符串或数组)可能会直接存放到老年代。&lt;br&gt;&lt;img src=&quot;/images/堆内存.png&quot; alt=&quot;堆内存&quot;&gt;&lt;br&gt;永久代有一些特殊，它用来存储类的元信息。对于GC是否发生在永久代有许多不同的看法，在我看来这取决于采用的JVM。大家可以通过创建大量的字符串来观察是发生了GC还是抛出了OutOfMemoryError。&lt;/p&gt;
&lt;h3 id=&quot;GC算法&quot;&gt;&lt;a href=&quot;#GC算法&quot; class=&quot;headerlink&quot; title=&quot;GC算法&quot;&gt;&lt;/a&gt;GC算法&lt;/h3&gt;&lt;ol&gt;
&lt;li&gt;标记清除算法&lt;br&gt;分为标记和清除两个阶段：首先标记出所有需要回收的对象，在标记完成后统一回收所有被标记的对象。该算法的缺点是效率不高并且会产生不连续的内存碎片。&lt;br&gt;&lt;img src=&quot;/images/sweep.jpg&quot; alt=&quot;image&quot;&gt;&lt;/li&gt;
&lt;li&gt;复制算法&lt;br&gt;把内存空间划为两个区域，每次只使用其中一个区域。垃圾回收时，遍历当前使用区域，把正在使用中的对象复制到另外一个区域中。次算法每次只处理正在使用中的对象，因此复制成本比较小，同时复制过去以后还能进行相应的内存整理，不会出现“碎片”问题。优点：实现简单，运行高效。缺点：会浪费一定的内存。一般新生代采用这种算法。&lt;br&gt;&lt;img src=&quot;/images/copy.jpg&quot; alt=&quot;image&quot;&gt;&lt;/li&gt;
&lt;li&gt;标记整理算法&lt;br&gt;标记阶段与标记清除算法一样。但后续并不是直接对可回收的对象进行清理，而是让所有存活对象都想一端移动，然后清理。优点是不会造成内存碎片。&lt;br&gt;&lt;img src=&quot;/images/compact.jpg&quot; alt=&quot;image&quot;&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;Java中垃圾回收器的类型&quot;&gt;&lt;a href=&quot;#Java中垃圾回收器的类型&quot; class=&quot;headerlink&quot; title=&quot;Java中垃圾回收器的类型&quot;&gt;&lt;/a&gt;Java中垃圾回收器的类型&lt;/h3&gt;&lt;p&gt;Java提供多种类型的垃圾回收器。JVM中的垃圾收集一般都采用“分代收集”，不同的堆内存区域采用不同的收集算法，主要目的就是为了增加吞吐量或降低停顿时间。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Serial收集器：新生代收集器，使用复制算法，使用一个线程进行GC，串行，其它工作线程暂停。&lt;/li&gt;
&lt;li&gt;ParNew收集器：新生代收集器，使用复制算法，Serial收集器的多线程版，用多个线程进行GC，并行，其它工作线程暂停。使用-XX:+UseParNewGC开关来控制使用ParNew+Serial Old收集器组合收集内存；使用-XX:ParallelGCThreads来设置执行内存回收的线程数。&lt;/li&gt;
&lt;li&gt;Parallel Scavenge 收集器：吞吐量优先的垃圾回收器，作用在新生代，使用复制算法，关注CPU吞吐量，即运行用户代码的时间/总时间。使用-XX:+UseParallelGC开关控制使用Parallel Scavenge+Serial Old收集器组合回收垃圾。&lt;/li&gt;
&lt;li&gt;Serial Old收集器：老年代收集器，单线程收集器，串行，使用标记整理算法，使用单线程进行GC，其它工作线程暂停。&lt;/li&gt;
&lt;li&gt;Parallel Old收集器：吞吐量优先的垃圾回收器，作用在老年代，多线程，并行，多线程机制与Parallel Scavenge差不错，使用标记整理算法，在Parallel Old执行时，仍然需要暂停其它线程。&lt;/li&gt;
&lt;li&gt;CMS（Concurrent Mark Sweep）收集器：老年代收集器，致力于获取最短回收停顿时间（即缩短垃圾回收的时间），使用标记清除算法，多线程，优点是并发收集（用户线程可以和GC线程同时工作），停顿小。使用-XX:+UseConcMarkSweepGC进行ParNew+CMS+Serial Old进行内存回收，优先使用ParNew+CMS（原因见Full GC和并发垃圾回收一节），当用户线程内存不足时，采用备用方案Serial Old收集。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;可以看&lt;a href=&quot;http://www.amazon.com/dp/0137142528/?tag=javamysqlanta-20&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Java Performance&lt;/a&gt;一书来获取更多关于GC调优的信息。&lt;/p&gt;
&lt;h3 id=&quot;与GC有关的JVM参数&quot;&gt;&lt;a href=&quot;#与GC有关的JVM参数&quot; class=&quot;headerlink&quot; title=&quot;与GC有关的JVM参数&quot;&gt;&lt;/a&gt;与GC有关的JVM参数&lt;/h3&gt;&lt;p&gt;做GC调优需要大量的实践，耐心和对项目的分析。我曾经参与过高容量，低延迟的电商系统，在开发中我们需要通过分析造成Full GC的原因来提高系统性能，在这个过程中我发现做GC的调优很大程度上依赖于对系统的分析，系统拥有怎样的对象以及他们的平均生命周期。&lt;br&gt;举个例子，如果一个应用大多是短生命周期的对象，那么应该确保Eden区足够大，这样可以减少Minor GC的次数。可以通过&lt;code&gt;-XX:NewRatio&lt;/code&gt;来控制新生代和老年代的比例，比如-XX:NewRatio=3代表新生代和老年代的比例为1：3。需要注意的是，扩大新生代的大小会减少老年代的大小，这会导致Major GC执行的更频繁，而Major GC可能会造成用户线程的停顿从而降低系统吞吐量。JVM中可以用NewSize和MaxNewSize参数来指定新生代内存最小和最大值，如果两个参数值一样，那么就相当于固定了新生代的大小。&lt;br&gt;个人建议，在做GC调优之前最好深入理解Java中GC机制，推荐阅读Sun Microsystems提供的有关GC的文档。这个&lt;a href=&quot;http://www.oracle.com/technetwork/java/gc-tuning-5-138395.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;链接&lt;/a&gt;可能会对理解GC机制提供一些帮助。下面的图列出了各个区可用的一些JVM参数。&lt;br&gt;&lt;img src=&quot;/images/jvm-parameter.png&quot; alt=&quot;jvm参数&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;Full-GC和并发垃圾回收&quot;&gt;&lt;a href=&quot;#Full-GC和并发垃圾回收&quot; class=&quot;headerlink&quot; title=&quot;Full GC和并发垃圾回收&quot;&gt;&lt;/a&gt;Full GC和并发垃圾回收&lt;/h3&gt;&lt;p&gt;并发垃圾回收器的内存回收过程是与用户线程一起并发执行的。通常情况下，并发垃圾回收器可以在用户线程运行的情况下完成大部分的回收工作，所以应用停顿时间很短。&lt;br&gt;但由于并发垃圾回收时用户线程还在运行，所以会有新的垃圾不断产生。作为担保，如果在老年代内存都被占用之前，如果并发垃圾回收器还没结束工作，那么应用会暂停，在所有用户线程停止的情况下完成回收。这种情况称作Full GC，这意味着需要调整有关并发回收的参数了。&lt;br&gt;由于Full GC很影响应用的性能，要尽量避免或减少。特别是如果对于高容量低延迟的电商系统，要尽量避免在交易时间段发生Full GC。&lt;/p&gt;
&lt;h3 id=&quot;总结&quot;&gt;&lt;a href=&quot;#总结&quot; class=&quot;headerlink&quot; title=&quot;总结&quot;&gt;&lt;/a&gt;总结&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;为了分代垃圾回收，Java堆内存分为3代：新生代，老年代和永久代。&lt;/li&gt;
&lt;li&gt;新的对象实例会优先分配在新生代，在经历几次Minor GC后(默认15次)，还存活的会被移至老年代(某些大对象会直接在老年代分配)。&lt;/li&gt;
&lt;li&gt;永久代是否执行GC，取决于采用的JVM。&lt;/li&gt;
&lt;li&gt;Minor GC发生在新生代，当Eden区没有足够空间时，会发起一次Minor GC，将Eden区中的存活对象移至Survivor区。Major GC发生在老年代，当升到老年代的对象大于老年代剩余空间时会发生Major GC。&lt;/li&gt;
&lt;li&gt;发生Major GC时用户线程会暂停，会降低系统性能和吞吐量。&lt;/li&gt;
&lt;li&gt;JVM的参数-Xmx和-Xms用来设置Java堆内存的初始大小和最大值。依据个人经验这个值的比例最好是1:1或者1:1.5。比如，你可以将-Xmx和-Xms都设为1GB，或者-Xmx和-Xms设为1.2GB和1.8GB。&lt;/li&gt;
&lt;li&gt;Java中不能手动触发GC，但可以用不同的引用类来辅助垃圾回收器工作(比如：&lt;a href=&quot;http://javarevisited.blogspot.com/2014/03/difference-between-weakreference-vs-softreference-phantom-strong-reference-java.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;弱引用或软引用&lt;/a&gt;)。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以上就是关于Java中GC的一些内容。通过这篇博客，我们可以知道堆内存是如何划分的；一个对象在没有任何强引用指向他或该对象通过根节点不可达时需要被垃圾回收器回收；当垃圾收集器意识到需要进行GC时会触发Minor GC或Major GC，是自动的，无法强制执行。&lt;/p&gt;
&lt;h3 id=&quot;参考文档-康桑阿米达&quot;&gt;&lt;a href=&quot;#参考文档-康桑阿米达&quot; class=&quot;headerlink&quot; title=&quot;参考文档(康桑阿米达~)&quot;&gt;&lt;/a&gt;参考文档(康桑阿米达~)&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://icyfenix.iteye.com/blog/715301&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://icyfenix.iteye.com/blog/715301&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.cnblogs.com/zhguang/p/3257367.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.cnblogs.com/zhguang/p/3257367.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.amazon.cn/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA-JVM%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-%E5%91%A8%E5%BF%97%E6%98%8E/dp/B00D2ID4PK/ref=sr_1_1?ie=UTF8&amp;amp;qid=1463192894&amp;amp;sr=8-1&amp;amp;keywords=%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3java%E8%99%9A%E6%8B%9F%E6%9C%BA&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;《深入理解java虚拟机》&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;————————————————其实我只是一条分割线———————————————————&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;关于永久代到底有没有GC还是很懵逼，很多地方看到的说法都不一致。欢迎指正错误，欢迎一起讨论~~&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;按国际惯例，wuli光洙结尾~~&lt;br&gt;&lt;img src=&quot;/images/liguangzhu4.jpg&quot; alt=&quot;李光洙&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;感觉人生就是while(true){一个选择接着一个选择接着一个选择;},好怕自己一不小心就做了错误的决定啊😭。堵上全部人品,希望新公司技术氛围浓厚,有大牛带我,切拜🙊🙏。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;不扯有的没的了，翻译一篇关于垃圾回收(以下简称GC)机制的博客(&lt;a href=&quot;http://javarevisited.blogspot.com/2011/04/garbage-collection-in-java.html&quot;&gt;原文地址&lt;/a&gt;)。博客内容包括：Java中GC是如何工作的，常见的GC算法(比如:标记清除)，Java中不同的垃圾收集器(比如:serial)。&lt;br&gt;
    
    </summary>
    
      <category term="java" scheme="http://yemengying.com/categories/java/"/>
    
    
      <category term="java" scheme="http://yemengying.com/tags/java/"/>
    
      <category term="jvm" scheme="http://yemengying.com/tags/jvm/"/>
    
  </entry>
  
  <entry>
    <title>如何线程安全的使用HashMap</title>
    <link href="http://yemengying.com/2016/05/07/threadsafe-hashmap/"/>
    <id>http://yemengying.com/2016/05/07/threadsafe-hashmap/</id>
    <published>2016-05-07T09:21:06.000Z</published>
    <updated>2016-05-09T13:32:54.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;这周真是发生了不少事，脑袋和心里一直都很乱，周二参加了一场面试，经历了笔试+3轮面试，周五正式提交了离职申请。要开始新的征程了，意外的有些失落和不舍，毕竟是毕业后的第一份工作，毕竟在这认识了一群可爱的人，毕竟在这学到了很多东西,毕竟这有8000+的aeron chair!!!。可既然已经做了选择就没有退路了，勇敢往下走吧，希望接下来的三周可以把手头上的工作做好交接善始善终，也希望以后不会后悔今天的选择。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;img src=&quot;/images/fighting.jpg&quot; alt=&quot;fighting！！！&quot;&gt;    &lt;/p&gt;
&lt;p&gt;进入正题，在周二面试时，一面的面试官有问到HashMap是否是线程安全的，如何在线程安全的前提下使用HashMap,其实也就是&lt;code&gt;HashMap&lt;/code&gt;，&lt;code&gt;Hashtable&lt;/code&gt;，&lt;code&gt;ConcurrentHashMap&lt;/code&gt;和&lt;code&gt;synchronized Map&lt;/code&gt;的原理和区别。当时有些紧张只是简单说了下HashMap不是线程安全的；Hashtable线程安全，但效率低，因为是Hashtable是使用synchronized的，所有线程竞争同一把锁；而ConcurrentHashMap不仅线程安全而且效率高，因为它包含一个segment数组，将数据分段存储，给每一段数据配一把锁，也就是所谓的锁分段技术。当时忘记了synchronized Map和解释一下HashMap为什么线程不安全。面试结束后问了下面试官哪里有些不足，面试官说上面这个问题的回答算过关，但可以在深入一些或者自己动手尝试一下。so~~~虽然拿到了offer，但还是再整理一下，不能得过且过啊。&lt;/p&gt;
&lt;h3 id=&quot;为什么HashMap是线程不安全的&quot;&gt;&lt;a href=&quot;#为什么HashMap是线程不安全的&quot; class=&quot;headerlink&quot; title=&quot;为什么HashMap是线程不安全的&quot;&gt;&lt;/a&gt;为什么HashMap是线程不安全的&lt;/h3&gt;&lt;p&gt;总说HashMap是线程不安全的，不安全的，不安全的，那么到底为什么它是线程不安全的呢？要回答这个问题就要先来简单了解一下HashMap源码中的使用的&lt;code&gt;存储结构&lt;/code&gt;(这里引用的是Java 8的源码，与7是不一样的)和它的&lt;code&gt;扩容机制&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id=&quot;HashMap的内部存储结构&quot;&gt;&lt;a href=&quot;#HashMap的内部存储结构&quot; class=&quot;headerlink&quot; title=&quot;HashMap的内部存储结构&quot;&gt;&lt;/a&gt;HashMap的内部存储结构&lt;/h4&gt;&lt;p&gt;下面是HashMap使用的存储结构:&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;transient&lt;/span&gt; Node&amp;lt;K,V&amp;gt;[] table;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Node&lt;/span&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;K&lt;/span&gt;,&lt;span class=&quot;title&quot;&gt;V&lt;/span&gt;&amp;gt; &lt;span class=&quot;keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Map&lt;/span&gt;.&lt;span class=&quot;title&quot;&gt;Entry&lt;/span&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;K&lt;/span&gt;,&lt;span class=&quot;title&quot;&gt;V&lt;/span&gt;&amp;gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; hash;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; K key;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        V value;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        Node&amp;lt;K,V&amp;gt; next;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;可以看到HashMap内部存储使用了一个Node数组(默认大小是16)，而Node类包含一个类型为Node的next的变量，也就是相当于一个链表，所有hash值相同(即产生了冲突)的key会存储到同一个链表里，大概就是下面图的样子(顺便推荐个在线画图的网站&lt;a href=&quot;http://creately.com/Draw-UML-and-Class-Diagrams-Online&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Creately&lt;/a&gt;)。&lt;br&gt;&lt;img src=&quot;/images/node1.png&quot; alt=&quot;HashMap内部存储结果&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;需要注意的是，在Java 8中如果hash值相同的key数量大于指定值(默认是8)时使用平衡树来代替链表，这会将get()方法的性能从O(n)提高到O(logn)。具体的可以看我的另一篇博客&lt;a href=&quot;http://yemengying.com/2016/02/03/%E8%AF%91-Java%E4%B8%ADHashMap%E5%92%8CLinkedHashMap%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%86%B2%E7%AA%81/&quot;&gt;Java 8中HashMap和LinkedHashMap如何解决冲突&lt;/a&gt;。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;HashMap的自动扩容机制&quot;&gt;&lt;a href=&quot;#HashMap的自动扩容机制&quot; class=&quot;headerlink&quot; title=&quot;HashMap的自动扩容机制&quot;&gt;&lt;/a&gt;HashMap的自动扩容机制&lt;/h4&gt;&lt;p&gt;HashMap内部的Node数组默认的大小是16，假设有100万个元素，那么最好的情况下每个hash桶里都有62500个元素😱，这时get(),put(),remove()等方法效率都会降低。为了解决这个问题，HashMap提供了自动扩容机制，当元素个数达到数组大小&lt;em&gt;loadFactor后会扩大数组的大小，在默认情况下，数组大小为16，loadFactor为0.75，也就是说当HashMap中的元素超过16\&lt;/em&gt;0.75=12时，会把数组大小扩展为2*16=32，并且重新计算每个元素在新数组中的位置。如下图所示(&lt;a href=&quot;http://coding-geek.com/how-does-a-hashmap-work-in-java/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;图片来源&lt;/a&gt;，权侵删)。&lt;br&gt;&lt;img src=&quot;/images/resizing_of_java_hashmap.jpg&quot; alt=&quot;自动扩容&quot;&gt;&lt;br&gt;从图中可以看到没扩容前，获取EntryE需要遍历5个元素，扩容之后只需要2次。&lt;/p&gt;
&lt;h4 id=&quot;为什么线程不安全&quot;&gt;&lt;a href=&quot;#为什么线程不安全&quot; class=&quot;headerlink&quot; title=&quot;为什么线程不安全&quot;&gt;&lt;/a&gt;为什么线程不安全&lt;/h4&gt;&lt;p&gt;个人觉得HashMap在并发时可能出现的问题主要是两方面,首先如果多个线程同时使用put方法添加元素，而且假设正好存在两个put的key发生了碰撞(hash值一样)，那么根据HashMap的实现，这两个key会添加到数组的同一个位置，这样最终就会发生其中一个线程的put的数据被覆盖。第二就是如果多个线程同时检测到元素个数超过数组大小*loadFactor，这样就会发生多个线程同时对Node数组进行扩容，都在重新计算元素位置以及复制数据，但是最终只有一个线程扩容后的数组会赋给table，也就是说其他线程的都会丢失，并且各自线程put的数据也丢失。&lt;br&gt;关于HashMap线程不安全这一点，《Java并发编程的艺术》一书中是这样说的：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;HashMap在并发执行put操作时会引起死循环，导致CPU利用率接近100%。因为多线程会导致HashMap的Node链表形成环形数据结构，一旦形成环形数据结构，Node的next节点永远不为空，就会在获取Node时产生死循环。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;哇塞，听上去si不si好神奇，居然会产生死循环。。。。google了一下，才知道死循环并不是发生在put操作时，而是发生在扩容时。详细的解释可以看下面几篇博客：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://coolshell.cn/articles/9606.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;酷壳-Java HashMap的死循环&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://firezhfox.iteye.com/blog/2241043&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HashMap在java并发中如何发生死循环&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://coding-geek.com/how-does-a-hashmap-work-in-java/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;How does a HashMap work in JAVA&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;如何线程安全的使用HashMap&quot;&gt;&lt;a href=&quot;#如何线程安全的使用HashMap&quot; class=&quot;headerlink&quot; title=&quot;如何线程安全的使用HashMap&quot;&gt;&lt;/a&gt;如何线程安全的使用HashMap&lt;/h3&gt;&lt;p&gt;了解了HashMap为什么线程不安全，那现在看看如何线程安全的使用HashMap。这个无非就是以下三种方式：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Hashtable&lt;/li&gt;
&lt;li&gt;ConcurrentHashMap&lt;/li&gt;
&lt;li&gt;Synchronized Map&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;例子：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//Hashtable&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Map&amp;lt;String, String&amp;gt; hashtable = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Hashtable&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//synchronizedMap&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Map&amp;lt;String, String&amp;gt; synchronizedHashMap = Collections.synchronizedMap(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;String, String&amp;gt;());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//ConcurrentHashMap&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Map&amp;lt;String, String&amp;gt; concurrentHashMap = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;依次来看看。&lt;/p&gt;
&lt;h4 id=&quot;Hashtable&quot;&gt;&lt;a href=&quot;#Hashtable&quot; class=&quot;headerlink&quot; title=&quot;Hashtable&quot;&gt;&lt;/a&gt;Hashtable&lt;/h4&gt;&lt;p&gt;先稍微吐槽一下，为啥命名不是HashTable啊，看着好难受😖，不管了就装作它叫HashTable吧。这货已经不常用了，就简单说说吧。HashTable源码中是使用&lt;code&gt;synchronized&lt;/code&gt;来保证线程安全的，比如下面的get方法和put方法：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;synchronized&lt;/span&gt; V &lt;span class=&quot;title&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Object key)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;comment&quot;&gt;// 省略实现&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;synchronized&lt;/span&gt; V &lt;span class=&quot;title&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(K key, V value)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;comment&quot;&gt;// 省略实现&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;所以当一个线程访问HashTable的同步方法时，其他线程如果也要访问同步方法，会被阻塞住。举个例子，当一个线程使用put方法时，另一个线程不但不可以使用put方法，连get方法都不可以，好霸道啊！！！so~~，效率很低，现在基本不会选择它了。&lt;/p&gt;
&lt;h4 id=&quot;ConcurrentHashMap&quot;&gt;&lt;a href=&quot;#ConcurrentHashMap&quot; class=&quot;headerlink&quot; title=&quot;ConcurrentHashMap&quot;&gt;&lt;/a&gt;ConcurrentHashMap&lt;/h4&gt;&lt;p&gt;ConcurrentHashMap(以下简称CHM)是JUC包中的一个类，Spring的源码中有很多使用CHM的地方。之前已经翻译过一篇关于ConcurrentHashMap的博客，&lt;a href=&quot;http://yemengying.com/2015/11/06/%E3%80%90%E8%AF%91%E3%80%91%E5%A6%82%E4%BD%95%E5%9C%A8java%E4%B8%AD%E4%BD%BF%E7%94%A8ConcurrentHashMap/&quot;&gt;如何在java中使用ConcurrentHashMap&lt;/a&gt;，里面介绍了CHM在Java中的实现，CHM的一些重要特性和什么情况下应该使用CHM。需要注意的是，上面博客是基于Java 7的，和8有区别,在8中CHM摒弃了Segment（锁段）的概念，而是启用了一种全新的方式实现,利用CAS算法，有时间会重新总结一下。&lt;/p&gt;
&lt;h4 id=&quot;SynchronizedMap&quot;&gt;&lt;a href=&quot;#SynchronizedMap&quot; class=&quot;headerlink&quot; title=&quot;SynchronizedMap&quot;&gt;&lt;/a&gt;SynchronizedMap&lt;/h4&gt;&lt;p&gt;看了一下源码，SynchronizedMap的实现还是很简单的。&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// synchronizedMap方法&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &amp;lt;K,V&amp;gt; &lt;span class=&quot;function&quot;&gt;Map&amp;lt;K,V&amp;gt; &lt;span class=&quot;title&quot;&gt;synchronizedMap&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Map&amp;lt;K,V&amp;gt; m)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; SynchronizedMap&amp;lt;&amp;gt;(m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;// SynchronizedMap类&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;SynchronizedMap&lt;/span&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;K&lt;/span&gt;,&lt;span class=&quot;title&quot;&gt;V&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Map&lt;/span&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;K&lt;/span&gt;,&lt;span class=&quot;title&quot;&gt;V&lt;/span&gt;&amp;gt;, &lt;span class=&quot;title&quot;&gt;Serializable&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; serialVersionUID = &lt;span class=&quot;number&quot;&gt;1978198479659022715L&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;K,V&amp;gt; m;     &lt;span class=&quot;comment&quot;&gt;// Backing Map&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; Object      mutex;        &lt;span class=&quot;comment&quot;&gt;// Object on which to synchronize&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       SynchronizedMap(Map&amp;lt;K,V&amp;gt; m) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.m = Objects.requireNonNull(m);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           mutex = &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       SynchronizedMap(Map&amp;lt;K,V&amp;gt; m, Object mutex) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.m = m;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;keyword&quot;&gt;this&lt;/span&gt;.mutex = mutex;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;keyword&quot;&gt;synchronized&lt;/span&gt; (mutex) &amp;#123;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; m.size();&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;isEmpty&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;keyword&quot;&gt;synchronized&lt;/span&gt; (mutex) &amp;#123;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; m.isEmpty();&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;containsKey&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Object key)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;keyword&quot;&gt;synchronized&lt;/span&gt; (mutex) &amp;#123;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; m.containsKey(key);&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;containsValue&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Object value)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;keyword&quot;&gt;synchronized&lt;/span&gt; (mutex) &amp;#123;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; m.containsValue(value);&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; V &lt;span class=&quot;title&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Object key)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;keyword&quot;&gt;synchronized&lt;/span&gt; (mutex) &amp;#123;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; m.get(key);&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; V &lt;span class=&quot;title&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(K key, V value)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;keyword&quot;&gt;synchronized&lt;/span&gt; (mutex) &amp;#123;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; m.put(key, value);&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; V &lt;span class=&quot;title&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Object key)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;           &lt;span class=&quot;keyword&quot;&gt;synchronized&lt;/span&gt; (mutex) &amp;#123;&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; m.remove(key);&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       &lt;span class=&quot;comment&quot;&gt;// 省略其他方法&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;从源码中可以看出调用synchronizedMap()方法后会返回一个SynchronizedMap类的对象，而在SynchronizedMap类中使用了synchronized同步关键字来保证对Map的操作是线程安全的。&lt;/p&gt;
&lt;h4 id=&quot;性能对比&quot;&gt;&lt;a href=&quot;#性能对比&quot; class=&quot;headerlink&quot; title=&quot;性能对比&quot;&gt;&lt;/a&gt;性能对比&lt;/h4&gt;&lt;p&gt;这是要靠数据说话的时代，所以不能只靠嘴说CHM快，它就快了。写个测试用例，实际的比较一下这三种方式的效率(&lt;a href=&quot;http://crunchify.com/hashmap-vs-concurrenthashmap-vs-synchronizedmap-how-a-hashmap-can-be-synchronized-in-java/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;源码来源&lt;/a&gt;)，下面的代码分别通过三种方式创建Map对象，使用&lt;code&gt;ExecutorService&lt;/code&gt;来并发运行5个线程，每个线程添加/获取500K个元素。&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;66&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;CrunchifyConcurrentHashMapVsSynchronizedMap&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; THREAD_POOL_SIZE = &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; Map&amp;lt;String, Integer&amp;gt; crunchifyHashTableObject = &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; Map&amp;lt;String, Integer&amp;gt; crunchifySynchronizedMapObject = &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; Map&amp;lt;String, Integer&amp;gt; crunchifyConcurrentHashMapObject = &lt;span class=&quot;keyword&quot;&gt;null&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(String[] args)&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;throws&lt;/span&gt; InterruptedException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// Test with Hashtable Object&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        crunchifyHashTableObject = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Hashtable&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        crunchifyPerformTest(crunchifyHashTableObject);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// Test with synchronizedMap Object&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        crunchifySynchronizedMapObject = Collections.synchronizedMap(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;String, Integer&amp;gt;());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        crunchifyPerformTest(crunchifySynchronizedMapObject);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;comment&quot;&gt;// Test with ConcurrentHashMap Object&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        crunchifyConcurrentHashMapObject = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ConcurrentHashMap&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        crunchifyPerformTest(crunchifyConcurrentHashMapObject);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;crunchifyPerformTest&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(&lt;span class=&quot;keyword&quot;&gt;final&lt;/span&gt; Map&amp;lt;String, Integer&amp;gt; crunchifyThreads)&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;throws&lt;/span&gt; InterruptedException &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        System.out.println(&lt;span class=&quot;string&quot;&gt;&quot;Test started for: &quot;&lt;/span&gt; + crunchifyThreads.getClass());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; averageTime = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; startTime = System.nanoTime();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            ExecutorService crunchifyExServer = Executors.newFixedThreadPool(THREAD_POOL_SIZE);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; j = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; j &amp;lt; THREAD_POOL_SIZE; j++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                crunchifyExServer.execute(&lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; Runnable() &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;meta&quot;&gt;@SuppressWarnings&lt;/span&gt;(&lt;span class=&quot;string&quot;&gt;&quot;unused&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;meta&quot;&gt;@Override&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;number&quot;&gt;500000&lt;/span&gt;; i++) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            Integer crunchifyRandomNumber = (&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt;) Math.ceil(Math.random() * &lt;span class=&quot;number&quot;&gt;550000&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            &lt;span class=&quot;comment&quot;&gt;// Retrieve value. We are not using it anywhere&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            Integer crunchifyValue = crunchifyThreads.get(String.valueOf(crunchifyRandomNumber));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            &lt;span class=&quot;comment&quot;&gt;// Put value&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                            crunchifyThreads.put(String.valueOf(crunchifyRandomNumber), crunchifyRandomNumber);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// Make sure executor stops&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            crunchifyExServer.shutdown();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;// Blocks until all tasks have completed execution after a shutdown request&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            crunchifyExServer.awaitTermination(Long.MAX_VALUE, TimeUnit.DAYS);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; entTime = System.nanoTime();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;long&lt;/span&gt; totalTime = (entTime - startTime) / &lt;span class=&quot;number&quot;&gt;1000000L&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            averageTime += totalTime;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            System.out.println(&lt;span class=&quot;string&quot;&gt;&quot;2500K entried added/retrieved in &quot;&lt;/span&gt; + totalTime + &lt;span class=&quot;string&quot;&gt;&quot; ms&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        System.out.println(&lt;span class=&quot;string&quot;&gt;&quot;For &quot;&lt;/span&gt; + crunchifyThreads.getClass() + &lt;span class=&quot;string&quot;&gt;&quot; the average time is &quot;&lt;/span&gt; + averageTime / &lt;span class=&quot;number&quot;&gt;5&lt;/span&gt; + &lt;span class=&quot;string&quot;&gt;&quot; ms\n&quot;&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;测试结果：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;Test started &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;: class java.util.Hashtable&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 2018 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 1746 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 1806 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 1801 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 1804 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;For class java.util.Hashtable the average time is 1835 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Test started &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;: class java.util.Collections&lt;span class=&quot;variable&quot;&gt;$SynchronizedMap&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 3041 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 1690 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 1740 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 1649 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 1696 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;For class java.util.Collections&lt;span class=&quot;variable&quot;&gt;$SynchronizedMap&lt;/span&gt; the average time is 1963 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;Test started &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;: class java.util.concurrent.ConcurrentHashMap&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 738 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 696 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 548 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 1447 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2500K entried added/retrieved &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; 531 ms&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;For class java.util.concurrent.ConcurrentHashMap the average time is 792 ms&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这个就不用废话了，CHM性能是明显优于Hashtable和SynchronizedMap的,CHM花费的时间比前两个的一半还少，哈哈，以后再有人问就可以甩数据了。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;欢迎指正错误，欢迎一起讨论。另外，针对提离职当天发生的一个小插曲，真真是给我上了一课，不是所有人都能接受实话的，只想引用欢乐颂里安迪的一句话:常与同好争高下,不与傻瓜论短长。&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;这周真是发生了不少事，脑袋和心里一直都很乱，周二参加了一场面试，经历了笔试+3轮面试，周五正式提交了离职申请。要开始新的征程了，意外的有些失落和不舍，毕竟是毕业后的第一份工作，毕竟在这认识了一群可爱的人，毕竟在这学到了很多东西,毕竟这有8000+的aeron chair!!!。可既然已经做了选择就没有退路了，勇敢往下走吧，希望接下来的三周可以把手头上的工作做好交接善始善终，也希望以后不会后悔今天的选择。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="java" scheme="http://yemengying.com/categories/java/"/>
    
      <category term="hashmap" scheme="http://yemengying.com/categories/java/hashmap/"/>
    
    
      <category term="java" scheme="http://yemengying.com/tags/java/"/>
    
      <category term="hashMap" scheme="http://yemengying.com/tags/hashMap/"/>
    
  </entry>
  
  <entry>
    <title>觉得还不错的网站</title>
    <link href="http://yemengying.com/2016/04/24/good-website/"/>
    <id>http://yemengying.com/2016/04/24/good-website/</id>
    <published>2016-04-24T13:35:44.000Z</published>
    <updated>2016-05-09T12:49:09.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;整理下收藏夹中觉得还不错的网站或资料，不涉及订阅的博客，主要是因为一开始收藏夹并没有分类所以就乱了，不方便找😂，嫑吐槽我。。。。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;镇楼&quot;&gt;&lt;a href=&quot;#镇楼&quot; class=&quot;headerlink&quot; title=&quot;镇楼&quot;&gt;&lt;/a&gt;镇楼&lt;/h3&gt;&lt;p&gt;1.&lt;a href=&quot;https://www.google.com&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://www.google.com&lt;/a&gt;&lt;br&gt;2.&lt;a href=&quot;http://stackoverflow.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://stackoverflow.com/&lt;/a&gt;&lt;br&gt;3.&lt;a href=&quot;https://github.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/&lt;/a&gt;&lt;br&gt;这三个大家都懂。。把它们放上来的主要目的是。。。撑场子。。。&lt;br&gt;&lt;img src=&quot;/images/liguangzhu3.jpg&quot; alt=&quot;哈哈哈&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;Redis相关&quot;&gt;&lt;a href=&quot;#Redis相关&quot; class=&quot;headerlink&quot; title=&quot;Redis相关&quot;&gt;&lt;/a&gt;Redis相关&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;官网&lt;br&gt;1.&lt;a href=&quot;http://redis.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://redis.io/&lt;/a&gt;(英文版)&lt;br&gt;2.&lt;a href=&quot;http://www.redis.cn/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.redis.cn/&lt;/a&gt;(中文版)    &lt;/li&gt;
&lt;li&gt;其它网站&lt;br&gt;1.&lt;a href=&quot;http://try.redis.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://try.redis.io/&lt;/a&gt;(可以在线练习redis常用命令)&lt;br&gt;2.&lt;a href=&quot;http://redisdoc.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://redisdoc.com/&lt;/a&gt;(查找redis命令的详细信息 包括查看命令的返回值和时间复杂度)&lt;/li&gt;
&lt;li&gt;一本短小精悍的电子书&lt;br&gt;1.&lt;a href=&quot;https://github.com/karlseguin/the-little-redis-book&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/karlseguin/the-little-redis-book&lt;/a&gt;(英文原版)&lt;br&gt;2.&lt;a href=&quot;https://github.com/JasonLai256/the-little-redis-book/blob/master/cn/redis.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/JasonLai256/the-little-redis-book/blob/master/cn/redis.md&lt;/a&gt;(中文译版)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;算法和数据结构相关&quot;&gt;&lt;a href=&quot;#算法和数据结构相关&quot; class=&quot;headerlink&quot; title=&quot;算法和数据结构相关&quot;&gt;&lt;/a&gt;算法和数据结构相关&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;公开课&lt;br&gt;&lt;a href=&quot;http://open.163.com/special/opencourse/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://open.163.com/special/opencourse/&lt;/a&gt;(网易公开课上的麻省理工算法导论课程)&lt;/li&gt;
&lt;li&gt;做题&lt;br&gt;&lt;a href=&quot;https://leetcode.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://leetcode.com/&lt;/a&gt;(leetcode,类似网站有好几个，有选择恐惧症就放一个吧）&lt;/li&gt;
&lt;li&gt;其它网站&lt;br&gt;&lt;a href=&quot;http://algorithms.tutorialhorizon.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://algorithms.tutorialhorizon.com/&lt;/a&gt;(最近特别爱的一个网站，讲解各种算法的，有图解，有code，简直不能更赞，只能意会不可言传，点进去看看吧)&lt;br&gt;&lt;a href=&quot;http://visualgo.net/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://visualgo.net/&lt;/a&gt; （一个通过动图帮助理解数据结构的网站 比较适合初学者 英文版）&lt;br&gt;&lt;a href=&quot;http://zh.visualgo.net/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://zh.visualgo.net/&lt;/a&gt;（上面网站的中文版）&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;什么都能学&quot;&gt;&lt;a href=&quot;#什么都能学&quot; class=&quot;headerlink&quot; title=&quot;什么都能学&quot;&gt;&lt;/a&gt;什么都能学&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;教程网站&lt;br&gt;1.&lt;a href=&quot;http://tutorials.jenkov.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://tutorials.jenkov.com/&lt;/a&gt;(关于Java，Web ，Mobile and so on)&lt;br&gt;2.&lt;a href=&quot;http://www.sitepoint.com&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.sitepoint.com&lt;/a&gt;(感觉是个不错的网站，不过关于Java的内容不太多，所以也没常看)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;不知道怎么分类&quot;&gt;&lt;a href=&quot;#不知道怎么分类&quot; class=&quot;headerlink&quot; title=&quot;不知道怎么分类&quot;&gt;&lt;/a&gt;不知道怎么分类&lt;/h3&gt;&lt;p&gt;1.&lt;a href=&quot;http://overapi.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://overapi.com/&lt;/a&gt;(网站收集了很多很有用的手册，开发时可以节省很多时间)&lt;br&gt;2.&lt;a href=&quot;https://www.reddit.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://www.reddit.com/&lt;/a&gt;(信息量比较大的网站，比较喜欢去上面看些搞笑的图片)&lt;br&gt;3.&lt;a href=&quot;https://news.ycombinator.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://news.ycombinator.com/&lt;/a&gt;(不是很喜欢它的页面。。。)&lt;br&gt;4.&lt;a href=&quot;https://www.v2ex.com/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://www.v2ex.com/&lt;/a&gt;（可以上去找工作 哈哈）&lt;br&gt;5.&lt;a href=&quot;https://wanqu.co/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://wanqu.co/&lt;/a&gt;(湾区日报 每天推送5篇优质英文文章)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;突然发现目前最幸福的事就是在重看以前的Running Man时，发现有一集没看过😜。。不写了 去看wuli光洙了😍&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;整理下收藏夹中觉得还不错的网站或资料，不涉及订阅的博客，主要是因为一开始收藏夹并没有分类所以就乱了，不方便找😂，嫑吐槽我。。。。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="随笔" scheme="http://yemengying.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="随笔" scheme="http://yemengying.com/tags/%E9%9A%8F%E7%AC%94/"/>
    
  </entry>
  
  <entry>
    <title>Redis相关---Redis持久化(AOF&amp;Snapshot)</title>
    <link href="http://yemengying.com/2016/04/24/Redis-Persistence/"/>
    <id>http://yemengying.com/2016/04/24/Redis-Persistence/</id>
    <published>2016-04-24T07:09:18.000Z</published>
    <updated>2016-05-09T12:49:33.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;恩，先说点题外话。上周被小虐了一丢丢,但有很大收获,了解了自己的不足,知道了自己还在哪些方面有欠缺。更坚定了一直以来的想法,应届生或者工作时间不长的人找工作公司规模，福利薪资都是浮云，跟对人才是最重要的,非常及其以及特别的重要,一个人好技术牛的部门leader绝对抵得上5K的薪资。这也完美解释了为何部门拆分,老大和磊哥走了之后这么不舒服,这尼玛相当于给我减了5K的工资啊,扯远了。。。。还是来看Redis吧，整理下Redis持久化的相关内容，加深下印象。不想看文字的可直接看下面的图😂。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;&lt;img src=&quot;/images/persistent.png&quot; alt=&quot;概要&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;AOF持久化&quot;&gt;&lt;a href=&quot;#AOF持久化&quot; class=&quot;headerlink&quot; title=&quot;AOF持久化&quot;&gt;&lt;/a&gt;AOF持久化&lt;/h3&gt;&lt;p&gt;AOF(append-only file只追加文件)持久化会将执行的写命令追加到AOF文件的末尾。在恢复数据时，只要从头到尾的执行AOF文件中包含的所有写命令即可&lt;/p&gt;
&lt;h4 id=&quot;AOF可用配置&quot;&gt;&lt;a href=&quot;#AOF可用配置&quot; class=&quot;headerlink&quot; title=&quot;AOF可用配置&quot;&gt;&lt;/a&gt;AOF可用配置&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;配置项&lt;/th&gt;
&lt;th&gt;含义&lt;/th&gt;
&lt;th&gt;可选值 &lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;appendonly&lt;/td&gt;
&lt;td&gt;是否开启AOF持久化&lt;/td&gt;
&lt;td&gt;no,yes &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;appendfsync&lt;/td&gt;
&lt;td&gt;将写命令同步到硬盘的间隔&lt;/td&gt;
&lt;td&gt;everysec,always,no&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;no-appendfsync-on-rewrite&lt;/td&gt;
&lt;td&gt;对文件进行压缩时能否执行同步操作&lt;/td&gt;
&lt;td&gt;no,yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;auto-aof-rewrite-percentage&lt;/td&gt;
&lt;td&gt;当前文件大小是上一次压缩后AOF文件大小的多少时执行自动压缩&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;auto-aof-rewrite-min-size&lt;/td&gt;
&lt;td&gt;当前文件大小是多少时执行自动压缩&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;dir path/to/appendonly.aof&lt;/td&gt;
&lt;td&gt;文件存放位置&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;其实主要的就是appendfsync配置项，有三个可选值，&lt;code&gt;always&lt;/code&gt;(每次执行写操作都要同步写入硬盘),&lt;code&gt;everysec&lt;/code&gt;(每秒执行一次同步),&lt;code&gt;no&lt;/code&gt;(让系统决定何时执行同步)。虽然选择&lt;code&gt;always&lt;/code&gt;可将数据丢失减少到最少，但这种策略会对硬盘进行大量的写入操作，处理命令速度受到硬盘限制。建议选择&lt;code&gt;everysec&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id=&quot;AOF优缺点&quot;&gt;&lt;a href=&quot;#AOF优缺点&quot; class=&quot;headerlink&quot; title=&quot;AOF优缺点&quot;&gt;&lt;/a&gt;AOF优缺点&lt;/h4&gt;&lt;p&gt;优点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;比快照方式可靠，默认每秒同步一次，意味着最多丢失一秒的数据&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;缺点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;相同数据集大小，AOF文件会比快照文件大&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;AOF文件格式&quot;&gt;&lt;a href=&quot;#AOF文件格式&quot; class=&quot;headerlink&quot; title=&quot;AOF文件格式&quot;&gt;&lt;/a&gt;AOF文件格式&lt;/h4&gt;&lt;p&gt;一开始以为Redis就是将写命令原封不动的存储到AOF文件中，自己试了一下才知道，AOF文件是使用Redis网络通讯协议的格式来保存这些命令。&lt;br&gt;举个🌰：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;127.0.0.1:6379&amp;gt; &lt;span class=&quot;built_in&quot;&gt;set&lt;/span&gt; number 21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;OK&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;将上面的命令存储到AOF文件就是下面的样子（select 0命令是代表选择id为0的数据库）：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;*2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$6&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;SELECT&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;0&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;*3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;SET&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$6&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;number&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;variable&quot;&gt;$2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;来看下AOF文件的格式，了解它的格式可以让我们很容易的解析它，指不定哪天能用到啊🌝。*号代表命令参数的个数(在上面的例子中参数为set、number、21,共3个)，$号代表第N个参数的长度，在上面的例子中，三个参数的长度分别为3，6，2。&lt;/p&gt;
&lt;h4 id=&quot;压缩AOF文件&quot;&gt;&lt;a href=&quot;#压缩AOF文件&quot; class=&quot;headerlink&quot; title=&quot;压缩AOF文件&quot;&gt;&lt;/a&gt;压缩AOF文件&lt;/h4&gt;&lt;p&gt;Redis可以自动压缩(也可以叫重写)AOF文件，用户也可以通过&lt;code&gt;BGREWRITEAOF&lt;/code&gt;命令来压缩AOF文件。这里的压缩，不是平时说的压缩的意思，是指创建一个新的文件来替换旧的文件，两个文件保存的数据状态完全一致。如果在本地手动执行&lt;code&gt;BGREWRITEAOF&lt;/code&gt;命令，可以看到会生成一个temp-rewriteaof-*.aof的临时文件，在结束后替换appendonly.aof文件，从而减小appendonly.aof文件的大小。我知道这样说其实还是不好理解，还是上图吧。为了方便画图，我就默默假装Redis直接将命令按输入的样子存储到AOF文件中，不要拆穿我🙈。&lt;br&gt;假设执行的写命令是下面的样子：&lt;br&gt;&lt;img src=&quot;/images/write.png&quot; alt=&quot;执行的写操作&quot;&gt;&lt;br&gt;那么看看在压缩前AOF文件的样子(就是存储了除get命令外的所有写命令)：&lt;br&gt;&lt;img src=&quot;/images/aof.png&quot; alt=&quot;压缩前的AOF文件&quot;&gt;&lt;br&gt;接着执行BGREWRITEAOF命令，Redis会生成一个新的文件来替换旧的AOF文件，从而达到压缩的目的：&lt;br&gt;&lt;img src=&quot;/images/yasuo.png&quot; alt=&quot;压缩后的AOF文件&quot;&gt;&lt;/p&gt;
&lt;p&gt;可以看到压缩前文件中存储了7条写命令，压缩后只存储一条。而且执行set number 1和6次incr number命令 ，与执行set number 7命令效果是一样的。从而即保证了数据的正确性又压缩了文件的大小。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;需要注意的是，Redis是启用子进程来进行AOF文件的压缩，在这期间主进程还是可以继续处理请求的，如果这时请求有写操作就可能导致当前数据库与压缩后的AOF不一致。Redis增加了一个缓存来解决这个问题，主进程在接收到新的写操作命令之后，会将命令写入现有的AOF文件和缓存中。在子进程完成新的AOF文件之后会将缓存的内容写入到新的AOF文件中，并改名覆盖旧的AOF文件。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;快照持久化&quot;&gt;&lt;a href=&quot;#快照持久化&quot; class=&quot;headerlink&quot; title=&quot;快照持久化&quot;&gt;&lt;/a&gt;快照持久化&lt;/h3&gt;&lt;h4 id=&quot;快照可用配置&quot;&gt;&lt;a href=&quot;#快照可用配置&quot; class=&quot;headerlink&quot; title=&quot;快照可用配置&quot;&gt;&lt;/a&gt;快照可用配置&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;配置项&lt;/th&gt;
&lt;th&gt;含义&lt;/th&gt;
&lt;th&gt;可选值 &lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;save m n&lt;/td&gt;
&lt;td&gt;m秒内有n次写入时创建快照&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;stop-writes-on-bgsave-error&lt;/td&gt;
&lt;td&gt;创建快照失败后是否继续执行写命令&lt;/td&gt;
&lt;td&gt;no,yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;rdbcomression&lt;/td&gt;
&lt;td&gt;是否压缩快照文件&lt;/td&gt;
&lt;td&gt;no,yes&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;dbfilename&lt;/td&gt;
&lt;td&gt;命名快照文件&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;dir path/to/dump.rdb&lt;/td&gt;
&lt;td&gt;文件存放位置&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&quot;RDB文件结构&quot;&gt;&lt;a href=&quot;#RDB文件结构&quot; class=&quot;headerlink&quot; title=&quot;RDB文件结构&quot;&gt;&lt;/a&gt;RDB文件结构&lt;/h4&gt;&lt;p&gt;RDB文件是一个经过压缩的二进制文件，不同类型的键值对会采用不同的方式来保存它们。具体的结构我也还没理清楚。。可以参考这篇文章&lt;a href=&quot;http://redisbook.com/preview/rdb/rdb_struct.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://redisbook.com/preview/rdb/rdb_struct.html&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;创建快照&quot;&gt;&lt;a href=&quot;#创建快照&quot; class=&quot;headerlink&quot; title=&quot;创建快照&quot;&gt;&lt;/a&gt;创建快照&lt;/h4&gt;&lt;p&gt;创建快照的方式有以下几种：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;客户端发送&lt;code&gt;BGSAVE&lt;/code&gt;命令。与压缩AOF文件一样，Redis会fork出一个子进程，由子进程负责将快照写入硬盘。&lt;/li&gt;
&lt;li&gt;客户端发送&lt;code&gt;SAVE&lt;/code&gt;命令。Redis会开始创建快照，并且在快照创建完成之前不再处理其他命令。不常使用&lt;code&gt;SAVE&lt;/code&gt;命令&lt;/li&gt;
&lt;li&gt;在满足配置的save m n选项时。比如，配置了save 60 1000,会在满足60秒内有1000次写入的时候开始创建快照。&lt;/li&gt;
&lt;li&gt;当接收到&lt;code&gt;SHUTDOWN&lt;/code&gt;请求时，Redis会执行&lt;code&gt;SAVE&lt;/code&gt;命令,并且不再执行任何其他命令。&lt;/li&gt;
&lt;li&gt;当从服务器向主服务器发送SYNC命令时，如果主服务器不是刚刚执行过&lt;code&gt;BGSAVE&lt;/code&gt;命令,就会开始执行&lt;code&gt;BGSAVE&lt;/code&gt;来创建快照。&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;快照优缺点&quot;&gt;&lt;a href=&quot;#快照优缺点&quot; class=&quot;headerlink&quot; title=&quot;快照优缺点&quot;&gt;&lt;/a&gt;快照优缺点&lt;/h4&gt;&lt;p&gt;优点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;文件紧凑,适用于做不同版本的数据备份&lt;/li&gt;
&lt;li&gt;与AOF相比在恢复大数据集时，更快&lt;/li&gt;
&lt;li&gt;很方便传送到另一个数据中心&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;缺点：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;一旦Redis出现问题，上一次创建快照之后的数据就丢失了&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;参考文档&quot;&gt;&lt;a href=&quot;#参考文档&quot; class=&quot;headerlink&quot; title=&quot;参考文档&quot;&gt;&lt;/a&gt;参考文档&lt;/h3&gt;&lt;p&gt;《Redis In Action》&lt;br&gt;&lt;a href=&quot;http://www.redis.cn/topics/persistence.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.redis.cn/topics/persistence.html&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://redisbook.readthedocs.org/en/latest/internal/aof.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://redisbook.readthedocs.org/en/latest/internal/aof.html&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;恩，先说点题外话。上周被小虐了一丢丢,但有很大收获,了解了自己的不足,知道了自己还在哪些方面有欠缺。更坚定了一直以来的想法,应届生或者工作时间不长的人找工作公司规模，福利薪资都是浮云，跟对人才是最重要的,非常及其以及特别的重要,一个人好技术牛的部门leader绝对抵得上5K的薪资。这也完美解释了为何部门拆分,老大和磊哥走了之后这么不舒服,这尼玛相当于给我减了5K的工资啊,扯远了。。。。还是来看Redis吧，整理下Redis持久化的相关内容，加深下印象。不想看文字的可直接看下面的图😂。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="redis" scheme="http://yemengying.com/categories/redis/"/>
    
    
      <category term="redis" scheme="http://yemengying.com/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>Redis相关---【译】利用Redis起飞吧</title>
    <link href="http://yemengying.com/2016/04/02/take-advantage-of-Redis/"/>
    <id>http://yemengying.com/2016/04/02/take-advantage-of-Redis/</id>
    <published>2016-04-02T02:56:03.000Z</published>
    <updated>2016-05-14T09:30:03.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;一直以来对Redis的使用都很是简单粗暴，不得精髓，趁假期好好补补。翻译一篇Redis之父Antirez的博客，文章中讲述了几个利用Redis解决实际问题的例子。并非逐字逐句的翻译，有些不太懂的地方就任性的跳过了😋，翻译这篇博客只做加深印象之用，建议大家还是出门左转看原文吧。。。。。。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;原文地址：&lt;a href=&quot;http://oldblog.antirez.com/post/take-advantage-of-redis-adding-it-to-your-stack.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://oldblog.antirez.com/post/take-advantage-of-redis-adding-it-to-your-stack.html&lt;/a&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;写在前面&quot;&gt;&lt;a href=&quot;#写在前面&quot; class=&quot;headerlink&quot; title=&quot;写在前面&quot;&gt;&lt;/a&gt;写在前面&lt;/h3&gt;&lt;p&gt; Redis在很多方面不同于MySql等数据库：比如，Redis使用内存做主要的存储，使用磁盘实现数据持久化；数据模型不同；Redis是单线程的等等。但我认为最大的不同是如果开发者想要使用Redis，无需切换到Redis。可以在不把Redis作为数据库的前提下，利用Redis实现一些以前不好实现的功能或者优化遗留的问题。&lt;br&gt; 完全切换到Redis当然也是可行的，许多开发者在想使用Redis的一些特性时，会将Redis当做主数据库，但将一个已经在生产环境中运行的项目切换到Redis显然是个大工程。而且有一些应用并不适合将Redis作为数据库：比如Redis的数据集不能比可用内存大，所以对于大数据量的应用，Redis可能不是一个好的选择。&lt;br&gt;下面会介绍一些在已有项目中加入Redis的例子，会向大家展示如何在不把Redis当做主要数据库的情况下利用Redis的某些特性解决问题。&lt;/p&gt;
&lt;h3 id=&quot;在主页展示最新的评论列表&quot;&gt;&lt;a href=&quot;#在主页展示最新的评论列表&quot; class=&quot;headerlink&quot; title=&quot;在主页展示最新的评论列表&quot;&gt;&lt;/a&gt;在主页展示最新的评论列表&lt;/h3&gt;&lt;p&gt;我敢打赌，如果每次都通过下面的查询语句获取最新评论，那么网站性能会很差。&lt;br&gt;&lt;figure class=&quot;highlight sql&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;SELECT&lt;/span&gt; * &lt;span class=&quot;keyword&quot;&gt;FROM&lt;/span&gt; foo &lt;span class=&quot;keyword&quot;&gt;WHERE&lt;/span&gt; ... &lt;span class=&quot;keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;BY&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;time&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;DESC&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;LIMIT&lt;/span&gt; &lt;span class=&quot;number&quot;&gt;10&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;展现最新添加的某些东西在网站应用中十分常见，下面看看如何利用Redis优化这类问题。假设网站想要展示最新的20条评论，并且还有个“展示全部评论”的链接，通过这个链接可以通过分页的形式查看历史评论记录。&lt;br&gt;我们还假设每条评论都存储在数据库中，并且有一个自增的Id。&lt;br&gt;我们可以使用一个很简单的Redis同时解决展现最新评论和分页展现历史评论的问题。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;每当创建一条新的评论，将评论的Id插入到Redis的一个列表中:&lt;strong&gt;LPUSH latest.comments &lt;id&gt;&lt;/id&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Redis支持将列表修剪到指定长度。所以我们可以通过&lt;strong&gt;LTRIM latest.comments 0 5000.&lt;/strong&gt;操作维持列表中始终存储5000个最新的评论Id.&lt;/li&gt;
&lt;li&gt;每次想要获取指定范围内的评论时，可以使用下面的函数（伪代码）.&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;FUNCTION get_latest_comments(start,num_items):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    id_list = redis.lrange(&lt;span class=&quot;string&quot;&gt;&quot;latest.comments&quot;&lt;/span&gt;,start,start+num_items&lt;span class=&quot;number&quot;&gt;-1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    IF id_list.length &amp;lt; num_items&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        id_list = SQL_DB(&lt;span class=&quot;string&quot;&gt;&quot;SELECT ... ORDER BY time LIMIT ...&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    END&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    RETURN id_list&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;END&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这段代码的功能很简单。在Redis中维护一个&lt;code&gt;“动态缓存”&lt;/code&gt;，经常更新,存储最新评论的Id,缓存中限制最多只存5000个Id。在系统第一次启动时,缓存列表中的Id个数为0。所以我们上面实现的方法会在先访问Redis，如果参数(start/count)的超过了列表范围，再去访问数据库。&lt;br&gt;我们无需刷新缓存，并且只会在用户想要查看最新5000条评论之外的评论时才会访问数据库。也就是说展示最新评论的主页，和查看历史评论前几页都无需访问数据库。&lt;/p&gt;
&lt;h3 id=&quot;删除和过滤&quot;&gt;&lt;a href=&quot;#删除和过滤&quot; class=&quot;headerlink&quot; title=&quot;删除和过滤&quot;&gt;&lt;/a&gt;删除和过滤&lt;/h3&gt;&lt;p&gt;在遇到评论被删除时，我们可以使用&lt;code&gt;LREM&lt;/code&gt;命令来删除Redis列表中缓存的评论Id。如果删除评论的情况不常见，也可以在展示指定评论时跳过它，因为我们在根据评论Id去数据库查询评论具体内容时，数据库会告诉我们某条评论已经不存在了。&lt;/p&gt;
&lt;h3 id=&quot;选手积分榜及相关问题&quot;&gt;&lt;a href=&quot;#选手积分榜及相关问题&quot; class=&quot;headerlink&quot; title=&quot;选手积分榜及相关问题&quot;&gt;&lt;/a&gt;选手积分榜及相关问题&lt;/h3&gt;&lt;p&gt;另一个比较常见的，用数据库实现性能较差的需求是按分数排序，展现列表，并且实时更新，一个常见的例子就是在线游戏中的选手积分榜。在在线游戏中，需要接受高频率的来自不同用户的分数更新，通过这些分数实现以下需求：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在积分榜中展现分数最高的100位选手&lt;/li&gt;
&lt;li&gt;展现用户的当前排名&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;这些操作用Redis的&lt;code&gt;有序集合&lt;/code&gt;来实现是很简单的，哪怕你的系统每分钟要更新上百万的分数。&lt;br&gt;每当接受到一个用户的新分数时，我们对Redis做如下的操作：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ZADD leaderboard &amp;lt;score&amp;gt; &amp;lt;username&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ps:也可以使用userId，而不是用户名, 看开发者的个人喜好。&lt;br&gt;接下来，我们可以很简单的通过下面的操作获得分数排名前100的用户&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ZREVRANGE leaderboard 0 99&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;也可以通过&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;ZRANK leaderboard &amp;lt;username&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;来获取用户的当前排名。&lt;br&gt;除此之外，我们还可以获得排名靠近当前用户的用户，以及等等等等。。。。。&lt;/p&gt;
&lt;h3 id=&quot;按照用户投票和时间排序&quot;&gt;&lt;a href=&quot;#按照用户投票和时间排序&quot; class=&quot;headerlink&quot; title=&quot;按照用户投票和时间排序&quot;&gt;&lt;/a&gt;按照用户投票和时间排序&lt;/h3&gt;&lt;p&gt;下面谈谈选手积分榜问题的一个变种问题。在诸如Reddit和Hacker News这类的网站中，新闻是按照类似下面公式计算得出的分数来排序的。&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;score = points / time^alpha&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;也就是说用户的投票会在一定很小程度上提升新闻的排名，而时间流逝则会使新闻的排名呈指数级下降。实际的算法会比我们的例子更复杂，但解决的方式是一样的。&lt;br&gt;首先假设只有最新发布的1000条新闻才有资格出现在首页上，所以我们只关注最新发布的1000条新闻，忽略太老的新闻，大致解决方法如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;每当新发布一条新闻，将其Id加入到Redis的列表中，通过&lt;strong&gt;LPUSH+LTRIM&lt;/strong&gt;将列表维持到只保存最新发布的1000条新闻的Id。&lt;/li&gt;
&lt;li&gt;通过一个定时任务获取Redis中Id列表，并且不断的计算列表中新闻的分数。将计算结果通过ZADD操作存储到一个有序集合中，同时将旧的新闻从有序列表中清除。&lt;br&gt;主要思想就是，有序集合中存储着1000条最新新闻，并按分数排序。分数的排序是通过后台程序完成的，与浏览网站的用户数无关。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;将元素过期&quot;&gt;&lt;a href=&quot;#将元素过期&quot; class=&quot;headerlink&quot; title=&quot;将元素过期&quot;&gt;&lt;/a&gt;将元素过期&lt;/h3&gt;&lt;p&gt;我们还可以利用有序集合实现将超过指定时间的元素在数据库中删除或置为过期。具体做法如下：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;每当数据库中新加入一个元素时，同时将其添加到有序集合中，分数是当前时间加上指定的存活时间&lt;/li&gt;
&lt;li&gt;让一个后台任务查询有序集合，利用&lt;strong&gt;ZRANGE …WITHSCORES&lt;/strong&gt;获取元素，如果元素对应的分数小于当前时间，说明元素已过期，在数据库中删除对应记录。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;计数器&quot;&gt;&lt;a href=&quot;#计数器&quot; class=&quot;headerlink&quot; title=&quot;计数器&quot;&gt;&lt;/a&gt;计数器&lt;/h3&gt;&lt;p&gt;Redis可以用来实现计数器,使用INCRBY操作即可。&lt;br&gt;相信很多人都曾想过在数据库中添加一张计数器表，用来为用户展现一些统计信息，但又考虑到需要对这张表进行大量的写操作而放弃，本宝宝曾经无数次遇到过这个问题。&lt;br&gt;现在，我们可以通过Redis来解决这个问题。通过Redis我们可以为计数器原子性的增加计数,也可以使用&lt;code&gt;GETSET&lt;/code&gt;命令重置计数器或者为计数器设置过期时间。比如我们可以按照如下做法实现计数一个用户指定时间内的页面访问量，如果超过了指定值，比如20，就弹出一个提示。&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;INCR user:&amp;lt;id&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;EXPIRE user:&amp;lt;id&amp;gt; 60&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;统计指定时间内不同的用户&quot;&gt;&lt;a href=&quot;#统计指定时间内不同的用户&quot; class=&quot;headerlink&quot; title=&quot;统计指定时间内不同的用户&quot;&gt;&lt;/a&gt;统计指定时间内不同的用户&lt;/h3&gt;&lt;p&gt;另一个用数据库实现比较困难，但是用Redis却很简单的功能就是统计指定时间内访问某资源的用户数。比如我想知道访问指定页面的用户数(相同用户访问多次只计算一次)，我只需要在新增一个页面浏览(PV)时,执行下面的操作：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;SADD page:day1:&amp;lt;page_id&amp;gt;  &amp;lt;user_id&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;想获得某页面的用户访问数，只需执行&lt;strong&gt;SCARD page:day1:&lt;page_id&gt;&lt;/page_id&gt;&lt;/strong&gt;即可。&lt;/p&gt;
&lt;h3 id=&quot;实时分析&quot;&gt;&lt;a href=&quot;#实时分析&quot; class=&quot;headerlink&quot; title=&quot;实时分析&quot;&gt;&lt;/a&gt;实时分析&lt;/h3&gt;&lt;p&gt;我们已经看过了几个利用Redis如何实现一些利用数据库不好实现的功能，如果深入学习Redis的命令集，活用Redis中的数据结构，我们可以很容易的实现实时统计的功能，用来增强反垃圾邮件系统，或者通过分析得到的一些数据来提高网站的质量。&lt;/p&gt;
&lt;h3 id=&quot;发布-订阅&quot;&gt;&lt;a href=&quot;#发布-订阅&quot; class=&quot;headerlink&quot; title=&quot;发布/订阅&quot;&gt;&lt;/a&gt;发布/订阅&lt;/h3&gt;&lt;p&gt;Redis中实现了一个高性能的&lt;code&gt;发布/订阅&lt;/code&gt;系统，易于使用，稳定，性能高，并且支持模式匹配。详细的信息可以阅读&lt;a href=&quot;http://redis.io/topics/pubsub&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Redis官方文档&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;队列&quot;&gt;&lt;a href=&quot;#队列&quot; class=&quot;headerlink&quot; title=&quot;队列&quot;&gt;&lt;/a&gt;队列&lt;/h3&gt;&lt;p&gt;大家可能已经注意到了，通过Redis对列表插入元素和弹出元素的命令，很适合用来实现一个队列。但Redis能做的远远不止这些，比如Redis弹出列表元素时还有提供&lt;a href=&quot;http://redis.io/commands/blpop&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;BLPOP命令&lt;/a&gt;，可以在列表为空时，将连接阻塞。除此之外利用有序集合也可以很容易的实现一个优先队列。Redis在队列方面还有很多用法(比如&lt;code&gt;RPOPLPUSH&lt;/code&gt;,&lt;code&gt;Resque&lt;/code&gt;)，大家可以慢慢发掘。&lt;/p&gt;
&lt;h3 id=&quot;缓存&quot;&gt;&lt;a href=&quot;#缓存&quot; class=&quot;headerlink&quot; title=&quot;缓存&quot;&gt;&lt;/a&gt;缓存&lt;/h3&gt;&lt;p&gt;关于这一节其实就够再写一篇博客了。简单来说，Redis可以作为&lt;code&gt;memcached&lt;/code&gt;的替代品，使我们的缓存既可以存储数据又易于更新。&lt;/p&gt;
&lt;h3 id=&quot;快在Redis的帮助下起飞吧&quot;&gt;&lt;a href=&quot;#快在Redis的帮助下起飞吧&quot; class=&quot;headerlink&quot; title=&quot;快在Redis的帮助下起飞吧&quot;&gt;&lt;/a&gt;快在Redis的帮助下起飞吧&lt;/h3&gt;&lt;p&gt;快使用Redis来增强用户体验，降低系统复杂度，加快请求响应吧~~，无需全部切换到Redis，可仅仅利用Redis实现用数据库不好实现或性能不高的新功能。&lt;/p&gt;
&lt;p&gt;分享个觉得还不错的视频，拖延症患者可以看看，不过估计也没什么卵用，该拖还得拖，哈哈哈哈哈哈~~~&lt;/p&gt;
&lt;object width=&quot;640&quot; height=&quot;360&quot;&gt;&lt;param name=&quot;movie&quot; value=&quot;http://swf.ws.126.net/openplayer/v02/-0-2_MBHQSM52F_MBI15O7QE-vimg1_ws_126_net//image/snapshot_movie/2016/3/Q/F/MBI15O7QF-1423031805654.swf?isTEDPlay=1&quot;&gt;&lt;param name=&quot;allowScriptAccess&quot; value=&quot;always&quot;&gt;&lt;param name=&quot;wmode&quot; value=&quot;transparent&quot;&gt;&lt;embed src=&quot;http://swf.ws.126.net/openplayer/v02/-0-2_MBHQSM52F_MBI15O7QE-vimg1_ws_126_net//image/snapshot_movie/2016/3/Q/F/MBI15O7QF-1423031805654.swf?isTEDPlay=1&quot; type=&quot;application/x-shockwave-flash&quot; width=&quot;640&quot; height=&quot;360&quot; allowfullscreen=&quot;true&quot; wmode=&quot;transparent&quot; allowscriptaccess=&quot;always&quot;&gt;&lt;/object&gt;










</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;一直以来对Redis的使用都很是简单粗暴，不得精髓，趁假期好好补补。翻译一篇Redis之父Antirez的博客，文章中讲述了几个利用Redis解决实际问题的例子。并非逐字逐句的翻译，有些不太懂的地方就任性的跳过了😋，翻译这篇博客只做加深印象之用，建议大家还是出门左转看原文吧。。。。。。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;原文地址：&lt;a href=&quot;http://oldblog.antirez.com/post/take-advantage-of-redis-adding-it-to-your-stack.html&quot;&gt;http://oldblog.antirez.com/post/take-advantage-of-redis-adding-it-to-your-stack.html&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="redis" scheme="http://yemengying.com/categories/redis/"/>
    
    
      <category term="翻译" scheme="http://yemengying.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
      <category term="redis" scheme="http://yemengying.com/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>[Elasticsearch配置项(二)]Node,Threadpool模块配置</title>
    <link href="http://yemengying.com/2016/03/21/elasticsearch-settings2/"/>
    <id>http://yemengying.com/2016/03/21/elasticsearch-settings2/</id>
    <published>2016-03-21T13:32:41.000Z</published>
    <updated>2016-05-09T12:54:33.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;接上文。。。。。。按照官方文档(版本2.2)和一些参考资料整理一下elasticsearch的可配置项。先整理了Node，ThreadPool两个模块的可配置项，其他模块(比如Cluster)会在之后慢慢整理的。本文只包含两个模块可用配置项的含义及用法，并不涉及应该如何优化，这是为什么呢？因为俺也不会。。。。。(欢迎指正错误，康桑阿米达)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;相关博客：&lt;a href=&quot;http://yemengying.com/2016/03/18/Elasticsearch%E9%85%8D%E7%BD%AE%E9%A1%B9-Local-gateway-HTTP-Indices-Network-Settings%E6%A8%A1%E5%9D%97%E9%85%8D%E7%BD%AE/&quot;&gt;elasticsearch 配置项(一)&lt;/a&gt;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;wuli光洙镇楼~~&lt;br&gt;&lt;img src=&quot;/images/guangzhu.jpg&quot; alt=&quot;hahaha&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;参考文档（万分感谢）&quot;&gt;&lt;a href=&quot;#参考文档（万分感谢）&quot; class=&quot;headerlink&quot; title=&quot;参考文档（万分感谢）&quot;&gt;&lt;/a&gt;参考文档（万分感谢）&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.opscoder.info/es_threadpool.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.opscoder.info/es_threadpool.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://www.voidcn.com/blog/BrotherDong90/article/p-3851633.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://www.voidcn.com/blog/BrotherDong90/article/p-3851633.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;Node-节点&quot;&gt;&lt;a href=&quot;#Node-节点&quot; class=&quot;headerlink&quot; title=&quot;Node(节点)&quot;&gt;&lt;/a&gt;Node(节点)&lt;/h3&gt;&lt;p&gt;每当启动一个Es实例，就是启动了一个节点。多个连接在一起的节点组成的集合就是集群。&lt;br&gt;默认情况下，每个节点都可以通过HTTP和Transport通信。每个节点都知道集群中的其他节点，可以将客户端的请求转发到合适的节点。除此之外，每个节点还有着以下一种或多种具体角色。&lt;br&gt;&lt;strong&gt; Master-eligible node (候选主节点) &lt;/strong&gt;&lt;br&gt;当一个节点的&lt;code&gt;node.master&lt;/code&gt;被设置为&lt;code&gt;true&lt;/code&gt;(默认为true)时，该节点就有资格被选为master节点，控制集群。&lt;br&gt;&lt;strong&gt; Data node (数据节点) &lt;/strong&gt;&lt;br&gt;配置项&lt;code&gt;node.data&lt;/code&gt;设置为true的节点称为数据节点。数据节点存储数据并且处理和数据相关的一些操作，比如CRUD，查找和聚合等。&lt;br&gt;&lt;strong&gt; Client node (客户端节点) &lt;/strong&gt;&lt;br&gt;当一个节点的&lt;code&gt;node.master&lt;/code&gt;和&lt;code&gt;node.data&lt;/code&gt;均被设置为&lt;code&gt;false&lt;/code&gt;时，它既不能存储数据也不能作为一个主节点。它被看做一个“路由器”，负责将集群层面的请求转发到主节点，将数据相关的请求转发到数据节点。&lt;br&gt;&lt;strong&gt; Tribe node (部落节点) &lt;/strong&gt;&lt;br&gt;部落节点是一种特殊类型的客户端节点，可通过&lt;code&gt;tribe.*&lt;/code&gt;配置项配置。部落节点可以连接多个集群，并且可以跨集群执行查找和其他操作。&lt;/p&gt;
&lt;p&gt;默认情况下，每个节点即是主节点也是数据节点。但是当集群扩大后，更好的做法是将主节点和数据节点独立开。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Coordinating node(协调节点)：一些请求可能会涉及到多个数据节点，比如搜索或批量索引。搜索请求一般分为两个阶段，由接受客户端请求的节点做协调，称为协调节点。在搜索的第一阶段协调节点会将请求转发到数据节点，每个节点在本地执行请求，并将结果返给协调节点。在第二阶段，协调节点会将各个结果汇总在一起。这意味着负责接受请求的客户端节点(也就是协调节点)需要用足够的内存和CPU来处理查询结果的汇总。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;Master-eligible-node-候选主节点&quot;&gt;&lt;a href=&quot;#Master-eligible-node-候选主节点&quot; class=&quot;headerlink&quot; title=&quot;Master-eligible node(候选主节点)&quot;&gt;&lt;/a&gt;Master-eligible node(候选主节点)&lt;/h4&gt;&lt;p&gt;主节点主要负责创建索引，删除索引，追踪集群中的节点，分配分片等，所以有一个稳定的主节点对于集群来说非常重要，非常重要，非常重要（说三遍，哈哈哈）。集群中任何有资格成为主节点的节点都可能被选为主节点。&lt;br&gt;由于索引和搜索会对节点资源造成压力，在集群比较大时，最好将主节点和数据节点的角色区分，即不要让主节点同时也是数据节点。&lt;br&gt;通过下面的配置可以设置一个专门的主节点(只是主节点不是数据节点)。&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;node.master: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;node.data: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt; 通过minimum_master_nodes来避免脑裂现象 &lt;/strong&gt;&lt;br&gt;&lt;code&gt;discovery.zen.minimum_master_nodes&lt;/code&gt;配置项说明形成集群时，集群中有资格成为主节点的节点数最少是多少，默认为1.&lt;br&gt;脑裂现象：假设集群中有两个有资格成为主节点的候选主节点，&lt;code&gt;discovery.zen.minimum_master_nodes&lt;/code&gt;配置默认为1。当由于网络问题中断了两个节点间的通信，这时两个节点都只会发现一个有资格成为主节点的节点（自己本身）， 根据配置(minimum_master_nodes = 1),符合组成一个集群的条件，所以每个节点都会成为新的master节点，从而导致形成了两个集群，也就是脑裂。直到其中一个节点重启，才会重新形成集群，并且写入重启节点的数据会丢失。假设集群中有三个有资格成为主节点的候选主节点，而这时&lt;code&gt;minimum_master_nodes&lt;/code&gt;设置为2，如果一个节点与其他两个失去了通信，被独立的节点会发现不满足设置的条件(有两个候选主节点)，所以不会选举自己为主节点。而剩下两个节点会选举出一个新的主节点，确保正常运行。&lt;br&gt;&lt;code&gt;discovery.zen.minimum_master_nodes&lt;/code&gt;最好设置为(候选主节点数/2) + 1, 举个例子，当有三个候选主节点时，该配置项的值为(3/2)+1=2。&lt;br&gt;也可以通过下面的API动态的更新这个值：&lt;br&gt;&lt;figure class=&quot;highlight&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;PUT _cluster/settings&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &quot;transient&quot;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;discovery.zen.minimum_master_nodes&quot;: 2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;Data-node-数据节点&quot;&gt;&lt;a href=&quot;#Data-node-数据节点&quot; class=&quot;headerlink&quot; title=&quot;Data node(数据节点)&quot;&gt;&lt;/a&gt;Data node(数据节点)&lt;/h4&gt;&lt;p&gt;数据节点包含着索引文档的分片，负责处理和数据相关的操作，比如CRUD，搜索和聚合。这些操作会涉及到IO,内存和CPU，所以要注意监控这些资源，添加更多的数据节点以防负载过重。通过下面的配置可以设置一个专门的数据节点(只是数据节点不是主节点)。&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;node.master: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;node.data: &lt;span class=&quot;literal&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;Client-node-客户端节点&quot;&gt;&lt;a href=&quot;#Client-node-客户端节点&quot; class=&quot;headerlink&quot; title=&quot;Client node(客户端节点)&quot;&gt;&lt;/a&gt;Client node(客户端节点)&lt;/h4&gt;&lt;p&gt;客户端节点主要负责路由请求，汇总搜索结果等，本质上来看，客户端节点更像一个负载均衡器。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意：集群中添加过多的客户端节点会增加整个集群的负担。所以不要过大夸大客户端节点的好处，数据节点也可以像客户端节点一样服务。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt; 通过下面的配置可以设置一个专门的客户端节点(不是数据节点也不是主节点)。&lt;br&gt; &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;node.master: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;node.data: &lt;span class=&quot;literal&quot;&gt;false&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;设置节点的数据路径&quot;&gt;&lt;a href=&quot;#设置节点的数据路径&quot; class=&quot;headerlink&quot; title=&quot;设置节点的数据路径&quot;&gt;&lt;/a&gt;设置节点的数据路径&lt;/h4&gt;&lt;p&gt;&lt;code&gt;path.data&lt;/code&gt;&lt;br&gt;每个数据节点和主节点都需要在文件中存储一些关于分片，索引和集群的元数据。&lt;code&gt;elasticsearch.yml&lt;/code&gt;文件中的&lt;code&gt;path.data&lt;/code&gt;可以配置文件的绝对路径或相对路径，默认值是&lt;code&gt;$ES_HOME/data&lt;/code&gt;，也可以通过命令配置。&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;./bin/elasticsearch --path.data /var/elasticsearch/data&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;node.max_local_storage-nodes&lt;/code&gt;&lt;br&gt;上面的设置可以被不同的节点共享（在生产环境下建议一个服务器只运行一个节点）。为了避免多个节点共享同一个路径，可以在&lt;code&gt;elasticsearch.yml&lt;/code&gt;中添加如下配置。&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;node.max_&lt;span class=&quot;built_in&quot;&gt;local&lt;/span&gt;_storage_nodes: 1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意，不要将不同类型节点的信息存储到同一个目录下，可能会造称数据丢失。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;Thread-Pool-线程池&quot;&gt;&lt;a href=&quot;#Thread-Pool-线程池&quot; class=&quot;headerlink&quot; title=&quot;Thread Pool(线程池)&quot;&gt;&lt;/a&gt;Thread Pool(线程池)&lt;/h3&gt;&lt;p&gt;为了提升线程内存消耗的管理，每个Es节点都有多个线程池。&lt;/p&gt;
&lt;h4 id=&quot;线程池类型&quot;&gt;&lt;a href=&quot;#线程池类型&quot; class=&quot;headerlink&quot; title=&quot;线程池类型&quot;&gt;&lt;/a&gt;线程池类型&lt;/h4&gt;&lt;p&gt;下面介绍一下线程池的三种类型和各自的一些参数：&lt;br&gt;&lt;strong&gt;cached&lt;/strong&gt;:&lt;br&gt;    &lt;code&gt;cached&lt;/code&gt;类型的线程池没有限制大小，当有pending的请求时就会创建一个线程。这类线程池可以防止请求阻塞或被拒绝。未使用的线程会在过期(默认5分钟)之后消亡。&lt;code&gt;cache&lt;/code&gt;类型专门为&lt;code&gt;generic&lt;/code&gt;线程池保留的。&lt;br&gt;    &lt;code&gt;keep_alive&lt;/code&gt;参数定义了未使用的线程的存活时间。&lt;br&gt;    &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;threadpool:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   generic:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       keep_alive: 2m&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;fixed&lt;/strong&gt;:&lt;br&gt;    &lt;code&gt;fixed&lt;/code&gt;类型的线程池持有固定个数的线程处理请求队列。&lt;code&gt;size&lt;/code&gt;参数用来控制线程的个数，默认为cpu核心数的5倍。&lt;code&gt;queue_size&lt;/code&gt;参数用来控制请求队列的大小。默认值为-1，意味着无上限。如果请求队列已满，那么接下来到来的请求会被终止。&lt;br&gt;    &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;threadpool:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   index:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       size: 30&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       queue_size: 1000&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;scaling&lt;/strong&gt;:&lt;br&gt;    &lt;code&gt;scaling&lt;/code&gt;线程池中线程数可动态变化。线程数在1和&lt;code&gt;size&lt;/code&gt;参数值的中间。&lt;br&gt;    &lt;code&gt;keep_alive&lt;/code&gt;参数定义了未使用的线程的存活时间。&lt;br&gt;    &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;threadpool:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;   warmer:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       size: 8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;       keep_alive: 2m&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;Es中重要的线程池&quot;&gt;&lt;a href=&quot;#Es中重要的线程池&quot; class=&quot;headerlink&quot; title=&quot;Es中重要的线程池&quot;&gt;&lt;/a&gt;Es中重要的线程池&lt;/h4&gt;&lt;p&gt;以下是Es中几个比较重要的线程池及他们的类型:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;线程池&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;generic&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;负责一些诸如发现节点之类的通用操作。该线程池类型为&lt;code&gt;cache&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;index&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;负责索引数据/删除数据操作，类型为&lt;code&gt;fixed&lt;/code&gt;，默认线程数为&lt;code&gt;available processors&lt;/code&gt;,队列大小为&lt;code&gt;200&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;search&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;负责统计/搜索操作，类型为&lt;code&gt;fixed&lt;/code&gt;,默认线程数为&lt;code&gt;int((available_processors * 3) / 2) + 1&lt;/code&gt;,队列大小为&lt;code&gt;1000&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;suggest&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;负责获取提示操作，类型为&lt;code&gt;fixed&lt;/code&gt;,默认线程数为&lt;code&gt;available processors&lt;/code&gt;,队列大小为&lt;code&gt;1000&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;get&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;负责get操作，类型为&lt;code&gt;fixed&lt;/code&gt;,默认线程数为&lt;code&gt;available processors&lt;/code&gt;,队列大小为&lt;code&gt;1000&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;bulk&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;负责批量操作，类型为&lt;code&gt;fixed&lt;/code&gt;,默认线程数为&lt;code&gt;available processors&lt;/code&gt;,队列大小为&lt;code&gt;50&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;percolate&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;负责过滤操作，类型为&lt;code&gt;fixed&lt;/code&gt;,默认线程数为&lt;code&gt;available processors&lt;/code&gt;,队列大小为&lt;code&gt;1000&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;snapshot&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;负责快照/恢复操作，类型为&lt;code&gt;scaling&lt;/code&gt;,默认线程数为&lt;code&gt;min(5, (available processors)/2)&lt;/code&gt;,默认未使用线程的存活时间为&lt;code&gt;5m&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;warmer&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;负责warm-up操作，类型为&lt;code&gt;scaling&lt;/code&gt;,默认线程数为&lt;code&gt;min(5, (available processors)/2)&lt;/code&gt;,默认未使用线程的存活时间为&lt;code&gt;5m&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;refresh&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;负责更新操作，类型为&lt;code&gt;scaling&lt;/code&gt;,默认线程数为&lt;code&gt;min(10, (available processors)/2)&lt;/code&gt;,默认未使用线程的存活时间为&lt;code&gt;5m&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;listener&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;负责java client的执行，类型为&lt;code&gt;scaling&lt;/code&gt;,默认线程数为&lt;code&gt;min(10, (available processors)/2)&lt;/code&gt;,默认未使用线程的存活时间为&lt;code&gt;5m&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&quot;处理器设置&quot;&gt;&lt;a href=&quot;#处理器设置&quot; class=&quot;headerlink&quot; title=&quot;处理器设置&quot;&gt;&lt;/a&gt;处理器设置&lt;/h4&gt;&lt;p&gt;Es可以自动检测处理器的数量，线程池的配置也会基于这个值。可能存在检测失败的情况，这是可以通过&lt;code&gt;processors&lt;/code&gt;配置显式设置这个值。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意以上这些配置如果不是很了解，还是不要轻易改动，使用默认配置即可。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;看累了吧，分享个觉得还不错的TED视频~~&lt;/p&gt;
&lt;object width=&quot;640&quot; height=&quot;360&quot;&gt;&lt;param name=&quot;movie&quot; value=&quot;http://swf.ws.126.net/openplayer/v02/-0-2_MBFLN6BJF_MBFLNJGFE-vimg1_ws_126_net//image/snapshot_movie/2016/2/F/F/MBFLNJGFF-1423031805654.swf?isTEDPlay=1&quot;&gt;&lt;param name=&quot;allowScriptAccess&quot; value=&quot;always&quot;&gt;&lt;param name=&quot;wmode&quot; value=&quot;transparent&quot;&gt;&lt;embed src=&quot;http://swf.ws.126.net/openplayer/v02/-0-2_MBFLN6BJF_MBFLNJGFE-vimg1_ws_126_net//image/snapshot_movie/2016/2/F/F/MBFLNJGFF-1423031805654.swf?isTEDPlay=1&quot; type=&quot;application/x-shockwave-flash&quot; width=&quot;640&quot; height=&quot;360&quot; allowfullscreen=&quot;true&quot; wmode=&quot;transparent&quot; allowscriptaccess=&quot;always&quot;&gt;&lt;/object&gt;







</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;接上文。。。。。。按照官方文档(版本2.2)和一些参考资料整理一下elasticsearch的可配置项。先整理了Node，ThreadPool两个模块的可配置项，其他模块(比如Cluster)会在之后慢慢整理的。本文只包含两个模块可用配置项的含义及用法，并不涉及应该如何优化，这是为什么呢？因为俺也不会。。。。。(欢迎指正错误，康桑阿米达)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;相关博客：&lt;a href=&quot;http://yemengying.com/2016/03/18/Elasticsearch%E9%85%8D%E7%BD%AE%E9%A1%B9-Local-gateway-HTTP-Indices-Network-Settings%E6%A8%A1%E5%9D%97%E9%85%8D%E7%BD%AE/&quot;&gt;elasticsearch 配置项(一)&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="elasticsearch" scheme="http://yemengying.com/categories/elasticsearch/"/>
    
    
      <category term="elasticsearch" scheme="http://yemengying.com/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>[Elasticsearch配置项(一)]Local gateway,HTTP,Indices,Network Settings模块配置</title>
    <link href="http://yemengying.com/2016/03/18/Elasticsearch%E9%85%8D%E7%BD%AE%E9%A1%B9-Local-gateway-HTTP-Indices-Network-Settings%E6%A8%A1%E5%9D%97%E9%85%8D%E7%BD%AE/"/>
    <id>http://yemengying.com/2016/03/18/Elasticsearch配置项-Local-gateway-HTTP-Indices-Network-Settings模块配置/</id>
    <published>2016-03-18T09:48:10.000Z</published>
    <updated>2016-05-09T12:50:00.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;近两周线上的搜索接口间隔性莫名其妙的出现莫名其妙的异常，比如神马NoAvailableThread，NoAvailableWorker之类的。可能是由于部门中没有很懂elasticsearch的人，只能摸着石头过河，所以一直使用elasticsearch的默认配置并没有对其线程池和内存分配进行优化造成的。所以按照官方文档(版本2.2)和一些参考资料整理一下elasticsearch的可配置项，看看可不可以优化一下。先整理了Local gateway,HTTP,Indices,Network Settings四个模块的可配置项，其他模块(比如Cluster)会在之后慢慢整理的。本文只包含四个模块可用配置项的含义及用法，并不涉及应该如何优化，这是为什么呢？因为俺也不会。。。。。(欢迎指正错误，康桑阿米达)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;相关博客：&lt;a href=&quot;http://yemengying.com/2016/03/21/elasticsearch-settings2/&quot;&gt;elasticsearch 配置项(二)&lt;/a&gt;&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;br&gt;&lt;img src=&quot;/images/baobao.jpg&quot; alt=&quot;哇咔咔咔&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;参考资料-万分感谢-：&quot;&gt;&lt;a href=&quot;#参考资料-万分感谢-：&quot; class=&quot;headerlink&quot; title=&quot;参考资料(万分感谢)：&quot;&gt;&lt;/a&gt;参考资料(万分感谢)：&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://donlianli.iteye.com/blog/2115979&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://donlianli.iteye.com/blog/2115979&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://aoyouzi.iteye.com/blog/2164820&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://aoyouzi.iteye.com/blog/2164820&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.csdn.net/jingkyks/article/details/41081261&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://blog.csdn.net/jingkyks/article/details/41081261&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://m.oschina.net/blog/387512&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://m.oschina.net/blog/387512&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://my.oschina.net/secisland/blog/618702?fromerr=ZGR1hlby#OSC_h4_5&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://my.oschina.net/secisland/blog/618702?fromerr=ZGR1hlby#OSC_h4_5&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/chenryn/ELKstack-guide-cn/blob/master/elasticsearch/performance/cache.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://github.com/chenryn/ELKstack-guide-cn/blob/master/elasticsearch/performance/cache.md&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;Local-gateway模块&quot;&gt;&lt;a href=&quot;#Local-gateway模块&quot; class=&quot;headerlink&quot; title=&quot;Local gateway模块&quot;&gt;&lt;/a&gt;Local gateway模块&lt;/h3&gt;&lt;p&gt;官网对应链接：&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-gateway.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Local gateway&lt;/a&gt;&lt;br&gt;该模块用于存储集群信息和分片数据，以便整个集群重启后可以恢复。&lt;br&gt;以下的一些静态配置，需要在集群的每一个节点上设置，用来控制节点需要等待多长时间之后再尝试恢复存储在本地的数据。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;配置项&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;gateway.expected_nodes&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;期望的集群中节点的数量，当集群中的节点数达到设定值时立即开始启动恢复本地数据的进程(会忽略recover_after_time配置)，默认为0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;gateway.expected_master_nodes&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;期望的集群中master节点的数量，当集群中的节点数达到设定值时立即开始启动恢复本地数据的进程(会忽略recover_after_time配置)，默认为0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;gateway.expected_data_nodes&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;期望的集群中master节点的数量，当集群中的节点数达到设定值时立即开始启动恢复本地数据的进程(会忽略recover_after_time配置)，默认为0&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;gateway.recover_after_time&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;当没有达到期望的节点数时，恢复进程会在等待配置时间之后尝试启动。当期望的节点数设置为1时，等待时间默认为5m&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;一旦到达了recover_after_time设置的时间，还要满足以下的配置条件，恢复进程才会启动。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;配置项&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;gateway.recover_after_nodes&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;需要多少个节点加入集群&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;gateway.recover_after_master_nodes&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;需要多少个master节点加入集群&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;gateway.recover_after_data_nodes&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;需要多少个data节点加入集群&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;注意：这些配置只有在整个集群重启时才会有用。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;HTTP模块&quot;&gt;&lt;a href=&quot;#HTTP模块&quot; class=&quot;headerlink&quot; title=&quot;HTTP模块&quot;&gt;&lt;/a&gt;HTTP模块&lt;/h3&gt;&lt;p&gt;官网对应链接：&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-http.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HTTP&lt;/a&gt;&lt;br&gt;HTTP模块用来通过HTTP暴露Es的API。因为HTTP机制是完全异步的，这意味着等待响应时不会阻塞线程。使用异步的通信可以解决&lt;a href=&quot;http://en.wikipedia.org/wiki/C10k_problem&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;C10k&lt;/a&gt;的问题。&lt;br&gt;如果可以，可考虑使用&lt;a href=&quot;https://en.wikipedia.org/wiki/Keepalive#HTTP_Keepalive&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HTTP keep alive&lt;/a&gt;来连接以便提升性能。并且不要在客户端使用&lt;a href=&quot;https://en.wikipedia.org/wiki/Chunked_transfer_encoding&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;HTTP chunking&lt;/a&gt;。&lt;/p&gt;
&lt;h4 id=&quot;配置&quot;&gt;&lt;a href=&quot;#配置&quot; class=&quot;headerlink&quot; title=&quot;配置&quot;&gt;&lt;/a&gt;配置&lt;/h4&gt;&lt;p&gt;下面表中是关于HTTP模块的一些配置。需要注意的是，它们都不能动态更新，必须配置在&lt;code&gt;elasticsearch.yml&lt;/code&gt;文件中。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;配置项&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.port&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;绑定端口的范围 默认9200-9300&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.publish_port&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;客户端与节点交互时需要使用的端口。这一配置在集群节点处于防火墙后时很有用，默认和&lt;code&gt;http.port&lt;/code&gt;中分配的端口一致。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.bind_host&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;绑定http服务的host地址，默认和&lt;code&gt;http.host&lt;/code&gt;(如果设置了)或者&lt;code&gt;network.bind_host&lt;/code&gt;一致&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.publish_host&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;客户端访问的host地址，默认和&lt;code&gt;http.host&lt;/code&gt;(如果设置了)或者&lt;code&gt;network.public_host&lt;/code&gt;一致&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.host&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;用来设置&lt;code&gt;http.bind_host&lt;/code&gt;和&lt;code&gt;http.publish_host&lt;/code&gt;,默认为&lt;code&gt;http.host&lt;/code&gt;或者&lt;code&gt;network.host&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.max_content_length&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;设置请求内容的最大大小。默认&lt;code&gt;100mb&lt;/code&gt;。如果设置的数值超过了&lt;code&gt;Integer.MAX_VALUE&lt;/code&gt;,会被重置为100mb。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.max_initial_line_length&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;HTTP请求URL的最大长度，默认&lt;code&gt;4kb&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.max_header_size&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;请求头的最大大小，默认&lt;code&gt;8kb&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.compression&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;是否支持压缩(使用Accept-Encoding)，默认&lt;code&gt;false&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.compression_level&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;定义使用的压缩级别，默认为6&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.cors.enabled&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;是否允许跨域请求。默认为&lt;code&gt;false&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.cors.allow-origin&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;定义允许哪些源请求。可以使用正则表达式，例如&lt;code&gt;/https?:\/\/localhost(:[0-9]+)?/&lt;/code&gt;可设置支持本地HTTP和HTTPS请求。也可以设置为&lt;code&gt;*&lt;/code&gt;,但是会存在安全隐患，因为任何来源都可访问Elasticsearch(以下简称为Es)实例。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.cors.max-age&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;浏览器会发送一个“预检”的OPTIONS请求，来检查CORS设置。&lt;code&gt;max-age&lt;/code&gt;定义应该缓存多长时间的结果。默认为&lt;code&gt;1728000&lt;/code&gt;（20天）&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.cors.allow-methods&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;定义了允许的请求方式，默认允许&lt;code&gt;OPTIONS&lt;/code&gt;, &lt;code&gt;HEAD&lt;/code&gt;, &lt;code&gt;GET&lt;/code&gt;, &lt;code&gt;POST&lt;/code&gt;, &lt;code&gt;PUT&lt;/code&gt;, &lt;code&gt;DELETE&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.cors.allow-headers&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;定义了允许的请求头信息。默认允许&lt;code&gt;X-Requested-With&lt;/code&gt;, &lt;code&gt;Content-Type&lt;/code&gt;, &lt;code&gt;Content-Length&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.cors.allow-credentials&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;是否返回设置的&lt;code&gt;Access-Control-Allow-Credentials&lt;/code&gt;头信息。默认为false&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.detailed_errors.enabled&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;是否输出详细的错误信息和堆栈。默认为&lt;code&gt;true&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.pipelining&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;是否启用HTTP管道支持, 默认为true&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.pipelining.max_events&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;在一个HTTP连接被关闭之前内存队列中允许的最大的事件数量，默认为&lt;code&gt;10000&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;该模块也可使用一些公共的网络配置(见网络设置一节)。&lt;/p&gt;
&lt;h4 id=&quot;禁用HTTP&quot;&gt;&lt;a href=&quot;#禁用HTTP&quot; class=&quot;headerlink&quot; title=&quot;禁用HTTP&quot;&gt;&lt;/a&gt;禁用HTTP&lt;/h4&gt;&lt;p&gt;HTTP模块可以通过将&lt;code&gt;http.enable&lt;/code&gt;设置为false来禁用。Es节点(和Java客户端)的内部通信使用transport接口，而非HTTP。这意味着我们可以将不接受直接REST请求的节点的HTTP禁用。比如，可以将数据节点的http禁用，创建非数据节点用来处理所有的REST请求。需要注意的是，不能向一个已经禁用了HTTP的节点直接发送任何REST请求。&lt;/p&gt;
&lt;h3 id=&quot;Indices-索引模块&quot;&gt;&lt;a href=&quot;#Indices-索引模块&quot; class=&quot;headerlink&quot; title=&quot;Indices(索引模块)&quot;&gt;&lt;/a&gt;Indices(索引模块)&lt;/h3&gt;&lt;p&gt;官网对应链接：&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-indices.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Indices&lt;/a&gt;&lt;br&gt;这一模块可以对所有索引的索引相关配置进行全局控制。&lt;br&gt;相关的配置如下：&lt;/p&gt;
&lt;h4 id=&quot;Circuit-breaker-断路器&quot;&gt;&lt;a href=&quot;#Circuit-breaker-断路器&quot; class=&quot;headerlink&quot; title=&quot;Circuit breaker(断路器)&quot;&gt;&lt;/a&gt;Circuit breaker(断路器)&lt;/h4&gt;&lt;p&gt;官网对应链接：&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/circuit-breaker.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Circuit breaker&lt;/a&gt;&lt;br&gt;该模块用来限制内存的使用，避免出现内存溢出。&lt;br&gt;Es中包含多个Circuit breaker(断路器)用来阻止可能造成OutOfMemoryError异常的操作。此外，还有一个父级别断路器限制了可以使用的总内存。&lt;br&gt;这些配置都可通过&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-update-settings.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Cluster-update-settings&lt;/a&gt;动态更新。&lt;br&gt;&lt;strong&gt;父断路器&lt;/strong&gt;&lt;br&gt;父级别的断路器可以通过&lt;code&gt;indices.breaker.total.limit&lt;/code&gt;来设置，默认是JVM堆的70%&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Filed data断路器&lt;/strong&gt;&lt;br&gt;允许Es提前估计加载一个字段需要的内存，然后检查加载需要的fielddata会不会导致总的内存大小超过设置的百分比。这样可以预防在加载的过程中产生异常。默认的限制是60%的JVM堆，可以通过以下参数配置。&lt;br&gt;&lt;code&gt;indices.breaker.fielddata.limit&lt;/code&gt;：限制fielddata所能占用的最大内存，默认为JVM堆的60%&lt;br&gt;&lt;code&gt;indices.breaker.fielddata.overhead&lt;/code&gt;:一个常量。es将使用这个值乘以field实际的大小作Field估算值，默认为1.03&lt;br&gt;&lt;strong&gt;请求断路器&lt;/strong&gt;&lt;br&gt;允许Es阻止使用内存超过限制的请求。&lt;br&gt;&lt;code&gt;indices.breaker.request.limit&lt;/code&gt;:默认JVM堆的40%&lt;br&gt;&lt;code&gt;indices.breaker.request.overhead&lt;/code&gt;:一个常量。所有请求的预估内存乘以这个常量就是最终的估计值。默认为1&lt;/p&gt;
&lt;h4 id=&quot;Fielddata-cache-字段数据缓存&quot;&gt;&lt;a href=&quot;#Fielddata-cache-字段数据缓存&quot; class=&quot;headerlink&quot; title=&quot;Fielddata cache(字段数据缓存)&quot;&gt;&lt;/a&gt;Fielddata cache(字段数据缓存)&lt;/h4&gt;&lt;p&gt;限制内存中的数据缓存可以使用多大的堆内存&lt;br&gt;field data缓存主要用于针对一个字段排序和做聚合计算。为了快速的访问某些值，Es会将这些字段值加载到内存中。需要注意的是将字段加载到内存很耗费资源，所以官方建议保证有足够的内存，并且保持所有字段被加载。&lt;br&gt;field data内存的大小可通过&lt;code&gt;indices.fielddata.cache.size&lt;/code&gt;配置项控制。要注意的是，当这个缓存不够用时，为了腾出空间给新的缓存，原来缓存的字段会被挤出来，这会导致系统性能下降。&lt;br&gt;&lt;code&gt;indices.fielddata.cache.size&lt;/code&gt;:field data缓存的最大值。可以设为节点堆空间的30%，也可设置为一个确定的值，比如12GB。默认无限大，生产环境要注意设置这个值。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意：这些静态配置需要在集群的每一个节点上设置。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;监控field data&lt;/strong&gt;&lt;br&gt;可以通过&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-stats.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Node Stats API&lt;/a&gt;监控内存使用情况。&lt;/p&gt;
&lt;h4 id=&quot;Node-query-cache-查询缓存&quot;&gt;&lt;a href=&quot;#Node-query-cache-查询缓存&quot; class=&quot;headerlink&quot; title=&quot;Node query cache(查询缓存)&quot;&gt;&lt;/a&gt;Node query cache(查询缓存)&lt;/h4&gt;&lt;p&gt;配置缓存查询结果可以使用多少堆内存&lt;br&gt;查询缓存负责对查询结果进行缓存。每一个节点都有一个查询缓存，由所有分片共享。缓存采用LRU机制，将最近最少使用的内容替换成新数据。查询缓存只会缓存filter的内容。&lt;br&gt;下面的配置需要在集群的每一个节点上配置。&lt;br&gt;&lt;code&gt;indices.queries.cache.size&lt;/code&gt;: 控制过滤结果缓存的大小。默认是10%。也可设置为一个确定的值，如&lt;code&gt;512mb&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id=&quot;Indexing-buffer-索引缓冲&quot;&gt;&lt;a href=&quot;#Indexing-buffer-索引缓冲&quot; class=&quot;headerlink&quot; title=&quot;Indexing buffer(索引缓冲)&quot;&gt;&lt;/a&gt;Indexing buffer(索引缓冲)&lt;/h4&gt;&lt;p&gt;控制分配多少内存给索引进程&lt;br&gt;索引缓冲用来存储新索引的文档。当缓冲区满了时，缓冲的文档会被写到磁盘的一个段，划分到该节点的所有分片上。&lt;br&gt;以下这些静态配置需要在集群的每一个节点上设置。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;配置项&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;indices.memory.index_buffer_size&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;设置索引缓冲区的大小。可设置一个百分比或者字节大小。默认为10%，意味着节点的10%的&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;indices.memory.min_index_buffer_size&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;如果indices.memory.index_buffer_size被设置成了一个百分比，本配置项可以用来代表缓冲区的最小值，默认为48mb。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;indices.memory.max_index_buffer_size&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;如果indices.memory.index_buffer_size被设置成了一个百分比，本配置项可以用来代表缓冲区的最大值，默认无限大。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;indices.memory.min_shard_index_buffer_size&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;为每个分片自己的索引缓冲区设置最小值。默认4mb&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&quot;Shard-request-cache-分片请求缓存&quot;&gt;&lt;a href=&quot;#Shard-request-cache-分片请求缓存&quot; class=&quot;headerlink&quot; title=&quot;Shard request cache(分片请求缓存)&quot;&gt;&lt;/a&gt;Shard request cache(分片请求缓存)&lt;/h4&gt;&lt;p&gt;控制分片级别的查询缓存的行为。&lt;br&gt;当一个搜索请求是针对一个索引或者多个索引的时候，每一个涉及到的分片都会在本地进行搜索，然后把结果返回到协调节点，在由协调节点把这些结果合并到一起。由于分片缓存模块会将本地的查询结果缓存，所以频率高的搜索请求会立刻返回结果。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意：目前，请求缓存只缓存查询条件size=0的搜索，缓存的内容有hits.total, aggregations,suggestions，而不缓存原始的hits。并且通过now查询的结果也不缓存。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;只缓存查询条件size=0的搜索原因如下(引用自&lt;a href=&quot;https://github.com/chenryn/ELKstack-guide-cn/blob/master/elasticsearch/performance/cache.md&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ELKstack-guide-cn&lt;/a&gt;):ES对请求的处理过程是有不同类型的，默认的叫 query_then_fetch。在这种情况下，各数据节点处理检索请求后，返回的是只包含文档id和相关性分值的结果，这一段处理，叫做query阶段；汇聚到这份结果后，按照分值排序，得到一个全集群最终需要的文档id，再向对应节点发送一次文档获取请求，拿到文档内容，这一段处理，叫做 fetch阶段。两段都结束后才返回响应。&lt;br&gt;此外，还有DFS_query_then_fetch类型，提高小数据量时的精确度;query_and_fetch类型，在有明确routing时可以省略一个数据来回;count类型，不关心文档内容只需要计数时省略 fetch阶段;scan类型，批量获取数据省略query阶段，在reindex时就是使用这种类型。&lt;br&gt;回到query cache，这里这个query，就是处理过程中query阶段的意思。各个节点上的数据分片，会在处理完query阶段时，将得到的本分片有关该请求的计数值，缓存起来。&lt;br&gt;根据上面的请求类型介绍，显然,只有当?search_type=count的时候，这个query cache才能起到作用。&lt;br&gt;&lt;strong&gt;缓存失效&lt;/strong&gt;&lt;br&gt;在分片数据真正发生变化时刷新索引分片，缓存的结果会自动失效。刷新间隔越长缓存的数据越多。当缓存满了的时候，会将最少使用的数据删除。&lt;br&gt;缓存可以通过&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-clearcache.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;clear-cache API&lt;/a&gt;手动设置过期。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;curl -XPOST &lt;span class=&quot;string&quot;&gt;&#39;localhost:9200/kimchy,elasticsearch/_cache/clear?request_cache=true&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;默认启动缓存&lt;/strong&gt;&lt;br&gt;分片请求缓存默认是不启动的，但可以在创建新的索引时通过下面的方式启动：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;curl -XPUT localhost:9200/my_index &lt;span class=&quot;_&quot;&gt;-d&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &quot;settings&quot;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;index.requests.cache.enable&quot;: true&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;也可以通过&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-update-settings.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;update-settings API&lt;/a&gt;为就索引动态的启动和关闭缓存。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;curl -XPUT localhost:9200/my_index/_settings &lt;span class=&quot;_&quot;&gt;-d&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123; &quot;index.requests.cache.enable&quot;: true &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;为每个请求启动缓存&lt;/strong&gt;&lt;br&gt;可以在请求时通过请求参数&lt;code&gt;request_cache&lt;/code&gt;来为每个请求启动和关闭缓存。&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;curl &lt;span class=&quot;string&quot;&gt;&#39;localhost:9200/my_index/_search?request_cache=true&#39;&lt;/span&gt; &lt;span class=&quot;_&quot;&gt;-d&lt;/span&gt;&lt;span class=&quot;string&quot;&gt;&#39;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &quot;size&quot;: 0,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &quot;aggs&quot;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &quot;popular_colors&quot;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &quot;terms&quot;: &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &quot;field&quot;: &quot;colors&quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;      &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;缓存设置&lt;/strong&gt;&lt;br&gt;缓存是在节点级别管理，默认JVM堆内存的&lt;code&gt;1%&lt;/code&gt;。可在&lt;code&gt;config/elasticsearch.yml&lt;/code&gt;文件中更改。&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;indices.requests.cache.size: 2%&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;也可以通过&lt;code&gt;indices.requests.cache.expire&lt;/code&gt;设置缓存过期时间，但是没有必要，因为旧的结果会在索引刷新时自动失效。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;检测缓存使用&lt;/strong&gt;&lt;br&gt;可通过&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-stats.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;indices-stats API&lt;/a&gt;检测索引中缓存的使用情况&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;curl &lt;span class=&quot;string&quot;&gt;&#39;localhost:9200/_stats/request_cache?pretty&amp;amp;human&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;或通过&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-nodes-stats.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;nodes-stats API&lt;/a&gt;查看节点的使用情况。&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;curl &lt;span class=&quot;string&quot;&gt;&#39;localhost:9200/_nodes/stats/indices/request_cache?pretty&amp;amp;human&#39;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;Indices-Recovery-索引恢复&quot;&gt;&lt;a href=&quot;#Indices-Recovery-索引恢复&quot; class=&quot;headerlink&quot; title=&quot;Indices Recovery(索引恢复)&quot;&gt;&lt;/a&gt;Indices Recovery(索引恢复)&lt;/h4&gt;&lt;p&gt;限制分片恢复进程的资源&lt;br&gt;以下的配置用来管理恢复策略：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;配置项&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;indices.recovery.concurrent_streams&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;默认是3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;indices.recovery.concurrent_small_file_streams&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;默认2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;indices.recovery.file_chunk_size&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;默认512kb&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;indices.recovery.translog_ops&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;默认1000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;indices.recovery.translog_size&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;默认512kb&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;indices.recovery.compress&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;默认true&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;indices.recovery.max_bytes_per_sec&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;默认40mb&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;这些配置都可通过&lt;a href=&quot;https://www.elastic.co/guide/en/elasticsearch/reference/current/cluster-update-settings.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Cluster-update-settings&lt;/a&gt;动态更新。&lt;/p&gt;
&lt;h4 id=&quot;TTL-interval&quot;&gt;&lt;a href=&quot;#TTL-interval&quot; class=&quot;headerlink&quot; title=&quot;TTL interval&quot;&gt;&lt;/a&gt;TTL interval&lt;/h4&gt;&lt;p&gt;控制过期文档的删除&lt;br&gt;设有ttl值的文档会在过期之后被删除。以下动态配置控制了删除文档的检查间隔，和批量删除的大小。&lt;br&gt;&lt;code&gt;indices.ttl.interval&lt;/code&gt;：删除进程启动间隔。默认60s&lt;br&gt;&lt;code&gt;indices.ttl.bulk_size&lt;/code&gt;：删除进程的数量。默认为1000&lt;/p&gt;
&lt;h3 id=&quot;NetWork-Settings-网络设置&quot;&gt;&lt;a href=&quot;#NetWork-Settings-网络设置&quot; class=&quot;headerlink&quot; title=&quot;NetWork Settings(网络设置)&quot;&gt;&lt;/a&gt;NetWork Settings(网络设置)&lt;/h3&gt;&lt;p&gt;Es默认只和localhost绑定。如果想要在多个服务器上启动生产环境的集群需要配置一些基本的网络设置。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意：要小心使用网络配置，不要将不受保护的节点暴露在公共网络中。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;常用的网络设置&quot;&gt;&lt;a href=&quot;#常用的网络设置&quot; class=&quot;headerlink&quot; title=&quot;常用的网络设置&quot;&gt;&lt;/a&gt;常用的网络设置&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;配置项&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;network.host&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;将节点绑定到设置的hostname或ip地址，并通知集群中的其他节点。该配置项接受IP地址，主机名，一些特定值(见下一个表)和由上面几项组成的数组。默认为&lt;code&gt;_local_&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;discovery.zen.ping.unicast.hosts&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;如果一个节点加入一个集群，需要知道集群中其他节点hostname和ip地址。本配置项为节点提供了其他节点的初始列表。默认&lt;code&gt;[&amp;quot;127.0.0.1&amp;quot;,&amp;quot;[::1]&amp;quot;]&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;http.port&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;为HTTP请求绑定端口，可设置单个端口，也可设置一个范围。如果设定了一个范围，节点会绑定在范围中第一个可用的端口。默认&lt;code&gt;9200-9300&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;transport.tcp.port&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;节点间内部通信绑定的端口，可设置单个端口，也可设置一个范围。如果设定了一个范围，节点会绑定在范围中第一个可用的端口。默认&lt;code&gt;9300-9400&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&quot;network-host可使用的一些特殊值&quot;&gt;&lt;a href=&quot;#network-host可使用的一些特殊值&quot; class=&quot;headerlink&quot; title=&quot;network.host可使用的一些特殊值&quot;&gt;&lt;/a&gt;&lt;code&gt;network.host&lt;/code&gt;可使用的一些特殊值&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;特殊值&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;_[networkInterface]_&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;指定网卡的IP地址，如_en0_&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;_local_&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;本机ip地址，如127.0.0.1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;_site_&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;任意一个site-local地址，如192.168.0.1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;_global_&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;任意一个globally-scoped地址，如8.8.8.8&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;IPv4 vs IPv6&lt;/strong&gt;&lt;br&gt;以上特殊值默认在IPV4和IPv6下均可使用，可以通过:ipv4和:ipv6标识符来做限制。例如,&lt;code&gt;_en0:ipv4_&lt;/code&gt;。&lt;/p&gt;
&lt;h4 id=&quot;高级网络设置&quot;&gt;&lt;a href=&quot;#高级网络设置&quot; class=&quot;headerlink&quot; title=&quot;高级网络设置&quot;&gt;&lt;/a&gt;高级网络设置&lt;/h4&gt;&lt;p&gt;常用网络设置一节中提到的&lt;code&gt;network.host&lt;/code&gt;配置项只是一个为了同时设置&lt;code&gt;band_host&lt;/code&gt;和&lt;code&gt;publish_host&lt;/code&gt;的快捷设置。为了一下更复杂的情况，比如在一个代理服务器后运行节点，可能需要一些不同的配置。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;配置项&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;network.bind_host&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;设置节点绑定的ip地址，用来监听请求。默认&lt;code&gt;network.host&lt;/code&gt;。&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;network.publish_host&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;配置其他节点与本节点通信的地址，默认为&lt;code&gt;network.bind_host&lt;/code&gt;中的最佳地址。&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;以上配置都和&lt;code&gt;network.host&lt;/code&gt;一样，可配置ip地址，hostname和某些特殊值。&lt;/p&gt;
&lt;h4 id=&quot;高级TCP设置&quot;&gt;&lt;a href=&quot;#高级TCP设置&quot; class=&quot;headerlink&quot; title=&quot;高级TCP设置&quot;&gt;&lt;/a&gt;高级TCP设置&lt;/h4&gt;&lt;p&gt;任何使用TCP的模块（如HTTP和Transport）共享以下的配置。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;配置项&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;含义&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;network.tcp.no_delay&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;是否启用&lt;a href=&quot;https://en.wikipedia.org/wiki/Nagle%27s_algorithm&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;TCP no delay&lt;/a&gt;。默认为&lt;code&gt;true&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;network.tcp.keep_alive&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;是否启用&lt;a href=&quot;https://en.wikipedia.org/wiki/Keepalive&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;TCP keep alive&lt;/a&gt;。默认为&lt;code&gt;true&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;network.tcp.reuse_address&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;一个地址是否可以重复使用&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;network.tcp.send_buffer_size&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;TCP发送缓冲区的大小，默认不设置&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;network.tcp.receive_buffer_size&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;TCP接收缓冲区的大小，默认不设置&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&quot;Transport和HTTP协议&quot;&gt;&lt;a href=&quot;#Transport和HTTP协议&quot; class=&quot;headerlink&quot; title=&quot;Transport和HTTP协议&quot;&gt;&lt;/a&gt;Transport和HTTP协议&lt;/h4&gt;&lt;p&gt;Es会基于上面的配置暴露两种网络协议，它们也可以进一步独立配置。&lt;br&gt;&lt;strong&gt;TCP transport&lt;/strong&gt; 用于节点之间通信 具体可见Transport模块一节。&lt;br&gt;&lt;strong&gt;HTTP&lt;/strong&gt; 用于暴露基于JSON的http接口。具体可见HTTP模块一节。&lt;/p&gt;
&lt;p&gt;都看到这了，听首歌再走吧。分享首适合抖腿的歌，写博客时听这种歌真是分分钟都要把键盘按穿。。。&lt;/p&gt;
&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;http://music.163.com/outchain/player?type=2&amp;id=26095964&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;










</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;近两周线上的搜索接口间隔性莫名其妙的出现莫名其妙的异常，比如神马NoAvailableThread，NoAvailableWorker之类的。可能是由于部门中没有很懂elasticsearch的人，只能摸着石头过河，所以一直使用elasticsearch的默认配置并没有对其线程池和内存分配进行优化造成的。所以按照官方文档(版本2.2)和一些参考资料整理一下elasticsearch的可配置项，看看可不可以优化一下。先整理了Local gateway,HTTP,Indices,Network Settings四个模块的可配置项，其他模块(比如Cluster)会在之后慢慢整理的。本文只包含四个模块可用配置项的含义及用法，并不涉及应该如何优化，这是为什么呢？因为俺也不会。。。。。(欢迎指正错误，康桑阿米达)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;相关博客：&lt;a href=&quot;http://yemengying.com/2016/03/21/elasticsearch-settings2/&quot;&gt;elasticsearch 配置项(二)&lt;/a&gt;&lt;br&gt;
    
    </summary>
    
      <category term="elasticsearch" scheme="http://yemengying.com/categories/elasticsearch/"/>
    
    
      <category term="elasticsearch" scheme="http://yemengying.com/tags/elasticsearch/"/>
    
  </entry>
  
  <entry>
    <title>疯狂动物城</title>
    <link href="http://yemengying.com/2016/03/15/zootopia/"/>
    <id>http://yemengying.com/2016/03/15/zootopia/</id>
    <published>2016-03-15T04:44:12.000Z</published>
    <updated>2016-03-15T13:08:24.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;真的是太喜欢疯狂动物城这部电影了，二刷之后还是想去电影院接着看，对这种毛茸茸的小动物真是一点抵抗力都没有，尤其是苏苏的狐尼克。放点网上搜来的图(权侵删)，方便看到它们，哇咔咔咔咔。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;110&quot; src=&quot;http://music.163.com/outchain/player?type=1&amp;id=3443094&amp;auto=0&amp;height=90&quot;&gt;&lt;/iframe&gt;


&lt;p&gt;&lt;strong&gt;蠢萌蠢萌，慢的出奇，戳中笑点的树懒flash&lt;/strong&gt;&lt;br&gt;&lt;img src=&quot;/images/zootopia/flash1.gif&quot; alt=&quot;flash 1&quot;&gt;&lt;br&gt;&lt;img src=&quot;/images/zootopia/flash2.gif&quot; alt=&quot;flash 2&quot;&gt;&lt;br&gt;&lt;img src=&quot;/images/zootopia/flash3.gif&quot; alt=&quot;flash 3&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;被圈饭的兔狐CP&lt;/strong&gt;&lt;br&gt;&lt;img src=&quot;/images/zootopia/nick&amp;amp;judy2.gif&quot; alt=&quot;狐尼克&amp;amp;兔朱迪&quot;&gt;&lt;br&gt;&lt;img src=&quot;/images/zootopia/nick&amp;amp;judy1.gif&quot; alt=&quot;狐尼克&amp;amp;兔朱迪&quot;&gt;&lt;br&gt;&lt;img src=&quot;/images/zootopia/nick&amp;amp;judy3.gif&quot; alt=&quot;狐尼克&amp;amp;兔朱迪&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;最爱的狐尼克&lt;/strong&gt;&lt;br&gt;&lt;img src=&quot;/images/zootopia/nick2.jpg&quot; alt=&quot;狐尼克&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;勇敢的兔朱迪&lt;/strong&gt;&lt;br&gt;&lt;img src=&quot;/images/zootopia/judy1.gif&quot; alt=&quot;兔朱迪&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;致敬教父的Mr. Big&lt;/strong&gt;&lt;br&gt;&lt;img src=&quot;/images/zootopia/MrBig.jpg&quot; alt=&quot;Mr Big&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;少女心的豹警官&lt;/strong&gt;&lt;br&gt;&lt;img src=&quot;/images/zootopia/bao1.gif&quot; alt=&quot;萌萌的豹豹1&quot;&gt;&lt;br&gt;&lt;img src=&quot;/images/zootopia/bao2.gif&quot; alt=&quot;萌萌的豹豹2&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;大合照&lt;/strong&gt;&lt;br&gt;&lt;img src=&quot;/images/zootopia/zootopia.jpg&quot; alt=&quot;zootopia&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;从冰雪奇缘到超能陆战队再到疯狂动物城，不得不说迪斯尼的动画越来越好看了。好的动画片真的是老少皆宜的，让人在捧腹大笑的同时又能有所思考，不管是关于消除偏见，梦想还是成长~~~~。&lt;/p&gt;
&lt;/blockquote&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;真的是太喜欢疯狂动物城这部电影了，二刷之后还是想去电影院接着看，对这种毛茸茸的小动物真是一点抵抗力都没有，尤其是苏苏的狐尼克。放点网上搜来的图(权侵删)，方便看到它们，哇咔咔咔咔。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="随笔" scheme="http://yemengying.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="随笔" scheme="http://yemengying.com/tags/%E9%9A%8F%E7%AC%94/"/>
    
      <category term="电影" scheme="http://yemengying.com/tags/%E7%94%B5%E5%BD%B1/"/>
    
  </entry>
  
  <entry>
    <title>Java 8 --行为参数化(behavior parameterization)</title>
    <link href="http://yemengying.com/2016/02/20/Java-8-%E8%A1%8C%E4%B8%BA%E5%8F%82%E6%95%B0%E5%8C%96-behavior-parameterization/"/>
    <id>http://yemengying.com/2016/02/20/Java-8-行为参数化-behavior-parameterization/</id>
    <published>2016-02-20T11:33:21.000Z</published>
    <updated>2016-04-22T13:44:59.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;根据书 &amp;lt;&amp;lt; Java 8 in action &amp;gt;&amp;gt;第二章的一个例子整理。书中通过一个例子，讲述了如何利用behavior parameterization来应对不停变化的需求。想想之前自己写的工具类，真是大写的Low啊。。。。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;题外话：要时刻谨记 Later equals never,Later equals never,Later equals never！！！！！！！&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;http://music.163.com/outchain/player?type=2&amp;id=35090760&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;



&lt;h3 id=&quot;行为参数化&quot;&gt;&lt;a href=&quot;#行为参数化&quot; class=&quot;headerlink&quot; title=&quot;行为参数化&quot;&gt;&lt;/a&gt;行为参数化&lt;/h3&gt;&lt;p&gt;在软件开发中，一个众所周知的问题就是无论你做什么,用户的需求总会改变。举个栗子，假设要做一个帮助农场主理解库存的应用。一开始，农场主可能想有一个在所有库存中找出所有绿色苹果的功能。但是第二天他可能会告诉你他还想要找到所有重量大于150g的苹果。两天后，他可能又提出找到所有绿色的并且重量大于150g的苹果。在面对这些相似的新功能时，我们都想尽可能的减少开发量。&lt;br&gt;&lt;strong&gt;behavior parameterization&lt;/strong&gt;是用来处理频繁更改的需求的一种软件开发模式，可以将一段代码块当做参数传给另一个方法，之后执行。这样做的好处是，方法的行为可以由传入的代码块控制。&lt;/p&gt;
&lt;h3 id=&quot;例子&quot;&gt;&lt;a href=&quot;#例子&quot; class=&quot;headerlink&quot; title=&quot;例子&quot;&gt;&lt;/a&gt;例子&lt;/h3&gt;&lt;p&gt;下面通过农场应用来看看面对不断改变的需求如何将代码写的更灵活。先实现第一个功能:从一个list中过滤出所有的绿色苹果,听起来是不是很简单。&lt;/p&gt;
&lt;h4 id=&quot;版本1-：-过滤出绿色苹果&quot;&gt;&lt;a href=&quot;#版本1-：-过滤出绿色苹果&quot; class=&quot;headerlink&quot; title=&quot;版本1 ： 过滤出绿色苹果&quot;&gt;&lt;/a&gt;版本1 ： 过滤出绿色苹果&lt;/h4&gt;&lt;p&gt;最开始想到的解决办法可能长下面的样子：&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; List&amp;lt;Apple&amp;gt; &lt;span class=&quot;title&quot;&gt;filterGreenApples&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(List&amp;lt;Apple&amp;gt; inventory)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        List&amp;lt;Apple&amp;gt; result = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;(); &lt;span class=&quot;comment&quot;&gt;// An accumulator list for apples&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(Apple apple : inventory)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;( &lt;span class=&quot;string&quot;&gt;&quot;green&quot;&lt;/span&gt;.equals(apple.getColor()))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                &lt;span class=&quot;comment&quot;&gt;// Select only green apples&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                result.add(apple);     &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;上面的方法可以过滤出绿色的苹果，但是如果农场主还想知道红色的苹果呢？一个很幼稚的做法是将上面的方法复制一遍，命名为filterRedApples，更改一下if语句。但如果还想知道黄色的呢？一个好的做法是：试着抽象。&lt;/p&gt;
&lt;h4 id=&quot;版本2-：-将颜色作为参数&quot;&gt;&lt;a href=&quot;#版本2-：-将颜色作为参数&quot; class=&quot;headerlink&quot; title=&quot;版本2 ： 将颜色作为参数&quot;&gt;&lt;/a&gt;版本2 ： 将颜色作为参数&lt;/h4&gt;&lt;p&gt;可以在方法中加入颜色作为参数，使代码更灵活。&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; List&amp;lt;Apple&amp;gt; &lt;span class=&quot;title&quot;&gt;filterApplesByColor&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(List&amp;lt;Apple&amp;gt; inventory,String color)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        List&amp;lt;Apple&amp;gt; result = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Apple apple: inventory)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( apple.getColor().equals(color) ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                result.add(apple);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这样就可以灵活的根据颜色来筛选。这时农场主又提出了根据重量筛选，于是参照上面根据颜色筛选的方法又新增了一个根据重量筛选的方法，如下：&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; List&amp;lt;Apple&amp;gt; &lt;span class=&quot;title&quot;&gt;filterApplesByWeight&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(List&amp;lt;Apple&amp;gt; inventory,&lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; weight)&lt;/span&gt; &lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        List&amp;lt;Apple&amp;gt; result = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; (Apple apple: inventory)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; ( apple.getWeight()&amp;gt;weight ) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                result.add(apple);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;这是一个解决办法，但考虑到苹果有许多其它特性，如果针对每一特性的筛选都复制一个方法，违背了DRY(don’t repeat yourself)原则.我们可以将颜色和重量结合到一个方法，并通过一个标记来指明想要进行过滤的是颜色还是重量(这样做其实很不好，之后会解释)。&lt;/p&gt;
&lt;h4 id=&quot;版本3-：-在一个方法中过滤想要过滤的属性&quot;&gt;&lt;a href=&quot;#版本3-：-在一个方法中过滤想要过滤的属性&quot; class=&quot;headerlink&quot; title=&quot;版本3 ： 在一个方法中过滤想要过滤的属性&quot;&gt;&lt;/a&gt;版本3 ： 在一个方法中过滤想要过滤的属性&lt;/h4&gt;&lt;p&gt;下面在一个方法中根据flag值的不同过滤不同的属性(这样做法很不好)。&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; List&amp;lt;Apple&amp;gt; &lt;span class=&quot;title&quot;&gt;filterApples&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(List&amp;lt;Apple&amp;gt; inventory,String color, &lt;span class=&quot;keyword&quot;&gt;int&lt;/span&gt; weight, &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; flag)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        List&amp;lt;Apple&amp;gt; result = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(Apple apple : inventory)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;((flag&amp;amp;&amp;amp;apple.getColor().equals(color)) || &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                    (!flag &amp;amp;&amp;amp; apple.getWeight() &amp;gt; weight))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;                result.add(apple);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;上面的代码很丑陋而且也没有解决需求变化的问题，比如如果农场主还想要根据大小，产地，形状来筛选就不适用了。&lt;/p&gt;
&lt;h4 id=&quot;版本4-：-根据抽象约束过滤&quot;&gt;&lt;a href=&quot;#版本4-：-根据抽象约束过滤&quot; class=&quot;headerlink&quot; title=&quot;版本4 ： 根据抽象约束过滤&quot;&gt;&lt;/a&gt;版本4 ： 根据抽象约束过滤&lt;/h4&gt;&lt;p&gt;一个更好的解决办法是将过滤的标准抽象出来，我们先定义一个接口作为抽象的选择标准.&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ApplePredicate&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Apple apple)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;接下来就可以定义多个ApplePredicate接口的实现类来代表不同的过滤标准。如下图:&lt;br&gt;&lt;img src=&quot;/images/behavior.jpg&quot; alt=&quot;abstract criteria&quot;&gt;&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//select only heavy apple&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;AppleHeavyWeightPredicate&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ApplePredicate&lt;/span&gt;&lt;/span&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Apple apple)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; apple.getWeight() &amp;gt; &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;//select only green apple&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;AppleGreenColorPredicate&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ApplePredicate&lt;/span&gt;&lt;/span&gt;&amp;#123; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Apple apple)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;green&quot;&lt;/span&gt;.equals(apple.getColor);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;上面每一个实现了ApplePredicate接口的类都代表了一种筛选策略。在此基础上，我们可以将筛选方法修改成下面的样子,将ApplePredicate作为参数传入。&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; List&amp;lt;Apple&amp;gt; &lt;span class=&quot;title&quot;&gt;filterApples&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(List&amp;lt;Apple&amp;gt; inventory, ApplePredicate p)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	List&amp;lt;Apple&amp;gt; result = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(Apple apple : inventory)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(p.test(apple))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			result.add(apple);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;现在的筛选方法比第一个版本灵活多了，如果想改变筛选标准，只需创建不同的ApplePredicate对象，并传入filterApples方法即可。例如新增了选出红色并且重量大于150g的苹果的需求，我们可以创建一个实现ApplePredicate接口的类即可，代码如下:&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;AppleRedAndHeavyPredicate&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;implements&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;ApplePredicate&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Apple apple)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;.equals(apple.getColor()) &amp;amp;&amp;amp; apple.getWeight() &amp;gt; &lt;span class=&quot;number&quot;&gt;150&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;List&amp;lt;Apple&amp;gt; redAndHeavyApples = filter(inventory, &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; AppleRedAndHeavyPredicate());&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;但是上面的实现有一个缺点，就是太啰嗦了，每新增一个筛选标准都要新增一个类。下面来继续优化一下。&lt;/p&gt;
&lt;h4 id=&quot;版本5-：-使用匿名类&quot;&gt;&lt;a href=&quot;#版本5-：-使用匿名类&quot; class=&quot;headerlink&quot; title=&quot;版本5 ： 使用匿名类&quot;&gt;&lt;/a&gt;版本5 ： 使用匿名类&lt;/h4&gt;&lt;p&gt;匿名类是没有名字的类，使用匿名类可以创建一个临时的实现。下面的代码展示了如何利用匿名类创建实现了ApplePredicate的对象。&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;List&amp;lt;Apple&amp;gt; redApples = filterApples(inventory, &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ApplePredicate()&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(Apple apple)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;.equals(apple.getColor());&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;但是尽管匿名类解决了为一个接口声明多个实现类的问题，使用匿名类还不足够好。使用匿名类代码看起来有些笨重，可读性差，而且有一些开发者对匿名类感到困惑。下面我们使用Java 8引入的lambda表达式使代码看起来更加简洁一点。&lt;/p&gt;
&lt;h4 id=&quot;版本6-：-使用lambda表达式&quot;&gt;&lt;a href=&quot;#版本6-：-使用lambda表达式&quot; class=&quot;headerlink&quot; title=&quot;版本6 ： 使用lambda表达式&quot;&gt;&lt;/a&gt;版本6 ： 使用lambda表达式&lt;/h4&gt;&lt;p&gt;我们可以使用lambda表达式简化代码.&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;List&amp;lt;Apple&amp;gt; result = filterApples(inventory,(Apple apple) -&amp;gt; &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;.equals(apple.getColor()));&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h4 id=&quot;最终版-：-使用泛型，抽象列表的类型&quot;&gt;&lt;a href=&quot;#最终版-：-使用泛型，抽象列表的类型&quot; class=&quot;headerlink&quot; title=&quot;最终版 ： 使用泛型，抽象列表的类型&quot;&gt;&lt;/a&gt;最终版 ： 使用泛型，抽象列表的类型&lt;/h4&gt;&lt;p&gt;我们可以继续做一些抽象。目前，filterApples方法只可以过滤元素类型为Apple的List。我们可以将列表的类型抽象出来，使得我们的过滤方法变得更加通用，代码如下：&lt;br&gt;&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;class&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;interface&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;Predicate&lt;/span&gt;&amp;lt;&lt;span class=&quot;title&quot;&gt;T&lt;/span&gt;&amp;gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(T t)&lt;/span&gt;&lt;/span&gt;;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;pucblic &lt;span class=&quot;keyword&quot;&gt;static&lt;/span&gt; &amp;lt;T&amp;gt; &lt;span class=&quot;function&quot;&gt;List&amp;lt;T&amp;gt; &lt;span class=&quot;title&quot;&gt;filter&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;(List&amp;lt;T&amp;gt; list, Predicate&amp;lt;T&amp;gt; p)&lt;/span&gt;&lt;/span&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	List&amp;lt;T&amp;gt; result = &lt;span class=&quot;keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&amp;gt;();&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt;(T e: list)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt;(p.test(e))&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;			result.add(e);&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;		&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;	&lt;span class=&quot;keyword&quot;&gt;return&lt;/span&gt; result;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;这样就可以对多种类型的list进行过滤了：&lt;/p&gt;
&lt;figure class=&quot;highlight java&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;List&amp;lt;Apple&amp;gt; redApples = filter(inventory, (Apple apple) -&amp;gt; &lt;span class=&quot;string&quot;&gt;&quot;red&quot;&lt;/span&gt;.equals(apple.getColor()));&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;List&amp;lt;String&amp;gt; evenNumber = filter(numbers, (Integer i) -&amp;gt; i%&lt;span class=&quot;number&quot;&gt;2&lt;/span&gt; == &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;终于over了，拖延癌果真已经到了晚期。。。。。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/delay.jpg&quot; alt=&quot;do it now&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;根据书 &amp;lt;&amp;lt; Java 8 in action &amp;gt;&amp;gt;第二章的一个例子整理。书中通过一个例子，讲述了如何利用behavior parameterization来应对不停变化的需求。想想之前自己写的工具类，真是大写的Low啊。。。。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;题外话：要时刻谨记 Later equals never,Later equals never,Later equals never！！！！！！！&lt;/p&gt;
    
    </summary>
    
      <category term="java" scheme="http://yemengying.com/categories/java/"/>
    
    
      <category term="java" scheme="http://yemengying.com/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>[译]Java 8中HashMap和LinkedHashMap如何解决冲突</title>
    <link href="http://yemengying.com/2016/02/03/%E8%AF%91-Java%E4%B8%ADHashMap%E5%92%8CLinkedHashMap%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%86%B2%E7%AA%81/"/>
    <id>http://yemengying.com/2016/02/03/译-Java中HashMap和LinkedHashMap如何解决冲突/</id>
    <published>2016-02-03T08:23:39.000Z</published>
    <updated>2016-04-22T13:44:14.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;原文来自一个java大牛的博客 原文地址&lt;a href=&quot;http://javarevisited.blogspot.jp/2016/01/how-does-java-hashmap-or-linkedhahsmap-handles.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;http://javarevisited.blogspot.jp/2016/01/how-does-java-hashmap-or-linkedhahsmap-handles.html&lt;/a&gt; 博客讲解了Java 8中HashMap和LinkedHashMap是如何解决冲突的。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;p&gt;在Java 8 之前，HashMap和其他基于map的类都是通过链地址法解决冲突，它们使用单向链表来存储相同索引值的元素。在最坏的情况下，这种方式会将HashMap的get方法的性能从O(1)降低到O(n)。为了解决在频繁冲突时hashmap性能降低的问题，Java 8中使用平衡树来替代链表存储冲突的元素。这意味着我们可以将最坏情况下的性能从O(n)提高到O(logn)。&lt;br&gt;在Java 8中使用常量&lt;strong&gt;TREEIFY_THRESHOLD&lt;/strong&gt;来控制是否切换到平衡树来存储。目前，这个常量值是8，这意味着当有超过8个元素的索引一样时，HashMap会使用树来存储它们。&lt;br&gt;这一改变是为了继续优化常用类。大家可能还记得在Java 7中为了优化常用类对ArrayList和HashMap采用了延迟加载的机制，在有元素加入之前不会分配内存，这会减少空的链表和HashMap占用的内存。&lt;br&gt;这一动态的特性使得HashMap一开始使用链表，并在冲突的元素数量超过指定值时用平衡二叉树替换链表。不过这一特性在所有基于hash table的类中并没有，例如Hashtable和WeakHashMap。&lt;br&gt;目前，只有&lt;strong&gt;ConcurrentHashMap&lt;/strong&gt;,&lt;strong&gt;LinkedHashMap&lt;/strong&gt;和&lt;strong&gt;HashMap&lt;/strong&gt;会在频繁冲突的情况下使用平衡树。&lt;/p&gt;
&lt;h3 id=&quot;什么时候会产生冲突&quot;&gt;&lt;a href=&quot;#什么时候会产生冲突&quot; class=&quot;headerlink&quot; title=&quot;什么时候会产生冲突&quot;&gt;&lt;/a&gt;什么时候会产生冲突&lt;/h3&gt;&lt;p&gt;HashMap中调用&lt;strong&gt;hashCode()&lt;/strong&gt;方法来计算hashCode。&lt;br&gt;由于在Java中两个不同的对象可能有一样的hashCode,所以不同的键可能有一样hashCode，从而导致冲突的产生。&lt;/p&gt;
&lt;h3 id=&quot;总结&quot;&gt;&lt;a href=&quot;#总结&quot; class=&quot;headerlink&quot; title=&quot;总结&quot;&gt;&lt;/a&gt;总结&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;HashMap在处理冲突时使用链表存储相同索引的元素。&lt;/li&gt;
&lt;li&gt;从Java 8开始，HashMap，ConcurrentHashMap和LinkedHashMap在处理频繁冲突时将使用平衡树来代替链表，当同一hash桶中的元素数量超过特定的值便会由链表切换到平衡树，这会将get()方法的性能从O(n)提高到O(logn)。&lt;/li&gt;
&lt;li&gt;当从链表切换到平衡树时，HashMap迭代的顺序将会改变。不过这并不会造成什么问题，因为HashMap并没有对迭代的顺序提供任何保证。&lt;/li&gt;
&lt;li&gt;从Java 1中就存在的Hashtable类为了保证迭代顺序不变，即便在频繁冲突的情况下也不会使用平衡树。这一决定是为了不破坏某些较老的需要依赖于Hashtable迭代顺序的Java应用。&lt;/li&gt;
&lt;li&gt;除了Hashtable之外，WeakHashMap和IdentityHashMap也不会在频繁冲突的情况下使用平衡树。&lt;/li&gt;
&lt;li&gt;使用HashMap之所以会产生冲突是因为使用了键对象的hashCode()方法，而equals()和hashCode()方法不保证不同对象的hashCode是不同的。需要记住的是，相同对象的hashCode一定是相同的，但相同的hashCode不一定是相同的对象。&lt;/li&gt;
&lt;li&gt;在HashTable和HashMap中，冲突的产生是由于不同对象的hashCode()方法返回了一样的值。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以上就是Java中HashMap如何处理冲突。这种方法被称为链地址法，因为使用链表存储同一桶内的元素。通常情况HashMap，HashSet，LinkedHashSet，LinkedHashMap，ConcurrentHashMap，HashTable，IdentityHashMap和WeakHashMap均采用这种方法处理冲突。&lt;/p&gt;
&lt;p&gt;从JDK 8开始，HashMap，LinkedHashMap和ConcurrentHashMap为了提升性能，在频繁冲突的时候使用平衡树来替代链表。因为HashSet内部使用了HashMap，LinkedHashSet内部使用了LinkedHashMap，所以他们的性能也会得到提升。&lt;/p&gt;
&lt;h3 id=&quot;相关阅读&quot;&gt;&lt;a href=&quot;#相关阅读&quot; class=&quot;headerlink&quot; title=&quot;相关阅读&quot;&gt;&lt;/a&gt;相关阅读&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://www.amazon.com/Data-Structures-Algorithms-Michael-Goodrich/dp/0470383267?tag=javamysqlanta-20&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Data Structure and Algorithm in Java&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://www.amazon.com/Java-Performance-The-Definitive-Guide/dp/1449358454?tag=javamysqlanta-20&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Java Performance The Definitive Guide&lt;/a&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;原文来自一个java大牛的博客 原文地址&lt;a href=&quot;http://javarevisited.blogspot.jp/2016/01/how-does-java-hashmap-or-linkedhahsmap-handles.html&quot;&gt;http://javarevisited.blogspot.jp/2016/01/how-does-java-hashmap-or-linkedhahsmap-handles.html&lt;/a&gt; 博客讲解了Java 8中HashMap和LinkedHashMap是如何解决冲突的。&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="java" scheme="http://yemengying.com/categories/java/"/>
    
      <category term="hashmap" scheme="http://yemengying.com/categories/java/hashmap/"/>
    
    
      <category term="java" scheme="http://yemengying.com/tags/java/"/>
    
      <category term="翻译" scheme="http://yemengying.com/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>最近看的书</title>
    <link href="http://yemengying.com/2016/01/19/%E6%9C%80%E8%BF%91%E7%9C%8B%E7%9A%84%E4%B9%A6/"/>
    <id>http://yemengying.com/2016/01/19/最近看的书/</id>
    <published>2016-01-19T06:34:13.000Z</published>
    <updated>2016-04-22T13:44:30.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;自从去年8月份之后真是变成了个爱看书のgirl，算是*%^&amp;amp;#$带来的唯一好处吧，是时候整理一发啦。不过，要按什么分类呢，技术和非技术，看完和没看完，好看和不好看还是外文和中文？好乱。。。。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;算了 还是不分了随便列吧。。。。&lt;br&gt;&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&quot;Flipped-怦然心动&quot;&gt;&lt;a href=&quot;#Flipped-怦然心动&quot; class=&quot;headerlink&quot; title=&quot;Flipped(怦然心动)&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://www.amazon.cn/Flipped-Van-Draanen-Wendelin/dp/0375825444/ref=sr_1_1?ie=UTF8&amp;amp;qid=1453186195&amp;amp;sr=8-1&amp;amp;keywords=flipped&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Flipped(怦然心动)&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/flipped.png&quot; alt=&quot;flipped&quot;&gt;&lt;br&gt;一本讲两个小学生初恋的英文小说，适合放松的时候看看。虽然已经看过了电影，再看小说还是觉得很美好，成功唤醒了我那颗沉睡已久的少女心。女主性格超级可爱，男主虽然一开始挺烦人的，不过后期的转变还是不错的，撩妹技能满分，还有女的爸爸和男主的爷爷也都是很有哲理的人。里面的句子都挺简单的，用来学英语也不错。&lt;/p&gt;
&lt;h3 id=&quot;淘宝技术这十年&quot;&gt;&lt;a href=&quot;#淘宝技术这十年&quot; class=&quot;headerlink&quot; title=&quot;淘宝技术这十年&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://www.amazon.cn/%E6%B7%98%E5%AE%9D%E6%8A%80%E6%9C%AF%E8%BF%99%E5%8D%81%E5%B9%B4-%E5%AD%90%E6%9F%B3/dp/B00CK2H13K/ref=cm_cr_pr_product_top?ie=UTF8&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;淘宝技术这十年&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/taobao.png&quot; alt=&quot;淘宝技术这十年&quot;&gt;&lt;br&gt;很多地方都有推荐这本书，就买了，不过看完倒也没觉得多好看，里面关于技术的地方讲的很浅，所以指望着学到什么技术还是别看了,当故事书看还是不错的。现在书的内容已经记不太清了，就记得两句话，好的架构都是一步步演化来的和再牛B的人也都有一段苦B的经历。&lt;/p&gt;
&lt;h3 id=&quot;清醒思考的艺术&quot;&gt;&lt;a href=&quot;#清醒思考的艺术&quot; class=&quot;headerlink&quot; title=&quot;清醒思考的艺术&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://www.amazon.cn/%E6%B8%85%E9%86%92%E6%80%9D%E8%80%83%E7%9A%84%E8%89%BA%E6%9C%AF-Rolf-Dobelli-PhD/dp/B00CFEYLU4/ref=sr_1_1?ie=UTF8&amp;amp;qid=1453188150&amp;amp;sr=8-1&amp;amp;keywords=%E6%B8%85%E9%86%92%E6%80%9D%E8%80%83%E7%9A%84%E8%89%BA%E6%9C%AF&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;清醒思考的艺术&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/sikao.png&quot; alt=&quot;清醒思考的艺术&quot;&gt;&lt;br&gt;左耳朵耗子来做技术分享时推荐的，里面是一个个的小故事，通过讲故事的方式来告诉读者思考时容易犯的错。读起来挺轻松的，可以睡前看一个小故事。不过吧。。。。道理都懂，想做到清醒思考还是挺难的。&lt;/p&gt;
&lt;h3 id=&quot;灿烂千阳-A-THOUSAND-SPLENDID-SUNS&quot;&gt;&lt;a href=&quot;#灿烂千阳-A-THOUSAND-SPLENDID-SUNS&quot; class=&quot;headerlink&quot; title=&quot;灿烂千阳(A THOUSAND SPLENDID SUNS)&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://www.amazon.cn/%E7%81%BF%E7%83%82%E5%8D%83%E9%98%B3-%E5%8D%A1%E5%8B%92%E5%BE%B7%E2%80%A2%E8%83%A1%E8%B5%9B%E5%B0%BC/dp/B0011C1E0G/ref=sr_1_1?s=books&amp;amp;ie=UTF8&amp;amp;qid=1453189059&amp;amp;sr=1-1&amp;amp;keywords=%E7%81%BF%E7%83%82%E5%8D%83%E9%98%B3&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;灿烂千阳(A THOUSAND SPLENDID SUNS)&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/canlan.png&quot; alt=&quot;灿烂千阳&quot;&gt;&lt;br&gt;是《追风筝的人》作者的另一本小说，没看过追风筝的人，不过名气好像挺大的。灿烂千阳主要讲了两个阿富汗少女悲惨的一生，虽然莱拉结局还算不错，不过整体看还是挺惨的，都是战争害的。觉得整本书最感人的地方不是莱拉和玛利亚姆互相帮助和莱拉和塔里克的爱情，而是书的结尾莱拉发现了玛利亚姆父亲留给她的东西，戳中泪点啊。。。。。看完了之后觉得现在生活真心很幸福的啊。&lt;/p&gt;
&lt;h3 id=&quot;深入理解Java虚拟机&quot;&gt;&lt;a href=&quot;#深入理解Java虚拟机&quot; class=&quot;headerlink&quot; title=&quot;深入理解Java虚拟机&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://www.amazon.cn/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA-JVM%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7%E4%B8%8E%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-%E5%91%A8%E5%BF%97%E6%98%8E/dp/B00D2ID4PK/ref=sr_1_1?ie=UTF8&amp;amp;qid=1453191565&amp;amp;sr=8-1&amp;amp;keywords=%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E8%99%9A%E6%8B%9F%E6%9C%BA%EF%BC%88%E7%AC%AC2%E7%89%88&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;深入理解Java虚拟机&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/jvm.png&quot; alt=&quot;深入理解Java虚拟机&quot;&gt;&lt;br&gt;这本。。。。大概看了两三章，实在看不下去。。。不是书写的不好，是我技术渣看不太懂。。。还是先放放吧&lt;/p&gt;
&lt;h3 id=&quot;从0到1&quot;&gt;&lt;a href=&quot;#从0到1&quot; class=&quot;headerlink&quot; title=&quot;从0到1&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://www.amazon.cn/%E4%BB%8E0%E5%88%B01-%E5%BC%80%E5%90%AF%E5%95%86%E4%B8%9A%E4%B8%8E%E6%9C%AA%E6%9D%A5%E7%9A%84%E7%A7%98%E5%AF%86-%E5%BD%BC%E5%BE%97%C2%B7%E8%92%82%E5%B0%94/dp/B00RWP6BOU/ref=sr_1_1?ie=UTF8&amp;amp;qid=1453192094&amp;amp;sr=8-1&amp;amp;keywords=%E4%BB%8E0%E5%88%B01&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;从0到1&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/from0to1.png&quot; alt=&quot;从0到1&quot;&gt;&lt;/p&gt;
&lt;p&gt;利用周末看完了，感觉作者说的都对，但对现在的我帮助不大，可能经历还不够吧。不过喜欢做开发也正是因为从0到1的创造一个产品的过程很interesting。&lt;/p&gt;
&lt;h3 id=&quot;Linux-Bible-9th-Edition&quot;&gt;&lt;a href=&quot;#Linux-Bible-9th-Edition&quot; class=&quot;headerlink&quot; title=&quot;Linux Bible 9th Edition&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://www.amazon.cn/%E5%9B%BE%E4%B9%A6/dp/111898384X/ref=sr_1_1?ie=UTF8&amp;amp;qid=1453192604&amp;amp;sr=8-1&amp;amp;keywords=linux+bible&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Linux Bible 9th Edition&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/linux.png&quot; alt=&quot;Linux Bible&quot;&gt;&lt;br&gt;超实用的技术书，不过由于是英文的还是技术书，看的比较慢，才看到第六章，基本一章一个主题已经从使用shell看到管理进程了。真是每一章都有很大收获，比如以前查看进程就知道用ps aux，并不知道每个命令选项的具体意思。走过路过不要错过，linux学的好的也可以看看，查漏补缺啊。争取以一周一章的速度把它看完。有要电子书的可以留邮箱 哈哈。&lt;/p&gt;
&lt;h3 id=&quot;Spring-in-Action-4th-edition&quot;&gt;&lt;a href=&quot;#Spring-in-Action-4th-edition&quot; class=&quot;headerlink&quot; title=&quot;Spring in Action 4th edition&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://www.geekbooks.me/book/view/spring-in-action-4th-edition&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Spring in Action 4th edition&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/springInAction.png&quot; alt=&quot;Spring In Actino&quot;&gt;&lt;br&gt;虽然一直在用spring，但是貌似一直没有系统完整的看过一本关于spring的书，正好从geekbook上爬下了这本就看看吧，查漏补缺，以前注入bean，一直用xml和利用注解自动注入的方式，借这个机会了解下利用JavaConfig是如何实现依赖注入的。令我吃惊的是，作者第二推荐的居然是JavaConfig，一直以为Xml的方式应该排第二呢。。。刚看到第三章，慢慢看吧。。。有要电子书的可以留邮箱。&lt;/p&gt;
&lt;h3 id=&quot;The-Martian-火星救援&quot;&gt;&lt;a href=&quot;#The-Martian-火星救援&quot; class=&quot;headerlink&quot; title=&quot;The Martian(火星救援)&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://www.amazon.cn/The-Martian-A-Novel-Weir-Andy/dp/B00EMXBDMA/ref=sr_1_2?ie=UTF8&amp;amp;qid=1453197526&amp;amp;sr=8-2&amp;amp;keywords=%E7%81%AB%E6%98%9F%E6%95%91%E6%8F%B4&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;The Martian(火星救援)&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/martian.png&quot; alt=&quot;火星救援&quot;&gt;&lt;br&gt;看完电影再来看书，觉得书比电影好一点，当然电影也不差。男主实在令人折服，尤其是他遇到困难只想着怎么解决困难的精神。如果把我留在火星上，估计得死好几百回。。。。&lt;/p&gt;
&lt;h3 id=&quot;偷影子的人&quot;&gt;&lt;a href=&quot;#偷影子的人&quot; class=&quot;headerlink&quot; title=&quot;偷影子的人&quot;&gt;&lt;/a&gt;&lt;a href=&quot;http://www.amazon.cn/gp/product/B008ASCLJW/ref=s9_acsd_ri_bw_rw_r0_p7_t?pf_rd_m=A1AJ19PSB66TGU&amp;amp;pf_rd_s=merchandised-search-5&amp;amp;pf_rd_r=013VAE3JTBKQPMZMJ4RY&amp;amp;pf_rd_t=101&amp;amp;pf_rd_p=261616452&amp;amp;pf_rd_i=658390051&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;偷影子的人&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/偷影子的人.png&quot; alt=&quot;偷影子的人&quot;&gt;&lt;br&gt;一本治愈系的法国小说，喜欢封面的设计，内容挺平淡的，感觉前半部分比后面要好看。&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/liguangzhu2.gif&quot; alt=&quot;liguangzhu&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;自从去年8月份之后真是变成了个爱看书のgirl，算是*%^&amp;amp;#$带来的唯一好处吧，是时候整理一发啦。不过，要按什么分类呢，技术和非技术，看完和没看完，好看和不好看还是外文和中文？好乱。。。。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;算了 还是不分了随便列吧。。。。&lt;br&gt;
    
    </summary>
    
      <category term="随笔" scheme="http://yemengying.com/categories/%E9%9A%8F%E7%AC%94/"/>
    
    
      <category term="随笔" scheme="http://yemengying.com/tags/%E9%9A%8F%E7%AC%94/"/>
    
      <category term="书单" scheme="http://yemengying.com/tags/%E4%B9%A6%E5%8D%95/"/>
    
  </entry>
  
  <entry>
    <title>拥有自己的图书小金库</title>
    <link href="http://yemengying.com/2016/01/09/%E6%8B%A5%E6%9C%89%E8%87%AA%E5%B7%B1%E7%9A%84%E5%9B%BE%E4%B9%A6%E5%B0%8F%E9%87%91%E5%BA%93/"/>
    <id>http://yemengying.com/2016/01/09/拥有自己的图书小金库/</id>
    <published>2016-01-09T06:15:46.000Z</published>
    <updated>2016-04-23T01:59:14.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;在找matering elasticsearch second edition这本书的时候，在许多可以免费下电子书的网站都没有找到，所以就买了&lt;a href=&quot;https://www.geekbooks.me/category&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Geekbook&lt;/a&gt;一个月的会员，为了不浪费充会员的钱，决定撸个脚本把全站的书都下下来,并用django搭个管理后台。和&lt;a href=&quot;https://github.com/KevinOfNeu&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;洪菊&lt;/a&gt;，&lt;a href=&quot;https://github.com/stephenluu&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;卢神&lt;/a&gt;利用空闲时间忙活了快两周，终于有了自己的图书小金库，5000+的优质英文原版电子书，哇咔咔咔咔，这辈子的书都有了，放了一部分到github上。&lt;br&gt;geekbook千万不要怪我们啊，谁让你不封我们的~~。&lt;br&gt;&lt;strong&gt;项目地址：&lt;/strong&gt;&lt;div id=&quot;badge-container-giraffe0813-GeekBook-3d83e8f&quot; class=&quot;hexo-github&quot; style=&quot;width: 100%&quot;&gt;&lt;/div&gt;
&lt;script src=&quot;/hexo-github/badge.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  loadStyle(&quot;/hexo-github/style.css&quot;);
  loadStyle(&quot;/hexo-github/octicons/octicons.css&quot;);
  new Badge(&quot;#badge-container-giraffe0813-GeekBook-3d83e8f&quot;, &quot;giraffe0813&quot;, &quot;GeekBook&quot;, &quot;3d83e8f&quot;, false);
&lt;/script&gt;
&lt;br&gt;&lt;strong&gt;部分电子书地址:&lt;/strong&gt; &lt;div id=&quot;badge-container-Geek-Organization-geek-programming-books-643e0bd&quot; class=&quot;hexo-github&quot; style=&quot;width: 100%&quot;&gt;&lt;/div&gt;
&lt;script src=&quot;/hexo-github/badge.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  loadStyle(&quot;/hexo-github/style.css&quot;);
  loadStyle(&quot;/hexo-github/octicons/octicons.css&quot;);
  new Badge(&quot;#badge-container-Geek-Organization-geek-programming-books-643e0bd&quot;, &quot;Geek-Organization&quot;, &quot;geek-programming-books&quot;, &quot;643e0bd&quot;, false);
&lt;/script&gt;
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;遇到的坑&quot;&gt;&lt;a href=&quot;#遇到的坑&quot; class=&quot;headerlink&quot; title=&quot;遇到的坑&quot;&gt;&lt;/a&gt;遇到的坑&lt;/h3&gt;&lt;p&gt;记录下遇到的坑 不然就忘了😂&lt;/p&gt;
&lt;h4 id=&quot;只带cookie-无法下载&quot;&gt;&lt;a href=&quot;#只带cookie-无法下载&quot; class=&quot;headerlink&quot; title=&quot;只带cookie 无法下载&quot;&gt;&lt;/a&gt;只带cookie 无法下载&lt;/h4&gt;&lt;p&gt;本来以为只要带着登录之后的cookie请求下载的地址(eg:&lt;a href=&quot;https://www.geekbooks.me/books/56/48/c1955c13518f994167b11f7b7279/amazon_ec2_cookbook.pdf&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://www.geekbooks.me/books/56/48/c1955c13518f994167b11f7b7279/amazon_ec2_cookbook.pdf&lt;/a&gt;) 就可以下载了，不过发现下下来的并不是书，而是网站上书的详情页的html。受到博客&lt;a href=&quot;http://www.jianshu.com/p/c3dbf8294c33&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Course抓站小结&lt;/a&gt; 的启发，又研究了一下请求的header。&lt;br&gt;&lt;img src=&quot;/images/header.jpg&quot; alt=&quot;header&quot;&gt;&lt;br&gt;发现除了要带cookie之外，还要带有user_agent和Referer，refer是表示从哪个页面访问当前链接。&lt;br&gt;所以修改了下代码，在请求头中加入user-agent和referer之后，问题就解决了,部分代码如下&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;cookie = cookielib.MozillaCookieJar()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# get cookie from file&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;cookie.load(&lt;span class=&quot;string&quot;&gt;&#39;../data/cookie4geek.data&#39;&lt;/span&gt;, ignore_discard=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;, ignore_expires=&lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;handler = urllib2.HTTPCookieProcessor(cookie)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;opener = urllib2.build_opener(handler)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# add header&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;opener.addheaders = [(&lt;span class=&quot;string&quot;&gt;&#39;User-agent&#39;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&#39;Mozilla/5.0&#39;&lt;/span&gt;), (&lt;span class=&quot;string&quot;&gt;&quot;Referer&quot;&lt;/span&gt;, url)]&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;下载文件的时候不显示进度&quot;&gt;&lt;a href=&quot;#下载文件的时候不显示进度&quot; class=&quot;headerlink&quot; title=&quot;下载文件的时候不显示进度&quot;&gt;&lt;/a&gt;下载文件的时候不显示进度&lt;/h4&gt;&lt;p&gt;可以下载文件之后，希望可以在下载文件的时候显示下载进度，让我们知道他在工作。。。。直接在stackoverflow上抄了段代码，这个问题也愉快的解决了。&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;u = opener.open(&lt;span class=&quot;string&quot;&gt;&quot;https://www.geekbooks.me&quot;&lt;/span&gt; + url)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;Preparing to download...&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# f with directory&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; os.path.exists(conf_books_dir + category + &lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt; + file_name) &lt;span class=&quot;keyword&quot;&gt;and&lt;/span&gt; detect_book(&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        (conf_books_dir + category + &lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt; + file_name)):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;continue&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;f = open(conf_books_dir + category + &lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt; + file_name, &lt;span class=&quot;string&quot;&gt;&#39;wb&#39;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;meta = u.info()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;file_size = int(meta.getheaders(&lt;span class=&quot;string&quot;&gt;&quot;Content-Length&quot;&lt;/span&gt;)[&lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;Downloading: %s Bytes: %s&quot;&lt;/span&gt; % (file_name, file_size)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;file_size_dl = &lt;span class=&quot;number&quot;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;block_sz = &lt;span class=&quot;number&quot;&gt;8192&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;True&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    buffer = u.read(block_sz)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; buffer:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;break&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    file_size_dl += len(buffer)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f.write(buffer)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    status = &lt;span class=&quot;string&quot;&gt;r&quot;%10d  [%3.2f%%]&quot;&lt;/span&gt; % (file_size_dl, file_size_dl * &lt;span class=&quot;number&quot;&gt;100.&lt;/span&gt; / file_size)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    status = status + chr(&lt;span class=&quot;number&quot;&gt;8&lt;/span&gt;) * (len(status) + &lt;span class=&quot;number&quot;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;print&lt;/span&gt; status,&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;f.close()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;一本一本下载速度太慢&quot;&gt;&lt;a href=&quot;#一本一本下载速度太慢&quot; class=&quot;headerlink&quot; title=&quot;一本一本下载速度太慢&quot;&gt;&lt;/a&gt;一本一本下载速度太慢&lt;/h4&gt;&lt;p&gt;这个只能果断上多线程了。。。&lt;br&gt;&lt;figure class=&quot;highlight python&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;function&quot;&gt;&lt;span class=&quot;keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;title&quot;&gt;download_work&lt;/span&gt;&lt;span class=&quot;params&quot;&gt;()&lt;/span&gt;:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    f = open(&lt;span class=&quot;string&quot;&gt;&quot;../data/detailurl.txt&quot;&lt;/span&gt;, &lt;span class=&quot;string&quot;&gt;&quot;r&quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    books = []&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    destDir = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    tmp = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; line &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; f:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;keyword&quot;&gt;not&lt;/span&gt; (line.strip()).startswith(&lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            tmp += &lt;span class=&quot;string&quot;&gt;&quot;/&quot;&lt;/span&gt; + line.strip()&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            destDir = tmp&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;        &lt;span class=&quot;keyword&quot;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            &lt;span class=&quot;comment&quot;&gt;# desDir&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            book = Book(destDir, line.strip())&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            books.append(book)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;            tmp = &lt;span class=&quot;string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    pool = threadpool.ThreadPool(conf_thread_count)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    reqs = threadpool.makeRequests(&lt;span class=&quot;keyword&quot;&gt;lambda&lt;/span&gt; book: book.download(), books)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    [pool.putRequest(req) &lt;span class=&quot;keyword&quot;&gt;for&lt;/span&gt; req &lt;span class=&quot;keyword&quot;&gt;in&lt;/span&gt; reqs]&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;    pool.wait()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&quot;无法展示下载书的具体信息&quot;&gt;&lt;a href=&quot;#无法展示下载书的具体信息&quot; class=&quot;headerlink&quot; title=&quot;无法展示下载书的具体信息&quot;&gt;&lt;/a&gt;无法展示下载书的具体信息&lt;/h4&gt;&lt;p&gt;除了将书下载下来，还想将书的一些基本信息保存下来，比如:作者，简洁，出版年份，封面，标签等等。。最好可以根据作者，题目进行搜索。本来想自己写个网站出来，但是又没有时间。还好之前学叔推荐过django，用django搭个管理后台简直不要太方便好么，配置nginx，supervisor的时间都比写代码的时间长👅，还可以很方便定义想搜索的字段和想展示的字段。样式是丑了一丢丢，但自己用也无所谓。&lt;/p&gt;
&lt;h3 id=&quot;成品&quot;&gt;&lt;a href=&quot;#成品&quot; class=&quot;headerlink&quot; title=&quot;成品&quot;&gt;&lt;/a&gt;成品&lt;/h3&gt;&lt;p&gt;&lt;img src=&quot;/images/admin.jpg&quot; alt=&quot;admin&quot;&gt;&lt;/p&gt;
&lt;h3 id=&quot;Summary&quot;&gt;&lt;a href=&quot;#Summary&quot; class=&quot;headerlink&quot; title=&quot;Summary&quot;&gt;&lt;/a&gt;Summary&lt;/h3&gt;&lt;p&gt;依靠空闲时间可以做点想做的事，也是蛮好的~~。用python写脚本真的很方便，基本不用自己造轮子，用它自带的模块就可以完成了。用django搭管理后台也是快的不要不要的。一周多的时间换4000+的书很值啊，但是。。。。服务器+存储平均一天的成本就要10块。。。是不是得想个法子，看能不能用这些电子书挣点钱啊。。。。想到这。。。突然没那么开心了。。。&lt;br&gt;&lt;img src=&quot;/images/lingluan.jpg&quot; alt=&quot;lingluan&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;在找matering elasticsearch second edition这本书的时候，在许多可以免费下电子书的网站都没有找到，所以就买了&lt;a href=&quot;https://www.geekbooks.me/category&quot;&gt;Geekbook&lt;/a&gt;一个月的会员，为了不浪费充会员的钱，决定撸个脚本把全站的书都下下来,并用django搭个管理后台。和&lt;a href=&quot;https://github.com/KevinOfNeu&quot;&gt;洪菊&lt;/a&gt;，&lt;a href=&quot;https://github.com/stephenluu&quot;&gt;卢神&lt;/a&gt;利用空闲时间忙活了快两周，终于有了自己的图书小金库，5000+的优质英文原版电子书，哇咔咔咔咔，这辈子的书都有了，放了一部分到github上。&lt;br&gt;geekbook千万不要怪我们啊，谁让你不封我们的~~。&lt;br&gt;&lt;strong&gt;项目地址：&lt;/strong&gt;&lt;div id=&quot;badge-container-giraffe0813-GeekBook-3d83e8f&quot; class=&quot;hexo-github&quot; style=&quot;width: 100%&quot;&gt;&lt;/div&gt;
&lt;script src=&quot;/hexo-github/badge.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  loadStyle(&quot;/hexo-github/style.css&quot;);
  loadStyle(&quot;/hexo-github/octicons/octicons.css&quot;);
  new Badge(&quot;#badge-container-giraffe0813-GeekBook-3d83e8f&quot;, &quot;giraffe0813&quot;, &quot;GeekBook&quot;, &quot;3d83e8f&quot;, false);
&lt;/script&gt;
&lt;br&gt;&lt;strong&gt;部分电子书地址:&lt;/strong&gt; &lt;div id=&quot;badge-container-Geek-Organization-geek-programming-books-643e0bd&quot; class=&quot;hexo-github&quot; style=&quot;width: 100%&quot;&gt;&lt;/div&gt;
&lt;script src=&quot;/hexo-github/badge.js&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;text/javascript&quot;&gt;
  loadStyle(&quot;/hexo-github/style.css&quot;);
  loadStyle(&quot;/hexo-github/octicons/octicons.css&quot;);
  new Badge(&quot;#badge-container-Geek-Organization-geek-programming-books-643e0bd&quot;, &quot;Geek-Organization&quot;, &quot;geek-programming-books&quot;, &quot;643e0bd&quot;, false);
&lt;/script&gt;
&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
      <category term="python" scheme="http://yemengying.com/categories/python/"/>
    
    
      <category term="python" scheme="http://yemengying.com/tags/python/"/>
    
      <category term="爬虫" scheme="http://yemengying.com/tags/%E7%88%AC%E8%99%AB/"/>
    
      <category term="django" scheme="http://yemengying.com/tags/django/"/>
    
  </entry>
  
  <entry>
    <title>读书笔记-Linux Bible 9th Edition之进程大法好</title>
    <link href="http://yemengying.com/2015/12/24/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E8%BF%9B%E7%A8%8B%E5%A4%A7%E6%B3%95%E5%A5%BD/"/>
    <id>http://yemengying.com/2015/12/24/读书笔记-Linux-Bible-9th-Edition之进程大法好/</id>
    <published>2015-12-24T09:56:03.000Z</published>
    <updated>2016-04-22T13:43:24.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;根据Linux Bible第九版第六章整理的读书笔记，记录linux系统下如何管理进程&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Linux是一个支持多用户和多任务的操作系统，多任务是指可以同时运行多个程序，而每个运行程序的一个实例被称作一个进程。Linux系统提供了可以让我们列出正运行进程，杀死进程，监听系统使用情况的工具。&lt;/p&gt;
&lt;p&gt;相关博客:&lt;br&gt;&lt;a href=&quot;http://yemengying.com/2015/11/23/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition/&quot;&gt;Linux Bible 9th Edition之使用shell&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://yemengying.com/2015/11/30/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E7%8E%A9%E8%BD%AC%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6/&quot;&gt;Linux Bible 9th Edition之玩转文本文件&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://yemengying.com/2015/11/26/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/&quot;&gt;Linux Bible 9th Edition之文件系统&lt;/a&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;理解进程&quot;&gt;&lt;a href=&quot;#理解进程&quot; class=&quot;headerlink&quot; title=&quot;理解进程&quot;&gt;&lt;/a&gt;理解进程&lt;/h3&gt;&lt;p&gt;一个进程是一个命令正在运行的实例。比如，系统中有一个&lt;strong&gt;vi&lt;/strong&gt;命令，如果&lt;strong&gt;vi&lt;/strong&gt;命令正在被15个不同的用户运行，那么就对应了15个不同的运行进程。&lt;br&gt;一个进程在系统中通过进程Id(process ID)来标识，在当前系统中进程Id是独一无二的。换句话说，如果一个进程正在运行，那么其他进程都不能使用它的进程Id的数字作为自己的进程Id。但如果这个进程已经结束，那么他的进程Id可以被重新使用当做其他进程的进程Id。&lt;br&gt;除了进程Id，进程还有一些其他属性。每个运行的进程都会关联一个指定的用户账号和用户组，这个账号决定了进程可以访问哪些系统资源。所以root用户运行的进程能比普通用户的进程访问更多的文件。&lt;br&gt;对于一个Linux的管理员来说，管理进程的能力至关重要。因为有时，一些运行的进程会严重影响系统的性能，这一章会讲述如果根据内存和CPU的使用情况，定位和处理这些进程。&lt;/p&gt;
&lt;h4 id=&quot;列出进程&quot;&gt;&lt;a href=&quot;#列出进程&quot; class=&quot;headerlink&quot; title=&quot;列出进程&quot;&gt;&lt;/a&gt;列出进程&lt;/h4&gt;&lt;p&gt;如果使用命令行列出当前系统运行的进程，&lt;strong&gt;ps&lt;/strong&gt;命令是最老也是最常用的命令，而&lt;strong&gt;top&lt;/strong&gt;命令不仅可以列出进程还可以更改进程的状态。如果使用的是GNOME，可以使用&lt;strong&gt;gnome-system-monitor&lt;/strong&gt;来通过图形界面管理进程。&lt;/p&gt;
&lt;h5 id=&quot;通过ps命令列出进程&quot;&gt;&lt;a href=&quot;#通过ps命令列出进程&quot; class=&quot;headerlink&quot; title=&quot;通过ps命令列出进程&quot;&gt;&lt;/a&gt;通过ps命令列出进程&lt;/h5&gt;&lt;p&gt;最常用的查看正在运行进程的工具就是ps命令，通过ps命令，我们可以查看正在运行的进程，它们使用的资源以及运行它们的用户。下面是ps命令的一个例子:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ ps u&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMAND &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;jake 2147 0.0 0.7 1836 1020 tty1 S+ 14:50 0:00 -bash &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;jake 2310 0.0 0.7 2592 912 tty1 R+ 18:22 0:00 ps u&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;在上面的命令中，使用u选项会显示用户名和一些其他信息，比如进程是什么时候开始运行的，进程占用的内存和Cpu，命令运行的位置(TTY)等。上面的第一个进程说明了jake用户在登录之后打开了一个bash shell。第二进程显示了jake用户正在运行ps u命令。终端设备&lt;strong&gt;tty1&lt;/strong&gt;正在被登录会话使用着。&lt;strong&gt;STAT&lt;/strong&gt;这一列代表了进程的状态，R代表进程正在运行，S代表进程处于休眠状态。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;STAT除了R和S之外还可以有别的值，D代表不可中断，R运行，S中断/休眠，T停止，Z僵死。如果后面有+号，代表在前台运行的进程。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;USER&lt;/strong&gt;列显示了运行这个进程的用户。&lt;strong&gt;PID&lt;/strong&gt;列是进程的进程Id，每个进程都有一个独一无二的进程Id，在需要杀死一个进程或者为进程发送信号时使用。&lt;strong&gt;%CPU&lt;/strong&gt;和&lt;strong&gt;%MEN&lt;/strong&gt;两列显示了进程占用的CPU百分比和内存百分比。&lt;br&gt;&lt;strong&gt;VSZ&lt;/strong&gt;(virtual set size)展示了虚拟内存占用大小(单位：kb/kilobytes),&lt;strong&gt;RSS&lt;/strong&gt;(reside set size)展示了实际内存占用大小(单位：kb/kilobytes)。VSZ和RSS的值可能不一样，因为VSZ是分配给进程的内存大小，而RSS是进程实际使用的内存大小，代表了不可交换的物理内存。&lt;strong&gt;START&lt;/strong&gt;代表了进程启动的时间，&lt;strong&gt;TIME&lt;/strong&gt;执行累计时间(如果占用cpu时间非常短不到一秒，会显示 0:00)。&lt;br&gt;在Linux中，有些运行的进程是与终端无关的，这些进程通常在系统启动时开始运行，并且会持续运行，直到系统关闭。可以使用x选项查看与终端无关的进程。&lt;/p&gt;
&lt;p&gt;分页查看与当前用户有关的所有运行进程&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ ps ux | less&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;分页查看所有用户的运行的进程&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ ps aux | less&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;管道符(“|”)会将第一个命令的输出当做第二个命令的输入，上面的例子中ps命令的输出会当做less命令的输入，这样就可以分页查看信息了。按空格键换页，按q退出。&lt;br&gt;我们还可以自定义ps命令展示的信息，并按其中一列排序。使用-o选项，可以通过关键字指定想要展示的列。下面的例子就是指定ps展示进程Id(pid),用户名(username),用户Id(uid),用户组(group),组Id(gid),分配的虚拟内存(vsz),实际使用内存(rss),运行的命令(comm),默认情况下按进程Id排序。&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ ps -eo pid,user,uid,group,gid,vsz,rss,comm | less  PID USER GROUP GID VSZ   RSS   COMMAND&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  1   root  root  0  19324 1320   init &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;  2   root  root  0  0       0    kthreadd&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;如果想要按其他列排序可以使用sort=选项。例如，想查看那个进程占用了最多的内存，可以按rss排列，会按rss从低到高展示进程，如果想从高到底可以在前面加连字符。下面是例子：&lt;br&gt;&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ ps -eo pid,user,group,gid,vsz,rss,comm --sort=-rss | less&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;PID     USER     GROUP     GID     VSZ       RSS       COMMAND&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12005   cnegus   cnegus   13597   1271008    522192    firefox&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5412    cnegus   cnegus   13597   949584     157268 thunderbird-bin&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;25870   cnegus   cnegus   13597   1332492    112952 swriter.bin&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&quot;通过top命令列出进程-修改进程&quot;&gt;&lt;a href=&quot;#通过top命令列出进程-修改进程&quot; class=&quot;headerlink&quot; title=&quot;通过top命令列出进程,修改进程&quot;&gt;&lt;/a&gt;通过top命令列出进程,修改进程&lt;/h5&gt;&lt;p&gt;使用top命令，会默认按占用CPU的时间展示进程，也可以按其他指标排序。如果定位到了一个异常的进程，可以使用top终止(kill)进程或修改其优先级(reprioritize)。如果想要能够终止所有的进程或更改所有进程优先级需要使用root user来运行top命令。如果只是想要展示进程，或者更改自己的进程，那么可以使用普通用户的身份。下图是使用top的例子，最上面列出了系统的基本信息，下面是每个运行进程的信息。从最上面的输出信息你可以知道系统启动了多长时间，目前用多少用户登入，在过去的1,5,10分钟内分别运行了多少条命令。除此之外还包括了当前有多少进程在运行，CPU占用多少，用多少可用的Swap和RAM。紧接着列出了每个进程的基本信息，按进程占用cpu百分比排列，默认情况下所有信息5秒钟刷新一次。&lt;br&gt;&lt;img src=&quot;/images/top.png&quot; alt=&quot;top&quot;&gt;&lt;/p&gt;
&lt;p&gt;下面列出了在用top展示、修改进程时可用的一些操作：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;按&lt;strong&gt;h&lt;/strong&gt;看帮助选项，按任意键返回&lt;/li&gt;
&lt;li&gt;按&lt;strong&gt;M&lt;/strong&gt;按占用内存排列，按&lt;strong&gt;P&lt;/strong&gt;返回按CPU排列&lt;/li&gt;
&lt;li&gt;按数字1可以在所有cpu中切换，前提是你的系统中有多于一个cpu&lt;/li&gt;
&lt;li&gt;按&lt;strong&gt;R&lt;/strong&gt;将输出倒序排列&lt;/li&gt;
&lt;li&gt;按&lt;strong&gt;u&lt;/strong&gt;并输入一个用户名，展示指定用户的进程&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;下面是运行top命令时，如何终止进程或修改其优先级:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;修改优先级：记下想要修改的进程的PID，之后按r输入线程对应的PID,再输入想要调整的值(-19 到 20)。&lt;/li&gt;
&lt;li&gt;终止进程： 记下想要修改的进程的PID，之后按k输入线程对应的PID，之后输入15(终止)或9(强迫终止)。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;题外话&quot;&gt;&lt;a href=&quot;#题外话&quot; class=&quot;headerlink&quot; title=&quot;题外话&quot;&gt;&lt;/a&gt;题外话&lt;/h3&gt;&lt;p&gt;最近负能量太多了 赶紧听首我大少时的歌压压。&lt;/p&gt;
&lt;iframe frameborder=&quot;no&quot; border=&quot;0&quot; marginwidth=&quot;0&quot; marginheight=&quot;0&quot; width=&quot;330&quot; height=&quot;86&quot; src=&quot;http://music.163.com/outchain/player?type=2&amp;id=26133356&amp;auto=0&amp;height=66&quot;&gt;&lt;/iframe&gt;










</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;根据Linux Bible第九版第六章整理的读书笔记，记录linux系统下如何管理进程&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Linux是一个支持多用户和多任务的操作系统，多任务是指可以同时运行多个程序，而每个运行程序的一个实例被称作一个进程。Linux系统提供了可以让我们列出正运行进程，杀死进程，监听系统使用情况的工具。&lt;/p&gt;
&lt;p&gt;相关博客:&lt;br&gt;&lt;a href=&quot;http://yemengying.com/2015/11/23/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition/&quot;&gt;Linux Bible 9th Edition之使用shell&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://yemengying.com/2015/11/30/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E7%8E%A9%E8%BD%AC%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6/&quot;&gt;Linux Bible 9th Edition之玩转文本文件&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;http://yemengying.com/2015/11/26/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/&quot;&gt;Linux Bible 9th Edition之文件系统&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="linux" scheme="http://yemengying.com/categories/linux/"/>
    
    
      <category term="linux" scheme="http://yemengying.com/tags/linux/"/>
    
      <category term="读书笔记" scheme="http://yemengying.com/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>读书笔记-Linux Bible 9th Edition之玩转文本文件</title>
    <link href="http://yemengying.com/2015/11/30/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E7%8E%A9%E8%BD%AC%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6/"/>
    <id>http://yemengying.com/2015/11/30/读书笔记-Linux-Bible-9th-Edition之玩转文本文件/</id>
    <published>2015-11-30T07:04:46.000Z</published>
    <updated>2016-04-22T13:43:30.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;根据书的第5章整理一下关于操作文本文件的常用命令。在Linux系统中许多信息都是在文本文件中管理的,所以熟练掌握对文本文件的更改，查找是很重要的。这一点，在出bug查找服务器日志时真是深有体会啊！😼😼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;相关博客:&lt;br&gt; &lt;a href=&quot;http://yemengying.com/2015/11/23/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition/&quot;&gt;Linux Bible 9th Edition之使用shell&lt;/a&gt;&lt;br&gt; &lt;a href=&quot;http://yemengying.com/2015/11/26/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/&quot;&gt;Linux Bible 9th Edition之文件系统&lt;/a&gt;&lt;br&gt; &lt;a href=&quot;http://yemengying.com/2015/12/24/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E8%BF%9B%E7%A8%8B%E5%A4%A7%E6%B3%95%E5%A5%BD/&quot;&gt;Linux Bible 9th Edition之进程大法好&lt;/a&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;使用vim和vi编辑文件&quot;&gt;&lt;a href=&quot;#使用vim和vi编辑文件&quot; class=&quot;headerlink&quot; title=&quot;使用vim和vi编辑文件&quot;&gt;&lt;/a&gt;使用vim和vi编辑文件&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;刚接触vi编辑器可能会觉得有点难，不过当你熟悉了之后可以只用键盘就能快速高效的编辑文件，无需使用鼠标或功能键。(如果觉得vi不适合你，可以选择其它的文本编辑器，比如:nano,gedit,jed,kate,kedit,mcedit,nedit…等等)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;从最常见的打开文件的开始了解vi&lt;br&gt;打开文件:&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ vi &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果这是一个空的文件，你会看到类似下图的东东。最上面闪烁的东东代表了光标的当前位置，最下面的一行显示了关于文件的一些信息,中间的”~”符号代表没有内容。&lt;br&gt;&lt;img src=&quot;/images/vi1.jpg&quot; alt=&quot;使用vi打开一个空文件&quot;&gt;&lt;br&gt;当你看到这个界面可能会感觉不知所措，因为没有任何菜单，提示和图标来告诉你该做什么。更恐怖的是，你不能直接输入，否则会听见”嘟嘟”的声音。&lt;/p&gt;
&lt;h4 id=&quot;添加文件内容&quot;&gt;&lt;a href=&quot;#添加文件内容&quot; class=&quot;headerlink&quot; title=&quot;添加文件内容&quot;&gt;&lt;/a&gt;添加文件内容&lt;/h4&gt;&lt;p&gt;不要怕,首先,需要了解两种主要的模式:命令模式(command)和编辑模式(input)。vi编辑器以命令模式启动，在添加或改变文本内容之前需输入命令来告诉vi你想要做什么(大小写敏感)。输入下面的命令就可以进入编辑模式，当编辑结束后，按&lt;em&gt;Esc&lt;/em&gt;键就可以回到命令模式。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;命令&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;a&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;可以在光标右侧开始插入文本&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;A&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;可以在当前行的最后开始插入文本&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;i&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;可以在光标左侧开始插入文本&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;I&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;可以在当前行的最前面开始插入文本&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;o&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;在当前行下面 插入新的一行 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;O&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;在当前行上面 插入新的一行&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img src=&quot;/images/tips.jpg&quot; alt=&quot;提示&quot;&gt; 当进入编辑模式时，屏幕下方会出现– INSERT –；编辑结束后，按&lt;em&gt;Esc&lt;/em&gt;键就可以回到命令模式。不过如果输入了”:”符号，需要按两下&lt;em&gt;Esc&lt;/em&gt;键&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;在文本中移动&quot;&gt;&lt;a href=&quot;#在文本中移动&quot; class=&quot;headerlink&quot; title=&quot;在文本中移动&quot;&gt;&lt;/a&gt;在文本中移动&lt;/h4&gt;&lt;p&gt;可以使用方向键可以在文本中移动光标，但还有一些小技巧可以让我们更方便的在文本中移动&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;命令&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;w&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;光标移到下一个单词的开头(单词以spaces,tabs,标点界定)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;W&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;光标移到下一个单词的开头(单词以spaces,tabs界定)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;b&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;光标移到前一个单词的开头(单词以spaces,tabs,标点界定)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;B&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;光标移到前一个单词的开头(单词以spaces,tabs界定)&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;0(zero)&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;光标移到当前行的最前面&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;$&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;光标移到当前行的最后&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;H&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;光标移到屏幕的左上角&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;M&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;移到中间行第一个字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;L&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;光标移到屏幕的左下角&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&quot;删除，复制，更改文本&quot;&gt;&lt;a href=&quot;#删除，复制，更改文本&quot; class=&quot;headerlink&quot; title=&quot;删除，复制，更改文本&quot;&gt;&lt;/a&gt;删除，复制，更改文本&lt;/h4&gt;&lt;p&gt;了解了如何添加文本和移动光标是远远不够的，还需要知道如何删除，复制和更改文本。命令x,d,y,c等可以帮助我们删除和修改文本，这些命令也可以和移动光标的命令(上一个表格中提到的)或者数字配合使用来告诉编辑器确切的操作是什么。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;命令&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;x&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;删除光标所在位置的字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;X&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;删除光标所在位置的前一个字符&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;d?&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;删除一些文本&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;c?&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;更改一些文本&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;y?&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;复制一些文本&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;?代表这些命令要和移动光标的命令配合着使用，下面是一些例子&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;命令&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;dw&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;删除当前光标位置的后一个单词&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;db&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;删除当前光标位置的前一个单词&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;dd&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;删除当前一整行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;c$&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;更改(实际上是擦除)从当前位置到当前行最后的内容，并进入编辑模式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;c0&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;更改(实际上是擦除)从当前位置到当前行最前面的内容，并进入编辑模式&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;yy&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;将当前行复制到buffer中&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;上面这些命令也可以和数字配合使用,下面是栗子🌰&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;命令&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;3dd&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;删除当前行往下的三行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;3dw&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;删除接下来的三个单词&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;5cl&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;删除接下来的5个字符，并进入编辑模式&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&quot;粘贴&quot;&gt;&lt;a href=&quot;#粘贴&quot; class=&quot;headerlink&quot; title=&quot;粘贴&quot;&gt;&lt;/a&gt;粘贴&lt;/h4&gt;&lt;p&gt;可以使用命令p和P，将复制到buffer中的内容粘贴到文本中。p是将缓存区的内容粘贴到当前光标所在位置的下方，P是将缓存区的内容粘贴到当前光标所在位置的上方&lt;/p&gt;
&lt;h4 id=&quot;在文件中跳跃&quot;&gt;&lt;a href=&quot;#在文件中跳跃&quot; class=&quot;headerlink&quot; title=&quot;在文件中跳跃&quot;&gt;&lt;/a&gt;在文件中跳跃&lt;/h4&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;命令&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;ctrl+f&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;向下一页&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;ctrl+b&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;向上一页&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;ctrl+d&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;向下一页半&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;ctrl+u&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;向上一页半&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;G&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;跳到最后一行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;1G&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;跳到第一行&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;35G&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;跳到第35行&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&quot;查找文本&quot;&gt;&lt;a href=&quot;#查找文本&quot; class=&quot;headerlink&quot; title=&quot;查找文本&quot;&gt;&lt;/a&gt;查找文本&lt;/h4&gt;&lt;p&gt;查找文本时,”/“和”?”分别对应向前和向后查找,也可以使用一些通配符，比如/The.*foot,&lt;br&gt;?[pP]rint,查找之后可以按n和N来重复查找和按相反方向查找&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;命令&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;/hello&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;向前查找单词”hello”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;?goodbye&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;向后查找单词”goodbye”&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&quot;使用ex模式&quot;&gt;&lt;a href=&quot;#使用ex模式&quot; class=&quot;headerlink&quot; title=&quot;使用ex模式&quot;&gt;&lt;/a&gt;使用ex模式&lt;/h4&gt;&lt;p&gt;当输入冒号,并且光标在最下方时就进入了ex模式，下面是一些在ex模式下查找，修改文本的栗子🌰&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;命令&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;:g/local&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;查找local 并打印&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;:s/local/r&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;将local第一次出现的位置替换为r&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h4 id=&quot;退出vi&quot;&gt;&lt;a href=&quot;#退出vi&quot; class=&quot;headerlink&quot; title=&quot;退出vi&quot;&gt;&lt;/a&gt;退出vi&lt;/h4&gt;&lt;p&gt;以下的命令用来保存和退出文件&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;命令&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;ZZ&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;保存修改 并退出vi&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;:w&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;保存修改 但不退出vi&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;:wq&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;与ZZ命令一样&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;:q&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;退出文件，该命令只有在没有未保存的修改下才起效&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;:q!&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;退出文件 不保存对文件的修改&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&quot;查找文件&quot;&gt;&lt;a href=&quot;#查找文件&quot; class=&quot;headerlink&quot; title=&quot;查找文件&quot;&gt;&lt;/a&gt;查找文件&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;为了帮助用户更有效的查找他们的文件，linux系统提供了locate,find,grep三个命令，依次来看看他们的作用。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;使用localte命令查找文件&quot;&gt;&lt;a href=&quot;#使用localte命令查找文件&quot; class=&quot;headerlink&quot; title=&quot;使用localte命令查找文件&quot;&gt;&lt;/a&gt;使用localte命令查找文件&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;大多数linux系统中，updatedb命令会每天执行一次，将系统中文件的名字存到数据库中。通过locate命令，我们可以查找存在在数据库中的文件的位置。相较于find命令，locate命令效率更高，因为它搜索数据库而不是整个文件系统。不过locate命令也有它的缺点，它并不能找到所有存放在系统的文件，因为并不是所有的文件都会存储于数据库中，/etc/updatedb.conf文件决定了哪些文件将存在于数据库中。另外，普通用户无法通过数据库查找那些他们在文件系统中没有权利查看的文件，比如，普通用户无法在/root目录下执行ls命令，那么他们也无法通过locate查找这个目录下的文件。如果用locate命令查找一个字符串，那么这个字符串可能出现在返回文件的路径的任意位置。举个栗子，查找passwd，结果可能为/etc/passwd,/usr/bin/passwd和其它路径包含passwd的文件。还需要注意的是，如果创建一个文件之后，希望立刻通过locate查找它，最好执行命令updatedb更新下数据库。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ locate .bashrc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/etc/skel/.bashrc &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/home/cnegus/.bashrc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# locate ./bashrc (身份不同 查找结果不同)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/etc/skel/.bashrc &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/home/bill/.bashrc &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/home/joe/.bashrc &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/root/.bashrc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ locate -i muttrc（-i 忽略大小写）/etc/Muttrc/etc/Muttrc.local /usr/share/doc/mutt-1.5.20/sample.muttrc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ locate services (查找的字符串可能出现在文件路径中)/etc/services/usr/share/services/bmp.kmgio /usr/share/services/data.kmgio&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;中场休息，看看我家光洙&lt;br&gt;&lt;img src=&quot;/images/liguangzhu.gif&quot; alt=&quot;李光珠&quot;&gt;&lt;/p&gt;
&lt;h4 id=&quot;使用find命令查找文件&quot;&gt;&lt;a href=&quot;#使用find命令查找文件&quot; class=&quot;headerlink&quot; title=&quot;使用find命令查找文件&quot;&gt;&lt;/a&gt;使用find命令查找文件&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;由于有许多不同的属性，find命令是查找文件的利器。当执行find命令时，它会搜索整个文件系统，这会造成find命令比locate命令耗时长，但同时也能让用户查找到系统中最新的文件。find命令最大的优点在于所有你能想到的文件的属性，都可以通过它查找，例如名字，拥有者，权限，大小，修改时间等等，也可以进行组合查找。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ find (列出当前目录下所有的文件和目录)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ find /etc (列出/etc目录下所有的文件和目录，权限不足时会报错)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ find -ls (列出文件的拥有者，权限，大小等信息)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ find /etc -name passwd（根据名字查找）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ find /etc -iname &lt;span class=&quot;string&quot;&gt;&#39;*passwd*&#39;&lt;/span&gt; （可以使用通配符）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ find /bigdata -size +10G （查找大小大于10G的文件）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ find /smalldata -size -5M (查找大小小于5M的文件)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ find /home -user chris -ls (输出/home目录下拥有者是chris的文件的详细信息)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ find /home -user chris -or -user joe -ls (输出/home目录下拥有者是chris或joe的文件的详细信息)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ find /home -not -user root -ls (输出/home目录下拥有者不是root的文件的详细信息)&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ find /bin -perm 755 -ls（通过权限查找）&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ find . -perm -002 -type f -ls （通过类型查找）&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;find命令还有一个很棒的特性，可以使用-excute和-ok选项可以在查找到的任何文件上执行命令。excute选项会直接在每个找到的文件上执行命令，不会询问是否执行。而ok选项会在每个文件执行命令前询问是否执行。&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ find /etc -iname iptables -exec &lt;span class=&quot;built_in&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;string&quot;&gt;&quot;I found &amp;#123;&amp;#125;&quot;&lt;/span&gt; \; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;I found /etc/bash_completion.d/iptablesI found /etc/sysconfig/iptables&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# find /var/allusers/ -user joe -ok mv &amp;#123;&amp;#125; /tmp/joe/ \;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;mv ... /var/allusers/dict.dat &amp;gt; ? ymv ... /var/allusers/five &amp;gt; ? y&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;img src=&quot;/images/tips.jpg&quot; alt=&quot;提示&quot;&gt; 想了解更多关于find命令的信息，可以执行命令 man find&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;使用grep命令在文件中查找&quot;&gt;&lt;a href=&quot;#使用grep命令在文件中查找&quot; class=&quot;headerlink&quot; title=&quot;使用grep命令在文件中查找&quot;&gt;&lt;/a&gt;使用grep命令在文件中查找&lt;/h4&gt;&lt;blockquote&gt;
&lt;p&gt;如果希望查找包含特定内容的文件，可以使用grep命令。通过grep命令，可以搜索单个文件，也可以递归搜索整个目录。默认情况下，grep命令是大小写敏感的&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ grep desktop /etc/services &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;desktop-dna 2763/tcp &lt;span class=&quot;comment&quot;&gt;# Desktop DNA &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;desktop-dna 2763/udp &lt;span class=&quot;comment&quot;&gt;# Desktop DNA&lt;/span&gt;$ grep -i desktop /etc/servicessco-dtmgr 617/tcp &lt;span class=&quot;comment&quot;&gt;# SCO Desktop Administration Server&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;sco-dtmgr 617/udp &lt;span class=&quot;comment&quot;&gt;# SCO Desktop Administration Server&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;airsync 2175/tcp  &lt;span class=&quot;comment&quot;&gt;# Microsoft Desktop AirSync Protocol&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;第一个例子，是在/etc/services文件中查找字符串desktop.第二个例子通过选项-i,在查找时大小写不敏感&lt;br&gt;-v 是查找不包含指定内容的行，-r是在目录中递归查找，-l是列出文件名 而不是包含内容的具体行&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ grep -v desktop /etc/services&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ grep -rli peerdns /usr/share/doc/ &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/usr/share/doc/dnsmasq-2.66/setup.html &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;/usr/share/doc/initscripts-9.49.17/sysconfig.txt&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;以我大谢耳朵结尾吧，主要看气质，哈哈~~&lt;br&gt;&lt;img src=&quot;/images/sheldon.jpg&quot; alt=&quot;sheldon&quot;&gt;&lt;/p&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;根据书的第5章整理一下关于操作文本文件的常用命令。在Linux系统中许多信息都是在文本文件中管理的,所以熟练掌握对文本文件的更改，查找是很重要的。这一点，在出bug查找服务器日志时真是深有体会啊！😼😼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;相关博客:&lt;br&gt; &lt;a href=&quot;http://yemengying.com/2015/11/23/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition/&quot;&gt;Linux Bible 9th Edition之使用shell&lt;/a&gt;&lt;br&gt; &lt;a href=&quot;http://yemengying.com/2015/11/26/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/&quot;&gt;Linux Bible 9th Edition之文件系统&lt;/a&gt;&lt;br&gt; &lt;a href=&quot;http://yemengying.com/2015/12/24/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E8%BF%9B%E7%A8%8B%E5%A4%A7%E6%B3%95%E5%A5%BD/&quot;&gt;Linux Bible 9th Edition之进程大法好&lt;/a&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="linux" scheme="http://yemengying.com/categories/linux/"/>
    
    
      <category term="linux" scheme="http://yemengying.com/tags/linux/"/>
    
      <category term="读书笔记" scheme="http://yemengying.com/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>读书笔记-Linux Bible 9th Edition之文件系统</title>
    <link href="http://yemengying.com/2015/11/26/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"/>
    <id>http://yemengying.com/2015/11/26/读书笔记-Linux-Bible-9th-Edition之文件系统/</id>
    <published>2015-11-26T08:28:15.000Z</published>
    <updated>2016-02-23T03:46:42.000Z</updated>
    
    <content type="html">&lt;blockquote&gt;
&lt;p&gt;跟着书，重新梳理一下linux文件系统的有关知识, 最近一天一个接口的节奏真真是极好的,有时间看看书了。😻😻😻&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt; 相关博客:&lt;br&gt; &lt;a href=&quot;http://yemengying.com/2015/11/23/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition/&quot;&gt;Linux Bible 9th Edition之使用shell&lt;/a&gt;&lt;br&gt; &lt;a href=&quot;http://yemengying.com/2015/11/30/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E7%8E%A9%E8%BD%AC%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6/&quot;&gt;Linux Bible 9th Edition之玩转文本文件&lt;/a&gt;&lt;br&gt; &lt;a href=&quot;http://yemengying.com/2015/12/24/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E8%BF%9B%E7%A8%8B%E5%A4%A7%E6%B3%95%E5%A5%BD/&quot;&gt;Linux Bible 9th Edition之进程大法好&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/霸气的喵喵.jpg&quot; alt=&quot;霸气的喵喵&quot;&gt;&lt;/p&gt;
&lt;a id=&quot;more&quot;&gt;&lt;/a&gt;
&lt;h3 id=&quot;Linux文件系统结构&quot;&gt;&lt;a href=&quot;#Linux文件系统结构&quot; class=&quot;headerlink&quot; title=&quot;Linux文件系统结构&quot;&gt;&lt;/a&gt;Linux文件系统结构&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;在linux中文件组织在一个层级的目录结构中，每个目录可以包含文件和目录，整体看起来就像一个倒过来的树。最上面就是根目录，用”/“符号表示。根目录下面是linux系统中一些常见的目录,比如bin,dev,home,lib等等。下面的图(书上的截图)展示了linux文件系统的层级结构。&lt;br&gt;&lt;img src=&quot;/images/linux_filesystem.jpg&quot; alt=&quot;linux_filesystem&quot;&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;基本的一些文件系统命令&quot;&gt;&lt;a href=&quot;#基本的一些文件系统命令&quot; class=&quot;headerlink&quot; title=&quot;基本的一些文件系统命令&quot;&gt;&lt;/a&gt;基本的一些文件系统命令&lt;/h3&gt;&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;命令&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;cd&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;进入另一个目录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;pwd&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;打印当前工作目录的路径&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;mkdir&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;创建一个目录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;chmod&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;更改文件或目录的权限&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;ls&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;列出目录的内容&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;cd&lt;/em&gt;命令&lt;br&gt;cd命令是其中最常用的&lt;br&gt;eg：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 进入根目录下的usr目录下的share目录 以&quot;/&quot;开头，代表在根目录下&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; /usr/share&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 只输入cd 回到home目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 进入home目录下的某一目录 &quot;~&quot;代表home目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; ~/coffee&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 回到上一级目录 &quot;..&quot;代表上一级目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;cd&lt;/span&gt; ..&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;创建目录并查看权限&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 创建目录test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ mkdir &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 查看目录权限&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ ls -ld &lt;span class=&quot;built_in&quot;&gt;test&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;使用Metacharacters-元字符-和Operators-操作符&quot;&gt;&lt;a href=&quot;#使用Metacharacters-元字符-和Operators-操作符&quot; class=&quot;headerlink&quot; title=&quot;使用Metacharacters(元字符)和Operators(操作符)&quot;&gt;&lt;/a&gt;使用Metacharacters(元字符)和Operators(操作符)&lt;/h3&gt;&lt;p&gt; 使用metacharacters进行文件匹配     &lt;/p&gt;
&lt;p&gt;  “*”代表任意数量的字符 “?”代表任意一个字符 “[…]”匹配任意一个包含在括号中的字符,也可以用连字符表示一个范围&lt;br&gt;  eg：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 创建5个空文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ touch apple banana grape grapefruit watermelon&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ ls a*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;apple&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ ls g*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;grape &lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ ls g???e&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;grape&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ ls [abw]*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;apple banana watermelon&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ ls [a-g]*&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;apple banana grape grapefruit&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt; 使用metacharacters进行文件重定向&lt;br&gt;    使用管道符号”|”可以将一个命令的标准输出(standard output)作为另一个命令的标准输入(standard input)。对于文件，我们可以用”&amp;lt;”和”&amp;gt;”来将数据从文件中输入或输出。&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;符号&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;&amp;lt;&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;文件的内容输入到命令&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;&amp;gt;&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;将一个命令的标准输出输出到文件，如果文件已存在,文件的内容会被覆盖&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;2&amp;gt;&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;将错误输出输出到文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;&amp;amp;&amp;gt;&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;将标准输出和错误输出都输出到文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;&amp;gt;&amp;gt;&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;将命令的输出到文件中，不覆盖文件原有内容，将输出添加到文件最后&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;&amp;lt;&amp;lt;&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;后面要跟着一个单词，之后所有的输入都会当做用户输入，直到重复输入符号后的单词&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt; 使用大括号 &lt;/p&gt;
&lt;p&gt; 通过使用大括号”{}”,可以在文件名后扩展一组元素。&lt;br&gt; eg:&lt;br&gt; &lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ touch &amp;#123;a,b,c&amp;#125;-&amp;#123;1,2,3&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ ls&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;a-1 a-2 a-3 b-1 b-2 b-3 c-1 c-2 c-3&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h3 id=&quot;列出文件和目录&quot;&gt;&lt;a href=&quot;#列出文件和目录&quot; class=&quot;headerlink&quot; title=&quot;列出文件和目录&quot;&gt;&lt;/a&gt;列出文件和目录&lt;/h3&gt;&lt;p&gt;在linux系统中,&lt;em&gt;ls&lt;/em&gt;命令用来列出文件和目录的有关信息，&lt;em&gt;ls&lt;/em&gt;命令有许多option。在默认情况下，输入&lt;em&gt;ls&lt;/em&gt;，会输出当前目录下所有的非隐藏的文件和目录。如果在命令后在上选项”-l”会输出详细的信息(如下)，其中total代表了目录中的内容占用了多少磁盘空间;第一列第一个字符代表了文件的类型，”-“代表普通文件，”d”代表是目录，”l”代表是一个符号链接,剩下的9个字符代表了文件的权限(下面会讲);第二列展示了文件硬链接数或目录子目录数;第三列显示了文件或目录的拥有者;第四列代表文件拥有者所在的组;第五列是文件的大小;第六列是文件最后的修改时间;最后一列展示了文件或目录的名字;&lt;br&gt;eg：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;$ ls &lt;span class=&quot;_&quot;&gt;-l&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;total 4-rw-rw-r--. 1 joe joe 0 Dec 18 13:38 applelrwxrwxrwx. 1 joe joe 5 Dec 18 13:46 pointer_to_apple -&amp;gt; apple -rwxr-xr-x. 1 joe joe 0 Dec 18 13:37 scriptx.shdrwxrwxr-x. 2 joe joe 4096 Dec 18 13:38 Stuff&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;em&gt;ls&lt;/em&gt;命令的其它选项：&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style=&quot;text-align:left&quot;&gt;选项&lt;/th&gt;
&lt;th style=&quot;text-align:left&quot;&gt;作用&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;-a&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;展示包含隐藏文件(以.开头)在内的所有文件&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;-t&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;按照最近修改时间展示&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;-F&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;在展示时，在目录名后加”/“,在可执行文件后加”*”,在符号链接后加”@”&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;-S&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;展示时按大小排序&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;-d&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;只展示包含的目录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;-R&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;递归的列出当前目录下所有的文件和目录&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=&quot;text-align:left&quot;&gt;–hide=&lt;/td&gt;
&lt;td style=&quot;text-align:left&quot;&gt;不展示指定目录或文件&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h3 id=&quot;理解文件权限&quot;&gt;&lt;a href=&quot;#理解文件权限&quot; class=&quot;headerlink&quot; title=&quot;理解文件权限&quot;&gt;&lt;/a&gt;理解文件权限&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;在使用Linux系统时，经常会看到”Permission Denied”(权限不足)的提示。权限控制是为了避免用户访问其他用户的私有文件和保护重要的系统文件。在Linux中，每个文件对应一个9bit的权限信息(eg:rwxrwxrwx)。其中前三位代表了文件拥有者的权限，中间三位代表了拥有者所在组的权限，最后三位代表了其他用户的权限。权限由字母代表，”r”代表读权限，”w”代表写权限，”x”代表执行权限，如果某一位不是字母，而是”-“，则代表没有该位所代表的权限。举个两个栗子🌰🌰，”rw-“代表有读写权限，没有执行权限；”r–”代表只有读权限&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;使用chmod命令更改权限&quot;&gt;&lt;a href=&quot;#使用chmod命令更改权限&quot; class=&quot;headerlink&quot; title=&quot;使用chmod命令更改权限&quot;&gt;&lt;/a&gt;使用chmod命令更改权限&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;使用数字&lt;blockquote&gt;
&lt;p&gt;文件的拥有者可以改变文件的权限，每种权限都对应了一个数字，读权限r对应4，写权限w对应2，执行权限x对应1。可以通过设置数值来建立权限。&lt;br&gt;eg:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 设置权限 rwxrwxrwx&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chmod 777 filename&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 设置权限 rwxr-xr-x&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chomd 755 filename&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 设置权限 rw-r--r--&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chomd 644 filename&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 设置权限 ---------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chmod 000 filename&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;使用字母&lt;blockquote&gt;
&lt;p&gt;在linux中，还有另一种改变权限的方式。在这种方式中，”+”和”-“分别代表权限的开和关。字母”u”,”g”,”o”和”a”分别代表拥有者,组，其他用户和全部用户。和上一种方式一样”r”,”w”,”x”分别代表读、写和执行权限。&lt;br&gt;eg：&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 设置权限 将权限rwxrwxrwx改为r-xr-xr-x&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chmod a-w filename&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 设置权限 将权限rwxrwxrwx改为rwxrwxrw-&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chomd o-x filename&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 设置权限 将权限rwxrwxrwx改为rwx------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chmod go-rwx filename&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 设置权限 将权限---------改为rw-------&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chmod u+rw filename&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 更改目录下所有文件和目录的权限&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chmod -R o-w myapps&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;使用umask设置默认权限&lt;blockquote&gt;
&lt;p&gt;普通用户创建文件 默认权限是rw-rw-r–，创建目录 默认权限是rwxrwxr-x。root用户创建文件和目录权限分别是rw-r–r–和rwxr-xr-x。这些默认值由&lt;em&gt;umask&lt;/em&gt;的值决定，可通过命令&lt;em&gt;umask&lt;/em&gt;查看它的值。与&lt;em&gt;chmod&lt;/em&gt;效果刚好相反，&lt;em&gt;umask&lt;/em&gt;设置的是权限的补码，&lt;em&gt;umask&lt;/em&gt;的值有三位分别对应拥有者，同组用户和其他用户的权限。对于文件来说，每一位的最大值是6，因为系统不允许在创建一个文件时就赋予执行权限，需通过&lt;em&gt;chmod&lt;/em&gt;设置；对于目录来说每一位的最大值是7。例如&lt;em&gt;umask&lt;/em&gt;值002所对应的文件和目录的创建权限是664和775。可通过&lt;em&gt;umask&lt;/em&gt;命令改变默认值。&lt;br&gt;eg：&lt;/p&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 查看默认值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;umask&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 改变默认值&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ &lt;span class=&quot;built_in&quot;&gt;umask&lt;/span&gt; 022&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;改变文件的拥有者&quot;&gt;&lt;a href=&quot;#改变文件的拥有者&quot; class=&quot;headerlink&quot; title=&quot;改变文件的拥有者&quot;&gt;&lt;/a&gt;改变文件的拥有者&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;作为普通用户，是不能更改文件或目录的拥有者的，只有root user(管理员才可以)。&lt;br&gt;eg:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 修改文件的拥有者&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chown giraffe filename.text&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 同时修改拥有者和组&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chown giraffe:coffee filename.txt&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 修改目录下的所有目录和文件的拥有者&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# chown -R giraffe:coffee /mydic&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h3 id=&quot;移动-复制-删除文件&quot;&gt;&lt;a href=&quot;#移动-复制-删除文件&quot; class=&quot;headerlink&quot; title=&quot;移动 复制 删除文件&quot;&gt;&lt;/a&gt;移动 复制 删除文件&lt;/h3&gt;&lt;blockquote&gt;
&lt;p&gt;移动、复制和删除文件的命令很简单。如果想要改变文件的位置，使用&lt;em&gt;mv&lt;/em&gt;命令。如果想要复制文件，使用&lt;em&gt;cp&lt;/em&gt;命令。如果想要删除文件，使用&lt;em&gt;rm&lt;/em&gt;命令。这些命令可以使用在单一的文件和目录上，也可以递归的使用在许多文件和目录上。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;移动文件&lt;br&gt;eg：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 将文件abc移到home目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ mv abc ~&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 将目录mydemo的全部内容移到目录document中&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ mv /home/giraffe/mydemo /home/giraffe/document&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;复制文件&lt;br&gt;eg：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 将文件abc复制到home目录下&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ cp abc ~&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 将目录bash-completion*下的内容复制到tmp/a下&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ cp -r /usr/share/bash-completion* /tmp/a&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 将目录bash-completion*下的内容复制到tmp/a下 并且保留权限&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ cp -ra /usr/share/bash-completion* /tmp/a&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;ul&gt;
&lt;li&gt;删除文件&lt;br&gt;eg：&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&quot;highlight bash&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 删除文件abc&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ rm abc&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 删除当前目录下所有文件&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ rm *&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 删除一个空的目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ rmdir /home/giraffe/empty&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 删除目录和他包含的所有内容&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ rm -r /home/giraffe/bigdir&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;&lt;span class=&quot;comment&quot;&gt;# 不提示的删除目录和它包含的所有内容&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;line&quot;&gt;$ rm -rf /home/giraffe/bigdir&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
</content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;跟着书，重新梳理一下linux文件系统的有关知识, 最近一天一个接口的节奏真真是极好的,有时间看看书了。😻😻😻&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt; 相关博客:&lt;br&gt; &lt;a href=&quot;http://yemengying.com/2015/11/23/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition/&quot;&gt;Linux Bible 9th Edition之使用shell&lt;/a&gt;&lt;br&gt; &lt;a href=&quot;http://yemengying.com/2015/11/30/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E7%8E%A9%E8%BD%AC%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6/&quot;&gt;Linux Bible 9th Edition之玩转文本文件&lt;/a&gt;&lt;br&gt; &lt;a href=&quot;http://yemengying.com/2015/12/24/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0-Linux-Bible-9th-Edition%E4%B9%8B%E8%BF%9B%E7%A8%8B%E5%A4%A7%E6%B3%95%E5%A5%BD/&quot;&gt;Linux Bible 9th Edition之进程大法好&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/images/霸气的喵喵.jpg&quot; alt=&quot;霸气的喵喵&quot;&gt;&lt;/p&gt;
    
    </summary>
    
      <category term="linux" scheme="http://yemengying.com/categories/linux/"/>
    
    
      <category term="linux" scheme="http://yemengying.com/tags/linux/"/>
    
      <category term="读书笔记" scheme="http://yemengying.com/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
</feed>
